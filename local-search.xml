<?xml version="1.0" encoding="utf-8"?>
<search>
  
  
  
  <entry>
    <title>C-ã€Šç¨‹è‰¾å½±ã€‹</title>
    <link href="/2022/10/28/c-cheng-ai-ying/"/>
    <url>/2022/10/28/c-cheng-ai-ying/</url>
    
    <content type="html"><![CDATA[<center>ã€Šç¨‹è‰¾å½±ã€‹</center><p><img src="/2022/10/28/c-cheng-ai-ying/image-20221028201426573.png" alt></p><p>capo = 5</p><p>å‰å¥-ä¸»æ­Œ-å‰¯æ­Œ-é—´æ­‡-ä¸»æ­Œ-å‰¯æ­Œ-å“¼å”±-å‰¯æ­Œ-ä¸»æ­Œ-å°¾å¥</p><p><img src="/2022/10/28/c-cheng-ai-ying/image-20221028201251237.png" alt></p><p><img src="/2022/10/28/c-cheng-ai-ying/image-20221028201315318.png" alt></p><p><img src="/2022/10/28/c-cheng-ai-ying/image-20221028201340211.png" alt></p><blockquote><p>æ›²è°±æ¥æºäºå°å…µer</p></blockquote>]]></content>
    
    
    <categories>
      
      <category>å‰ä»–</category>
      
    </categories>
    
    
    <tags>
      
      <tag>å‰ä»–</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>C-ã€Šå¤œç©ºä¸­æœ€äº®çš„æ˜Ÿã€‹</title>
    <link href="/2022/10/28/c-ye-kong-zhong-zui-liang-de-xing/"/>
    <url>/2022/10/28/c-ye-kong-zhong-zui-liang-de-xing/</url>
    
    <content type="html"><![CDATA[<center>ã€Šå¤œç©ºä¸­æœ€äº®çš„æ˜Ÿã€‹</center><p>åŸè°ƒB | é€‰è°ƒA | capo = 2</p><p><img src="/2022/10/28/c-ye-kong-zhong-zui-liang-de-xing/image-20221028194640928.png" alt></p><p><img src="/2022/10/28/c-ye-kong-zhong-zui-liang-de-xing/image-20221028194753369.png" alt></p><blockquote><p>æ›²è°±æ¥æºäºè¶£è°ˆéŸ³ä¹</p></blockquote>]]></content>
    
    
    <categories>
      
      <category>å‰ä»–</category>
      
    </categories>
    
    
    <tags>
      
      <tag>å‰ä»–</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>JVM-03-è¿è¡Œæ—¶æ•°æ®åŒº</title>
    <link href="/2022/10/27/jvm-03-yun-xing-shi-shu-ju-qu/"/>
    <url>/2022/10/27/jvm-03-yun-xing-shi-shu-ju-qu/</url>
    
    <content type="html"><![CDATA[<h1>1ã€è¿è¡Œæ—¶æ•°æ®åŒºæ¦‚è¿°åŠçº¿ç¨‹</h1><h2 id="1ã€æ¦‚è¿°">1ã€æ¦‚è¿°</h2><p>è¿è¡Œæ—¶æ•°æ®åŒºï¼Œä¹Ÿå°±æ˜¯ä¸‹å›¾è¿™éƒ¨åˆ†ï¼Œå®ƒæ˜¯åœ¨ç±»åŠ è½½å®Œæˆåçš„é˜¶æ®µ</p><p><img src="/2022/10/27/jvm-03-yun-xing-shi-shu-ju-qu/image-20221027165103294.png" alt></p><p>å½“æˆ‘ä»¬é€šè¿‡å‰é¢çš„ï¼šç±»çš„åŠ è½½ â€“&gt; éªŒè¯ â€“&gt; å‡†å¤‡ â€“&gt; è§£æ â€“&gt; åˆå§‹åŒ–ï¼Œè¿™å‡ ä¸ªé˜¶æ®µå®Œæˆåï¼Œå°±ä¼šç”¨åˆ°æ‰§è¡Œå¼•æ“å¯¹æˆ‘ä»¬çš„ç±»è¿›è¡Œä½¿ç”¨ï¼ŒåŒæ—¶æ‰§è¡Œå¼•æ“å°†ä¼šä½¿ç”¨åˆ°æˆ‘ä»¬è¿è¡Œæ—¶æ•°æ®åŒº</p><p><img src="/2022/10/27/jvm-03-yun-xing-shi-shu-ju-qu/image-20221027165118280.png" alt></p><p>ç±»æ¯”ä¸€ä¸‹ä¹Ÿå°±æ˜¯å¤§å¨åšé¥­ï¼Œæˆ‘ä»¬æŠŠå¤§å¨åé¢çš„ä¸œè¥¿ï¼ˆåˆ‡å¥½çš„èœï¼Œåˆ€ï¼Œè°ƒæ–™ï¼‰ï¼Œæ¯”ä½œæ˜¯è¿è¡Œæ—¶æ•°æ®åŒºã€‚è€Œå¨å¸ˆå¯ä»¥ç±»æ¯”äºæ‰§è¡Œå¼•æ“ï¼Œå°†é€šè¿‡å‡†å¤‡çš„ä¸œè¥¿è¿›è¡Œåˆ¶ä½œæˆç²¾ç¾çš„èœå“ã€‚</p><p><img src="/2022/10/27/jvm-03-yun-xing-shi-shu-ju-qu/image-20221027165152827.png" alt></p><h2 id="2ã€è¿è¡Œæ—¶æ•°æ®åŒºç»“æ„">2ã€è¿è¡Œæ—¶æ•°æ®åŒºç»“æ„</h2><h3 id="1ã€è¿è¡Œæ—¶æ•°æ®åŒºå’Œå†…å­˜">1ã€è¿è¡Œæ—¶æ•°æ®åŒºå’Œå†…å­˜</h3><ol><li>å†…å­˜æ˜¯éå¸¸é‡è¦çš„ç³»ç»Ÿèµ„æºï¼Œæ˜¯ç¡¬ç›˜å’ŒCPUçš„ä¸­é—´ä»“åº“åŠæ¡¥æ¢ï¼Œæ‰¿è½½ç€æ“ä½œç³»ç»Ÿå’Œåº”ç”¨ç¨‹åºçš„å®æ—¶è¿è¡Œã€‚JVMå†…å­˜å¸ƒå±€è§„å®šäº†Javaåœ¨è¿è¡Œè¿‡ç¨‹ä¸­å†…å­˜ç”³è¯·ã€åˆ†é…ã€ç®¡ç†çš„ç­–ç•¥ï¼Œä¿è¯äº†JVMçš„é«˜æ•ˆç¨³å®šè¿è¡Œã€‚<strong>ä¸åŒçš„JVMå¯¹äºå†…å­˜çš„åˆ’åˆ†æ–¹å¼å’Œç®¡ç†æœºåˆ¶å­˜åœ¨ç€éƒ¨åˆ†å·®å¼‚</strong>ã€‚ç»“åˆJVMè™šæ‹Ÿæœºè§„èŒƒï¼Œæ¥æ¢è®¨ä¸€ä¸‹ç»å…¸çš„JVMå†…å­˜å¸ƒå±€ã€‚</li><li>æˆ‘ä»¬é€šè¿‡ç£ç›˜æˆ–è€…ç½‘ç»œIOå¾—åˆ°çš„æ•°æ®ï¼Œéƒ½éœ€è¦å…ˆåŠ è½½åˆ°å†…å­˜ä¸­ï¼Œç„¶åCPUä»å†…å­˜ä¸­è·å–æ•°æ®è¿›è¡Œè¯»å–ï¼Œä¹Ÿå°±æ˜¯è¯´å†…å­˜å……å½“äº†CPUå’Œç£ç›˜ä¹‹é—´çš„æ¡¥æ¢</li></ol><p>ä¸‹å›¾æºäºé˜¿é‡Œå·´å·´æ‰‹å†Œjdk8</p><p><img src="/2022/10/27/jvm-03-yun-xing-shi-shu-ju-qu/image-20221027170903919.png" alt></p><h3 id="2ã€çº¿ç¨‹çš„å†…å­˜ç©ºé—´">2ã€çº¿ç¨‹çš„å†…å­˜ç©ºé—´</h3><ol><li>Javaè™šæ‹Ÿæœºå®šä¹‰äº†è‹¥å¹²ç§ç¨‹åºè¿è¡ŒæœŸé—´ä¼šä½¿ç”¨åˆ°çš„è¿è¡Œæ—¶æ•°æ®åŒºï¼šå…¶ä¸­æœ‰ä¸€äº›ä¼šéšç€è™šæ‹Ÿæœºå¯åŠ¨è€Œåˆ›å»ºï¼Œéšç€è™šæ‹Ÿæœºé€€å‡ºè€Œé”€æ¯ã€‚å¦å¤–ä¸€äº›åˆ™æ˜¯ä¸çº¿ç¨‹ä¸€ä¸€å¯¹åº”çš„ï¼Œè¿™äº›ä¸çº¿ç¨‹å¯¹åº”çš„æ•°æ®åŒºåŸŸä¼šéšç€çº¿ç¨‹å¼€å§‹å’Œç»“æŸè€Œåˆ›å»ºå’Œé”€æ¯ã€‚</li><li>ç°è‰²çš„ä¸ºå•ç‹¬çº¿ç¨‹ç§æœ‰çš„ï¼Œçº¢è‰²çš„ä¸ºå¤šä¸ªçº¿ç¨‹å…±äº«çš„ã€‚å³ï¼š<ul><li>çº¿ç¨‹ç‹¬æœ‰ï¼šç‹¬ç«‹åŒ…æ‹¬ç¨‹åºè®¡æ•°å™¨ã€æ ˆã€æœ¬åœ°æ–¹æ³•æ ˆ</li><li>çº¿ç¨‹é—´å…±äº«ï¼šå †ã€å †å¤–å†…å­˜ï¼ˆæ°¸ä¹…ä»£æˆ–å…ƒç©ºé—´ã€ä»£ç ç¼“å­˜ï¼‰</li></ul></li></ol><p><img src="/2022/10/27/jvm-03-yun-xing-shi-shu-ju-qu/image-20221027171302313.png" alt></p><h3 id="3ã€Runtimeç±»">3ã€Runtimeç±»</h3><p><strong>æ¯ä¸ªJVMåªæœ‰ä¸€ä¸ªRuntimeå®ä¾‹</strong>ã€‚å³ä¸ºè¿è¡Œæ—¶ç¯å¢ƒï¼Œç›¸å½“äºå†…å­˜ç»“æ„çš„ä¸­é—´çš„é‚£ä¸ªæ¡†æ¡†ï¼šè¿è¡Œæ—¶ç¯å¢ƒï¼ˆè¿è¡Œæ—¶æ•°æ®åŒºï¼‰ã€‚</p><p><img src="/2022/10/27/jvm-03-yun-xing-shi-shu-ju-qu/image-20221027171346233.png" alt></p><h2 id="3ã€çº¿ç¨‹">3ã€çº¿ç¨‹</h2><h3 id="1ã€JVMçº¿ç¨‹">1ã€JVMçº¿ç¨‹</h3><ol><li>çº¿ç¨‹æ˜¯ä¸€ä¸ªç¨‹åºé‡Œçš„è¿è¡Œå•å…ƒã€‚JVMå…è®¸ä¸€ä¸ªåº”ç”¨æœ‰å¤šä¸ªçº¿ç¨‹å¹¶è¡Œçš„æ‰§è¡Œ</li><li>åœ¨Hotspot JVMé‡Œï¼Œæ¯ä¸ªçº¿ç¨‹éƒ½ä¸æ“ä½œç³»ç»Ÿçš„æœ¬åœ°çº¿ç¨‹ç›´æ¥æ˜ å°„<ul><li>å½“ä¸€ä¸ªJavaçº¿ç¨‹å‡†å¤‡å¥½æ‰§è¡Œä»¥åï¼Œæ­¤æ—¶ä¸€ä¸ªæ“ä½œç³»ç»Ÿçš„æœ¬åœ°çº¿ç¨‹ä¹ŸåŒæ—¶åˆ›å»ºã€‚Javaçº¿ç¨‹æ‰§è¡Œç»ˆæ­¢åï¼Œæœ¬åœ°çº¿ç¨‹ä¹Ÿä¼šå›æ”¶</li></ul></li><li>æ“ä½œç³»ç»Ÿè´Ÿè´£å°†çº¿ç¨‹å®‰æ’è°ƒåº¦åˆ°ä»»ä½•ä¸€ä¸ªå¯ç”¨çš„CPUä¸Šã€‚ä¸€æ—¦æœ¬åœ°çº¿ç¨‹åˆå§‹åŒ–æˆåŠŸï¼Œå®ƒå°±ä¼šè°ƒç”¨Javaçº¿ç¨‹ä¸­çš„run()æ–¹æ³•</li></ol><h3 id="2ã€JVMç³»ç»Ÿçº¿ç¨‹">2ã€JVMç³»ç»Ÿçº¿ç¨‹</h3><ul><li>å¦‚æœä½¿ç”¨jconsoleæˆ–è€…æ˜¯ä»»ä½•ä¸€ä¸ªè°ƒè¯•å·¥å…·ï¼Œéƒ½èƒ½çœ‹åˆ°åœ¨åå°æœ‰è®¸å¤šçº¿ç¨‹åœ¨è¿è¡Œã€‚è¿™äº›åå°çº¿ç¨‹ä¸åŒ…æ‹¬è°ƒç”¨<code>public static void main(String[])</code>çš„mainçº¿ç¨‹ä»¥åŠæ‰€æœ‰è¿™ä¸ªmainçº¿ç¨‹è‡ªå·±åˆ›å»ºçš„çº¿ç¨‹ã€‚</li><li>è¿™äº›ä¸»è¦çš„åå°ç³»ç»Ÿçº¿ç¨‹åœ¨Hotspot JVMé‡Œä¸»è¦æ˜¯ä»¥ä¸‹å‡ ä¸ªï¼ˆäº†è§£ï¼‰ï¼š</li></ul><ol><li><strong>è™šæ‹Ÿæœºçº¿ç¨‹</strong>ï¼šè¿™ç§çº¿ç¨‹çš„æ“ä½œæ˜¯éœ€è¦JVMè¾¾åˆ°å®‰å…¨ç‚¹æ‰ä¼šå‡ºç°ã€‚è¿™äº›æ“ä½œå¿…é¡»åœ¨ä¸åŒçš„çº¿ç¨‹ä¸­å‘ç”Ÿçš„åŸå› æ˜¯ä»–ä»¬éƒ½éœ€è¦JVMè¾¾åˆ°å®‰å…¨ç‚¹ï¼Œè¿™æ ·å †æ‰ä¸ä¼šå˜åŒ–ã€‚è¿™ç§çº¿ç¨‹çš„æ‰§è¡Œç±»å‹æ‹¬â€stop-the-worldâ€çš„åƒåœ¾æ”¶é›†ï¼Œçº¿ç¨‹æ ˆæ”¶é›†ï¼Œçº¿ç¨‹æŒ‚èµ·ä»¥åŠåå‘é”æ’¤é”€</li><li><strong>å‘¨æœŸä»»åŠ¡çº¿ç¨‹</strong>ï¼šè¿™ç§çº¿ç¨‹æ˜¯æ—¶é—´å‘¨æœŸäº‹ä»¶çš„ä½“ç°ï¼ˆæ¯”å¦‚ä¸­æ–­ï¼‰ï¼Œä»–ä»¬ä¸€èˆ¬ç”¨äºå‘¨æœŸæ€§æ“ä½œçš„è°ƒåº¦æ‰§è¡Œ</li><li><strong>GCçº¿ç¨‹</strong>ï¼šè¿™ç§çº¿ç¨‹å¯¹åœ¨JVMé‡Œä¸åŒç§ç±»çš„åƒåœ¾æ”¶é›†è¡Œä¸ºæä¾›äº†æ”¯æŒ</li><li><strong>ç¼–è¯‘çº¿ç¨‹</strong>ï¼šè¿™ç§çº¿ç¨‹åœ¨è¿è¡Œæ—¶ä¼šå°†å­—èŠ‚ç ç¼–è¯‘æˆåˆ°æœ¬åœ°ä»£ç </li><li><strong>ä¿¡å·è°ƒåº¦çº¿ç¨‹</strong>ï¼šè¿™ç§çº¿ç¨‹æ¥æ”¶ä¿¡å·å¹¶å‘é€ç»™JVMï¼Œåœ¨å®ƒå†…éƒ¨é€šè¿‡è°ƒç”¨é€‚å½“çš„æ–¹æ³•è¿›è¡Œå¤„ç†</li></ol><h1>2ã€ç¨‹åºè®¡æ•°å™¨(PCå¯„å­˜å™¨)</h1><h2 id="1ã€PCå¯„å­˜å™¨ä»‹ç»">1ã€PCå¯„å­˜å™¨ä»‹ç»</h2><blockquote><p>å®˜æ–¹æ–‡æ¡£ç½‘å€ï¼š<a href="https://docs.oracle.com/javase/specs/jvms/se8/html/index.html">https://docs.oracle.com/javase/specs/jvms/se8/html/index.html</a></p></blockquote><p><img src="/2022/10/27/jvm-03-yun-xing-shi-shu-ju-qu/image-20221027194012157.png" alt></p><ol><li>JVMä¸­çš„ç¨‹åºè®¡æ•°å¯„å­˜å™¨ï¼ˆProgram Counter Registerï¼‰ä¸­ï¼ŒRegisterçš„å‘½åæºäºCPUçš„å¯„å­˜å™¨ï¼Œ<strong>å¯„å­˜å™¨å­˜å‚¨æŒ‡ä»¤ç›¸å…³çš„ç°åœºä¿¡æ¯</strong>ã€‚CPUåªæœ‰æŠŠæ•°æ®è£…è½½åˆ°å¯„å­˜å™¨æ‰èƒ½å¤Ÿè¿è¡Œã€‚</li><li>è¿™é‡Œï¼Œå¹¶éæ˜¯å¹¿ä¹‰ä¸Šæ‰€æŒ‡çš„ç‰©ç†å¯„å­˜å™¨ï¼Œæˆ–è®¸å°†å…¶ç¿»è¯‘ä¸ºPCè®¡æ•°å™¨ï¼ˆæˆ–æŒ‡ä»¤è®¡æ•°å™¨ï¼‰ä¼šæ›´åŠ è´´åˆ‡ï¼ˆä¹Ÿç§°ä¸ºç¨‹åºé’©å­ï¼‰ï¼Œå¹¶ä¸”ä¹Ÿä¸å®¹æ˜“å¼•èµ·ä¸€äº›ä¸å¿…è¦çš„è¯¯ä¼šã€‚<code>JVMä¸­çš„PCå¯„å­˜å™¨æ˜¯å¯¹ç‰©ç†PCå¯„å­˜å™¨çš„ä¸€ç§æŠ½è±¡æ¨¡æ‹Ÿ</code>ã€‚</li><li>å®ƒæ˜¯ä¸€å—å¾ˆå°çš„å†…å­˜ç©ºé—´ï¼Œå‡ ä¹å¯ä»¥å¿½ç•¥ä¸è®°ã€‚ä¹Ÿæ˜¯è¿è¡Œé€Ÿåº¦æœ€å¿«çš„å­˜å‚¨åŒºåŸŸã€‚</li><li>åœ¨JVMè§„èŒƒä¸­ï¼Œæ¯ä¸ªçº¿ç¨‹éƒ½æœ‰å®ƒè‡ªå·±çš„ç¨‹åºè®¡æ•°å™¨ï¼Œæ˜¯çº¿ç¨‹ç§æœ‰çš„ï¼Œç”Ÿå‘½å‘¨æœŸä¸çº¿ç¨‹çš„ç”Ÿå‘½å‘¨æœŸä¿æŒä¸€è‡´ã€‚</li><li>ä»»ä½•æ—¶é—´ä¸€ä¸ªçº¿ç¨‹éƒ½åªæœ‰ä¸€ä¸ªæ–¹æ³•åœ¨æ‰§è¡Œï¼Œä¹Ÿå°±æ˜¯æ‰€è°“çš„<strong>å½“å‰æ–¹æ³•</strong>ã€‚ç¨‹åºè®¡æ•°å™¨ä¼šå­˜å‚¨å½“å‰çº¿ç¨‹æ­£åœ¨æ‰§è¡Œçš„Javaæ–¹æ³•çš„JVMæŒ‡ä»¤åœ°å€ï¼›æˆ–è€…ï¼Œå¦‚æœæ˜¯åœ¨æ‰§è¡Œnativeæ–¹æ³•ï¼Œåˆ™æ˜¯æœªæŒ‡å®šå€¼ï¼ˆundefnedï¼‰ã€‚</li><li>å®ƒæ˜¯<strong>ç¨‹åºæ§åˆ¶æµ</strong>çš„æŒ‡ç¤ºå™¨ï¼Œåˆ†æ”¯ã€å¾ªç¯ã€è·³è½¬ã€å¼‚å¸¸å¤„ç†ã€çº¿ç¨‹æ¢å¤ç­‰åŸºç¡€åŠŸèƒ½éƒ½éœ€è¦ä¾èµ–è¿™ä¸ªè®¡æ•°å™¨æ¥å®Œæˆã€‚</li><li>å­—èŠ‚ç è§£é‡Šå™¨å·¥ä½œæ—¶å°±æ˜¯é€šè¿‡æ”¹å˜è¿™ä¸ªè®¡æ•°å™¨çš„å€¼æ¥é€‰å–ä¸‹ä¸€æ¡éœ€è¦æ‰§è¡Œçš„å­—èŠ‚ç æŒ‡ä»¤ã€‚</li><li>å®ƒæ˜¯<strong>å”¯ä¸€ä¸€ä¸ª</strong>åœ¨Javaè™šæ‹Ÿæœºè§„èŒƒä¸­æ²¡æœ‰è§„å®šä»»ä½•OutofMemoryErrorï¼ˆæº¢å‡ºï¼‰æƒ…å†µçš„åŒºåŸŸã€‚</li></ol><h2 id="2ã€PCå¯„å­˜å™¨çš„ä½œç”¨">2ã€PCå¯„å­˜å™¨çš„ä½œç”¨</h2><p>PCå¯„å­˜å™¨ç”¨æ¥å­˜å‚¨æŒ‡å‘ä¸‹ä¸€æ¡æŒ‡ä»¤çš„åœ°å€ï¼Œä¹Ÿå³å°†è¦æ‰§è¡Œçš„æŒ‡ä»¤ä»£ç ã€‚ç”±æ‰§è¡Œå¼•æ“è¯»å–ä¸‹ä¸€æ¡æŒ‡ä»¤ï¼Œå¹¶æ‰§è¡Œè¯¥æŒ‡ä»¤ã€‚</p><p><img src="/2022/10/27/jvm-03-yun-xing-shi-shu-ju-qu/image-20221027194401567.png" alt></p><h2 id="3ã€ä¾‹å­">3ã€ä¾‹å­</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">PCRegisterTest</span> &#123;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span> &#123;<br>        <span class="hljs-type">int</span> <span class="hljs-variable">i</span> <span class="hljs-operator">=</span> <span class="hljs-number">10</span>;<br>        <span class="hljs-type">int</span> <span class="hljs-variable">j</span> <span class="hljs-operator">=</span> <span class="hljs-number">20</span>;<br>        <span class="hljs-type">int</span> <span class="hljs-variable">k</span> <span class="hljs-operator">=</span> i + j;<br><br>        <span class="hljs-type">String</span> <span class="hljs-variable">s</span> <span class="hljs-operator">=</span> <span class="hljs-string">&quot;abc&quot;</span>;<br>        System.out.println(i);<br>        System.out.println(k);<br><br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>æŸ¥çœ‹å­—èŠ‚ç </p><blockquote><p>çœ‹å­—èŠ‚ç çš„æ–¹æ³•ï¼š<a href="https://blog.csdn.net/21aspnet/article/details/88351875">https://blog.csdn.net/21aspnet/article/details/88351875</a></p></blockquote><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br></pre></td><td class="code"><pre><code class="hljs java">Classfile /F:/IDEAWorkSpaceSourceCode/JVMDemo/out/production/chapter04/com/atguigu/java/PCRegisterTest.<span class="hljs-keyword">class</span><br>  <span class="hljs-title class_">Last</span> modified <span class="hljs-number">2020</span>-<span class="hljs-number">11</span>-<span class="hljs-number">2</span>; size <span class="hljs-number">675</span> bytes<br>  MD5 checksum 53b3ef104479ec9e9b7ce5319e5881d3<br>  Compiled from <span class="hljs-string">&quot;PCRegisterTest.java&quot;</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">com</span>.atguigu.java.PCRegisterTest<br>  minor version: <span class="hljs-number">0</span><br>  major version: <span class="hljs-number">52</span><br>  flags: ACC_PUBLIC, ACC_SUPER<br>Constant pool:<br>   #<span class="hljs-number">1</span> = Methodref          #<span class="hljs-number">6.</span>#<span class="hljs-number">26</span>         <span class="hljs-comment">// java/lang/Object.&quot;&lt;init&gt;&quot;:()V</span><br>   #<span class="hljs-number">2</span> = String             #<span class="hljs-number">27</span>            <span class="hljs-comment">// abc</span><br>   #<span class="hljs-number">3</span> = Fieldref           #<span class="hljs-number">28.</span>#<span class="hljs-number">29</span>        <span class="hljs-comment">// java/lang/System.out:Ljava/io/PrintStream;</span><br>   #<span class="hljs-number">4</span> = Methodref          #<span class="hljs-number">30.</span>#<span class="hljs-number">31</span>        <span class="hljs-comment">// java/io/PrintStream.println:(I)V</span><br>   #<span class="hljs-number">5</span> = Class              #<span class="hljs-number">32</span>            <span class="hljs-comment">// com/atguigu/java/PCRegisterTest</span><br>   #<span class="hljs-number">6</span> = Class              #<span class="hljs-number">33</span>            <span class="hljs-comment">// java/lang/Object</span><br>   #<span class="hljs-number">7</span> = Utf8               &lt;init&gt;<br>   #<span class="hljs-number">8</span> = Utf8               ()V<br>   #<span class="hljs-number">9</span> = Utf8               Code<br>  #<span class="hljs-number">10</span> = Utf8               LineNumberTable<br>  #<span class="hljs-number">11</span> = Utf8               LocalVariableTable<br>  #<span class="hljs-number">12</span> = Utf8               <span class="hljs-built_in">this</span><br>  #<span class="hljs-number">13</span> = Utf8               Lcom/atguigu/java/PCRegisterTest;<br>  #<span class="hljs-number">14</span> = Utf8               main<br>  #<span class="hljs-number">15</span> = Utf8               ([Ljava/lang/String;)V<br>  #<span class="hljs-number">16</span> = Utf8               args<br>  #<span class="hljs-number">17</span> = Utf8               [Ljava/lang/String;<br>  #<span class="hljs-number">18</span> = Utf8               i<br>  #<span class="hljs-number">19</span> = Utf8               I<br>  #<span class="hljs-number">20</span> = Utf8               j<br>  #<span class="hljs-number">21</span> = Utf8               k<br>  #<span class="hljs-number">22</span> = Utf8               s<br>  #<span class="hljs-number">23</span> = Utf8               Ljava/lang/String;<br>  #<span class="hljs-number">24</span> = Utf8               SourceFile<br>  #<span class="hljs-number">25</span> = Utf8               PCRegisterTest.java<br>  #<span class="hljs-number">26</span> = NameAndType        #<span class="hljs-number">7</span>:#<span class="hljs-number">8</span>          <span class="hljs-comment">// &quot;&lt;init&gt;&quot;:()V</span><br>  #<span class="hljs-number">27</span> = Utf8               abc<br>  #<span class="hljs-number">28</span> = Class              #<span class="hljs-number">34</span>            <span class="hljs-comment">// java/lang/System</span><br>  #<span class="hljs-number">29</span> = NameAndType        #<span class="hljs-number">35</span>:#<span class="hljs-number">36</span>        <span class="hljs-comment">// out:Ljava/io/PrintStream;</span><br>  #<span class="hljs-number">30</span> = Class              #<span class="hljs-number">37</span>            <span class="hljs-comment">// java/io/PrintStream</span><br>  #<span class="hljs-number">31</span> = NameAndType        #<span class="hljs-number">38</span>:#<span class="hljs-number">39</span>        <span class="hljs-comment">// println:(I)V</span><br>  #<span class="hljs-number">32</span> = Utf8               com/atguigu/java/PCRegisterTest<br>  #<span class="hljs-number">33</span> = Utf8               java/lang/Object<br>  #<span class="hljs-number">34</span> = Utf8               java/lang/System<br>  #<span class="hljs-number">35</span> = Utf8               out<br>  #<span class="hljs-number">36</span> = Utf8               Ljava/io/PrintStream;<br>  #<span class="hljs-number">37</span> = Utf8               java/io/PrintStream<br>  #<span class="hljs-number">38</span> = Utf8               println<br>  #<span class="hljs-number">39</span> = Utf8               (I)V<br>&#123;<br>  <span class="hljs-keyword">public</span> com.atguigu.java.PCRegisterTest();<br>    descriptor: ()V<br>    flags: ACC_PUBLIC<br>    Code:<br>      stack=<span class="hljs-number">1</span>, locals=<span class="hljs-number">1</span>, args_size=<span class="hljs-number">1</span><br>         <span class="hljs-number">0</span>: aload_0<br>         <span class="hljs-number">1</span>: invokespecial #<span class="hljs-number">1</span>                  <span class="hljs-comment">// Method java/lang/Object.&quot;&lt;init&gt;&quot;:()V</span><br>         <span class="hljs-number">4</span>: <span class="hljs-keyword">return</span><br>      LineNumberTable:<br>        line <span class="hljs-number">7</span>: <span class="hljs-number">0</span><br>      LocalVariableTable:<br>        Start  Length  Slot  Name   Signature<br>            <span class="hljs-number">0</span>       <span class="hljs-number">5</span>     <span class="hljs-number">0</span>  <span class="hljs-built_in">this</span>   Lcom/atguigu/java/PCRegisterTest;<br><br>  <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(java.lang.String[])</span>;<br>    descriptor: ([Ljava/lang/String;)V<br>    flags: ACC_PUBLIC, ACC_STATIC<br>    Code:<br>      stack=<span class="hljs-number">2</span>, locals=<span class="hljs-number">5</span>, args_size=<span class="hljs-number">1</span><br>         <span class="hljs-number">0</span>: bipush        <span class="hljs-number">10</span><br>         <span class="hljs-number">2</span>: istore_1<br>         <span class="hljs-number">3</span>: bipush        <span class="hljs-number">20</span><br>         <span class="hljs-number">5</span>: istore_2<br>         <span class="hljs-number">6</span>: iload_1<br>         <span class="hljs-number">7</span>: iload_2<br>         <span class="hljs-number">8</span>: iadd<br>         <span class="hljs-number">9</span>: istore_3<br>        <span class="hljs-number">10</span>: ldc           #<span class="hljs-number">2</span>                  <span class="hljs-comment">// String abc</span><br>        <span class="hljs-number">12</span>: astore        <span class="hljs-number">4</span><br>        <span class="hljs-number">14</span>: getstatic     #<span class="hljs-number">3</span>                  <span class="hljs-comment">// Field java/lang/System.out:Ljava/io/PrintStream;</span><br>        <span class="hljs-number">17</span>: iload_1<br>        <span class="hljs-number">18</span>: invokevirtual #<span class="hljs-number">4</span>                  <span class="hljs-comment">// Method java/io/PrintStream.println:(I)V</span><br>        <span class="hljs-number">21</span>: getstatic     #<span class="hljs-number">3</span>                  <span class="hljs-comment">// Field java/lang/System.out:Ljava/io/PrintStream;</span><br>        <span class="hljs-number">24</span>: iload_3<br>        <span class="hljs-number">25</span>: invokevirtual #<span class="hljs-number">4</span>                  <span class="hljs-comment">// Method java/io/PrintStream.println:(I)V</span><br>        <span class="hljs-number">28</span>: <span class="hljs-keyword">return</span><br>      LineNumberTable:<br>        line <span class="hljs-number">10</span>: <span class="hljs-number">0</span><br>        line <span class="hljs-number">11</span>: <span class="hljs-number">3</span><br>        line <span class="hljs-number">12</span>: <span class="hljs-number">6</span><br>        line <span class="hljs-number">14</span>: <span class="hljs-number">10</span><br>        line <span class="hljs-number">15</span>: <span class="hljs-number">14</span><br>        line <span class="hljs-number">16</span>: <span class="hljs-number">21</span><br>        line <span class="hljs-number">18</span>: <span class="hljs-number">28</span><br>      LocalVariableTable:<br>        Start  Length  Slot  Name   Signature<br>            <span class="hljs-number">0</span>      <span class="hljs-number">29</span>     <span class="hljs-number">0</span>  args   [Ljava/lang/String;<br>            <span class="hljs-number">3</span>      <span class="hljs-number">26</span>     <span class="hljs-number">1</span>     i   I<br>            <span class="hljs-number">6</span>      <span class="hljs-number">23</span>     <span class="hljs-number">2</span>     j   I<br>           <span class="hljs-number">10</span>      <span class="hljs-number">19</span>     <span class="hljs-number">3</span>     k   I<br>           <span class="hljs-number">14</span>      <span class="hljs-number">15</span>     <span class="hljs-number">4</span>     s   Ljava/lang/String;<br>&#125;<br>SourceFile: <span class="hljs-string">&quot;PCRegisterTest.java&quot;</span><br></code></pre></td></tr></table></figure><p>å·¦è¾¹çš„æ•°å­—ä»£è¡¨<strong>æŒ‡ä»¤åœ°å€ï¼ˆæŒ‡ä»¤åç§»ï¼‰</strong>ï¼Œå³ PC å¯„å­˜å™¨ä¸­å¯èƒ½å­˜å‚¨çš„å€¼ï¼Œç„¶åæ‰§è¡Œå¼•æ“è¯»å– PC å¯„å­˜å™¨ä¸­çš„å€¼ï¼Œå¹¶æ‰§è¡Œè¯¥æŒ‡ä»¤</p><p><img src="/2022/10/27/jvm-03-yun-xing-shi-shu-ju-qu/image-20221027194950557.png" alt></p><h2 id="4ã€ğŸ”ºä¸¤ä¸ªæ³¨æ„ç‚¹">4ã€ğŸ”ºä¸¤ä¸ªæ³¨æ„ç‚¹</h2><p><strong>ä½¿ç”¨PCå¯„å­˜å™¨å­˜å‚¨å­—èŠ‚ç æŒ‡ä»¤åœ°å€æœ‰ä»€ä¹ˆç”¨å‘¢ï¼Ÿ<strong>æˆ–è€…é—®</strong>ä¸ºä»€ä¹ˆä½¿ç”¨ PC å¯„å­˜å™¨æ¥è®°å½•å½“å‰çº¿ç¨‹çš„æ‰§è¡Œåœ°å€å‘¢ï¼Ÿ</strong></p><ol><li>å› ä¸ºCPUéœ€è¦ä¸åœçš„åˆ‡æ¢å„ä¸ªçº¿ç¨‹ï¼Œè¿™æ—¶å€™åˆ‡æ¢å›æ¥ä»¥åï¼Œå°±å¾—çŸ¥é“æ¥ç€ä»å“ªå¼€å§‹ç»§ç»­æ‰§è¡Œ</li><li>JVMçš„å­—èŠ‚ç è§£é‡Šå™¨å°±éœ€è¦é€šè¿‡æ”¹å˜PCå¯„å­˜å™¨çš„å€¼æ¥æ˜ç¡®ä¸‹ä¸€æ¡åº”è¯¥æ‰§è¡Œä»€ä¹ˆæ ·çš„å­—èŠ‚ç æŒ‡ä»¤</li></ol><p><img src="/2022/10/27/jvm-03-yun-xing-shi-shu-ju-qu/image-20221027195119590.png" alt></p><p><strong>PCå¯„å­˜å™¨ä¸ºä»€ä¹ˆè¢«è®¾å®šä¸ºç§æœ‰çš„ï¼Ÿ</strong></p><ol><li>æˆ‘ä»¬éƒ½çŸ¥é“æ‰€è°“çš„å¤šçº¿ç¨‹åœ¨ä¸€ä¸ªç‰¹å®šçš„æ—¶é—´æ®µå†…åªä¼šæ‰§è¡Œå…¶ä¸­æŸä¸€ä¸ªçº¿ç¨‹çš„æ–¹æ³•ï¼ŒCPUä¼šä¸åœåœ°åšä»»åŠ¡åˆ‡æ¢ï¼Œè¿™æ ·å¿…ç„¶å¯¼è‡´ç»å¸¸ä¸­æ–­æˆ–æ¢å¤ï¼Œå¦‚ä½•ä¿è¯åˆ†æ¯«æ— å·®å‘¢ï¼Ÿ<strong>ä¸ºäº†èƒ½å¤Ÿå‡†ç¡®åœ°è®°å½•å„ä¸ªçº¿ç¨‹æ­£åœ¨æ‰§è¡Œçš„å½“å‰å­—èŠ‚ç æŒ‡ä»¤åœ°å€ï¼Œæœ€å¥½çš„åŠæ³•è‡ªç„¶æ˜¯ä¸ºæ¯ä¸€ä¸ªçº¿ç¨‹éƒ½åˆ†é…ä¸€ä¸ªPCå¯„å­˜å™¨</strong>ï¼Œè¿™æ ·ä¸€æ¥å„ä¸ªçº¿ç¨‹ä¹‹é—´ä¾¿å¯ä»¥è¿›è¡Œç‹¬ç«‹è®¡ç®—ï¼Œä»è€Œä¸ä¼šå‡ºç°ç›¸äº’å¹²æ‰°çš„æƒ…å†µã€‚</li><li>ç”±äºCPUæ—¶é—´ç‰‡è½®é™åˆ¶ï¼Œä¼—å¤šçº¿ç¨‹åœ¨å¹¶å‘æ‰§è¡Œè¿‡ç¨‹ä¸­ï¼Œä»»ä½•ä¸€ä¸ªç¡®å®šçš„æ—¶åˆ»ï¼Œä¸€ä¸ªå¤„ç†å™¨æˆ–è€…å¤šæ ¸å¤„ç†å™¨ä¸­çš„ä¸€ä¸ªå†…æ ¸ï¼Œåªä¼šæ‰§è¡ŒæŸä¸ªçº¿ç¨‹ä¸­çš„ä¸€æ¡æŒ‡ä»¤ã€‚</li><li>è¿™æ ·å¿…ç„¶å¯¼è‡´ç»å¸¸ä¸­æ–­æˆ–æ¢å¤ï¼Œå¦‚ä½•ä¿è¯åˆ†æ¯«æ— å·®å‘¢ï¼Ÿæ¯ä¸ªçº¿ç¨‹åœ¨åˆ›å»ºåï¼Œéƒ½ä¼šäº§ç”Ÿè‡ªå·±çš„ç¨‹åºè®¡æ•°å™¨å’Œæ ˆå¸§ï¼Œç¨‹åºè®¡æ•°å™¨åœ¨å„ä¸ªçº¿ç¨‹ä¹‹é—´äº’ä¸å½±å“ã€‚</li></ol><blockquote><p>æ³¨æ„å¹¶è¡Œå’Œå¹¶å‘ï¼Œä¸æ˜¯ä¸€ä¸ªæ¦‚å¿µ</p><p>å¹¶è¡Œï¼š  ä¸²è¡Œ</p><p>å¹¶å‘ï¼š  ä¸€ä¸ªæ ¸ï¼Œå¿«é€Ÿæ‰§è¡Œï¼Œçœ‹èµ·æ¥åƒå¹¶å‘</p></blockquote><h2 id="5ã€CPUæ—¶é—´ç‰‡">5ã€CPUæ—¶é—´ç‰‡</h2><ol><li>CPUæ—¶é—´ç‰‡å³CPUåˆ†é…ç»™å„ä¸ªç¨‹åºçš„æ—¶é—´ï¼Œæ¯ä¸ªçº¿ç¨‹è¢«åˆ†é…ä¸€ä¸ªæ—¶é—´æ®µï¼Œç§°ä½œå®ƒçš„æ—¶é—´ç‰‡ã€‚</li><li>åœ¨å®è§‚ä¸Šï¼šæˆ‘ä»¬å¯ä»¥åŒæ—¶æ‰“å¼€å¤šä¸ªåº”ç”¨ç¨‹åºï¼Œæ¯ä¸ªç¨‹åºå¹¶è¡Œä¸æ‚–ï¼ŒåŒæ—¶è¿è¡Œã€‚</li><li>ä½†åœ¨å¾®è§‚ä¸Šï¼šç”±äºåªæœ‰ä¸€ä¸ªCPUï¼Œä¸€æ¬¡åªèƒ½å¤„ç†ç¨‹åºè¦æ±‚çš„ä¸€éƒ¨åˆ†ï¼Œå¦‚ä½•å¤„ç†å…¬å¹³ï¼Œä¸€ç§æ–¹æ³•å°±æ˜¯å¼•å…¥æ—¶é—´ç‰‡ï¼Œ<strong>æ¯ä¸ªç¨‹åºè½®æµæ‰§è¡Œ</strong>ã€‚</li></ol><p><img src="/2022/10/27/jvm-03-yun-xing-shi-shu-ju-qu/image-20221027195216420.png" alt></p>]]></content>
    
    
    <categories>
      
      <category>JVM</category>
      
    </categories>
    
    
    <tags>
      
      <tag>java</tag>
      
      <tag>JVM</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>emoji</title>
    <link href="/2022/10/25/emoji/"/>
    <url>/2022/10/25/emoji/</url>
    
    <content type="html"><![CDATA[<p>People</p><table><thead><tr><th>:bowtie: <code>:bowtie:</code></th><th>ğŸ˜„ <code>:smile:</code></th><th>ğŸ˜† <code>:laughing:</code></th></tr></thead><tbody><tr><td>ğŸ˜Š <code>:blush:</code></td><td>ğŸ˜ƒ <code>:smiley:</code></td><td>â˜ºï¸ <code>:relaxed:</code></td></tr><tr><td>ğŸ˜ <code>:smirk:</code></td><td>ğŸ˜ <code>:heart_eyes:</code></td><td>ğŸ˜˜ <code>:kissing_heart:</code></td></tr><tr><td>ğŸ˜š <code>:kissing_closed_eyes:</code></td><td>ğŸ˜³ <code>:flushed:</code></td><td>ğŸ˜Œ <code>:relieved:</code></td></tr><tr><td>ğŸ˜† <code>:satisfied:</code></td><td>ğŸ˜ <code>:grin:</code></td><td>ğŸ˜‰ <code>:wink:</code></td></tr><tr><td>ğŸ˜œ <code>:stuck_out_tongue_winking_eye:</code></td><td>ğŸ˜ <code>:stuck_out_tongue_closed_eyes:</code></td><td>ğŸ˜€ <code>:grinning:</code></td></tr><tr><td>ğŸ˜— <code>:kissing:</code></td><td>ğŸ˜™ <code>:kissing_smiling_eyes:</code></td><td>ğŸ˜› <code>:stuck_out_tongue:</code></td></tr><tr><td>ğŸ˜´ <code>:sleeping:</code></td><td>ğŸ˜Ÿ <code>:worried:</code></td><td>ğŸ˜¦ <code>:frowning:</code></td></tr><tr><td>ğŸ˜§ <code>:anguished:</code></td><td>ğŸ˜® <code>:open_mouth:</code></td><td>ğŸ˜¬ <code>:grimacing:</code></td></tr><tr><td>ğŸ˜• <code>:confused:</code></td><td>ğŸ˜¯ <code>:hushed:</code></td><td>ğŸ˜‘ <code>:expressionless:</code></td></tr><tr><td>ğŸ˜’ <code>:unamused:</code></td><td>ğŸ˜… <code>:sweat_smile:</code></td><td>ğŸ˜“ <code>:sweat:</code></td></tr><tr><td>ğŸ˜¥ <code>:disappointed_relieved:</code></td><td>ğŸ˜© <code>:weary:</code></td><td>ğŸ˜” <code>:pensive:</code></td></tr><tr><td>ğŸ˜ <code>:disappointed:</code></td><td>ğŸ˜– <code>:confounded:</code></td><td>ğŸ˜¨ <code>:fearful:</code></td></tr><tr><td>ğŸ˜° <code>:cold_sweat:</code></td><td>ğŸ˜£ <code>:persevere:</code></td><td>ğŸ˜¢ <code>:cry:</code></td></tr><tr><td>ğŸ˜­ <code>:sob:</code></td><td>ğŸ˜‚ <code>:joy:</code></td><td>ğŸ˜² <code>:astonished:</code></td></tr><tr><td>ğŸ˜± <code>:scream:</code></td><td>:neckbeard: <code>:neckbeard:</code></td><td>ğŸ˜« <code>:tired_face:</code></td></tr><tr><td>ğŸ˜  <code>:angry:</code></td><td>ğŸ˜¡ <code>:rage:</code></td><td>ğŸ˜¤ <code>:triumph:</code></td></tr><tr><td>ğŸ˜ª <code>:sleepy:</code></td><td>ğŸ˜‹ <code>:yum:</code></td><td>ğŸ˜· <code>:mask:</code></td></tr><tr><td>ğŸ˜ <code>:sunglasses:</code></td><td>ğŸ˜µ <code>:dizzy_face:</code></td><td>ğŸ‘¿ <code>:imp:</code></td></tr><tr><td>ğŸ˜ˆ <code>:smiling_imp:</code></td><td>ğŸ˜ <code>:neutral_face:</code></td><td>ğŸ˜¶ <code>:no_mouth:</code></td></tr><tr><td>ğŸ˜‡ <code>:innocent:</code></td><td>ğŸ‘½ <code>:alien:</code></td><td>ğŸ’› <code>:yellow_heart:</code></td></tr><tr><td>ğŸ’™ <code>:blue_heart:</code></td><td>ğŸ’œ <code>:purple_heart:</code></td><td>â¤ï¸ <code>:heart:</code></td></tr><tr><td>ğŸ’š <code>:green_heart:</code></td><td>ğŸ’” <code>:broken_heart:</code></td><td>ğŸ’“ <code>:heartbeat:</code></td></tr><tr><td>ğŸ’— <code>:heartpulse:</code></td><td>ğŸ’• <code>:two_hearts:</code></td><td>ğŸ’ <code>:revolving_hearts:</code></td></tr><tr><td>ğŸ’˜ <code>:cupid:</code></td><td>ğŸ’– <code>:sparkling_heart:</code></td><td>âœ¨ <code>:sparkles:</code></td></tr><tr><td>â­ <code>:star:</code></td><td>ğŸŒŸ <code>:star2:</code></td><td>ğŸ’« <code>:dizzy:</code></td></tr><tr><td>ğŸ’¥ <code>:boom:</code></td><td>ğŸ’¥ <code>:collision:</code></td><td>ğŸ’¢ <code>:anger:</code></td></tr><tr><td>â— <code>:exclamation:</code></td><td>â“ <code>:question:</code></td><td>â• <code>:grey_exclamation:</code></td></tr><tr><td>â” <code>:grey_question:</code></td><td>ğŸ’¤ <code>:zzz:</code></td><td>ğŸ’¨ <code>:dash:</code></td></tr><tr><td>ğŸ’¦ <code>:sweat_drops:</code></td><td>ğŸ¶ <code>:notes:</code></td><td>ğŸµ <code>:musical_note:</code></td></tr><tr><td>ğŸ”¥ <code>:fire:</code></td><td>ğŸ’© <code>:hankey:</code></td><td>ğŸ’© <code>:poop:</code></td></tr><tr><td>ğŸ’© <code>:shit:</code></td><td>ğŸ‘ <code>:+1:</code></td><td>ğŸ‘ <code>:thumbsup:</code></td></tr><tr><td>ğŸ‘ <code>:-1:</code></td><td>ğŸ‘ <code>:thumbsdown:</code></td><td>ğŸ‘Œ <code>:ok_hand:</code></td></tr><tr><td>ğŸ‘Š <code>:punch:</code></td><td>ğŸ‘Š <code>:facepunch:</code></td><td>âœŠ <code>:fist:</code></td></tr><tr><td>âœŒï¸ <code>:v:</code></td><td>ğŸ‘‹ <code>:wave:</code></td><td>âœ‹ <code>:hand:</code></td></tr><tr><td>âœ‹ <code>:raised_hand:</code></td><td>ğŸ‘ <code>:open_hands:</code></td><td>â˜ï¸ <code>:point_up:</code></td></tr><tr><td>ğŸ‘‡ <code>:point_down:</code></td><td>ğŸ‘ˆ <code>:point_left:</code></td><td>ğŸ‘‰ <code>:point_right:</code></td></tr><tr><td>ğŸ™Œ <code>:raised_hands:</code></td><td>ğŸ™ <code>:pray:</code></td><td>ğŸ‘† <code>:point_up_2:</code></td></tr><tr><td>ğŸ‘ <code>:clap:</code></td><td>ğŸ’ª <code>:muscle:</code></td><td>ğŸ¤˜ <code>:metal:</code></td></tr><tr><td>ğŸ–• <code>:fu:</code></td><td>ğŸš¶ <code>:walking:</code></td><td>ğŸƒ <code>:runner:</code></td></tr><tr><td>ğŸƒ <code>:running:</code></td><td>ğŸ‘« <code>:couple:</code></td><td>ğŸ‘ª <code>:family:</code></td></tr><tr><td>ğŸ‘¬ <code>:two_men_holding_hands:</code></td><td>ğŸ‘­ <code>:two_women_holding_hands:</code></td><td>ğŸ’ƒ <code>:dancer:</code></td></tr><tr><td>ğŸ‘¯ <code>:dancers:</code></td><td>ğŸ™†â€â™€ï¸ <code>:ok_woman:</code></td><td>ğŸ™… <code>:no_good:</code></td></tr><tr><td>ğŸ’ <code>:information_desk_person:</code></td><td>ğŸ™‹ <code>:raising_hand:</code></td><td>ğŸ‘°â€â™€ï¸ <code>:bride_with_veil:</code></td></tr><tr><td>:person_with_pouting_face: <code>:person_with_pouting_face:</code></td><td>:person_frowning: <code>:person_frowning:</code></td><td>ğŸ™‡ <code>:bow:</code></td></tr><tr><td>ğŸ’ <code>:couplekiss:</code></td><td>ğŸ’‘ <code>:couple_with_heart:</code></td><td>ğŸ’† <code>:massage:</code></td></tr><tr><td>ğŸ’‡ <code>:haircut:</code></td><td>ğŸ’… <code>:nail_care:</code></td><td>ğŸ‘¦ <code>:boy:</code></td></tr><tr><td>ğŸ‘§ <code>:girl:</code></td><td>ğŸ‘© <code>:woman:</code></td><td>ğŸ‘¨ <code>:man:</code></td></tr><tr><td>ğŸ‘¶ <code>:baby:</code></td><td>ğŸ‘µ <code>:older_woman:</code></td><td>ğŸ‘´ <code>:older_man:</code></td></tr><tr><td>:person_with_blond_hair: <code>:person_with_blond_hair:</code></td><td>ğŸ‘² <code>:man_with_gua_pi_mao:</code></td><td>ğŸ‘³â€â™‚ï¸ <code>:man_with_turban:</code></td></tr><tr><td>ğŸ‘· <code>:construction_worker:</code></td><td>ğŸ‘® <code>:cop:</code></td><td>ğŸ‘¼ <code>:angel:</code></td></tr><tr><td>ğŸ‘¸ <code>:princess:</code></td><td>ğŸ˜º <code>:smiley_cat:</code></td><td>ğŸ˜¸ <code>:smile_cat:</code></td></tr><tr><td>ğŸ˜» <code>:heart_eyes_cat:</code></td><td>ğŸ˜½ <code>:kissing_cat:</code></td><td>ğŸ˜¼ <code>:smirk_cat:</code></td></tr><tr><td>ğŸ™€ <code>:scream_cat:</code></td><td>ğŸ˜¿ <code>:crying_cat_face:</code></td><td>ğŸ˜¹ <code>:joy_cat:</code></td></tr><tr><td>ğŸ˜¾ <code>:pouting_cat:</code></td><td>ğŸ‘¹ <code>:japanese_ogre:</code></td><td>ğŸ‘º <code>:japanese_goblin:</code></td></tr><tr><td>ğŸ™ˆ <code>:see_no_evil:</code></td><td>ğŸ™‰ <code>:hear_no_evil:</code></td><td>ğŸ™Š <code>:speak_no_evil:</code></td></tr><tr><td>ğŸ’‚â€â™‚ï¸ <code>:guardsman:</code></td><td>ğŸ’€ <code>:skull:</code></td><td>ğŸ¾ <code>:feet:</code></td></tr><tr><td>ğŸ‘„ <code>:lips:</code></td><td>ğŸ’‹ <code>:kiss:</code></td><td>ğŸ’§ <code>:droplet:</code></td></tr><tr><td>ğŸ‘‚ <code>:ear:</code></td><td>ğŸ‘€ <code>:eyes:</code></td><td>ğŸ‘ƒ <code>:nose:</code></td></tr><tr><td>ğŸ‘… <code>:tongue:</code></td><td>ğŸ’Œ <code>:love_letter:</code></td><td>ğŸ‘¤ <code>:bust_in_silhouette:</code></td></tr><tr><td>ğŸ‘¥ <code>:busts_in_silhouette:</code></td><td>ğŸ’¬ <code>:speech_balloon:</code></td><td>ğŸ’­ <code>:thought_balloon:</code></td></tr><tr><td>:feelsgood: <code>:feelsgood:</code></td><td>:finnadie: <code>:finnadie:</code></td><td>:goberserk: <code>:goberserk:</code></td></tr><tr><td>:godmode: <code>:godmode:</code></td><td>:hurtrealbad: <code>:hurtrealbad:</code></td><td>:rage1: <code>:rage1:</code></td></tr><tr><td>:rage2: <code>:rage2:</code></td><td>:rage3: <code>:rage3:</code></td><td>:rage4: <code>:rage4:</code></td></tr><tr><td>:suspect: <code>:suspect:</code></td><td>:trollface: <code>:trollface:</code></td><td></td></tr></tbody></table><p>Nature</p><table><thead><tr><th>â˜€ï¸ <code>:sunny:</code></th><th>â˜” <code>:umbrella:</code></th><th>â˜ï¸ <code>:cloud:</code></th></tr></thead><tbody><tr><td>â„ï¸ <code>:snowflake:</code></td><td>â›„ <code>:snowman:</code></td><td>âš¡ <code>:zap:</code></td></tr><tr><td>ğŸŒ€ <code>:cyclone:</code></td><td>ğŸŒ <code>:foggy:</code></td><td>ğŸŒŠ <code>:ocean:</code></td></tr><tr><td>ğŸ± <code>:cat:</code></td><td>ğŸ¶ <code>:dog:</code></td><td>ğŸ­ <code>:mouse:</code></td></tr><tr><td>ğŸ¹ <code>:hamster:</code></td><td>ğŸ° <code>:rabbit:</code></td><td>ğŸº <code>:wolf:</code></td></tr><tr><td>ğŸ¸ <code>:frog:</code></td><td>ğŸ¯ <code>:tiger:</code></td><td>ğŸ¨ <code>:koala:</code></td></tr><tr><td>ğŸ» <code>:bear:</code></td><td>ğŸ· <code>:pig:</code></td><td>ğŸ½ <code>:pig_nose:</code></td></tr><tr><td>ğŸ® <code>:cow:</code></td><td>ğŸ— <code>:boar:</code></td><td>ğŸµ <code>:monkey_face:</code></td></tr><tr><td>ğŸ’ <code>:monkey:</code></td><td>ğŸ´ <code>:horse:</code></td><td>ğŸ <code>:racehorse:</code></td></tr><tr><td>ğŸ« <code>:camel:</code></td><td>ğŸ‘ <code>:sheep:</code></td><td>ğŸ˜ <code>:elephant:</code></td></tr><tr><td>ğŸ¼ <code>:panda_face:</code></td><td>ğŸ <code>:snake:</code></td><td>ğŸ¦ <code>:bird:</code></td></tr><tr><td>ğŸ¤ <code>:baby_chick:</code></td><td>ğŸ¥ <code>:hatched_chick:</code></td><td>ğŸ£ <code>:hatching_chick:</code></td></tr><tr><td>ğŸ” <code>:chicken:</code></td><td>ğŸ§ <code>:penguin:</code></td><td>ğŸ¢ <code>:turtle:</code></td></tr><tr><td>ğŸ› <code>:bug:</code></td><td>ğŸ <code>:honeybee:</code></td><td>ğŸœ <code>:ant:</code></td></tr><tr><td>ğŸª² <code>:beetle:</code></td><td>ğŸŒ <code>:snail:</code></td><td>ğŸ™ <code>:octopus:</code></td></tr><tr><td>ğŸ  <code>:tropical_fish:</code></td><td>ğŸŸ <code>:fish:</code></td><td>ğŸ³ <code>:whale:</code></td></tr><tr><td>ğŸ‹ <code>:whale2:</code></td><td>ğŸ¬ <code>:dolphin:</code></td><td>ğŸ„ <code>:cow2:</code></td></tr><tr><td>ğŸ <code>:ram:</code></td><td>ğŸ€ <code>:rat:</code></td><td>ğŸƒ <code>:water_buffalo:</code></td></tr><tr><td>ğŸ… <code>:tiger2:</code></td><td>ğŸ‡ <code>:rabbit2:</code></td><td>ğŸ‰ <code>:dragon:</code></td></tr><tr><td>ğŸ <code>:goat:</code></td><td>ğŸ“ <code>:rooster:</code></td><td>ğŸ• <code>:dog2:</code></td></tr><tr><td>ğŸ– <code>:pig2:</code></td><td>ğŸ <code>:mouse2:</code></td><td>ğŸ‚ <code>:ox:</code></td></tr><tr><td>ğŸ² <code>:dragon_face:</code></td><td>ğŸ¡ <code>:blowfish:</code></td><td>ğŸŠ <code>:crocodile:</code></td></tr><tr><td>ğŸª <code>:dromedary_camel:</code></td><td>ğŸ† <code>:leopard:</code></td><td>ğŸˆ <code>:cat2:</code></td></tr><tr><td>ğŸ© <code>:poodle:</code></td><td>ğŸ¾ <code>:paw_prints:</code></td><td>ğŸ’ <code>:bouquet:</code></td></tr><tr><td>ğŸŒ¸ <code>:cherry_blossom:</code></td><td>ğŸŒ· <code>:tulip:</code></td><td>ğŸ€ <code>:four_leaf_clover:</code></td></tr><tr><td>ğŸŒ¹ <code>:rose:</code></td><td>ğŸŒ» <code>:sunflower:</code></td><td>ğŸŒº <code>:hibiscus:</code></td></tr><tr><td>ğŸ <code>:maple_leaf:</code></td><td>ğŸƒ <code>:leaves:</code></td><td>ğŸ‚ <code>:fallen_leaf:</code></td></tr><tr><td>ğŸŒ¿ <code>:herb:</code></td><td>ğŸ„ <code>:mushroom:</code></td><td>ğŸŒµ <code>:cactus:</code></td></tr><tr><td>ğŸŒ´ <code>:palm_tree:</code></td><td>ğŸŒ² <code>:evergreen_tree:</code></td><td>ğŸŒ³ <code>:deciduous_tree:</code></td></tr><tr><td>ğŸŒ° <code>:chestnut:</code></td><td>ğŸŒ± <code>:seedling:</code></td><td>ğŸŒ¼ <code>:blossom:</code></td></tr><tr><td>ğŸŒ¾ <code>:ear_of_rice:</code></td><td>ğŸš <code>:shell:</code></td><td>ğŸŒ <code>:globe_with_meridians:</code></td></tr><tr><td>ğŸŒ <code>:sun_with_face:</code></td><td>ğŸŒ <code>:full_moon_with_face:</code></td><td>ğŸŒš <code>:new_moon_with_face:</code></td></tr><tr><td>ğŸŒ‘ <code>:new_moon:</code></td><td>ğŸŒ’ <code>:waxing_crescent_moon:</code></td><td>ğŸŒ“ <code>:first_quarter_moon:</code></td></tr><tr><td>ğŸŒ” <code>:waxing_gibbous_moon:</code></td><td>ğŸŒ• <code>:full_moon:</code></td><td>ğŸŒ– <code>:waning_gibbous_moon:</code></td></tr><tr><td>ğŸŒ— <code>:last_quarter_moon:</code></td><td>ğŸŒ˜ <code>:waning_crescent_moon:</code></td><td>ğŸŒœ <code>:last_quarter_moon_with_face:</code></td></tr><tr><td>ğŸŒ› <code>:first_quarter_moon_with_face:</code></td><td>ğŸŒ” <code>:moon:</code></td><td>ğŸŒ <code>:earth_africa:</code></td></tr><tr><td>ğŸŒ <code>:earth_americas:</code></td><td>ğŸŒ <code>:earth_asia:</code></td><td>ğŸŒ‹ <code>:volcano:</code></td></tr><tr><td>ğŸŒŒ <code>:milky_way:</code></td><td>â›… <code>:partly_sunny:</code></td><td>:octocat: <code>:octocat:</code></td></tr><tr><td>:squirrel: <code>:squirrel:</code></td><td></td><td></td></tr></tbody></table><p>Objects</p><table><thead><tr><th>ğŸ <code>:bamboo:</code></th><th>ğŸ’ <code>:gift_heart:</code></th><th>ğŸ <code>:dolls:</code></th></tr></thead><tbody><tr><td>ğŸ’ <code>:school_satchel:</code></td><td>ğŸ“ <code>:mortar_board:</code></td><td>ğŸ <code>:flags:</code></td></tr><tr><td>ğŸ† <code>:fireworks:</code></td><td>ğŸ‡ <code>:sparkler:</code></td><td>ğŸ <code>:wind_chime:</code></td></tr><tr><td>ğŸ‘ <code>:rice_scene:</code></td><td>ğŸƒ <code>:jack_o_lantern:</code></td><td>ğŸ‘» <code>:ghost:</code></td></tr><tr><td>ğŸ… <code>:santa:</code></td><td>ğŸ„ <code>:christmas_tree:</code></td><td>ğŸ <code>:gift:</code></td></tr><tr><td>ğŸ”” <code>:bell:</code></td><td>ğŸ”• <code>:no_bell:</code></td><td>ğŸ‹ <code>:tanabata_tree:</code></td></tr><tr><td>ğŸ‰ <code>:tada:</code></td><td>ğŸŠ <code>:confetti_ball:</code></td><td>ğŸˆ <code>:balloon:</code></td></tr><tr><td>ğŸ”® <code>:crystal_ball:</code></td><td>ğŸ’¿ <code>:cd:</code></td><td>ğŸ“€ <code>:dvd:</code></td></tr><tr><td>ğŸ’¾ <code>:floppy_disk:</code></td><td>ğŸ“· <code>:camera:</code></td><td>ğŸ“¹ <code>:video_camera:</code></td></tr><tr><td>ğŸ¥ <code>:movie_camera:</code></td><td>ğŸ’» <code>:computer:</code></td><td>ğŸ“º <code>:tv:</code></td></tr><tr><td>ğŸ“± <code>:iphone:</code></td><td>â˜ï¸ <code>:phone:</code></td><td>â˜ï¸ <code>:telephone:</code></td></tr><tr><td>ğŸ“ <code>:telephone_receiver:</code></td><td>ğŸ“Ÿ <code>:pager:</code></td><td>ğŸ“  <code>:fax:</code></td></tr><tr><td>ğŸ’½ <code>:minidisc:</code></td><td>ğŸ“¼ <code>:vhs:</code></td><td>ğŸ”‰ <code>:sound:</code></td></tr><tr><td>ğŸ”ˆ <code>:speaker:</code></td><td>ğŸ”‡ <code>:mute:</code></td><td>ğŸ“¢ <code>:loudspeaker:</code></td></tr><tr><td>ğŸ“£ <code>:mega:</code></td><td>âŒ› <code>:hourglass:</code></td><td>â³ <code>:hourglass_flowing_sand:</code></td></tr><tr><td>â° <code>:alarm_clock:</code></td><td>âŒš <code>:watch:</code></td><td>ğŸ“» <code>:radio:</code></td></tr><tr><td>ğŸ“¡ <code>:satellite:</code></td><td>â¿ <code>:loop:</code></td><td>ğŸ” <code>:mag:</code></td></tr><tr><td>ğŸ” <code>:mag_right:</code></td><td>ğŸ”“ <code>:unlock:</code></td><td>ğŸ”’ <code>:lock:</code></td></tr><tr><td>ğŸ” <code>:lock_with_ink_pen:</code></td><td>ğŸ” <code>:closed_lock_with_key:</code></td><td>ğŸ”‘ <code>:key:</code></td></tr><tr><td>ğŸ’¡ <code>:bulb:</code></td><td>ğŸ”¦ <code>:flashlight:</code></td><td>ğŸ”† <code>:high_brightness:</code></td></tr><tr><td>ğŸ”… <code>:low_brightness:</code></td><td>ğŸ”Œ <code>:electric_plug:</code></td><td>ğŸ”‹ <code>:battery:</code></td></tr><tr><td>ğŸ“² <code>:calling:</code></td><td>ğŸ“§ <code>:email:</code></td><td>ğŸ“« <code>:mailbox:</code></td></tr><tr><td>ğŸ“® <code>:postbox:</code></td><td>ğŸ›€ <code>:bath:</code></td><td>ğŸ› <code>:bathtub:</code></td></tr><tr><td>ğŸš¿ <code>:shower:</code></td><td>ğŸš½ <code>:toilet:</code></td><td>ğŸ”§ <code>:wrench:</code></td></tr><tr><td>ğŸ”© <code>:nut_and_bolt:</code></td><td>ğŸ”¨ <code>:hammer:</code></td><td>ğŸ’º <code>:seat:</code></td></tr><tr><td>ğŸ’° <code>:moneybag:</code></td><td>ğŸ’´ <code>:yen:</code></td><td>ğŸ’µ <code>:dollar:</code></td></tr><tr><td>ğŸ’· <code>:pound:</code></td><td>ğŸ’¶ <code>:euro:</code></td><td>ğŸ’³ <code>:credit_card:</code></td></tr><tr><td>ğŸ’¸ <code>:money_with_wings:</code></td><td>ğŸ“§ <code>:e-mail:</code></td><td>ğŸ“¥ <code>:inbox_tray:</code></td></tr><tr><td>ğŸ“¤ <code>:outbox_tray:</code></td><td>âœ‰ï¸ <code>:envelope:</code></td><td>ğŸ“¨ <code>:incoming_envelope:</code></td></tr><tr><td>ğŸ“¯ <code>:postal_horn:</code></td><td>ğŸ“ª <code>:mailbox_closed:</code></td><td>ğŸ“¬ <code>:mailbox_with_mail:</code></td></tr><tr><td>ğŸ“­ <code>:mailbox_with_no_mail:</code></td><td>ğŸšª <code>:door:</code></td><td>ğŸš¬ <code>:smoking:</code></td></tr><tr><td>ğŸ’£ <code>:bomb:</code></td><td>ğŸ”« <code>:gun:</code></td><td>ğŸ”ª <code>:hocho:</code></td></tr><tr><td>ğŸ’Š <code>:pill:</code></td><td>ğŸ’‰ <code>:syringe:</code></td><td>ğŸ“„ <code>:page_facing_up:</code></td></tr><tr><td>ğŸ“ƒ <code>:page_with_curl:</code></td><td>ğŸ“‘ <code>:bookmark_tabs:</code></td><td>ğŸ“Š <code>:bar_chart:</code></td></tr><tr><td>ğŸ“ˆ <code>:chart_with_upwards_trend:</code></td><td>ğŸ“‰ <code>:chart_with_downwards_trend:</code></td><td>ğŸ“œ <code>:scroll:</code></td></tr><tr><td>ğŸ“‹ <code>:clipboard:</code></td><td>ğŸ“† <code>:calendar:</code></td><td>ğŸ“… <code>:date:</code></td></tr><tr><td>ğŸ“‡ <code>:card_index:</code></td><td>ğŸ“ <code>:file_folder:</code></td><td>ğŸ“‚ <code>:open_file_folder:</code></td></tr><tr><td>âœ‚ï¸ <code>:scissors:</code></td><td>ğŸ“Œ <code>:pushpin:</code></td><td>ğŸ“ <code>:paperclip:</code></td></tr><tr><td>âœ’ï¸ <code>:black_nib:</code></td><td>âœï¸ <code>:pencil2:</code></td><td>ğŸ“ <code>:straight_ruler:</code></td></tr><tr><td>ğŸ“ <code>:triangular_ruler:</code></td><td>ğŸ“• <code>:closed_book:</code></td><td>ğŸ“— <code>:green_book:</code></td></tr><tr><td>ğŸ“˜ <code>:blue_book:</code></td><td>ğŸ“™ <code>:orange_book:</code></td><td>ğŸ““ <code>:notebook:</code></td></tr><tr><td>ğŸ“” <code>:notebook_with_decorative_cover:</code></td><td>ğŸ“’ <code>:ledger:</code></td><td>ğŸ“š <code>:books:</code></td></tr><tr><td>ğŸ”– <code>:bookmark:</code></td><td>ğŸ“› <code>:name_badge:</code></td><td>ğŸ”¬ <code>:microscope:</code></td></tr><tr><td>ğŸ”­ <code>:telescope:</code></td><td>ğŸ“° <code>:newspaper:</code></td><td>ğŸˆ <code>:football:</code></td></tr><tr><td>ğŸ€ <code>:basketball:</code></td><td>âš½ <code>:soccer:</code></td><td>âš¾ <code>:baseball:</code></td></tr><tr><td>ğŸ¾ <code>:tennis:</code></td><td>ğŸ± <code>:8ball:</code></td><td>ğŸ‰ <code>:rugby_football:</code></td></tr><tr><td>ğŸ³ <code>:bowling:</code></td><td>â›³ <code>:golf:</code></td><td>ğŸšµ <code>:mountain_bicyclist:</code></td></tr><tr><td>ğŸš´ <code>:bicyclist:</code></td><td>ğŸ‡ <code>:horse_racing:</code></td><td>ğŸ‚ <code>:snowboarder:</code></td></tr><tr><td>ğŸŠ <code>:swimmer:</code></td><td>ğŸ„ <code>:surfer:</code></td><td>ğŸ¿ <code>:ski:</code></td></tr><tr><td>â™ ï¸ <code>:spades:</code></td><td>â™¥ï¸ <code>:hearts:</code></td><td>â™£ï¸ <code>:clubs:</code></td></tr><tr><td>â™¦ï¸ <code>:diamonds:</code></td><td>ğŸ’ <code>:gem:</code></td><td>ğŸ’ <code>:ring:</code></td></tr><tr><td>ğŸ† <code>:trophy:</code></td><td>ğŸ¼ <code>:musical_score:</code></td><td>ğŸ¹ <code>:musical_keyboard:</code></td></tr><tr><td>ğŸ» <code>:violin:</code></td><td>ğŸ‘¾ <code>:space_invader:</code></td><td>ğŸ® <code>:video_game:</code></td></tr><tr><td>ğŸƒ <code>:black_joker:</code></td><td>ğŸ´ <code>:flower_playing_cards:</code></td><td>ğŸ² <code>:game_die:</code></td></tr><tr><td>ğŸ¯ <code>:dart:</code></td><td>ğŸ€„ <code>:mahjong:</code></td><td>ğŸ¬ <code>:clapper:</code></td></tr><tr><td>ğŸ“ <code>:memo:</code></td><td>ğŸ“ <code>:pencil:</code></td><td>ğŸ“– <code>:book:</code></td></tr><tr><td>ğŸ¨ <code>:art:</code></td><td>ğŸ¤ <code>:microphone:</code></td><td>ğŸ§ <code>:headphones:</code></td></tr><tr><td>ğŸº <code>:trumpet:</code></td><td>ğŸ· <code>:saxophone:</code></td><td>ğŸ¸ <code>:guitar:</code></td></tr><tr><td>ğŸ‘ <code>:shoe:</code></td><td>ğŸ‘¡ <code>:sandal:</code></td><td>ğŸ‘  <code>:high_heel:</code></td></tr><tr><td>ğŸ’„ <code>:lipstick:</code></td><td>ğŸ‘¢ <code>:boot:</code></td><td>ğŸ‘• <code>:shirt:</code></td></tr><tr><td>ğŸ‘• <code>:tshirt:</code></td><td>ğŸ‘” <code>:necktie:</code></td><td>ğŸ‘š <code>:womans_clothes:</code></td></tr><tr><td>ğŸ‘— <code>:dress:</code></td><td>ğŸ½ <code>:running_shirt_with_sash:</code></td><td>ğŸ‘– <code>:jeans:</code></td></tr><tr><td>ğŸ‘˜ <code>:kimono:</code></td><td>ğŸ‘™ <code>:bikini:</code></td><td>ğŸ€ <code>:ribbon:</code></td></tr><tr><td>ğŸ© <code>:tophat:</code></td><td>ğŸ‘‘ <code>:crown:</code></td><td>ğŸ‘’ <code>:womans_hat:</code></td></tr><tr><td>ğŸ‘ <code>:mans_shoe:</code></td><td>ğŸŒ‚ <code>:closed_umbrella:</code></td><td>ğŸ’¼ <code>:briefcase:</code></td></tr><tr><td>ğŸ‘œ <code>:handbag:</code></td><td>ğŸ‘ <code>:pouch:</code></td><td>ğŸ‘› <code>:purse:</code></td></tr><tr><td>ğŸ‘“ <code>:eyeglasses:</code></td><td>ğŸ£ <code>:fishing_pole_and_fish:</code></td><td>â˜• <code>:coffee:</code></td></tr><tr><td>ğŸµ <code>:tea:</code></td><td>ğŸ¶ <code>:sake:</code></td><td>ğŸ¼ <code>:baby_bottle:</code></td></tr><tr><td>ğŸº <code>:beer:</code></td><td>ğŸ» <code>:beers:</code></td><td>ğŸ¸ <code>:cocktail:</code></td></tr><tr><td>ğŸ¹ <code>:tropical_drink:</code></td><td>ğŸ· <code>:wine_glass:</code></td><td>ğŸ´ <code>:fork_and_knife:</code></td></tr><tr><td>ğŸ• <code>:pizza:</code></td><td>ğŸ” <code>:hamburger:</code></td><td>ğŸŸ <code>:fries:</code></td></tr><tr><td>ğŸ— <code>:poultry_leg:</code></td><td>ğŸ– <code>:meat_on_bone:</code></td><td>ğŸ <code>:spaghetti:</code></td></tr><tr><td>ğŸ› <code>:curry:</code></td><td>ğŸ¤ <code>:fried_shrimp:</code></td><td>ğŸ± <code>:bento:</code></td></tr><tr><td>ğŸ£ <code>:sushi:</code></td><td>ğŸ¥ <code>:fish_cake:</code></td><td>ğŸ™ <code>:rice_ball:</code></td></tr><tr><td>ğŸ˜ <code>:rice_cracker:</code></td><td>ğŸš <code>:rice:</code></td><td>ğŸœ <code>:ramen:</code></td></tr><tr><td>ğŸ² <code>:stew:</code></td><td>ğŸ¢ <code>:oden:</code></td><td>ğŸ¡ <code>:dango:</code></td></tr><tr><td>ğŸ¥š <code>:egg:</code></td><td>ğŸ <code>:bread:</code></td><td>ğŸ© <code>:doughnut:</code></td></tr><tr><td>ğŸ® <code>:custard:</code></td><td>ğŸ¦ <code>:icecream:</code></td><td>ğŸ¨ <code>:ice_cream:</code></td></tr><tr><td>ğŸ§ <code>:shaved_ice:</code></td><td>ğŸ‚ <code>:birthday:</code></td><td>ğŸ° <code>:cake:</code></td></tr><tr><td>ğŸª <code>:cookie:</code></td><td>ğŸ« <code>:chocolate_bar:</code></td><td>ğŸ¬ <code>:candy:</code></td></tr><tr><td>ğŸ­ <code>:lollipop:</code></td><td>ğŸ¯ <code>:honey_pot:</code></td><td>ğŸ <code>:apple:</code></td></tr><tr><td>ğŸ <code>:green_apple:</code></td><td>ğŸŠ <code>:tangerine:</code></td><td>ğŸ‹ <code>:lemon:</code></td></tr><tr><td>ğŸ’ <code>:cherries:</code></td><td>ğŸ‡ <code>:grapes:</code></td><td>ğŸ‰ <code>:watermelon:</code></td></tr><tr><td>ğŸ“ <code>:strawberry:</code></td><td>ğŸ‘ <code>:peach:</code></td><td>ğŸˆ <code>:melon:</code></td></tr><tr><td>ğŸŒ <code>:banana:</code></td><td>ğŸ <code>:pear:</code></td><td>ğŸ <code>:pineapple:</code></td></tr><tr><td>ğŸ  <code>:sweet_potato:</code></td><td>ğŸ† <code>:eggplant:</code></td><td>ğŸ… <code>:tomato:</code></td></tr><tr><td>ğŸŒ½ <code>:corn:</code></td><td></td><td></td></tr></tbody></table><p>Places</p><table><thead><tr><th>ğŸ  <code>:house:</code></th><th>ğŸ¡ <code>:house_with_garden:</code></th><th>ğŸ« <code>:school:</code></th></tr></thead><tbody><tr><td>ğŸ¢ <code>:office:</code></td><td>ğŸ£ <code>:post_office:</code></td><td>ğŸ¥ <code>:hospital:</code></td></tr><tr><td>ğŸ¦ <code>:bank:</code></td><td>ğŸª <code>:convenience_store:</code></td><td>ğŸ© <code>:love_hotel:</code></td></tr><tr><td>ğŸ¨ <code>:hotel:</code></td><td>ğŸ’’ <code>:wedding:</code></td><td>â›ª <code>:church:</code></td></tr><tr><td>ğŸ¬ <code>:department_store:</code></td><td>ğŸ¤ <code>:european_post_office:</code></td><td>ğŸŒ‡ <code>:city_sunrise:</code></td></tr><tr><td>ğŸŒ† <code>:city_sunset:</code></td><td>ğŸ¯ <code>:japanese_castle:</code></td><td>ğŸ° <code>:european_castle:</code></td></tr><tr><td>â›º <code>:tent:</code></td><td>ğŸ­ <code>:factory:</code></td><td>ğŸ—¼ <code>:tokyo_tower:</code></td></tr><tr><td>ğŸ—¾ <code>:japan:</code></td><td>ğŸ—» <code>:mount_fuji:</code></td><td>ğŸŒ„ <code>:sunrise_over_mountains:</code></td></tr><tr><td>ğŸŒ… <code>:sunrise:</code></td><td>ğŸŒ  <code>:stars:</code></td><td>ğŸ—½ <code>:statue_of_liberty:</code></td></tr><tr><td>ğŸŒ‰ <code>:bridge_at_night:</code></td><td>ğŸ  <code>:carousel_horse:</code></td><td>ğŸŒˆ <code>:rainbow:</code></td></tr><tr><td>ğŸ¡ <code>:ferris_wheel:</code></td><td>â›² <code>:fountain:</code></td><td>ğŸ¢ <code>:roller_coaster:</code></td></tr><tr><td>ğŸš¢ <code>:ship:</code></td><td>ğŸš¤ <code>:speedboat:</code></td><td>â›µ <code>:boat:</code></td></tr><tr><td>â›µ <code>:sailboat:</code></td><td>ğŸš£ <code>:rowboat:</code></td><td>âš“ <code>:anchor:</code></td></tr><tr><td>ğŸš€ <code>:rocket:</code></td><td>âœˆï¸ <code>:airplane:</code></td><td>ğŸš <code>:helicopter:</code></td></tr><tr><td>ğŸš‚ <code>:steam_locomotive:</code></td><td>ğŸšŠ <code>:tram:</code></td><td>ğŸš <code>:mountain_railway:</code></td></tr><tr><td>ğŸš² <code>:bike:</code></td><td>ğŸš¡ <code>:aerial_tramway:</code></td><td>ğŸšŸ <code>:suspension_railway:</code></td></tr><tr><td>ğŸš  <code>:mountain_cableway:</code></td><td>ğŸšœ <code>:tractor:</code></td><td>ğŸš™ <code>:blue_car:</code></td></tr><tr><td>ğŸš˜ <code>:oncoming_automobile:</code></td><td>ğŸš— <code>:car:</code></td><td>ğŸš— <code>:red_car:</code></td></tr><tr><td>ğŸš• <code>:taxi:</code></td><td>ğŸš– <code>:oncoming_taxi:</code></td><td>ğŸš› <code>:articulated_lorry:</code></td></tr><tr><td>ğŸšŒ <code>:bus:</code></td><td>ğŸš <code>:oncoming_bus:</code></td><td>ğŸš¨ <code>:rotating_light:</code></td></tr><tr><td>ğŸš“ <code>:police_car:</code></td><td>ğŸš” <code>:oncoming_police_car:</code></td><td>ğŸš’ <code>:fire_engine:</code></td></tr><tr><td>ğŸš‘ <code>:ambulance:</code></td><td>ğŸš <code>:minibus:</code></td><td>ğŸšš <code>:truck:</code></td></tr><tr><td>ğŸš‹ <code>:train:</code></td><td>ğŸš‰ <code>:station:</code></td><td>ğŸš† <code>:train2:</code></td></tr><tr><td>ğŸš… <code>:bullettrain_front:</code></td><td>ğŸš„ <code>:bullettrain_side:</code></td><td>ğŸšˆ <code>:light_rail:</code></td></tr><tr><td>ğŸš <code>:monorail:</code></td><td>ğŸšƒ <code>:railway_car:</code></td><td>ğŸš <code>:trolleybus:</code></td></tr><tr><td>ğŸ« <code>:ticket:</code></td><td>â›½ <code>:fuelpump:</code></td><td>ğŸš¦ <code>:vertical_traffic_light:</code></td></tr><tr><td>ğŸš¥ <code>:traffic_light:</code></td><td>âš ï¸ <code>:warning:</code></td><td>ğŸš§ <code>:construction:</code></td></tr><tr><td>ğŸ”° <code>:beginner:</code></td><td>ğŸ§ <code>:atm:</code></td><td>ğŸ° <code>:slot_machine:</code></td></tr><tr><td>ğŸš <code>:busstop:</code></td><td>ğŸ’ˆ <code>:barber:</code></td><td>â™¨ï¸ <code>:hotsprings:</code></td></tr><tr><td>ğŸ <code>:checkered_flag:</code></td><td>ğŸŒ <code>:crossed_flags:</code></td><td>ğŸ® <code>:izakaya_lantern:</code></td></tr><tr><td>ğŸ—¿ <code>:moyai:</code></td><td>ğŸª <code>:circus_tent:</code></td><td>ğŸ­ <code>:performing_arts:</code></td></tr><tr><td>ğŸ“ <code>:round_pushpin:</code></td><td>ğŸš© <code>:triangular_flag_on_post:</code></td><td>ğŸ‡¯ğŸ‡µ <code>:jp:</code></td></tr><tr><td>ğŸ‡°ğŸ‡· <code>:kr:</code></td><td>ğŸ‡¨ğŸ‡³ <code>:cn:</code></td><td>ğŸ‡ºğŸ‡¸ <code>:us:</code></td></tr><tr><td>ğŸ‡«ğŸ‡· <code>:fr:</code></td><td>ğŸ‡ªğŸ‡¸ <code>:es:</code></td><td>ğŸ‡®ğŸ‡¹ <code>:it:</code></td></tr><tr><td>ğŸ‡·ğŸ‡º <code>:ru:</code></td><td>ğŸ‡¬ğŸ‡§ <code>:gb:</code></td><td>ğŸ‡¬ğŸ‡§ <code>:uk:</code></td></tr><tr><td>ğŸ‡©ğŸ‡ª <code>:de:</code></td><td></td><td></td></tr></tbody></table><p>Symbols</p><table><thead><tr><th>1ï¸âƒ£ <code>:one:</code></th><th>2ï¸âƒ£ <code>:two:</code></th><th>3ï¸âƒ£ <code>:three:</code></th></tr></thead><tbody><tr><td>4ï¸âƒ£ <code>:four:</code></td><td>5ï¸âƒ£ <code>:five:</code></td><td>6ï¸âƒ£ <code>:six:</code></td></tr><tr><td>7ï¸âƒ£ <code>:seven:</code></td><td>8ï¸âƒ£ <code>:eight:</code></td><td>9ï¸âƒ£ <code>:nine:</code></td></tr><tr><td>ğŸ”Ÿ <code>:keycap_ten:</code></td><td>ğŸ”¢ <code>:1234:</code></td><td>0ï¸âƒ£ <code>:zero:</code></td></tr><tr><td>#ï¸âƒ£ <code>:hash:</code></td><td>ğŸ”£ <code>:symbols:</code></td><td>â—€ï¸ <code>:arrow_backward:</code></td></tr><tr><td>â¬‡ï¸ <code>:arrow_down:</code></td><td>â–¶ï¸ <code>:arrow_forward:</code></td><td>â¬…ï¸ <code>:arrow_left:</code></td></tr><tr><td>ğŸ”  <code>:capital_abcd:</code></td><td>ğŸ”¡ <code>:abcd:</code></td><td>ğŸ”¤ <code>:abc:</code></td></tr><tr><td>â†™ï¸ <code>:arrow_lower_left:</code></td><td>â†˜ï¸ <code>:arrow_lower_right:</code></td><td>â¡ï¸ <code>:arrow_right:</code></td></tr><tr><td>â¬†ï¸ <code>:arrow_up:</code></td><td>â†–ï¸ <code>:arrow_upper_left:</code></td><td>â†—ï¸ <code>:arrow_upper_right:</code></td></tr><tr><td>â¬ <code>:arrow_double_down:</code></td><td>â« <code>:arrow_double_up:</code></td><td>ğŸ”½ <code>:arrow_down_small:</code></td></tr><tr><td>â¤µï¸ <code>:arrow_heading_down:</code></td><td>â¤´ï¸ <code>:arrow_heading_up:</code></td><td>â†©ï¸ <code>:leftwards_arrow_with_hook:</code></td></tr><tr><td>â†ªï¸ <code>:arrow_right_hook:</code></td><td>â†”ï¸ <code>:left_right_arrow:</code></td><td>â†•ï¸ <code>:arrow_up_down:</code></td></tr><tr><td>ğŸ”¼ <code>:arrow_up_small:</code></td><td>ğŸ”ƒ <code>:arrows_clockwise:</code></td><td>ğŸ”„ <code>:arrows_counterclockwise:</code></td></tr><tr><td>âª <code>:rewind:</code></td><td>â© <code>:fast_forward:</code></td><td>â„¹ï¸ <code>:information_source:</code></td></tr><tr><td>ğŸ†— <code>:ok:</code></td><td>ğŸ”€ <code>:twisted_rightwards_arrows:</code></td><td>ğŸ” <code>:repeat:</code></td></tr><tr><td>ğŸ”‚ <code>:repeat_one:</code></td><td>ğŸ†• <code>:new:</code></td><td>ğŸ” <code>:top:</code></td></tr><tr><td>ğŸ†™ <code>:up:</code></td><td>ğŸ†’ <code>:cool:</code></td><td>ğŸ†“ <code>:free:</code></td></tr><tr><td>ğŸ†– <code>:ng:</code></td><td>ğŸ¦ <code>:cinema:</code></td><td>ğŸˆ <code>:koko:</code></td></tr><tr><td>ğŸ“¶ <code>:signal_strength:</code></td><td>:u5272: <code>:u5272:</code></td><td>:u5408: <code>:u5408:</code></td></tr><tr><td>:u55b6: <code>:u55b6:</code></td><td>:u6307: <code>:u6307:</code></td><td>:u6708: <code>:u6708:</code></td></tr><tr><td>:u6709: <code>:u6709:</code></td><td>ğŸˆµ <code>:u6e80:</code></td><td>:u7121: <code>:u7121:</code></td></tr><tr><td>:u7533: <code>:u7533:</code></td><td>:u7a7a: <code>:u7a7a:</code></td><td>:u7981: <code>:u7981:</code></td></tr><tr><td>ğŸˆ‚ï¸ <code>:sa:</code></td><td>ğŸš» <code>:restroom:</code></td><td>ğŸš¹ <code>:mens:</code></td></tr><tr><td>ğŸšº <code>:womens:</code></td><td>ğŸš¼ <code>:baby_symbol:</code></td><td>ğŸš­ <code>:no_smoking:</code></td></tr><tr><td>ğŸ…¿ï¸ <code>:parking:</code></td><td>â™¿ <code>:wheelchair:</code></td><td>ğŸš‡ <code>:metro:</code></td></tr><tr><td>ğŸ›„ <code>:baggage_claim:</code></td><td>ğŸ‰‘ <code>:accept:</code></td><td>ğŸš¾ <code>:wc:</code></td></tr><tr><td>ğŸš° <code>:potable_water:</code></td><td>ğŸš® <code>:put_litter_in_its_place:</code></td><td>ãŠ™ï¸ <code>:secret:</code></td></tr><tr><td>ãŠ—ï¸ <code>:congratulations:</code></td><td>â“‚ï¸ <code>:m:</code></td><td>ğŸ›‚ <code>:passport_control:</code></td></tr><tr><td>ğŸ›… <code>:left_luggage:</code></td><td>ğŸ›ƒ <code>:customs:</code></td><td>ğŸ‰ <code>:ideograph_advantage:</code></td></tr><tr><td>ğŸ†‘ <code>:cl:</code></td><td>ğŸ†˜ <code>:sos:</code></td><td>ğŸ†” <code>:id:</code></td></tr><tr><td>ğŸš« <code>:no_entry_sign:</code></td><td>ğŸ” <code>:underage:</code></td><td>ğŸ“µ <code>:no_mobile_phones:</code></td></tr><tr><td>ğŸš¯ <code>:do_not_litter:</code></td><td>ğŸš± <code>:non-potable_water:</code></td><td>ğŸš³ <code>:no_bicycles:</code></td></tr><tr><td>ğŸš· <code>:no_pedestrians:</code></td><td>ğŸš¸ <code>:children_crossing:</code></td><td>â›” <code>:no_entry:</code></td></tr><tr><td>âœ³ï¸ <code>:eight_spoked_asterisk:</code></td><td>âœ´ï¸ <code>:eight_pointed_black_star:</code></td><td>ğŸ’Ÿ <code>:heart_decoration:</code></td></tr><tr><td>ğŸ†š <code>:vs:</code></td><td>ğŸ“³ <code>:vibration_mode:</code></td><td>ğŸ“´ <code>:mobile_phone_off:</code></td></tr><tr><td>ğŸ’¹ <code>:chart:</code></td><td>ğŸ’± <code>:currency_exchange:</code></td><td>â™ˆ <code>:aries:</code></td></tr><tr><td>â™‰ <code>:taurus:</code></td><td>â™Š <code>:gemini:</code></td><td>â™‹ <code>:cancer:</code></td></tr><tr><td>â™Œ <code>:leo:</code></td><td>â™ <code>:virgo:</code></td><td>â™ <code>:libra:</code></td></tr><tr><td>â™ <code>:scorpius:</code></td><td>â™ <code>:sagittarius:</code></td><td>â™‘ <code>:capricorn:</code></td></tr><tr><td>â™’ <code>:aquarius:</code></td><td>â™“ <code>:pisces:</code></td><td>â› <code>:ophiuchus:</code></td></tr><tr><td>ğŸ”¯ <code>:six_pointed_star:</code></td><td>â <code>:negative_squared_cross_mark:</code></td><td>ğŸ…°ï¸ <code>:a:</code></td></tr><tr><td>ğŸ…±ï¸ <code>:b:</code></td><td>ğŸ† <code>:ab:</code></td><td>ğŸ…¾ï¸ <code>:o2:</code></td></tr><tr><td>ğŸ’  <code>:diamond_shape_with_a_dot_inside:</code></td><td>â™»ï¸ <code>:recycle:</code></td><td>ğŸ”š <code>:end:</code></td></tr><tr><td>ğŸ”› <code>:on:</code></td><td>ğŸ”œ <code>:soon:</code></td><td>ğŸ• <code>:clock1:</code></td></tr><tr><td>ğŸ•œ <code>:clock130:</code></td><td>ğŸ•™ <code>:clock10:</code></td><td>ğŸ•¥ <code>:clock1030:</code></td></tr><tr><td>ğŸ•š <code>:clock11:</code></td><td>ğŸ•¦ <code>:clock1130:</code></td><td>ğŸ•› <code>:clock12:</code></td></tr><tr><td>ğŸ•§ <code>:clock1230:</code></td><td>ğŸ•‘ <code>:clock2:</code></td><td>ğŸ• <code>:clock230:</code></td></tr><tr><td>ğŸ•’ <code>:clock3:</code></td><td>ğŸ• <code>:clock330:</code></td><td>ğŸ•“ <code>:clock4:</code></td></tr><tr><td>ğŸ•Ÿ <code>:clock430:</code></td><td>ğŸ•” <code>:clock5:</code></td><td>ğŸ•  <code>:clock530:</code></td></tr><tr><td>ğŸ•• <code>:clock6:</code></td><td>ğŸ•¡ <code>:clock630:</code></td><td>ğŸ•– <code>:clock7:</code></td></tr><tr><td>ğŸ•¢ <code>:clock730:</code></td><td>ğŸ•— <code>:clock8:</code></td><td>ğŸ•£ <code>:clock830:</code></td></tr><tr><td>ğŸ•˜ <code>:clock9:</code></td><td>ğŸ•¤ <code>:clock930:</code></td><td>ğŸ’² <code>:heavy_dollar_sign:</code></td></tr><tr><td>Â©ï¸ <code>:copyright:</code></td><td>Â®ï¸ <code>:registered:</code></td><td>â„¢ï¸ <code>:tm:</code></td></tr><tr><td>âŒ <code>:x:</code></td><td>â— <code>:heavy_exclamation_mark:</code></td><td>â€¼ï¸ <code>:bangbang:</code></td></tr><tr><td>â‰ï¸ <code>:interrobang:</code></td><td>â­• <code>:o:</code></td><td>âœ–ï¸ <code>:heavy_multiplication_x:</code></td></tr><tr><td>â• <code>:heavy_plus_sign:</code></td><td>â– <code>:heavy_minus_sign:</code></td><td>â— <code>:heavy_division_sign:</code></td></tr><tr><td>ğŸ’® <code>:white_flower:</code></td><td>ğŸ’¯ <code>:100:</code></td><td>âœ”ï¸ <code>:heavy_check_mark:</code></td></tr><tr><td>â˜‘ï¸ <code>:ballot_box_with_check:</code></td><td>ğŸ”˜ <code>:radio_button:</code></td><td>ğŸ”— <code>:link:</code></td></tr><tr><td>â° <code>:curly_loop:</code></td><td>ã€°ï¸ <code>:wavy_dash:</code></td><td>ã€½ï¸ <code>:part_alternation_mark:</code></td></tr><tr><td>ğŸ”± <code>:trident:</code></td><td>:black_square: <code>:black_square:</code></td><td>:white_square: <code>:white_square:</code></td></tr><tr><td>âœ… <code>:white_check_mark:</code></td><td>ğŸ”² <code>:black_square_button:</code></td><td>ğŸ”³ <code>:white_square_button:</code></td></tr><tr><td>âš« <code>:black_circle:</code></td><td>âšª <code>:white_circle:</code></td><td>ğŸ”´ <code>:red_circle:</code></td></tr><tr><td>ğŸ”µ <code>:large_blue_circle:</code></td><td>ğŸ”· <code>:large_blue_diamond:</code></td><td>ğŸ”¶ <code>:large_orange_diamond:</code></td></tr><tr><td>ğŸ”¹ <code>:small_blue_diamond:</code></td><td>ğŸ”¸ <code>:small_orange_diamond:</code></td><td>ğŸ”º <code>:small_red_triangle:</code></td></tr><tr><td>ğŸ”» <code>:small_red_triangle_down:</code></td><td>:shipit: <code>:shipit:</code></td><td></td></tr></tbody></table>]]></content>
    
    
    <categories>
      
      <category>èµ„æº</category>
      
    </categories>
    
    
    <tags>
      
      <tag>emoji</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>JVM-02-ç±»åŠ è½½å­ç³»ç»Ÿ</title>
    <link href="/2022/10/24/jvm-02-lei-jia-zai-zi-xi-tong/"/>
    <url>/2022/10/24/jvm-02-lei-jia-zai-zi-xi-tong/</url>
    
    <content type="html"><![CDATA[<h2 id="1ã€ç±»åŠ è½½å­ç³»ç»Ÿ">1ã€ç±»åŠ è½½å­ç³»ç»Ÿ</h2><h3 id="1ã€å†…å­˜ç»“æ„æ¦‚è¿°">1ã€å†…å­˜ç»“æ„æ¦‚è¿°</h3><h4 id="1ã€ç®€å›¾">1ã€ç®€å›¾</h4><p><img src="/2022/10/24/jvm-02-lei-jia-zai-zi-xi-tong/image-20221024163558872.png" alt></p><h4 id="2ã€è¯¦ç»†å›¾">2ã€è¯¦ç»†å›¾</h4><p>è‹±æ–‡ç‰ˆ</p><p><img src="/2022/10/24/jvm-02-lei-jia-zai-zi-xi-tong/image-20221024164417433.png" alt></p><p>ä¸­æ–‡ç‰ˆ</p><p><img src="/2022/10/24/jvm-02-lei-jia-zai-zi-xi-tong/image-20221024164544639.png" alt></p><h3 id="2ã€ç±»åŠ è½½å™¨å­ç³»ç»Ÿ">2ã€ç±»åŠ è½½å™¨å­ç³»ç»Ÿ</h3><h4 id="1ã€ç±»åŠ è½½å™¨å­ç³»ç»Ÿçš„ä½œç”¨">1ã€ç±»åŠ è½½å™¨å­ç³»ç»Ÿçš„ä½œç”¨</h4><ol><li>ç±»åŠ è½½å™¨å­ç³»ç»Ÿè´Ÿè´£ä»æ–‡ä»¶ç³»ç»Ÿæˆ–è€…ç½‘ç»œä¸­åŠ è½½Classæ–‡ä»¶ï¼Œclassæ–‡ä»¶åœ¨æ–‡ä»¶å¼€å¤´æœ‰ç‰¹å®šçš„æ–‡ä»¶æ ‡è¯†ã€‚</li><li>ClassLoaderåªè´Ÿè´£classæ–‡ä»¶çš„åŠ è½½ï¼Œè‡³äºå®ƒæ˜¯å¦å¯ä»¥è¿è¡Œï¼Œåˆ™ç”±Execution Engineï¼ˆæ‰§è¡Œå¼•æ“ï¼‰å†³å®šã€‚<br>ï¼ˆæ¯”å¦‚ï¼šåˆ«äººç»™ä½ ä»‹ç»å¯¹è±¡ï¼Œèƒ½ä¸èƒ½æˆå¦è¯´ã€‚å…¶ä¸­ClassLoaderåªè´Ÿè´£åˆ«äººä»‹ç»å¯¹è±¡ï¼Œèƒ½ä¸èƒ½æˆå…¨çœ‹ä½ ï¼‰</li><li><strong>åŠ è½½çš„ç±»ä¿¡æ¯å­˜æ”¾äºä¸€å—ç§°ä¸ºæ–¹æ³•åŒºçš„å†…å­˜ç©ºé—´</strong>ã€‚é™¤äº†ç±»çš„ä¿¡æ¯å¤–ï¼Œæ–¹æ³•åŒºä¸­è¿˜ä¼šå­˜æ”¾è¿è¡Œæ—¶å¸¸é‡æ± ä¿¡æ¯ï¼Œå¯èƒ½è¿˜åŒ…æ‹¬å­—ç¬¦ä¸²å­—é¢é‡å’Œæ•°å­—å¸¸é‡ï¼ˆè¿™éƒ¨åˆ†å¸¸é‡ä¿¡æ¯æ˜¯Classæ–‡ä»¶ä¸­å¸¸é‡æ± éƒ¨åˆ†çš„å†…å­˜æ˜ å°„ï¼‰</li></ol><p><img src="/2022/10/24/jvm-02-lei-jia-zai-zi-xi-tong/image-20221024164911148.png" alt></p><h4 id="2ã€ç±»åŠ è½½å™¨ClassLoaderè§’è‰²">2ã€ç±»åŠ è½½å™¨ClassLoaderè§’è‰²</h4><ol><li>class fileï¼ˆåœ¨ä¸‹å›¾ä¸­å°±æ˜¯Car.classæ–‡ä»¶ï¼‰å­˜åœ¨äºæœ¬åœ°ç¡¬ç›˜ä¸Šï¼Œå¯ä»¥ç†è§£ä¸ºè®¾è®¡å¸ˆç”»åœ¨çº¸ä¸Šçš„æ¨¡æ¿ï¼Œè€Œæœ€ç»ˆè¿™ä¸ªæ¨¡æ¿åœ¨æ‰§è¡Œçš„æ—¶å€™æ˜¯è¦åŠ è½½åˆ°JVMå½“ä¸­æ¥æ ¹æ®è¿™ä¸ªæ–‡ä»¶å®ä¾‹åŒ–å‡ºnä¸ªä¸€æ¨¡ä¸€æ ·çš„å®ä¾‹ã€‚</li><li>class fileåŠ è½½åˆ°JVMä¸­ï¼Œè¢«ç§°ä¸ºDNAå…ƒæ•°æ®æ¨¡æ¿ï¼ˆåœ¨ä¸‹å›¾ä¸­å°±æ˜¯å†…å­˜ä¸­çš„Car Classï¼‰ï¼Œæ”¾åœ¨æ–¹æ³•åŒºã€‚</li><li>åœ¨.classæ–‡ä»¶â€“&gt;JVMâ€“&gt;æœ€ç»ˆæˆä¸ºå…ƒæ•°æ®æ¨¡æ¿ï¼Œæ­¤è¿‡ç¨‹å°±è¦ä¸€ä¸ªè¿è¾“å·¥å…·ï¼ˆç±»è£…è½½å™¨Class Loaderï¼‰ï¼Œæ‰®æ¼”ä¸€ä¸ªå¿«é€’å‘˜çš„è§’è‰²ã€‚</li></ol><p><img src="/2022/10/24/jvm-02-lei-jia-zai-zi-xi-tong/image-20221024165223695.png" alt></p><h3 id="3ã€ç±»åŠ è½½è¿‡ç¨‹">3ã€ç±»åŠ è½½è¿‡ç¨‹</h3><p><img src="/2022/10/24/jvm-02-lei-jia-zai-zi-xi-tong/image-20221024165836131.png" alt="ç±»åŠ è½½è¿‡ç¨‹"></p><h4 id="1ã€Demo">1ã€Demo</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">HelloLoader</span> &#123;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span> &#123;<br>        System.out.println(<span class="hljs-string">&quot;è°¢è°¢ClassLoaderåŠ è½½æˆ‘....&quot;</span>);<br>        System.out.println(<span class="hljs-string">&quot;ä½ çš„å¤§æ©å¤§å¾·ï¼Œæˆ‘ä¸‹è¾ˆå­å†æŠ¥ï¼&quot;</span>);<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>åŠ è½½è¿‡ç¨‹å¦‚ä¸‹ï¼š</p><ol><li>æ‰§è¡Œ main() æ–¹æ³•ï¼ˆé™æ€æ–¹æ³•ï¼‰å°±éœ€è¦å…ˆåŠ è½½mainæ–¹æ³•æ‰€åœ¨ç±» HelloLoader</li><li>åŠ è½½æˆåŠŸï¼Œåˆ™è¿›è¡Œé“¾æ¥ã€åˆå§‹åŒ–ç­‰æ“ä½œã€‚å®Œæˆåè°ƒç”¨ HelloLoader ç±»ä¸­çš„é™æ€æ–¹æ³• main</li><li>åŠ è½½å¤±è´¥åˆ™æŠ›å‡ºå¼‚å¸¸</li></ol><p><img src="/2022/10/24/jvm-02-lei-jia-zai-zi-xi-tong/image-20221024170014984.png" alt="ç±»åŠ è½½è¿‡ç¨‹ç¤ºæ„å›¾"></p><h4 id="2ã€åŠ è½½ï¼ˆLoadingï¼‰">2ã€åŠ è½½ï¼ˆLoadingï¼‰</h4><p>åŠ è½½ï¼š</p><ol><li>é€šè¿‡ä¸€ä¸ªç±»çš„å…¨é™å®šåè·å–å®šä¹‰æ­¤ç±»çš„äºŒè¿›åˆ¶å­—èŠ‚æµ</li><li>å°†è¿™ä¸ªå­—èŠ‚æµæ‰€ä»£è¡¨çš„é™æ€å­˜å‚¨ç»“æ„è½¬åŒ–ä¸ºæ–¹æ³•åŒºçš„è¿è¡Œæ—¶æ•°æ®ç»“æ„</li><li><code>åœ¨å†…å­˜ä¸­ç”Ÿæˆä¸€ä¸ªä»£è¡¨è¿™ä¸ªç±»çš„java.lang.Classå¯¹è±¡</code>ï¼Œä½œä¸ºæ–¹æ³•åŒºè¿™ä¸ªç±»çš„å„ç§æ•°æ®çš„è®¿é—®å…¥å£</li></ol><p><code>ç”Ÿæˆå¤§çš„classå®ä¾‹æ˜¯åœ¨åŠ è½½é˜¶æ®µå®ç°çš„</code></p><p>åŠ è½½ .class æ–‡ä»¶çš„æ–¹å¼ï¼š</p><ul><li>ä»æœ¬åœ°ç³»ç»Ÿä¸­ç›´æ¥åŠ è½½</li><li>é€šè¿‡ç½‘ç»œè·å–ï¼Œå…¸å‹åœºæ™¯ï¼šWeb Applet</li><li>ä»zipå‹ç¼©åŒ…ä¸­è¯»å–ï¼Œæˆä¸ºæ—¥åjarã€waræ ¼å¼çš„åŸºç¡€</li><li>è¿è¡Œæ—¶è®¡ç®—ç”Ÿæˆï¼Œä½¿ç”¨æœ€å¤šçš„æ˜¯ï¼šåŠ¨æ€ä»£ç†æŠ€æœ¯</li><li>ç”±å…¶ä»–æ–‡ä»¶ç”Ÿæˆï¼Œå…¸å‹åœºæ™¯ï¼šJSPåº”ç”¨</li><li>ä»ä¸“æœ‰æ•°æ®åº“ä¸­æå–.classæ–‡ä»¶ï¼Œæ¯”è¾ƒå°‘è§</li><li>ä»åŠ å¯†æ–‡ä»¶ä¸­è·å–ï¼Œå…¸å‹çš„é˜²Classæ–‡ä»¶è¢«åç¼–è¯‘çš„ä¿æŠ¤æªæ–½</li></ul><h4 id="3ã€é“¾æ¥ï¼ˆLinkingï¼‰">3ã€é“¾æ¥ï¼ˆLinkingï¼‰</h4><p>é“¾æ¥åˆåŒ…æ‹¬ä¸‰ä¸ªè¿‡ç¨‹ï¼šéªŒè¯ -&gt; å‡†å¤‡ -&gt; è§£æ</p><h5 id="1ã€éªŒè¯-Verify">1ã€éªŒè¯(Verify)</h5><ol><li>ç›®çš„åœ¨äºç¡®ä¿Classæ–‡ä»¶çš„å­—èŠ‚æµä¸­åŒ…å«ä¿¡æ¯ç¬¦åˆå½“å‰è™šæ‹Ÿæœºè¦æ±‚ï¼Œä¿è¯è¢«åŠ è½½ç±»çš„æ­£ç¡®æ€§ï¼Œä¸ä¼šå±å®³è™šæ‹Ÿæœºè‡ªèº«å®‰å…¨</li><li>ä¸»è¦åŒ…æ‹¬å››ç§éªŒè¯ï¼Œæ–‡ä»¶æ ¼å¼éªŒè¯ï¼Œå…ƒæ•°æ®éªŒè¯ï¼Œå­—èŠ‚ç éªŒè¯ï¼Œç¬¦å·å¼•ç”¨éªŒè¯ã€‚</li></ol><p>ä½¿ç”¨ BinaryViewerè½¯ä»¶æŸ¥çœ‹å­—èŠ‚ç æ–‡ä»¶ï¼Œå…¶å¼€å¤´å‡ä¸º CAFE BABE ï¼ˆjavaï¼‰ï¼Œå¦‚æœå‡ºç°ä¸åˆæ³•çš„å­—èŠ‚ç æ–‡ä»¶ï¼Œé‚£ä¹ˆå°†ä¼šéªŒè¯ä¸é€šè¿‡ã€‚</p><p><img src="/2022/10/24/jvm-02-lei-jia-zai-zi-xi-tong/image-20221024171040995.png" alt=".classæ–‡ä»¶"></p><h5 id="2ã€å‡†å¤‡-Prepare">2ã€å‡†å¤‡(Prepare)</h5><ol><li>ä¸ºç±»å˜é‡ï¼ˆstaticå˜é‡ï¼‰åˆ†é…å†…å­˜å¹¶ä¸”è®¾ç½®è¯¥ç±»å˜é‡çš„é»˜è®¤åˆå§‹å€¼ï¼Œå³é›¶å€¼</li><li><code>è¿™é‡Œä¸åŒ…å«ç”¨finalä¿®é¥°çš„staticï¼Œå› ä¸ºfinalåœ¨ç¼–è¯‘çš„æ—¶å€™å°±ä¼šåˆ†é…å¥½äº†é»˜è®¤å€¼ï¼Œå‡†å¤‡é˜¶æ®µä¼šæ˜¾å¼åˆå§‹åŒ–</code></li><li>æ³¨æ„ï¼š<code>è¿™é‡Œä¸ä¼šä¸ºå®ä¾‹å˜é‡åˆ†é…åˆå§‹åŒ–</code>ï¼Œç±»å˜é‡ä¼šåˆ†é…åœ¨æ–¹æ³•åŒºä¸­ï¼Œè€Œå®ä¾‹å˜é‡æ˜¯ä¼šéšç€å¯¹è±¡ä¸€èµ·åˆ†é…åˆ°Javaå †ä¸­</li></ol><blockquote><p>ä¸¾ä¾‹</p></blockquote><p>ä»£ç ï¼šå˜é‡aåœ¨å‡†å¤‡é˜¶æ®µä¼šèµ‹åˆå§‹å€¼ï¼Œä½†ä¸æ˜¯1ï¼Œè€Œæ˜¯0ï¼Œåœ¨åˆå§‹åŒ–é˜¶æ®µä¼šè¢«èµ‹å€¼ä¸º 1</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">HelloApp</span> &#123;<br>    <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-type">int</span> <span class="hljs-variable">a</span> <span class="hljs-operator">=</span> <span class="hljs-number">1</span>;<span class="hljs-comment">//prepareï¼ša = 0 ---&gt; initial : a = 1</span><br><br><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span> &#123;<br>        System.out.println(a);<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><h5 id="3ã€è§£æ-Resolve">3ã€è§£æ(Resolve)</h5><ol><li>å°†å¸¸é‡æ± å†…çš„<code>ç¬¦å·å¼•ç”¨</code>è½¬æ¢ä¸ºç›´æ¥å¼•ç”¨çš„è¿‡ç¨‹</li><li>äº‹å®ä¸Šï¼Œè§£ææ“ä½œå¾€å¾€ä¼šä¼´éšç€JVMåœ¨æ‰§è¡Œå®Œåˆå§‹åŒ–ä¹‹åå†æ‰§è¡Œ</li><li>ç¬¦å·å¼•ç”¨å°±æ˜¯ä¸€ç»„ç¬¦å·æ¥æè¿°æ‰€å¼•ç”¨çš„ç›®æ ‡ã€‚ç¬¦å·å¼•ç”¨çš„å­—é¢é‡å½¢å¼æ˜ç¡®å®šä¹‰åœ¨ã€Šjavaè™šæ‹Ÿæœºè§„èŒƒã€‹çš„classæ–‡ä»¶æ ¼å¼ä¸­ã€‚ç›´æ¥å¼•ç”¨å°±æ˜¯ç›´æ¥æŒ‡å‘ç›®æ ‡çš„æŒ‡é’ˆã€ç›¸å¯¹åç§»é‡æˆ–ä¸€ä¸ªé—´æ¥å®šä½åˆ°ç›®æ ‡çš„å¥æŸ„</li><li>è§£æåŠ¨ä½œä¸»è¦é’ˆå¯¹ç±»æˆ–æ¥å£ã€å­—æ®µã€ç±»æ–¹æ³•ã€æ¥å£æ–¹æ³•ã€æ–¹æ³•ç±»å‹ç­‰ã€‚å¯¹åº”å¸¸é‡æ± ä¸­çš„CONSTANT Class infoã€CONSTANT Fieldref infoã€CONSTANT Methodref infoç­‰</li></ol><blockquote><p>ç¬¦å·å¼•ç”¨ï¼šåç¼–è¯‘ class æ–‡ä»¶åå¯ä»¥æŸ¥çœ‹ç¬¦å·å¼•ç”¨ï¼Œä¸‹é¢å¸¦# çš„å°±æ˜¯ç¬¦å·å¼•ç”¨</p></blockquote><p><img src="/2022/10/24/jvm-02-lei-jia-zai-zi-xi-tong/image-20221024182616267.png" alt="æŸ¥çœ‹ç¬¦å·å¼•ç”¨"></p><h4 id="4ã€åˆå§‹åŒ–ï¼ˆInitializationï¼‰">4ã€åˆå§‹åŒ–ï¼ˆInitializationï¼‰</h4><p>ç±»çš„åˆå§‹åŒ–æ—¶æœºï¼š</p><ol><li>åˆ›å»ºç±»çš„å®ä¾‹</li><li>è®¿é—®æŸä¸ªç±»æˆ–æ¥å£çš„é™æ€å˜é‡ï¼Œæˆ–è€…å¯¹è¯¥é™æ€å˜é‡èµ‹å€¼</li><li>è°ƒç”¨ç±»çš„é™æ€æ–¹æ³•</li><li>åå°„ï¼ˆæ¯”å¦‚ï¼šClass.forName(â€œcom.atguigu.Testâ€)ï¼‰</li><li>åˆå§‹åŒ–ä¸€ä¸ªç±»çš„å­ç±»</li><li>Javaè™šæ‹Ÿæœºå¯åŠ¨æ—¶è¢«æ ‡æ˜ä¸ºå¯åŠ¨ç±»çš„ç±»</li><li>JDK7å¼€å§‹æä¾›çš„åŠ¨æ€è¯­è¨€æ”¯æŒï¼šjava.lang.invoke.MethodHandleå®ä¾‹çš„è§£æç»“æœREF_getStaticã€REF putStaticã€REF_invokeStaticå¥æŸ„å¯¹åº”çš„ç±»æ²¡æœ‰åˆå§‹åŒ–ï¼Œåˆ™åˆå§‹åŒ–</li></ol><p>é™¤äº†ä»¥ä¸Šä¸ƒç§æƒ…å†µï¼Œå…¶ä»–ä½¿ç”¨Javaç±»çš„æ–¹å¼éƒ½è¢«çœ‹ä½œæ˜¯å¯¹ç±»çš„è¢«åŠ¨ä½¿ç”¨ï¼Œéƒ½ä¸ä¼šå¯¼è‡´ç±»çš„åˆå§‹åŒ–ï¼Œå³<code>ä¸ä¼šæ‰§è¡Œåˆå§‹åŒ–é˜¶æ®µï¼ˆä¸ä¼šè°ƒç”¨ clinit() æ–¹æ³•å’Œ init() æ–¹æ³•ï¼‰</code></p><h4 id="5ã€clinit">5ã€clinit()</h4><ol><li>åˆå§‹åŒ–é˜¶æ®µå°±æ˜¯æ‰§è¡Œç±»æ„é€ å™¨æ–¹æ³•<code>&lt;clinit&gt;()</code>çš„è¿‡ç¨‹</li><li>æ­¤æ–¹æ³•ä¸éœ€å®šä¹‰ï¼Œæ˜¯javacç¼–è¯‘å™¨è‡ªåŠ¨æ”¶é›†ç±»ä¸­çš„æ‰€æœ‰<strong>ç±»å˜é‡</strong>çš„èµ‹å€¼åŠ¨ä½œå’Œé™æ€ä»£ç å—ä¸­çš„è¯­å¥åˆå¹¶è€Œæ¥ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œ<code>å½“æˆ‘ä»¬ä»£ç ä¸­åŒ…å«staticå˜é‡çš„æ—¶å€™ï¼Œå°±ä¼šæœ‰clinitæ–¹æ³•</code></li><li><code>&lt;clinit&gt;()</code>æ–¹æ³•ä¸­çš„æŒ‡ä»¤æŒ‰è¯­å¥åœ¨æºæ–‡ä»¶ä¸­å‡ºç°çš„é¡ºåºæ‰§è¡Œ</li><li><code>&lt;clinit&gt;()</code>ä¸åŒäºç±»çš„æ„é€ å™¨ã€‚ï¼ˆå…³è”ï¼šæ„é€ å™¨æ˜¯è™šæ‹Ÿæœºè§†è§’ä¸‹çš„<code>&lt;init&gt;()</code>ï¼‰</li><li>è‹¥è¯¥ç±»å…·æœ‰çˆ¶ç±»ï¼ŒJVMä¼šä¿è¯å­ç±»çš„<code>&lt;clinit&gt;()</code>æ‰§è¡Œå‰ï¼Œçˆ¶ç±»çš„<code>&lt;clinit&gt;()</code>å·²ç»æ‰§è¡Œå®Œæ¯•</li><li>è™šæ‹Ÿæœºå¿…é¡»ä¿è¯ä¸€ä¸ªç±»çš„<code>&lt;clinit&gt;()</code>æ–¹æ³•åœ¨å¤šçº¿ç¨‹ä¸‹è¢«åŒæ­¥åŠ é”</li></ol><blockquote><p>IDEA ä¸­å®‰è£… JClassLib Bytecode viewer æ’ä»¶ï¼Œå¯ä»¥å¾ˆæ–¹ä¾¿çš„çœ‹å­—èŠ‚ç ã€‚<a href="https://blog.csdn.net/qq_42326620/article/details/122768642">IDEAå®‰è£…JClassæ’ä»¶</a></p></blockquote><h5 id="1ã€æœ‰staticå˜é‡">1ã€æœ‰staticå˜é‡</h5><p>æŸ¥çœ‹ä¸‹é¢è¿™ä¸ªä»£ç çš„å­—èŠ‚ç ï¼Œå¯ä»¥å‘ç°æœ‰ä¸€ä¸ª<code>&lt;clinit&gt;()</code>æ–¹æ³•ã€‚</p><p><img src="/2022/10/24/jvm-02-lei-jia-zai-zi-xi-tong/image-20221024185101090.png" alt></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">ClassInitTest</span> &#123;<br>   <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-type">int</span> <span class="hljs-variable">num</span> <span class="hljs-operator">=</span> <span class="hljs-number">1</span>;<br><br>   <span class="hljs-keyword">static</span>&#123;<br>       num = <span class="hljs-number">2</span>;<br>       number = <span class="hljs-number">20</span>;<br>       System.out.println(num);<br>       <span class="hljs-comment">//System.out.println(number);//æŠ¥é”™ï¼šéæ³•çš„å‰å‘å¼•ç”¨ã€‚</span><br>   &#125;<br><br>   <span class="hljs-comment">/**</span><br><span class="hljs-comment">    * 1ã€linkingä¹‹prepare: number = 0 --&gt; initial: 20 --&gt; 10</span><br><span class="hljs-comment">    * 2ã€è¿™é‡Œå› ä¸ºé™æ€ä»£ç å—å‡ºç°åœ¨å£°æ˜å˜é‡è¯­å¥å‰é¢ï¼Œæ‰€ä»¥ä¹‹å‰è¢«å‡†å¤‡é˜¶æ®µä¸º0çš„numberå˜é‡ä¼š</span><br><span class="hljs-comment">    * é¦–å…ˆè¢«åˆå§‹åŒ–ä¸º20ï¼Œå†æ¥ç€è¢«åˆå§‹åŒ–æˆ10ï¼ˆè¿™ä¹Ÿæ˜¯é¢è¯•æ—¶å¸¸è€ƒçš„é—®é¢˜å“¦ï¼‰</span><br><span class="hljs-comment">    *</span><br><span class="hljs-comment">    */</span><br>   <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-type">int</span> <span class="hljs-variable">number</span> <span class="hljs-operator">=</span> <span class="hljs-number">10</span>;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span> &#123;<br>        System.out.println(ClassInitTest.num);<span class="hljs-comment">//2</span><br>        System.out.println(ClassInitTest.number);<span class="hljs-comment">//10</span><br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>&lt;clintå­—èŠ‚ç &gt;ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs java"> <span class="hljs-number">0</span> iconst_1<br> <span class="hljs-number">1</span> putstatic #<span class="hljs-number">3</span> &lt;com/atguigu/java/ClassInitTest.num&gt;<br> <span class="hljs-number">4</span> iconst_2<br> <span class="hljs-number">5</span> putstatic #<span class="hljs-number">3</span> &lt;com/atguigu/java/ClassInitTest.num&gt;<br> <span class="hljs-number">8</span> bipush <span class="hljs-number">20</span> <span class="hljs-comment">//å…ˆèµ‹20</span><br><span class="hljs-number">10</span> putstatic #<span class="hljs-number">5</span> &lt;com/atguigu/java/ClassInitTest.number&gt;<br><span class="hljs-number">13</span> getstatic #<span class="hljs-number">2</span> &lt;java/lang/System.out&gt;<br><span class="hljs-number">16</span> getstatic #<span class="hljs-number">3</span> &lt;com/atguigu/java/ClassInitTest.num&gt;<br><span class="hljs-number">19</span> invokevirtual #<span class="hljs-number">4</span> &lt;java/io/PrintStream.println&gt;<br><span class="hljs-number">22</span> bipush <span class="hljs-number">10</span><span class="hljs-comment">//å†èµ‹10</span><br><span class="hljs-number">24</span> putstatic #<span class="hljs-number">5</span> &lt;com/atguigu/java/ClassInitTest.number&gt;<br><span class="hljs-number">27</span> <span class="hljs-keyword">return</span><br></code></pre></td></tr></table></figure><blockquote><p>å½“æˆ‘ä»¬ä»£ç ä¸­åŒ…å«staticå˜é‡çš„æ—¶å€™ï¼Œå°±ä¼šæœ‰clinitæ–¹æ³•</p></blockquote><h5 id="2ã€æ— -static-å˜é‡">2ã€æ—  static å˜é‡</h5><p><img src="/2022/10/24/jvm-02-lei-jia-zai-zi-xi-tong/image-20221024185305810.png" alt></p><p>æ²¡æœ‰clinitæ˜¯å› ä¸ºæ²¡æœ‰staticå˜é‡</p><h5 id="3ã€æ„é€ å™¨">3ã€æ„é€ å™¨</h5><p><img src="/2022/10/24/jvm-02-lei-jia-zai-zi-xi-tong/image-20221024185513790.png" alt></p><p>æ„é€ å™¨å¯¹åº”çš„æ˜¯å³è¾¹çš„init()</p><p>åœ¨æ„é€ å™¨ä¸­ï¼š</p><ul><li>å…ˆå°†ç±»å˜é‡ a èµ‹å€¼ä¸º 10</li><li>å†å°†å±€éƒ¨å˜é‡èµ‹å€¼ä¸º 20</li></ul><h5 id="4ã€æ‹¥æœ‰çˆ¶ç±»çš„ç±»">4ã€æ‹¥æœ‰çˆ¶ç±»çš„ç±»</h5><p>è‹¥è¯¥ç±»å…·æœ‰çˆ¶ç±»ï¼ŒJVMä¼šä¿è¯å­ç±»çš„<code>&lt;clinit&gt;()</code>æ‰§è¡Œå‰ï¼Œçˆ¶ç±»çš„<code>&lt;clinit&gt;()</code>å·²ç»æ‰§è¡Œå®Œæ¯•</p><p><img src="/2022/10/24/jvm-02-lei-jia-zai-zi-xi-tong/image-20221024185655011.png" alt></p><p>å¦‚ä¸Šä»£ç ï¼ŒåŠ è½½æµç¨‹å¦‚ä¸‹ï¼š</p><ul><li>é¦–å…ˆï¼Œæ‰§è¡Œ main() æ–¹æ³•éœ€è¦åŠ è½½ ClinitTest1 ç±»</li><li>è·å– Son.B é™æ€å˜é‡ï¼Œéœ€è¦åŠ è½½ Son ç±»</li><li>Son ç±»çš„çˆ¶ç±»æ˜¯ Father ç±»ï¼Œæ‰€ä»¥éœ€è¦å…ˆæ‰§è¡Œ Father ç±»çš„åŠ è½½ï¼Œå†æ‰§è¡Œ Son ç±»çš„åŠ è½½</li></ul><h5 id="5ã€åŒæ­¥åŠ é”é—®é¢˜">5ã€åŒæ­¥åŠ é”é—®é¢˜</h5><p>è™šæ‹Ÿæœºå¿…é¡»ä¿è¯ä¸€ä¸ªç±»çš„<code>&lt;clinit&gt;()</code>æ–¹æ³•åœ¨å¤šçº¿ç¨‹ä¸‹è¢«åŒæ­¥åŠ é”</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">DeadThreadTest</span> &#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span> &#123;<br>        <span class="hljs-type">Runnable</span> <span class="hljs-variable">r</span> <span class="hljs-operator">=</span> () -&gt; &#123;<br>            System.out.println(Thread.currentThread().getName() + <span class="hljs-string">&quot;å¼€å§‹&quot;</span>);<br>            <span class="hljs-type">DeadThread</span> <span class="hljs-variable">dead</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">DeadThread</span>();<br>            System.out.println(Thread.currentThread().getName() + <span class="hljs-string">&quot;ç»“æŸ&quot;</span>);<br>        &#125;;<br><br>        <span class="hljs-type">Thread</span> <span class="hljs-variable">t1</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Thread</span>(r,<span class="hljs-string">&quot;çº¿ç¨‹1&quot;</span>);<br>        <span class="hljs-type">Thread</span> <span class="hljs-variable">t2</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Thread</span>(r,<span class="hljs-string">&quot;çº¿ç¨‹2&quot;</span>);<br><br>        t1.start();<br>        t2.start();<br>    &#125;<br>&#125;<br><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">DeadThread</span>&#123;<br>    <span class="hljs-keyword">static</span>&#123;<br>        <span class="hljs-keyword">if</span>(<span class="hljs-literal">true</span>)&#123;<br>            System.out.println(Thread.currentThread().getName() + <span class="hljs-string">&quot;åˆå§‹åŒ–å½“å‰ç±»&quot;</span>);<br>            <span class="hljs-keyword">while</span>(<span class="hljs-literal">true</span>)&#123;<br><br>            &#125;<br>        &#125;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>ç»“æœå¦‚ä¸‹ï¼š</p><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs awk">çº¿ç¨‹<span class="hljs-number">2</span>å¼€å§‹<br>çº¿ç¨‹<span class="hljs-number">1</span>å¼€å§‹<br>çº¿ç¨‹<span class="hljs-number">2</span>åˆå§‹åŒ–å½“å‰ç±»<br><br><span class="hljs-regexp">//</span>ç„¶åç¨‹åºå¡æ­»äº†<br></code></pre></td></tr></table></figure><p>ç¨‹åºå¡æ­»ï¼Œåˆ†æåŸå› ï¼š</p><ul><li>ä¸¤ä¸ªçº¿ç¨‹åŒæ—¶å»åŠ è½½ DeadThread ç±»ï¼Œè€Œ DeadThread ç±»ä¸­é™æ€ä»£ç å—ä¸­æœ‰ä¸€å¤„æ­»å¾ªç¯</li><li>å…ˆåŠ è½½ DeadThread ç±»çš„çº¿ç¨‹æŠ¢åˆ°äº†åŒæ­¥é”ï¼Œç„¶ååœ¨ç±»çš„é™æ€ä»£ç å—ä¸­æ‰§è¡Œæ­»å¾ªç¯ï¼Œè€Œå¦ä¸€ä¸ªçº¿ç¨‹åœ¨ç­‰å¾…åŒæ­¥é”çš„é‡Šæ”¾</li><li>æ‰€ä»¥æ— è®ºå“ªä¸ªçº¿ç¨‹å…ˆæ‰§è¡Œ DeadThread ç±»çš„åŠ è½½ï¼Œå¦å¤–ä¸€ä¸ªç±»ä¹Ÿä¸ä¼šç»§ç»­æ‰§è¡Œã€‚ï¼ˆä¸€ä¸ªç±»åªä¼šè¢«åŠ è½½ä¸€æ¬¡ï¼‰</li></ul><h3 id="4ã€ç±»åŠ è½½å™¨åˆ†ç±»">4ã€ç±»åŠ è½½å™¨åˆ†ç±»</h3><h4 id="1ã€æ¦‚è¿°">1ã€æ¦‚è¿°</h4><ol><li>JVMä¸¥æ ¼æ¥è®²æ”¯æŒä¸¤ç§ç±»å‹çš„ç±»åŠ è½½å™¨ ã€‚åˆ†åˆ«ä¸º<code>å¼•å¯¼ç±»åŠ è½½å™¨ï¼ˆBootstrap ClassLoaderï¼‰</code>å’Œ<code>è‡ªå®šä¹‰ç±»åŠ è½½å™¨ï¼ˆUser-Defined ClassLoaderï¼‰</code></li><li>ä»æ¦‚å¿µä¸Šæ¥è®²ï¼Œè‡ªå®šä¹‰ç±»åŠ è½½å™¨ä¸€èˆ¬æŒ‡çš„æ˜¯ç¨‹åºä¸­ç”±å¼€å‘äººå‘˜è‡ªå®šä¹‰çš„ä¸€ç±»ç±»åŠ è½½å™¨ï¼Œä½†æ˜¯Javaè™šæ‹Ÿæœºè§„èŒƒå´æ²¡æœ‰è¿™ä¹ˆå®šä¹‰ï¼Œè€Œæ˜¯<strong>å°†æ‰€æœ‰æ´¾ç”ŸäºæŠ½è±¡ç±»ClassLoaderçš„ç±»åŠ è½½å™¨éƒ½åˆ’åˆ†ä¸ºè‡ªå®šä¹‰ç±»åŠ è½½å™¨</strong></li><li>æ— è®ºç±»åŠ è½½å™¨çš„ç±»å‹å¦‚ä½•åˆ’åˆ†ï¼Œåœ¨ç¨‹åºä¸­æˆ‘ä»¬æœ€å¸¸è§çš„ç±»åŠ è½½å™¨å§‹ç»ˆåªæœ‰3ä¸ªï¼Œå¦‚ä¸‹æ‰€ç¤º</li></ol><p><img src="/2022/10/24/jvm-02-lei-jia-zai-zi-xi-tong/image-20221024191612814.png" alt></p><p>Optionalå››è€…ä¹‹é—´çš„å…³ç³»æ˜¯åŒ…å«å…³ç³»ã€‚ä¸æ˜¯ä¸Šå±‚ä¸‹å±‚ï¼Œä¹Ÿä¸æ˜¯å­çˆ¶ç±»çš„ ç»§æ‰¿å…³ç³»ã€‚</p><p><strong>ExtClassLoader</strong></p><p><img src="/2022/10/24/jvm-02-lei-jia-zai-zi-xi-tong/image-20221024191738052.png" alt></p><p><strong>AppClassLoader</strong></p><p><img src="/2022/10/24/jvm-02-lei-jia-zai-zi-xi-tong/image-20221024191755771.png" alt></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">ClassLoaderTest</span> &#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span> &#123;<br><br>        <span class="hljs-comment">//è·å–ç³»ç»Ÿç±»åŠ è½½å™¨</span><br>        <span class="hljs-type">ClassLoader</span> <span class="hljs-variable">systemClassLoader</span> <span class="hljs-operator">=</span> ClassLoader.getSystemClassLoader();<br>        System.out.println(systemClassLoader); <span class="hljs-comment">//sun.misc.Launcher$AppClassLoader@18b4aac2</span><br><br>        <span class="hljs-comment">//è·å–å…¶ä¸Šå±‚ï¼šæ‰©å±•ç±»åŠ è½½å™¨</span><br>        <span class="hljs-type">ClassLoader</span> <span class="hljs-variable">extClassLoader</span> <span class="hljs-operator">=</span> systemClassLoader.getParent();<br>        System.out.println(extClassLoader);<span class="hljs-comment">//sun.misc.Launcher$ExtClassLoader@1540e19d</span><br><br>        <span class="hljs-comment">//è·å–å…¶ä¸Šå±‚ï¼šè·å–ä¸åˆ°å¼•å¯¼ç±»åŠ è½½å™¨</span><br>        <span class="hljs-type">ClassLoader</span> <span class="hljs-variable">bootstrapClassLoader</span> <span class="hljs-operator">=</span> extClassLoader.getParent();<br>        System.out.println(bootstrapClassLoader);<span class="hljs-comment">//null</span><br><br>        <span class="hljs-comment">//å¯¹äºç”¨æˆ·è‡ªå®šä¹‰ç±»æ¥è¯´ï¼šé»˜è®¤ä½¿ç”¨ç³»ç»Ÿç±»åŠ è½½å™¨è¿›è¡ŒåŠ è½½</span><br>        <span class="hljs-type">ClassLoader</span> <span class="hljs-variable">classLoader</span> <span class="hljs-operator">=</span> ClassLoaderTest.class.getClassLoader();<br>        System.out.println(classLoader);<span class="hljs-comment">//sun.misc.Launcher$AppClassLoader@18b4aac2</span><br><br>        <span class="hljs-comment">//Stringç±»ä½¿ç”¨å¼•å¯¼ç±»åŠ è½½å™¨è¿›è¡ŒåŠ è½½çš„ã€‚---&gt; Javaçš„æ ¸å¿ƒç±»åº“éƒ½æ˜¯ä½¿ç”¨å¼•å¯¼ç±»åŠ è½½å™¨è¿›è¡ŒåŠ è½½çš„ã€‚</span><br>        <span class="hljs-type">ClassLoader</span> <span class="hljs-variable">classLoader1</span> <span class="hljs-operator">=</span> String.class.getClassLoader();<br>        System.out.println(classLoader1);<span class="hljs-comment">//null</span><br><br><br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><ul><li>æˆ‘ä»¬å°è¯•è·å–å¼•å¯¼ç±»åŠ è½½å™¨ï¼Œè·å–åˆ°çš„å€¼ä¸º null ï¼Œè¿™å¹¶ä¸ä»£è¡¨å¼•å¯¼ç±»åŠ è½½å™¨ä¸å­˜åœ¨ï¼Œ<strong>å› ä¸ºå¼•å¯¼ç±»åŠ è½½å™¨å³ C/C++ è¯­è¨€ï¼Œæˆ‘ä»¬è·å–ä¸åˆ°</strong></li><li>ä¸¤æ¬¡è·å–ç³»ç»Ÿç±»åŠ è½½å™¨çš„å€¼éƒ½ç›¸åŒï¼šsun.misc.Launcher$AppClassLoader@18b4aac2 ï¼Œè¿™è¯´æ˜<strong>ç³»ç»Ÿç±»åŠ è½½å™¨æ˜¯å…¨å±€å”¯ä¸€çš„</strong></li></ul><h4 id="2ã€è™šæ‹Ÿæœºè‡ªå¸¦çš„åŠ è½½å™¨">2ã€è™šæ‹Ÿæœºè‡ªå¸¦çš„åŠ è½½å™¨</h4><h5 id="1ã€å¯åŠ¨ç±»åŠ è½½å™¨">1ã€å¯åŠ¨ç±»åŠ è½½å™¨</h5><p>å¯åŠ¨ç±»åŠ è½½å™¨ï¼ˆå¼•å¯¼ç±»åŠ è½½å™¨ï¼ŒBootstrap ClassLoaderï¼‰</p><ol><li>è¿™ä¸ªç±»åŠ è½½ä½¿ç”¨<code>C/C++</code>è¯­è¨€å®ç°çš„ï¼ŒåµŒå¥—åœ¨JVMå†…éƒ¨</li><li>å®ƒç”¨æ¥åŠ è½½Javaçš„æ ¸å¿ƒåº“<code>ï¼ˆJAVA_HOME/jre/lib/rt.jarã€resources.jaræˆ–sun.boot.class.pathè·¯å¾„ä¸‹çš„å†…å®¹ï¼‰</code>ï¼Œç”¨äºæä¾›JVMè‡ªèº«éœ€è¦çš„ç±»</li><li>å¹¶ä¸ç»§æ‰¿è‡ªjava.lang.ClassLoaderï¼Œæ²¡æœ‰çˆ¶åŠ è½½å™¨</li><li>åŠ è½½æ‰©å±•ç±»å’Œåº”ç”¨ç¨‹åºç±»åŠ è½½å™¨ï¼Œå¹¶ä½œä¸ºä»–ä»¬çš„çˆ¶ç±»åŠ è½½å™¨</li><li>å‡ºäºå®‰å…¨è€ƒè™‘ï¼ŒBootstrapå¯åŠ¨ç±»åŠ è½½å™¨åªåŠ è½½åŒ…åä¸º<code>javaã€javaxã€sun</code>ç­‰å¼€å¤´çš„ç±»</li></ol><h5 id="2ã€æ‰©å±•ç±»åŠ è½½å™¨">2ã€æ‰©å±•ç±»åŠ è½½å™¨</h5><p>æ‰©å±•ç±»åŠ è½½å™¨ï¼ˆExtension ClassLoaderï¼‰</p><ol><li><code>Javaè¯­è¨€ç¼–å†™</code>ï¼Œç”±sun.misc.Launcher$ExtClassLoaderå®ç°</li><li>æ´¾ç”ŸäºClassLoaderç±»</li><li>çˆ¶ç±»åŠ è½½å™¨ä¸º<code>å¯åŠ¨ç±»åŠ è½½å™¨</code></li><li>ä»java.ext.dirsç³»ç»Ÿå±æ€§æ‰€æŒ‡å®šçš„ç›®å½•ä¸­åŠ è½½ç±»åº“ï¼Œæˆ–ä»JDKçš„å®‰è£…ç›®å½•çš„jre/lib/extå­ç›®å½•ï¼ˆæ‰©å±•ç›®å½•ï¼‰ä¸‹åŠ è½½ç±»åº“ã€‚å¦‚æœç”¨æˆ·åˆ›å»ºçš„JARæ”¾åœ¨æ­¤ç›®å½•ä¸‹ï¼Œä¹Ÿä¼šè‡ªåŠ¨ç”±æ‰©å±•ç±»åŠ è½½å™¨åŠ è½½</li></ol><h5 id="3ã€ç³»ç»Ÿç±»åŠ è½½å™¨">3ã€ç³»ç»Ÿç±»åŠ è½½å™¨</h5><p>åº”ç”¨ç¨‹åºç±»åŠ è½½å™¨ï¼ˆä¹Ÿç§°ä¸ºç³»ç»Ÿç±»åŠ è½½å™¨ï¼ŒAppClassLoaderï¼‰</p><ol><li>Javaè¯­è¨€ç¼–å†™ï¼Œç”±sun.misc.LaunchersAppClassLoaderå®ç°</li><li>æ´¾ç”ŸäºClassLoaderç±»</li><li>çˆ¶ç±»åŠ è½½å™¨ä¸º<code>æ‰©å±•ç±»åŠ è½½å™¨</code></li><li>å®ƒè´Ÿè´£åŠ è½½ç¯å¢ƒå˜é‡classpathæˆ–ç³»ç»Ÿå±æ€§java.class.pathæŒ‡å®šè·¯å¾„ä¸‹çš„ç±»åº“</li><li>è¯¥ç±»åŠ è½½æ˜¯ç¨‹åºä¸­é»˜è®¤çš„ç±»åŠ è½½å™¨ï¼Œä¸€èˆ¬æ¥è¯´ï¼ŒJavaåº”ç”¨çš„ç±»éƒ½æ˜¯ç”±å®ƒæ¥å®ŒæˆåŠ è½½</li><li>é€šè¿‡classLoader.getSystemclassLoader()æ–¹æ³•å¯ä»¥è·å–åˆ°è¯¥ç±»åŠ è½½å™¨</li></ol><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">ClassLoaderTest1</span> &#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span> &#123;<br>        System.out.println(<span class="hljs-string">&quot;**********å¯åŠ¨ç±»åŠ è½½å™¨**************&quot;</span>);<br>        <span class="hljs-comment">//è·å–BootstrapClassLoaderèƒ½å¤ŸåŠ è½½çš„apiçš„è·¯å¾„</span><br>        URL[] urLs = sun.misc.Launcher.getBootstrapClassPath().getURLs();<br>        <span class="hljs-keyword">for</span> (URL element : urLs) &#123;<br>            System.out.println(element.toExternalForm());<br>        &#125;<br>        <span class="hljs-comment">//ä»ä¸Šé¢çš„è·¯å¾„ä¸­éšæ„é€‰æ‹©ä¸€ä¸ªç±»,æ¥çœ‹çœ‹ä»–çš„ç±»åŠ è½½å™¨æ˜¯ä»€ä¹ˆ:å¼•å¯¼ç±»åŠ è½½å™¨</span><br>        <span class="hljs-type">ClassLoader</span> <span class="hljs-variable">classLoader</span> <span class="hljs-operator">=</span> Provider.class.getClassLoader();<br>        System.out.println(classLoader);<br><br>        System.out.println(<span class="hljs-string">&quot;***********æ‰©å±•ç±»åŠ è½½å™¨*************&quot;</span>);<br>        <span class="hljs-type">String</span> <span class="hljs-variable">extDirs</span> <span class="hljs-operator">=</span> System.getProperty(<span class="hljs-string">&quot;java.ext.dirs&quot;</span>);<br>        <span class="hljs-keyword">for</span> (String path : extDirs.split(<span class="hljs-string">&quot;;&quot;</span>)) &#123;<br>            System.out.println(path);<br>        &#125;<br><br>        <span class="hljs-comment">//ä»ä¸Šé¢çš„è·¯å¾„ä¸­éšæ„é€‰æ‹©ä¸€ä¸ªç±»,æ¥çœ‹çœ‹ä»–çš„ç±»åŠ è½½å™¨æ˜¯ä»€ä¹ˆ:æ‰©å±•ç±»åŠ è½½å™¨</span><br>        <span class="hljs-type">ClassLoader</span> <span class="hljs-variable">classLoader1</span> <span class="hljs-operator">=</span> CurveDB.class.getClassLoader();<br>        System.out.println(classLoader1);<span class="hljs-comment">//sun.misc.Launcher$ExtClassLoader@1540e19d</span><br><br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>ç»“æœï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs java">**********å¯åŠ¨ç±»åŠ è½½å™¨**************<br>file:/C:/Program%20Files/Java/jdk1<span class="hljs-number">.8</span><span class="hljs-number">.0_131</span>/jre/lib/resources.jar<br>file:/C:/Program%20Files/Java/jdk1<span class="hljs-number">.8</span><span class="hljs-number">.0_131</span>/jre/lib/rt.jar<br>file:/C:/Program%20Files/Java/jdk1<span class="hljs-number">.8</span><span class="hljs-number">.0_131</span>/jre/lib/sunrsasign.jar<br>file:/C:/Program%20Files/Java/jdk1<span class="hljs-number">.8</span><span class="hljs-number">.0_131</span>/jre/lib/jsse.jar<br>file:/C:/Program%20Files/Java/jdk1<span class="hljs-number">.8</span><span class="hljs-number">.0_131</span>/jre/lib/jce.jar<br>file:/C:/Program%20Files/Java/jdk1<span class="hljs-number">.8</span><span class="hljs-number">.0_131</span>/jre/lib/charsets.jar<br>file:/C:/Program%20Files/Java/jdk1<span class="hljs-number">.8</span><span class="hljs-number">.0_131</span>/jre/lib/jfr.jar<br>file:/C:/Program%20Files/Java/jdk1<span class="hljs-number">.8</span><span class="hljs-number">.0_131</span>/jre/classes<br><span class="hljs-literal">null</span><br>***********æ‰©å±•ç±»åŠ è½½å™¨*************<br>C:\Program Files\Java\jdk1<span class="hljs-number">.8</span><span class="hljs-number">.0_131</span>\jre\lib\ext<br>C:\Windows\Sun\Java\lib\ext<br>sun.misc.Launcher$ExtClassLoader@29453f44<br></code></pre></td></tr></table></figure><h4 id="3ã€ç”¨æˆ·è‡ªå®šä¹‰ç±»åŠ è½½å™¨">3ã€ç”¨æˆ·è‡ªå®šä¹‰ç±»åŠ è½½å™¨</h4><h5 id="1ã€ä½•æ—¶éœ€è¦è‡ªå®šä¹‰ç±»åŠ è½½å™¨ï¼Ÿ">1ã€ä½•æ—¶éœ€è¦è‡ªå®šä¹‰ç±»åŠ è½½å™¨ï¼Ÿ</h5><p>åœ¨Javaçš„æ—¥å¸¸åº”ç”¨ç¨‹åºå¼€å‘ä¸­ï¼Œç±»çš„åŠ è½½å‡ ä¹æ˜¯ç”±ä¸Šè¿°3ç§ç±»åŠ è½½å™¨ç›¸äº’é…åˆæ‰§è¡Œçš„ï¼Œåœ¨å¿…è¦æ—¶ï¼Œæˆ‘ä»¬è¿˜å¯ä»¥è‡ªå®šä¹‰ç±»åŠ è½½å™¨ï¼Œæ¥å®šåˆ¶ç±»çš„åŠ è½½æ–¹å¼ã€‚é‚£ä¸ºä»€ä¹ˆè¿˜éœ€è¦è‡ªå®šä¹‰ç±»åŠ è½½å™¨ï¼Ÿ</p><ul><li>éš”ç¦»åŠ è½½ç±»ï¼ˆæ¯”å¦‚è¯´æˆ‘å‡è®¾ç°åœ¨Springæ¡†æ¶ï¼Œå’ŒRocketMQæœ‰åŒ…åè·¯å¾„å®Œå…¨ä¸€æ ·çš„ç±»ï¼Œç±»åä¹Ÿä¸€æ ·ï¼Œè¿™ä¸ªæ—¶å€™ç±»å°±å†²çªäº†ã€‚ä¸è¿‡ä¸€èˆ¬çš„ä¸»æµæ¡†æ¶å’Œä¸­é—´ä»¶éƒ½ä¼šè‡ªå®šä¹‰ç±»åŠ è½½å™¨ï¼Œå®ç°ä¸åŒçš„æ¡†æ¶ï¼Œä¸­é—´ä»·ä¹‹é—´æ˜¯éš”ç¦»çš„ï¼‰</li><li>ä¿®æ”¹ç±»åŠ è½½çš„æ–¹å¼</li><li>æ‰©å±•åŠ è½½æºï¼ˆè¿˜å¯ä»¥è€ƒè™‘ä»æ•°æ®åº“ä¸­åŠ è½½ç±»ï¼Œè·¯ç”±å™¨ç­‰ç­‰ä¸åŒçš„åœ°æ–¹ï¼‰</li><li>é˜²æ­¢æºç æ³„æ¼ï¼ˆå¯¹å­—èŠ‚ç æ–‡ä»¶è¿›è¡Œè§£å¯†ï¼Œè‡ªå·±ç”¨çš„æ—¶å€™é€šè¿‡è‡ªå®šä¹‰ç±»åŠ è½½å™¨æ¥å¯¹å…¶è¿›è¡Œè§£å¯†ï¼‰</li></ul><h5 id="2ã€å¦‚ä½•è‡ªå®šä¹‰ç±»åŠ è½½å™¨ï¼Ÿ">2ã€å¦‚ä½•è‡ªå®šä¹‰ç±»åŠ è½½å™¨ï¼Ÿ</h5><ol><li>å¼€å‘äººå‘˜å¯ä»¥é€šè¿‡ç»§æ‰¿æŠ½è±¡ç±»java.lang.ClassLoaderç±»çš„æ–¹å¼ï¼Œå®ç°è‡ªå·±çš„ç±»åŠ è½½å™¨ï¼Œä»¥æ»¡è¶³ä¸€äº›ç‰¹æ®Šçš„éœ€æ±‚</li><li>åœ¨JDK1.2ä¹‹å‰ï¼Œåœ¨è‡ªå®šä¹‰ç±»åŠ è½½å™¨æ—¶ï¼Œæ€»ä¼šå»ç»§æ‰¿ClassLoaderç±»å¹¶é‡å†™loadClass()æ–¹æ³•ï¼Œä»è€Œå®ç°è‡ªå®šä¹‰çš„ç±»åŠ è½½ç±»ï¼Œä½†æ˜¯åœ¨JDK1.2ä¹‹åå·²ä¸å†å»ºè®®ç”¨æˆ·å»è¦†ç›–loadClass()æ–¹æ³•ï¼Œè€Œæ˜¯å»ºè®®æŠŠè‡ªå®šä¹‰çš„ç±»åŠ è½½é€»è¾‘å†™åœ¨findclass()æ–¹æ³•ä¸­</li><li>åœ¨ç¼–å†™è‡ªå®šä¹‰ç±»åŠ è½½å™¨æ—¶ï¼Œå¦‚æœæ²¡æœ‰å¤ªè¿‡äºå¤æ‚çš„éœ€æ±‚ï¼Œå¯ä»¥<code>ç›´æ¥ç»§æ‰¿URIClassLoaderç±»</code>ï¼Œè¿™æ ·å°±å¯ä»¥é¿å…è‡ªå·±å»ç¼–å†™findclass()æ–¹æ³•åŠå…¶è·å–å­—èŠ‚ç æµçš„æ–¹å¼ï¼Œä½¿è‡ªå®šä¹‰ç±»åŠ è½½å™¨ç¼–å†™æ›´åŠ ç®€æ´ã€‚</li></ol><p>ä»£ç ç¤ºä¾‹ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">CustomClassLoader</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_">ClassLoader</span> &#123;<br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-keyword">protected</span> Class&lt;?&gt; findClass(String name) <span class="hljs-keyword">throws</span> ClassNotFoundException &#123;<br><br>        <span class="hljs-keyword">try</span> &#123;<br>            <span class="hljs-type">byte</span>[] result = getClassFromCustomPath(name);<br>            <span class="hljs-keyword">if</span> (result == <span class="hljs-literal">null</span>) &#123;<br>                <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">FileNotFoundException</span>();<br>            &#125; <span class="hljs-keyword">else</span> &#123;<br>                <span class="hljs-comment">//defineClasså’ŒfindClassæ­é…ä½¿ç”¨</span><br>                <span class="hljs-keyword">return</span> defineClass(name, result, <span class="hljs-number">0</span>, result.length);<br>            &#125;<br>        &#125; <span class="hljs-keyword">catch</span> (FileNotFoundException e) &#123;<br>            e.printStackTrace();<br>        &#125;<br><br>        <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">ClassNotFoundException</span>(name);<br>    &#125;<br><span class="hljs-comment">//è‡ªå®šä¹‰æµçš„è·å–æ–¹å¼</span><br>    <span class="hljs-keyword">private</span> <span class="hljs-type">byte</span>[] getClassFromCustomPath(String name) &#123;<br>        <span class="hljs-comment">//ä»è‡ªå®šä¹‰è·¯å¾„ä¸­åŠ è½½æŒ‡å®šç±»:ç»†èŠ‚ç•¥</span><br>        <span class="hljs-comment">//å¦‚æœæŒ‡å®šè·¯å¾„çš„å­—èŠ‚ç æ–‡ä»¶è¿›è¡Œäº†åŠ å¯†ï¼Œåˆ™éœ€è¦åœ¨æ­¤æ–¹æ³•ä¸­è¿›è¡Œè§£å¯†æ“ä½œã€‚</span><br>        <span class="hljs-keyword">return</span> <span class="hljs-literal">null</span>;<br>    &#125;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span> &#123;<br>        <span class="hljs-type">CustomClassLoader</span> <span class="hljs-variable">customClassLoader</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">CustomClassLoader</span>();<br>        <span class="hljs-keyword">try</span> &#123;<br>            Class&lt;?&gt; clazz = Class.forName(<span class="hljs-string">&quot;One&quot;</span>, <span class="hljs-literal">true</span>, customClassLoader);<br>            <span class="hljs-type">Object</span> <span class="hljs-variable">obj</span> <span class="hljs-operator">=</span> clazz.newInstance();<br>            System.out.println(obj.getClass().getClassLoader());<br>        &#125; <span class="hljs-keyword">catch</span> (Exception e) &#123;<br>            e.printStackTrace();<br>        &#125;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><h4 id="4ã€ClassLoader">4ã€ClassLoader</h4><p>ClassLoaderç±»ï¼Œå®ƒæ˜¯ä¸€ä¸ªæŠ½è±¡ç±»ï¼Œå…¶åæ‰€æœ‰çš„ç±»åŠ è½½å™¨éƒ½ç»§æ‰¿è‡ªClassLoaderï¼ˆä¸åŒ…æ‹¬å¯åŠ¨ç±»åŠ è½½å™¨ï¼‰</p><p><img src="/2022/10/24/jvm-02-lei-jia-zai-zi-xi-tong/image-20221025162137614.png" alt></p><p>sun.misc.Launcher å®ƒæ˜¯ä¸€ä¸ªjavaè™šæ‹Ÿæœºçš„å…¥å£åº”ç”¨</p><p><img src="/2022/10/24/jvm-02-lei-jia-zai-zi-xi-tong/image-20221025162203691.png" alt></p><blockquote><p>è·å–ClassLoaderé€”å¾„</p></blockquote><p><img src="/2022/10/24/jvm-02-lei-jia-zai-zi-xi-tong/image-20221025162252275.png" alt></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">ClassLoaderTest2</span> &#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span> &#123;<br>        <span class="hljs-keyword">try</span> &#123;<br>            <span class="hljs-comment">//1.</span><br>            <span class="hljs-type">ClassLoader</span> <span class="hljs-variable">classLoader</span> <span class="hljs-operator">=</span> Class.forName(<span class="hljs-string">&quot;java.lang.String&quot;</span>).getClassLoader();<br>            System.out.println(classLoader);<br>            <span class="hljs-comment">//2.</span><br>            <span class="hljs-type">ClassLoader</span> <span class="hljs-variable">classLoader1</span> <span class="hljs-operator">=</span> Thread.currentThread().getContextClassLoader();<br>            System.out.println(classLoader1);<br><br>            <span class="hljs-comment">//3.</span><br>            <span class="hljs-type">ClassLoader</span> <span class="hljs-variable">classLoader2</span> <span class="hljs-operator">=</span> ClassLoader.getSystemClassLoader().getParent();<br>            System.out.println(classLoader2);<br><br>        &#125; <span class="hljs-keyword">catch</span> (ClassNotFoundException e) &#123;<br>            e.printStackTrace();<br>        &#125;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>ç»“æœå¦‚ä¸‹ï¼š</p><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs awk">null<br>sun.misc.Launcher<span class="hljs-variable">$AppClassLoader</span>@<span class="hljs-number">18</span>b4aac2<br>sun.misc.Launcher<span class="hljs-variable">$ExtClassLoader</span>@<span class="hljs-number">1540</span>e19d<br><br>Process finished with <span class="hljs-keyword">exit</span> code <span class="hljs-number">0</span><br></code></pre></td></tr></table></figure><h3 id="5ã€ğŸ”ºåŒäº²å§”æ´¾æœºåˆ¶">5ã€ğŸ”ºåŒäº²å§”æ´¾æœºåˆ¶</h3><h4 id="1ã€åŒäº²å§”æ´¾æœºåˆ¶åŸç†">1ã€åŒäº²å§”æ´¾æœºåˆ¶åŸç†</h4><p>Javaè™šæ‹Ÿæœºå¯¹classæ–‡ä»¶é‡‡ç”¨çš„æ˜¯<strong>æŒ‰éœ€åŠ è½½</strong>çš„æ–¹å¼ï¼Œä¹Ÿå°±æ˜¯è¯´å½“éœ€è¦ä½¿ç”¨è¯¥ç±»æ—¶æ‰ä¼šå°†å®ƒçš„classæ–‡ä»¶åŠ è½½åˆ°å†…å­˜ç”Ÿæˆclasså¯¹è±¡ã€‚è€Œä¸”åŠ è½½æŸä¸ªç±»çš„classæ–‡ä»¶æ—¶ï¼ŒJavaè™šæ‹Ÿæœºé‡‡ç”¨çš„æ˜¯åŒäº²å§”æ´¾æ¨¡å¼ï¼Œå³æŠŠè¯·æ±‚äº¤ç”±çˆ¶ç±»å¤„ç†ï¼Œå®ƒæ˜¯ä¸€ç§ä»»åŠ¡å§”æ´¾æ¨¡å¼</p><ol><li>å¦‚æœä¸€ä¸ªç±»åŠ è½½å™¨æ”¶åˆ°äº†ç±»åŠ è½½è¯·æ±‚ï¼Œå®ƒå¹¶ä¸ä¼šè‡ªå·±å…ˆå»åŠ è½½ï¼Œè€Œæ˜¯æŠŠè¿™ä¸ªè¯·æ±‚å§”æ‰˜ç»™çˆ¶ç±»çš„åŠ è½½å™¨å»æ‰§è¡Œï¼›</li><li>å¦‚æœçˆ¶ç±»åŠ è½½å™¨è¿˜å­˜åœ¨å…¶çˆ¶ç±»åŠ è½½å™¨ï¼Œåˆ™è¿›ä¸€æ­¥å‘ä¸Šå§”æ‰˜ï¼Œä¾æ¬¡é€’å½’ï¼Œè¯·æ±‚æœ€ç»ˆå°†åˆ°è¾¾é¡¶å±‚çš„å¯åŠ¨ç±»åŠ è½½å™¨ï¼›</li><li>å¦‚æœçˆ¶ç±»åŠ è½½å™¨å¯ä»¥å®Œæˆç±»åŠ è½½ä»»åŠ¡ï¼Œå°±æˆåŠŸè¿”å›ï¼Œå€˜è‹¥çˆ¶ç±»åŠ è½½å™¨æ— æ³•å®Œæˆæ­¤åŠ è½½ä»»åŠ¡ï¼Œå­åŠ è½½å™¨æ‰ä¼šå°è¯•è‡ªå·±å»åŠ è½½ï¼Œè¿™å°±æ˜¯åŒäº²å§”æ´¾æ¨¡å¼ã€‚</li><li>çˆ¶ç±»åŠ è½½å™¨ä¸€å±‚ä¸€å±‚å¾€ä¸‹åˆ†é…ä»»åŠ¡ï¼Œå¦‚æœå­ç±»åŠ è½½å™¨èƒ½åŠ è½½ï¼Œåˆ™åŠ è½½æ­¤ç±»ï¼Œå¦‚æœå°†åŠ è½½ä»»åŠ¡åˆ†é…è‡³ç³»ç»Ÿç±»åŠ è½½å™¨ä¹Ÿæ— æ³•åŠ è½½æ­¤ç±»ï¼Œåˆ™æŠ›å‡ºå¼‚å¸¸</li></ol><p><img src="/2022/10/24/jvm-02-lei-jia-zai-zi-xi-tong/image-20221025163844593.png" alt></p><blockquote><p>ä¸¾ä¸ªé€šä¿—çš„ä¾‹å­ï¼šå°å­©æœ‰ä¸€ä¸ªè‹¹æœï¼Œé—®å¦ˆå¦ˆè¯´åƒä¸åƒï¼Œå¦ˆå¦ˆä¸€çœ‹å¥¶å¥¶è¿˜åœ¨ï¼Œå°±é—®å¥¶å¥¶åƒä¸åƒè‹¹æœï¼›å¥¶å¥¶ä¸€çœ‹è‹¹æœæœ‰ç‚¹ç¡¬ï¼Œå’¬ä¸åŠ¨äºæ˜¯è¯´ä¸åƒï¼Œç»™äº†å¦ˆå¦ˆï¼Œå¦ˆå¦ˆä¸€çœ‹è¯´è‹¹æœæœ‰ç‚¹é…¸ï¼Œåˆç»™äº†å°å­©ï¼Œå°å­©è¯´æˆ‘æ­£å¥½å–œæ¬¢åƒåˆé…¸åˆç¡¬çš„ï¼Œäºæ˜¯å°å­©åƒäº†ã€‚</p></blockquote><p>æœ‰ç‚¹åƒ èŒè´£é“¾æ¨¡å¼</p><h4 id="2ã€åŒäº²å§”æ´¾æœºåˆ¶ä»£ç æ¼”ç¤º">2ã€åŒäº²å§”æ´¾æœºåˆ¶ä»£ç æ¼”ç¤º</h4><h5 id="1ã€Demo1">1ã€Demo1</h5><p>1ã€è‡ªå·±å»ºç«‹ä¸€ä¸ª java.lang.String ç±»ï¼Œå†™ä¸Š static ä»£ç å—</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">String</span> &#123;<br>    <span class="hljs-comment">//</span><br>    <span class="hljs-keyword">static</span>&#123;<br>        System.out.println(<span class="hljs-string">&quot;æˆ‘æ˜¯è‡ªå®šä¹‰çš„Stringç±»çš„é™æ€ä»£ç å—&quot;</span>);<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>2ã€åœ¨å¦å¤–çš„ç¨‹åºä¸­åŠ è½½ String ç±»ï¼Œçœ‹çœ‹åŠ è½½çš„ String ç±»æ˜¯ JDK è‡ªå¸¦çš„ String ç±»ï¼Œè¿˜æ˜¯æˆ‘ä»¬è‡ªå·±ç¼–å†™çš„ String ç±»</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">StringTest</span> &#123;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span> &#123;<br>        java.lang.<span class="hljs-type">String</span> <span class="hljs-variable">str</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">java</span>.lang.String();<br>        System.out.println(<span class="hljs-string">&quot;hello,atguigu.com&quot;</span>);<br><br>        <span class="hljs-type">StringTest</span> <span class="hljs-variable">test</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">StringTest</span>();<br>        System.out.println(test.getClass().getClassLoader());<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>ç»“æœï¼š</p><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs stylus">hello,atguigu<span class="hljs-selector-class">.com</span><br>sun<span class="hljs-selector-class">.misc</span>.Launcher<span class="hljs-variable">$AppClassLoader</span>@<span class="hljs-number">18</span>b4aac2<br></code></pre></td></tr></table></figure><p>ç¨‹åºå¹¶æ²¡æœ‰è¾“å‡ºæˆ‘ä»¬é™æ€ä»£ç å—ä¸­çš„å†…å®¹ï¼Œè¯´æ˜ä»ç„¶åŠ è½½çš„æ˜¯ JDK è‡ªå¸¦çš„ String ç±»ã€‚</p><p>æŠŠåˆšåˆšçš„ç±»æ”¹ä¸€ä¸‹</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">package</span> java.lang;<br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">String</span> &#123;<br>    <span class="hljs-comment">//</span><br>    <span class="hljs-keyword">static</span>&#123;<br>        System.out.println(<span class="hljs-string">&quot;æˆ‘æ˜¯è‡ªå®šä¹‰çš„Stringç±»çš„é™æ€ä»£ç å—&quot;</span>);<br>    &#125;<br>    <span class="hljs-comment">//é”™è¯¯: åœ¨ç±» java.lang.String ä¸­æ‰¾ä¸åˆ° main æ–¹æ³•</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span> &#123;<br>        System.out.println(<span class="hljs-string">&quot;hello,String&quot;</span>);<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p><img src="/2022/10/24/jvm-02-lei-jia-zai-zi-xi-tong/image-20221025164730203.png" alt></p><p>ç”±äºåŒäº²å§”æ´¾æœºåˆ¶ä¸€ç›´æ‰¾çˆ¶ç±»ï¼Œæ‰€ä»¥æœ€åæ‰¾åˆ°äº†Bootstrap ClassLoaderï¼ŒBootstrap ClassLoaderæ‰¾åˆ°çš„æ˜¯ JDK è‡ªå¸¦çš„ String ç±»ï¼Œåœ¨é‚£ä¸ªStringç±»ä¸­å¹¶æ²¡æœ‰ main() æ–¹æ³•ï¼Œæ‰€ä»¥å°±æŠ¥äº†ä¸Šé¢çš„é”™è¯¯ã€‚</p><h5 id="2ã€Demo2">2ã€Demo2</h5><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">package</span> java.lang;<br><br><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">ShkStart</span> &#123;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span> &#123;<br>        System.out.println(<span class="hljs-string">&quot;hello!&quot;</span>);<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>ç»“æœï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs java">java.lang.SecurityException: Prohibited <span class="hljs-keyword">package</span> name: java.lang<br>at java.lang.ClassLoader.preDefineClass(ClassLoader.java:<span class="hljs-number">662</span>)<br>at java.lang.ClassLoader.defineClass(ClassLoader.java:<span class="hljs-number">761</span>)<br>at java.security.SecureClassLoader.defineClass(SecureClassLoader.java:<span class="hljs-number">142</span>)<br>at java.net.URLClassLoader.defineClass(URLClassLoader.java:<span class="hljs-number">467</span>)<br>at java.net.URLClassLoader.access$<span class="hljs-number">100</span>(URLClassLoader.java:<span class="hljs-number">73</span>)<br>at java.net.URLClassLoader$<span class="hljs-number">1.</span>run(URLClassLoader.java:<span class="hljs-number">368</span>)<br>at java.net.URLClassLoader$<span class="hljs-number">1.</span>run(URLClassLoader.java:<span class="hljs-number">362</span>)<br>at java.security.AccessController.doPrivileged(Native Method)<br>at java.net.URLClassLoader.findClass(URLClassLoader.java:<span class="hljs-number">361</span>)<br>at java.lang.ClassLoader.loadClass(ClassLoader.java:<span class="hljs-number">424</span>)<br>at sun.misc.Launcher$AppClassLoader.loadClass(Launcher.java:<span class="hljs-number">335</span>)<br>at java.lang.ClassLoader.loadClass(ClassLoader.java:<span class="hljs-number">357</span>)<br>at sun.launcher.LauncherHelper.checkAndLoadMain(LauncherHelper.java:<span class="hljs-number">495</span>)<br>Error: A JNI error has occurred, please check your installation and <span class="hljs-keyword">try</span> again<br>Exception in thread <span class="hljs-string">&quot;main&quot;</span> <br>Process finished with exit code <span class="hljs-number">1</span><br></code></pre></td></tr></table></figure><p>å³ä½¿ç±»åæ²¡æœ‰é‡å¤ï¼Œä¹Ÿç¦æ­¢ä½¿ç”¨java.langè¿™ç§åŒ…åã€‚è¿™æ˜¯ä¸€ç§ä¿æŠ¤æœºåˆ¶</p><h5 id="3ã€Demo3">3ã€Demo3</h5><p>å½“æˆ‘ä»¬åŠ è½½jdbc.jar ç”¨äºå®ç°æ•°æ®åº“è¿æ¥çš„æ—¶å€™</p><ol><li>æˆ‘ä»¬ç°åœ¨ç¨‹åºä¸­éœ€è¦ç”¨åˆ°SPIæ¥å£ï¼Œè€ŒSPIæ¥å£å±äºrt.jaråŒ…ä¸­Javaæ ¸å¿ƒapi</li><li>ç„¶åä½¿ç”¨åŒæ¸…å§”æ´¾æœºåˆ¶ï¼Œå¼•å¯¼ç±»åŠ è½½å™¨æŠŠrt.jaråŒ…åŠ è½½è¿›æ¥ï¼Œè€Œrt.jaråŒ…ä¸­çš„SPIå­˜åœ¨ä¸€äº›æ¥å£ï¼Œæ¥å£æˆ‘ä»¬å°±éœ€è¦å…·ä½“çš„å®ç°ç±»äº†</li><li>å…·ä½“çš„å®ç°ç±»å°±æ¶‰åŠåˆ°äº†æŸäº›ç¬¬ä¸‰æ–¹çš„jaråŒ…äº†ï¼Œæ¯”å¦‚æˆ‘ä»¬åŠ è½½SPIçš„å®ç°ç±»jdbc.jaråŒ…ã€é¦–å…ˆæˆ‘ä»¬éœ€è¦çŸ¥é“çš„æ˜¯ jdbc.jaræ˜¯åŸºäºSPIæ¥å£è¿›è¡Œå®ç°çš„ã€‘</li><li>ç¬¬ä¸‰æ–¹çš„jaråŒ…ä¸­çš„ç±»å±äºç³»ç»Ÿç±»åŠ è½½å™¨æ¥åŠ è½½</li><li>ä»è¿™é‡Œé¢å°±å¯ä»¥çœ‹åˆ°SPIæ ¸å¿ƒæ¥å£ç”±å¼•å¯¼ç±»åŠ è½½å™¨æ¥åŠ è½½ï¼ŒSPIå…·ä½“å®ç°ç±»ç”±ç³»ç»Ÿç±»åŠ è½½å™¨æ¥åŠ è½½</li></ol><p><img src="/2022/10/24/jvm-02-lei-jia-zai-zi-xi-tong/image-20221025164859134.png" alt></p><h4 id="3ã€åŒäº²å§”æ´¾æœºåˆ¶çš„ä¼˜åŠ¿">3ã€åŒäº²å§”æ´¾æœºåˆ¶çš„ä¼˜åŠ¿</h4><ol><li>é¿å…ç±»çš„é‡å¤åŠ è½½</li><li>ä¿æŠ¤ç¨‹åºå®‰å…¨ï¼Œé˜²æ­¢æ ¸å¿ƒAPIè¢«éšæ„ç¯¡æ”¹<ul><li>è‡ªå®šä¹‰ç±»ï¼šè‡ªå®šä¹‰java.lang.String æ²¡æœ‰è¢«åŠ è½½ã€‚</li><li>è‡ªå®šä¹‰ç±»ï¼šjava.lang.ShkStartï¼ˆæŠ¥é”™ï¼šé˜»æ­¢åˆ›å»º java.langå¼€å¤´çš„ç±»ï¼‰</li></ul></li></ol><h3 id="6ã€æ²™ç®±å®‰å…¨æœºåˆ¶">6ã€æ²™ç®±å®‰å…¨æœºåˆ¶</h3><p>è‡ªå®šä¹‰Stringç±»æ—¶ï¼šåœ¨åŠ è½½è‡ªå®šä¹‰Stringç±»çš„æ—¶å€™ä¼šç‡å…ˆä½¿ç”¨å¼•å¯¼ç±»åŠ è½½å™¨åŠ è½½ï¼Œè€Œå¼•å¯¼ç±»åŠ è½½å™¨åœ¨åŠ è½½çš„è¿‡ç¨‹ä¸­ä¼šå…ˆåŠ è½½jdkè‡ªå¸¦çš„æ–‡ä»¶ï¼ˆrt.jaråŒ…ä¸­java.lang.String.classï¼‰ï¼ŒæŠ¥é”™ä¿¡æ¯è¯´æ²¡æœ‰mainæ–¹æ³•ï¼Œå°±æ˜¯å› ä¸ºåŠ è½½çš„æ˜¯rt.jaråŒ…ä¸­çš„Stringç±»ã€‚è¿™æ ·å¯ä»¥ä¿è¯å¯¹javaæ ¸å¿ƒæºä»£ç çš„ä¿æŠ¤ï¼Œè¿™å°±æ˜¯æ²™ç®±å®‰å…¨æœºåˆ¶ã€‚</p><p>ç®€å•æ¥è¯´ï¼Œå°±æ˜¯ä¿è¯å¼•å¯¼ç±»åŠ è½½å™¨è´Ÿè´£åŠ è½½çš„æ ¸å¿ƒåŒ…ä¸ä¼šè¢«æ¶æ„ç¯¡æ”¹</p><h3 id="7ã€å¦‚ä½•åˆ¤æ–­ä¸¤ä¸ªclasså¯¹è±¡æ˜¯å¦ç›¸åŒï¼Ÿ">7ã€å¦‚ä½•åˆ¤æ–­ä¸¤ä¸ªclasså¯¹è±¡æ˜¯å¦ç›¸åŒï¼Ÿ</h3><p>åœ¨JVMä¸­è¡¨ç¤ºä¸¤ä¸ªclasså¯¹è±¡æ˜¯å¦ä¸ºåŒä¸€ä¸ªç±»å­˜åœ¨ä¸¤ä¸ªå¿…è¦æ¡ä»¶ï¼š</p><ol><li>ç±»çš„å®Œæ•´ç±»åå¿…é¡»ä¸€è‡´ï¼ŒåŒ…æ‹¬åŒ…å</li><li><strong>åŠ è½½è¿™ä¸ªç±»çš„ClassLoaderï¼ˆæŒ‡ClassLoaderå®ä¾‹å¯¹è±¡ï¼‰å¿…é¡»ç›¸åŒ</strong></li></ol><p>æ¢å¥è¯è¯´ï¼Œåœ¨JVMä¸­ï¼Œå³ä½¿è¿™ä¸¤ä¸ªç±»å¯¹è±¡ï¼ˆclasså¯¹è±¡ï¼‰æ¥æºåŒä¸€ä¸ªClassæ–‡ä»¶ï¼Œè¢«åŒä¸€ä¸ªè™šæ‹Ÿæœºæ‰€åŠ è½½ï¼Œä½†åªè¦<code>åŠ è½½å®ƒä»¬çš„ClassLoaderå®ä¾‹å¯¹è±¡ä¸åŒï¼Œé‚£ä¹ˆè¿™ä¸¤ä¸ªç±»å¯¹è±¡ä¹Ÿæ˜¯ä¸ç›¸ç­‰çš„</code></p><h3 id="8ã€å¯¹ç±»åŠ è½½å™¨çš„å¼•ç”¨">8ã€å¯¹ç±»åŠ è½½å™¨çš„å¼•ç”¨</h3><ol><li>JVMå¿…é¡»çŸ¥é“ä¸€ä¸ªç±»å‹æ˜¯ç”±å¯åŠ¨åŠ è½½å™¨åŠ è½½çš„è¿˜æ˜¯ç”±ç”¨æˆ·ç±»åŠ è½½å™¨åŠ è½½çš„</li><li><code>å¦‚æœä¸€ä¸ªç±»å‹æ˜¯ç”±ç”¨æˆ·ç±»åŠ è½½å™¨åŠ è½½çš„ï¼Œé‚£ä¹ˆJVMä¼šå°†è¿™ä¸ªç±»åŠ è½½å™¨çš„ä¸€ä¸ªå¼•ç”¨ä½œä¸ºç±»å‹ä¿¡æ¯çš„ä¸€éƒ¨åˆ†ä¿å­˜åœ¨æ–¹æ³•åŒºä¸­</code></li><li>å½“è§£æä¸€ä¸ªç±»å‹åˆ°å¦ä¸€ä¸ªç±»å‹çš„å¼•ç”¨çš„æ—¶å€™ï¼ŒJVMéœ€è¦ä¿è¯è¿™ä¸¤ä¸ªç±»å‹çš„ç±»åŠ è½½å™¨æ˜¯ç›¸åŒçš„</li></ol>]]></content>
    
    
    <categories>
      
      <category>JVM</category>
      
    </categories>
    
    
    <tags>
      
      <tag>java</tag>
      
      <tag>JVM</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>JVM-01-JVMä¸Javaä½“ç³»ç»“æ„</title>
    <link href="/2022/10/21/jvm-01-jvm-yu-java-ti-xi-jie-gou/"/>
    <url>/2022/10/21/jvm-01-jvm-yu-java-ti-xi-jie-gou/</url>
    
    <content type="html"><![CDATA[<blockquote><p>JVMç³»åˆ—å‚è€ƒäº†<a href="https://www.bilibili.com/video/BV1PJ411n7xZ/?spm_id_from=333.337.search-card.all.click&amp;vd_source=4397d58737f806d687218418438c3de3">å°šç¡…è°·çš„JVMè§†é¢‘æ•™ç¨‹</a>ï¼Œä»¥åŠ<a href="https://imlql.cn/categories/JVM/">é£ç¥çš„æ—¶å…‰å½•çš„ä¸ªäººåšå®¢</a></p></blockquote><p>æ˜¯å¦é‡åˆ°è¿‡è¿™äº›é—®é¢˜ï¼Ÿ</p><ol><li>è¿è¡Œç€çš„çº¿ä¸Šç³»ç»Ÿçªç„¶å¡æ­»ï¼Œç³»ç»Ÿæ— æ³•è®¿é—®ï¼Œç”šè‡³ç›´æ¥OOMï¼</li><li>æƒ³è§£å†³çº¿ä¸ŠJVM GCé—®é¢˜ï¼Œä½†å´æ— ä»ä¸‹æ‰‹ã€‚</li><li>æ–°é¡¹ç›®ä¸Šçº¿ï¼Œå¯¹å„ç§JVMå‚æ•°è®¾ç½®ä¸€è„¸èŒ«ç„¶ï¼Œç›´æ¥é»˜è®¤å§ç„¶åå°±JJäº†ã€‚</li><li>æ¯æ¬¡é¢è¯•ä¹‹å‰éƒ½è¦é‡æ–°èƒŒä¸€éJVMçš„ä¸€äº›åŸç†æ¦‚å¿µæ€§çš„ä¸œè¥¿ï¼Œç„¶è€Œé¢è¯•å®˜å´ç»å¸¸é—®ä½ åœ¨å®é™…é¡¹ç›®ä¸­å¦‚ä½•è°ƒä¼˜VMå‚æ•°ï¼Œå¦‚ä½•è§£å†³GCã€OOMç­‰é—®é¢˜ï¼Œä¸€è„¸æ‡µé€¼ã€‚</li></ol><h2 id="1ã€JavaåŠJVMç®€ä»‹">1ã€JavaåŠJVMç®€ä»‹</h2><p><img src="/2022/10/21/jvm-01-jvm-yu-java-ti-xi-jie-gou/image-20221021162119621.png" alt></p><p>å¦‚æœæˆ‘ä»¬æŠŠæ ¸å¿ƒç±»åº“çš„APIæ¯”åšæ•°å­¦å…¬å¼çš„è¯ï¼Œé‚£ä¹ˆJavaè™šæ‹Ÿæœºçš„çŸ¥è¯†å°±å¥½æ¯”å…¬å¼çš„æ¨å¯¼è¿‡ç¨‹ã€‚</p><p><img src="/2022/10/21/jvm-01-jvm-yu-java-ti-xi-jie-gou/image-20221021162207599.png" alt></p><p>è®¡ç®—æœºç³»ç»Ÿä½“ç³»å¯¹æˆ‘ä»¬æ¥è¯´è¶Šæ¥è¶Šè¿œï¼Œåœ¨ä¸äº†è§£åº•å±‚å®ç°æ–¹å¼çš„å‰æä¸‹ï¼Œé€šè¿‡é«˜çº§è¯­è¨€å¾ˆå®¹æ˜“ç¼–å†™ç¨‹åºä»£ç ã€‚ä½†äº‹å®ä¸Šè®¡ç®—æœºå¹¶ä¸è®¤è¯†é«˜çº§è¯­è¨€ã€‚</p><p>Soï¼Œæ¶æ„å¸ˆæ¯å¤©éƒ½åœ¨æ€è€ƒä»€ä¹ˆï¼Ÿ</p><ol><li>åº”è¯¥å¦‚ä½•è®©æˆ‘çš„ç³»ç»Ÿæ›´å¿«ï¼Ÿ</li><li>å¦‚ä½•é¿å…ç³»ç»Ÿå‡ºç°ç“¶é¢ˆï¼Ÿ</li></ol><h3 id="1ã€æ¨èä¹¦ç›®">1ã€æ¨èä¹¦ç›®</h3><p><strong>å®˜æ–¹æ–‡æ¡£</strong></p><p><strong>è‹±æ–‡æ–‡æ¡£è§„èŒƒ</strong>ï¼š<a href="https://docs.oracle.com/javase/specs/index.html">https://docs.oracle.com/javase/specs/index.html</a></p><p><img src="/2022/10/21/jvm-01-jvm-yu-java-ti-xi-jie-gou/image-20221021162737446.png" alt></p><p><strong>ä¸­æ–‡ä¹¦ç±ï¼š</strong></p><p><img src="/2022/10/21/jvm-01-jvm-yu-java-ti-xi-jie-gou/image-20221021162826232.png" alt></p><p><img src="/2022/10/21/jvm-01-jvm-yu-java-ti-xi-jie-gou/image-20221021162848622.png" alt></p><h3 id="2ã€Java-VS-C">2ã€Java VS C++</h3><ol><li>åƒåœ¾æ”¶é›†æœºåˆ¶ä¸ºæˆ‘ä»¬æ‰“ç†äº†å¾ˆå¤šç¹ççš„å·¥ä½œï¼Œå¤§å¤§æé«˜äº†å¼€å‘çš„æ•ˆç‡ï¼Œä½†æ˜¯ï¼Œåƒåœ¾æ”¶é›†ä¹Ÿä¸æ˜¯ä¸‡èƒ½çš„ï¼Œæ‡‚å¾—JVMå†…éƒ¨çš„å†…å­˜ç»“æ„ã€å·¥ä½œæœºåˆ¶ï¼Œæ˜¯è®¾è®¡é«˜æ‰©å±•æ€§åº”ç”¨å’Œè¯Šæ–­è¿è¡Œæ—¶é—®é¢˜çš„åŸºç¡€ï¼Œä¹Ÿæ˜¯Javaå·¥ç¨‹å¸ˆè¿›é˜¶çš„å¿…å¤‡èƒ½åŠ›ã€‚</li><li>C++è¯­è¨€éœ€è¦ç¨‹åºå‘˜è‡ªå·±æ¥åˆ†é…å†…å­˜å’Œå›æ”¶å†…å­˜ï¼Œå¯¹äºé«˜æ‰‹æ¥è¯´å¯èƒ½æ›´åŠ èˆ’æœï¼Œä½†æ˜¯å¯¹äºæ™®é€šå¼€å‘è€…ï¼Œå¦‚æœæŠ€æœ¯å®åŠ›ä¸å¤Ÿï¼Œå¾ˆå®¹æ˜“é€ æˆå†…å­˜æ³„æ¼ã€‚è€ŒJavaå…¨éƒ¨äº¤ç»™JVMè¿›è¡Œå†…å­˜åˆ†é…å’Œå›æ”¶ï¼Œè¿™ä¹Ÿæ˜¯ä¸€ç§è¶‹åŠ¿ï¼Œå‡å°‘ç¨‹åºå‘˜çš„å·¥ä½œé‡ã€‚</li></ol><p><img src="/2022/10/21/jvm-01-jvm-yu-java-ti-xi-jie-gou/image-20221021162556628.png" alt></p><h3 id="3ã€Javaç”Ÿæ€åœˆ">3ã€Javaç”Ÿæ€åœˆ</h3><p>Javaæ˜¯ç›®å‰åº”ç”¨æœ€ä¸ºå¹¿æ³›çš„è½¯ä»¶å¼€å‘å¹³å°ä¹‹ä¸€ã€‚éšç€Javaä»¥åŠJavaç¤¾åŒºçš„ä¸æ–­å£®å¤§Java ä¹Ÿæ—©å·²ä¸å†æ˜¯ç®€ç®€å•å•çš„ä¸€é—¨è®¡ç®—æœºè¯­è¨€äº†ï¼Œå®ƒæ›´æ˜¯ä¸€ä¸ªå¹³å°ã€ä¸€ç§æ–‡åŒ–ã€ä¸€ä¸ªç¤¾åŒºã€‚</p><ol><li>ä½œä¸ºä¸€ä¸ªå¹³å°ï¼ŒJavaè™šæ‹Ÿæœºæ‰®æ¼”ç€ä¸¾è¶³è½»é‡çš„ä½œç”¨<ul><li>Groovyã€Scalaã€JRubyã€Kotlinç­‰éƒ½æ˜¯Javaå¹³å°çš„ä¸€éƒ¨åˆ†</li></ul></li><li>ä½œä¸ºä¸€ç§æ–‡åŒ–ï¼ŒJavaå‡ ä¹æˆä¸ºäº†â€œå¼€æºâ€çš„ä»£åè¯ã€‚<ul><li>ç¬¬ä¸‰æ–¹å¼€æºè½¯ä»¶å’Œæ¡†æ¶ã€‚å¦‚Tomcatã€Strutsï¼ŒMyBatisï¼ŒSpringç­‰ã€‚</li><li>å°±è¿JDKå’ŒJVMè‡ªèº«ä¹Ÿæœ‰ä¸å°‘å¼€æºçš„å®ç°ï¼Œå¦‚openJDKã€Harmonyã€‚</li></ul></li><li>ä½œä¸ºä¸€ä¸ªç¤¾åŒºï¼ŒJavaæ‹¥æœ‰å…¨ä¸–ç•Œæœ€å¤šçš„æŠ€æœ¯æ‹¥æŠ¤è€…å’Œå¼€æºç¤¾åŒºæ”¯æŒï¼Œæœ‰æ•°ä¸æ¸…çš„è®ºå›å’Œèµ„æ–™ã€‚ä»æ¡Œé¢åº”ç”¨è½¯ä»¶ã€åµŒå…¥å¼å¼€å‘åˆ°ä¼ä¸šçº§åº”ç”¨ã€åå°æœåŠ¡å™¨ã€ä¸­é—´ä»¶ï¼Œéƒ½å¯ä»¥çœ‹åˆ°Javaçš„èº«å½±ã€‚å…¶åº”ç”¨å½¢å¼ä¹‹å¤æ‚ã€å‚ä¸äººæ•°ä¹‹ä¼—å¤šä¹Ÿä»¤äººå’‹èˆŒã€‚</li></ol><blockquote><p>Java-è·¨å¹³å°çš„è¯­è¨€</p></blockquote><p>ä¸‹é¢è¿™å¼ å›¾å°±å¾ˆå½¢è±¡</p><p><img src="/2022/10/21/jvm-01-jvm-yu-java-ti-xi-jie-gou/image-20221021163236035.png" alt></p><blockquote><p>JVM-è·¨è¯­è¨€çš„å¹³å°</p></blockquote><p><img src="/2022/10/21/jvm-01-jvm-yu-java-ti-xi-jie-gou/image-20221021163440775.png" alt></p><ul><li>éšç€Java7çš„æ­£å¼å‘å¸ƒï¼ŒJavaè™šæ‹Ÿæœºçš„è®¾è®¡è€…ä»¬é€šè¿‡JSR-292è§„èŒƒåŸºæœ¬å®ç°<code>åœ¨Javaè™šæ‹Ÿæœºå¹³å°ä¸Šè¿è¡ŒéJavaè¯­è¨€ç¼–å†™çš„ç¨‹åº</code>ã€‚</li><li>Javaè™šæ‹Ÿæœºæ ¹æœ¬ä¸å…³å¿ƒè¿è¡Œåœ¨å…¶å†…éƒ¨çš„ç¨‹åºåˆ°åº•æ˜¯ä½¿ç”¨ä½•ç§ç¼–ç¨‹è¯­è¨€ç¼–å†™çš„ï¼Œå®ƒ<code>åªå…³å¿ƒâ€œå­—èŠ‚ç â€æ–‡ä»¶</code>ã€‚ä¹Ÿå°±æ˜¯è¯´Javaè™šæ‹Ÿæœºæ‹¥æœ‰è¯­è¨€æ— å…³æ€§ï¼Œå¹¶ä¸ä¼šå•çº¯åœ°ä¸Javaè¯­è¨€â€œç»ˆèº«ç»‘å®šâ€ï¼Œåªè¦å…¶ä»–ç¼–ç¨‹è¯­è¨€çš„ç¼–è¯‘ç»“æœæ»¡è¶³å¹¶åŒ…å«Javaè™šæ‹Ÿæœºçš„å†…éƒ¨æŒ‡ä»¤é›†ã€ç¬¦å·è¡¨ä»¥åŠå…¶ä»–çš„è¾…åŠ©ä¿¡æ¯ï¼Œå®ƒå°±æ˜¯ä¸€ä¸ªæœ‰æ•ˆçš„å­—èŠ‚ç æ–‡ä»¶ï¼Œå°±èƒ½å¤Ÿè¢«è™šæ‹Ÿæœºæ‰€è¯†åˆ«å¹¶è£…è½½è¿è¡Œã€‚</li><li>æˆ‘ä»¬å¹³æ—¶è¯´çš„javaå­—èŠ‚ç ï¼ŒæŒ‡çš„æ˜¯ç”¨javaè¯­è¨€ç¼–è¯‘æˆçš„å­—èŠ‚ç ã€‚å‡†ç¡®çš„è¯´ä»»ä½•èƒ½åœ¨jvmå¹³å°ä¸Šæ‰§è¡Œçš„å­—èŠ‚ç æ ¼å¼éƒ½æ˜¯ä¸€æ ·çš„ã€‚æ‰€ä»¥åº”è¯¥ç»Ÿç§°ä¸ºï¼š<code>jvmå­—èŠ‚ç </code>ã€‚</li><li>ä¸åŒçš„ç¼–è¯‘å™¨ï¼Œå¯ä»¥ç¼–è¯‘å‡ºç›¸åŒçš„å­—èŠ‚ç æ–‡ä»¶ï¼Œå­—èŠ‚ç æ–‡ä»¶ä¹Ÿå¯ä»¥åœ¨ä¸åŒçš„JVMä¸Šè¿è¡Œã€‚</li><li>Javaè™šæ‹Ÿæœºä¸Javaè¯­è¨€å¹¶æ²¡æœ‰å¿…ç„¶çš„è”ç³»ï¼Œå®ƒåªä¸ç‰¹å®šçš„äºŒè¿›åˆ¶æ–‡ä»¶æ ¼å¼â€”â€”<code>Classæ–‡ä»¶</code>æ ¼å¼æ‰€å…³è”ï¼ŒClassæ–‡ä»¶ä¸­åŒ…å«äº†Javaè™šæ‹ŸæœºæŒ‡ä»¤é›†ï¼ˆæˆ–è€…ç§°ä¸ºå­—èŠ‚ç ã€Bytecodesï¼‰å’Œç¬¦å·è¡¨ï¼Œè¿˜æœ‰ä¸€äº›å…¶ä»–è¾…åŠ©ä¿¡æ¯ã€‚</li></ul><blockquote><p>å¤šè¯­è¨€æ··åˆç¼–ç¨‹</p></blockquote><ol><li>Javaå¹³å°ä¸Šçš„å¤šè¯­è¨€æ··åˆç¼–ç¨‹æ­£æˆä¸ºä¸»æµï¼Œé€šè¿‡ç‰¹å®šé¢†åŸŸçš„è¯­è¨€å»è§£å†³ç‰¹å®šé¢†åŸŸçš„é—®é¢˜æ˜¯å½“å‰è½¯ä»¶å¼€å‘åº”å¯¹æ—¥è¶‹å¤æ‚çš„é¡¹ç›®éœ€æ±‚çš„ä¸€ä¸ªæ–¹å‘ã€‚</li><li>è¯•æƒ³ä¸€ä¸‹ï¼Œåœ¨ä¸€ä¸ªé¡¹ç›®ä¹‹ä¸­ï¼Œå¹¶è¡Œå¤„ç†ç”¨Clojureè¯­è¨€ç¼–å†™ï¼Œå±•ç¤ºå±‚ä½¿ç”¨JRuby/Railsï¼Œä¸­é—´å±‚åˆ™æ˜¯Javaï¼Œæ¯ä¸ªåº”ç”¨å±‚éƒ½å°†ä½¿ç”¨ä¸åŒçš„ç¼–ç¨‹è¯­è¨€æ¥å®Œæˆï¼Œè€Œä¸”ï¼Œæ¥å£å¯¹æ¯ä¸€å±‚çš„å¼€å‘è€…éƒ½æ˜¯é€æ˜çš„ï¼Œå„ç§è¯­è¨€ä¹‹é—´çš„äº¤äº’ä¸å­˜åœ¨ä»»ä½•å›°éš¾ï¼Œå°±åƒä½¿ç”¨è‡ªå·±è¯­è¨€çš„åŸç”ŸAPIä¸€æ ·æ–¹ä¾¿ï¼Œå› ä¸ºå®ƒä»¬æœ€ç»ˆéƒ½è¿è¡Œåœ¨ä¸€ä¸ªè™šæ‹Ÿæœºä¹‹ä¸Šã€‚</li><li>å¯¹è¿™äº›è¿è¡ŒäºJavaè™šæ‹Ÿæœºä¹‹ä¸Šã€Javaä¹‹å¤–çš„è¯­è¨€ï¼Œæ¥è‡ªç³»ç»Ÿçº§çš„ã€åº•å±‚çš„æ”¯æŒæ­£åœ¨è¿…é€Ÿå¢å¼ºï¼Œä»¥JSR-292ä¸ºæ ¸å¿ƒçš„ä¸€ç³»åˆ—é¡¹ç›®å’ŒåŠŸèƒ½æ”¹è¿›ï¼ˆå¦‚DaVinci Machineé¡¹ç›®ã€Nashornå¼•æ“ã€InvokeDynamicæŒ‡ä»¤ã€java.lang.invokeåŒ…ç­‰ï¼‰ï¼Œæ¨åŠ¨Javaè™šæ‹Ÿæœºä»â€œJavaè¯­è¨€çš„è™šæ‹Ÿæœºâ€å‘ â€œå¤šè¯­è¨€è™šæ‹Ÿæœºâ€çš„æ–¹å‘å‘å±•ã€‚</li></ol><blockquote><h4 id="Open-JDKå’ŒOracle-JDK">Open JDKå’ŒOracle JDK</h4></blockquote><p>åœ¨JDK11ä¹‹å‰ï¼ŒOracle JDKä¸­è¿˜ä¼šå­˜åœ¨ä¸€äº›Open JDKä¸­æ²¡æœ‰çš„ï¼Œé—­æºçš„åŠŸèƒ½ã€‚ä½†åœ¨JDK11ä¸­ï¼Œæˆ‘ä»¬å¯ä»¥è®¤ä¸ºOpen JDKå’ŒOracle JDKä»£ç å®è´¨ä¸Šå·²ç»è¾¾åˆ°å®Œå…¨ä¸€è‡´çš„ç¨‹åº¦äº†ã€‚</p><blockquote><p>Javaä»£ç æ‰§è¡Œæµç¨‹</p></blockquote><p><img src="/2022/10/21/jvm-01-jvm-yu-java-ti-xi-jie-gou/image-20221021165300594.png" alt></p><h3 id="4ã€è™šæ‹Ÿæœº">4ã€è™šæ‹Ÿæœº</h3><h4 id="1ã€è™šæ‹Ÿæœºæ¦‚å¿µ">1ã€è™šæ‹Ÿæœºæ¦‚å¿µ</h4><ul><li><p>æ‰€è°“è™šæ‹Ÿæœºï¼ˆVirtual Machineï¼‰ï¼Œå°±æ˜¯ä¸€å°è™šæ‹Ÿçš„è®¡ç®—æœºã€‚å®ƒæ˜¯ä¸€æ¬¾<code>è½¯ä»¶</code>ï¼Œç”¨æ¥æ‰§è¡Œä¸€ç³»åˆ—è™šæ‹Ÿè®¡ç®—æœºæŒ‡ä»¤ã€‚å¤§ä½“ä¸Šï¼Œè™šæ‹Ÿæœºå¯ä»¥åˆ†ä¸ºç³»ç»Ÿè™šæ‹Ÿæœºå’Œç¨‹åºè™šæ‹Ÿæœºã€‚</p><ul><li><p>å¤§åé¼é¼çš„Virtual Boxï¼ŒVMwareå°±å±äºç³»ç»Ÿè™šæ‹Ÿæœºï¼Œå®ƒä»¬å®Œå…¨æ˜¯å¯¹ç‰©ç†è®¡ç®—æœºç¡¬ä»¶çš„ä»¿çœŸ(æ¨¡æ‹Ÿ)ï¼Œæä¾›äº†ä¸€ä¸ªå¯è¿è¡Œå®Œæ•´æ“ä½œç³»ç»Ÿçš„è½¯ä»¶å¹³å°ã€‚</p></li><li><p>ç¨‹åºè™šæ‹Ÿæœºçš„å…¸å‹ä»£è¡¨å°±æ˜¯Javaè™šæ‹Ÿæœºï¼Œå®ƒä¸“é—¨ä¸ºæ‰§è¡Œå•ä¸ªè®¡ç®—æœºç¨‹åºè€Œè®¾è®¡ï¼Œåœ¨Javaè™šæ‹Ÿæœºä¸­æ‰§è¡Œçš„æŒ‡ä»¤æˆ‘ä»¬ç§°ä¸ºJavaå­—èŠ‚ç æŒ‡ä»¤ã€‚</p></li></ul></li><li><p>æ— è®ºæ˜¯ç³»ç»Ÿè™šæ‹Ÿæœºè¿˜æ˜¯ç¨‹åºè™šæ‹Ÿæœºï¼Œåœ¨ä¸Šé¢è¿è¡Œçš„è½¯ä»¶éƒ½è¢«é™åˆ¶äºè™šæ‹Ÿæœºæä¾›çš„èµ„æºä¸­ã€‚</p></li></ul><h4 id="2ã€Javaè™šæ‹Ÿæœº">2ã€Javaè™šæ‹Ÿæœº</h4><ol><li>Javaè™šæ‹Ÿæœºæ˜¯ä¸€å°æ‰§è¡ŒJavaå­—èŠ‚ç çš„è™šæ‹Ÿè®¡ç®—æœºï¼Œå®ƒæ‹¥æœ‰ç‹¬ç«‹çš„è¿è¡Œæœºåˆ¶ï¼Œå…¶è¿è¡Œçš„Javaå­—èŠ‚ç ä¹Ÿæœªå¿…ç”±Javaè¯­è¨€ç¼–è¯‘è€Œæˆã€‚</li><li>JVMå¹³å°çš„å„ç§è¯­è¨€å¯ä»¥å…±äº«Javaè™šæ‹Ÿæœºå¸¦æ¥çš„è·¨å¹³å°æ€§ã€ä¼˜ç§€çš„åƒåœ¾å›å™¨ï¼Œä»¥åŠå¯é çš„å³æ—¶ç¼–è¯‘å™¨ã€‚</li><li><strong>JavaæŠ€æœ¯çš„æ ¸å¿ƒå°±æ˜¯Javaè™šæ‹Ÿæœº</strong>ï¼ˆJVMï¼ŒJava Virtual Machineï¼‰ï¼Œå› ä¸ºæ‰€æœ‰çš„Javaç¨‹åºéƒ½è¿è¡Œåœ¨Javaè™šæ‹Ÿæœºå†…éƒ¨ã€‚</li></ol><p><strong>ä½œç”¨ï¼š</strong></p><p>Javaè™šæ‹Ÿæœºå°±æ˜¯äºŒè¿›åˆ¶å­—èŠ‚ç çš„è¿è¡Œç¯å¢ƒï¼Œè´Ÿè´£è£…è½½å­—èŠ‚ç åˆ°å…¶å†…éƒ¨ï¼Œè§£é‡Š/ç¼–è¯‘ä¸ºå¯¹åº”å¹³å°ä¸Šçš„æœºå™¨æŒ‡ä»¤æ‰§è¡Œã€‚æ¯ä¸€æ¡JavaæŒ‡ä»¤ï¼ŒJavaè™šæ‹Ÿæœºè§„èŒƒä¸­éƒ½æœ‰è¯¦ç»†å®šä¹‰ï¼Œå¦‚æ€ä¹ˆå–æ“ä½œæ•°ï¼Œæ€ä¹ˆå¤„ç†æ“ä½œæ•°ï¼Œå¤„ç†ç»“æœæ”¾åœ¨å“ªé‡Œã€‚</p><p><strong>ç‰¹ç‚¹ï¼š</strong></p><ol><li>ä¸€æ¬¡ç¼–è¯‘ï¼Œåˆ°å¤„è¿è¡Œ</li><li>è‡ªåŠ¨å†…å­˜ç®¡ç†</li><li>è‡ªåŠ¨åƒåœ¾å›æ”¶åŠŸèƒ½</li></ol><h3 id="5ã€JVMä½ç½®åŠæ•´ä½“æ¶æ„">5ã€JVMä½ç½®åŠæ•´ä½“æ¶æ„</h3><p><img src="/2022/10/21/jvm-01-jvm-yu-java-ti-xi-jie-gou/image-20221021164330033.png" alt></p><p>JVMæ˜¯è¿è¡Œåœ¨æ“ä½œç³»ç»Ÿä¹‹ä¸Šçš„ï¼Œå®ƒä¸ç¡¬ä»¶æ²¡æœ‰ç›´æ¥çš„äº¤äº’</p><p><img src="/2022/10/21/jvm-01-jvm-yu-java-ti-xi-jie-gou/image-20221021164401275.png" alt></p><ol><li>HotSpot VMæ˜¯ç›®å‰å¸‚é¢ä¸Šé«˜æ€§èƒ½è™šæ‹Ÿæœºçš„ä»£è¡¨ä½œä¹‹ä¸€ã€‚</li><li>å®ƒé‡‡ç”¨è§£é‡Šå™¨ä¸å³æ—¶ç¼–è¯‘å™¨å¹¶å­˜çš„æ¶æ„ã€‚</li><li>åœ¨ä»Šå¤©ï¼ŒJavaç¨‹åºçš„è¿è¡Œæ€§èƒ½æ—©å·²è„±èƒæ¢éª¨ï¼Œå·²ç»è¾¾åˆ°äº†å¯ä»¥å’ŒC/C++ç¨‹åºä¸€è¾ƒé«˜ä¸‹çš„åœ°æ­¥ã€‚</li></ol><blockquote><p>ä¸‹é¢è¿™å¼ å›¾è¦ä¼šç”»</p></blockquote><p><img src="/2022/10/21/jvm-01-jvm-yu-java-ti-xi-jie-gou/image-20221021164535409.png" alt></p><h3 id="6ã€JVMçš„æ¶æ„æ¨¡å‹">6ã€JVMçš„æ¶æ„æ¨¡å‹</h3><p>Javaç¼–è¯‘å™¨è¾“å…¥çš„æŒ‡ä»¤æµåŸºæœ¬ä¸Šæ˜¯ä¸€ç§<strong>åŸºäºæ ˆçš„æŒ‡ä»¤é›†æ¶æ„</strong>ï¼Œå¦å¤–ä¸€ç§æŒ‡ä»¤é›†æ¶æ„åˆ™æ˜¯<strong>åŸºäºå¯„å­˜å™¨çš„æŒ‡ä»¤é›†æ¶æ„</strong>ã€‚</p><blockquote><p>HotSpotæ˜¯åŸºäºæ ˆçš„æŒ‡ä»¤é›†æ¶æ„</p></blockquote><p>å…·ä½“æ¥è¯´ï¼šè¿™ä¸¤ç§æ¶æ„ä¹‹é—´çš„åŒºåˆ«ï¼š</p><h4 id="1ã€åŸºäºæ ˆçš„æŒ‡ä»¤é›†æ¶æ„">1ã€åŸºäºæ ˆçš„æŒ‡ä»¤é›†æ¶æ„</h4><p>åŸºäºæ ˆå¼æ¶æ„çš„ç‰¹ç‚¹ï¼š</p><ol><li>è®¾è®¡å’Œå®ç°æ›´ç®€å•ï¼Œé€‚ç”¨äºèµ„æºå—é™çš„ç³»ç»Ÿï¼›</li><li>é¿å¼€äº†å¯„å­˜å™¨çš„åˆ†é…éš¾é¢˜ï¼šä½¿ç”¨é›¶åœ°å€æŒ‡ä»¤æ–¹å¼åˆ†é…</li><li>æŒ‡ä»¤æµä¸­çš„æŒ‡ä»¤å¤§éƒ¨åˆ†æ˜¯é›¶åœ°å€æŒ‡ä»¤ï¼Œå…¶æ‰§è¡Œè¿‡ç¨‹ä¾èµ–äºæ“ä½œæ ˆã€‚æŒ‡ä»¤é›†æ›´å°ï¼Œç¼–è¯‘å™¨å®¹æ˜“å®ç°</li><li>ä¸éœ€è¦ç¡¬ä»¶æ”¯æŒï¼Œå¯ç§»æ¤æ€§æ›´å¥½ï¼Œæ›´å¥½å®ç°è·¨å¹³å°</li></ol><h4 id="2ã€åŸºäºå¯„å­˜å™¨çš„æŒ‡ä»¤çº§æ¶æ„">2ã€åŸºäºå¯„å­˜å™¨çš„æŒ‡ä»¤çº§æ¶æ„</h4><p>åŸºäºå¯„å­˜å™¨æ¶æ„çš„ç‰¹ç‚¹ï¼š</p><ol><li>å…¸å‹çš„åº”ç”¨æ˜¯x86çš„äºŒè¿›åˆ¶æŒ‡ä»¤é›†ï¼šæ¯”å¦‚ä¼ ç»Ÿçš„PCä»¥åŠAndroidçš„Davlikè™šæ‹Ÿæœºã€‚</li><li>æŒ‡ä»¤é›†æ¶æ„åˆ™å®Œå…¨ä¾èµ–ç¡¬ä»¶ï¼Œä¸ç¡¬ä»¶çš„è€¦åˆåº¦é«˜ï¼Œå¯ç§»æ¤æ€§å·®</li><li><code>æ€§èƒ½ä¼˜ç§€å’Œæ‰§è¡Œæ›´é«˜æ•ˆ</code></li><li><code>èŠ±è´¹æ›´å°‘çš„æŒ‡ä»¤å»å®Œæˆä¸€é¡¹æ“ä½œ</code></li><li>åœ¨å¤§éƒ¨åˆ†æƒ…å†µä¸‹ï¼ŒåŸºäºå¯„å­˜å™¨æ¶æ„çš„æŒ‡ä»¤é›†å¾€å¾€éƒ½ä»¥ä¸€åœ°å€æŒ‡ä»¤ã€äºŒåœ°å€æŒ‡ä»¤å’Œä¸‰åœ°å€æŒ‡ä»¤ä¸ºä¸»ï¼Œè€ŒåŸºäºæ ˆå¼æ¶æ„çš„æŒ‡ä»¤é›†å´æ˜¯ä»¥é›¶åœ°å€æŒ‡ä»¤ä¸ºä¸»</li></ol><h4 id="3ã€ä¸¾ä¾‹">3ã€ä¸¾ä¾‹</h4><p>æ‰§è¡Œ2+3è¿™ç§é€»è¾‘æ“ä½œ</p><ul><li><p>åŸºäºæ ˆçš„è®¡ç®—æµç¨‹ï¼ˆä»¥Javaè™šæ‹Ÿæœºä¸ºä¾‹ï¼‰ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs java">iconst_2 <span class="hljs-comment">//å¸¸é‡2å…¥æ ˆ</span><br>istore_1<br>iconst_3 <span class="hljs-comment">// å¸¸é‡3å…¥æ ˆ</span><br>istore_2<br>iload_1<br>iload_2<br>iadd <span class="hljs-comment">//å¸¸é‡2/3å‡ºæ ˆï¼Œæ‰§è¡Œç›¸åŠ </span><br>istore_0 <span class="hljs-comment">// ç»“æœ5å…¥æ ˆ</span><br></code></pre></td></tr></table></figure></li><li><p>è€ŒåŸºäºå¯„å­˜å™¨çš„è®¡ç®—æµç¨‹</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs java">mov eax,<span class="hljs-number">2</span> <span class="hljs-comment">//å°†eaxå¯„å­˜å™¨çš„å€¼è®¾ä¸º1</span><br>add eax,<span class="hljs-number">3</span> <span class="hljs-comment">//ä½¿eaxå¯„å­˜å™¨çš„å€¼åŠ 3</span><br></code></pre></td></tr></table></figure></li></ul><h4 id="4ã€JVMæ¶æ„æ€»ç»“">4ã€JVMæ¶æ„æ€»ç»“</h4><ol><li><strong>ç”±äºè·¨å¹³å°æ€§çš„è®¾è®¡ï¼ŒJavaçš„æŒ‡ä»¤éƒ½æ˜¯æ ¹æ®æ ˆæ¥è®¾è®¡çš„</strong>ã€‚ä¸åŒå¹³å°CPUæ¶æ„ä¸åŒï¼Œæ‰€ä»¥ä¸èƒ½è®¾è®¡ä¸ºåŸºäºå¯„å­˜å™¨çš„ã€‚<code>æ ˆçš„ä¼˜ç‚¹</code>ï¼šè·¨å¹³å°ï¼ŒæŒ‡ä»¤é›†å°ï¼Œç¼–è¯‘å™¨å®¹æ˜“å®ç°ï¼Œ<code>ç¼ºç‚¹</code>æ˜¯æ€§èƒ½æ¯”å¯„å­˜å™¨å·®ä¸€äº›ã€‚</li><li>æ—¶è‡³ä»Šæ—¥ï¼Œå°½ç®¡åµŒå…¥å¼å¹³å°å·²ç»ä¸æ˜¯Javaç¨‹åºçš„ä¸»æµè¿è¡Œå¹³å°äº†ï¼ˆå‡†ç¡®æ¥è¯´åº”è¯¥æ˜¯HotSpot VMçš„å®¿ä¸»ç¯å¢ƒå·²ç»ä¸å±€é™äºåµŒå…¥å¼å¹³å°äº†ï¼‰ï¼Œé‚£ä¹ˆä¸ºä»€ä¹ˆä¸å°†æ¶æ„æ›´æ¢ä¸ºåŸºäºå¯„å­˜å™¨çš„æ¶æ„å‘¢ï¼Ÿ</li></ol><p>å› ä¸ºåŸºäºæ ˆçš„æ¶æ„è·¨å¹³å°æ€§å¥½ã€æŒ‡ä»¤é›†å°ï¼Œè™½ç„¶ç›¸å¯¹äºåŸºäºå¯„å­˜å™¨çš„æ¶æ„æ¥è¯´ï¼ŒåŸºäºæ ˆçš„æ¶æ„ç¼–è¯‘å¾—åˆ°çš„æŒ‡ä»¤æ›´å¤šï¼Œæ‰§è¡Œæ€§èƒ½ä¹Ÿä¸å¦‚åŸºäºå¯„å­˜å™¨çš„æ¶æ„å¥½ï¼Œä½†è€ƒè™‘åˆ°å…¶è·¨å¹³å°æ€§ä¸ç§»æ¤æ€§ï¼Œæˆ‘ä»¬è¿˜æ˜¯é€‰ç”¨æ ˆçš„æ¶æ„</p><h3 id="7ã€JVMçš„ç”Ÿå‘½å‘¨æœŸ">7ã€JVMçš„ç”Ÿå‘½å‘¨æœŸ</h3><h4 id="1ã€è™šæ‹Ÿæœºçš„å¯åŠ¨">1ã€è™šæ‹Ÿæœºçš„å¯åŠ¨</h4><p>Javaè™šæ‹Ÿæœºçš„å¯åŠ¨æ˜¯é€šè¿‡å¼•å¯¼ç±»åŠ è½½å™¨ï¼ˆbootstrap class loaderï¼‰åˆ›å»ºä¸€ä¸ªåˆå§‹ç±»ï¼ˆinitial classï¼‰æ¥å®Œæˆçš„ï¼Œè¿™ä¸ªç±»æ˜¯ç”±è™šæ‹Ÿæœºçš„å…·ä½“å®ç°æŒ‡å®šçš„ã€‚</p><h4 id="2ã€è™šæ‹Ÿæœºçš„æ‰§è¡Œ">2ã€è™šæ‹Ÿæœºçš„æ‰§è¡Œ</h4><ol><li>ä¸€ä¸ªè¿è¡Œä¸­çš„Javaè™šæ‹Ÿæœºæœ‰ç€ä¸€ä¸ªæ¸…æ™°çš„ä»»åŠ¡ï¼šæ‰§è¡ŒJavaç¨‹åº</li><li>ç¨‹åºå¼€å§‹æ‰§è¡Œæ—¶ä»–æ‰è¿è¡Œï¼Œç¨‹åºç»“æŸæ—¶ä»–å°±åœæ­¢</li><li><code>æ‰§è¡Œä¸€ä¸ªæ‰€è°“çš„Javaç¨‹åºçš„æ—¶å€™ï¼ŒçœŸçœŸæ­£æ­£åœ¨æ‰§è¡Œçš„æ˜¯ä¸€ä¸ªå«åšJavaè™šæ‹Ÿæœºçš„è¿›ç¨‹</code></li></ol><h4 id="3ã€è™šæ‹Ÿæœºçš„é€€å‡º">3ã€è™šæ‹Ÿæœºçš„é€€å‡º</h4><p><code>æœ‰å¦‚ä¸‹çš„å‡ ç§æƒ…å†µï¼š</code></p><ol><li>ç¨‹åºæ­£å¸¸æ‰§è¡Œç»“æŸ</li><li>ç¨‹åºåœ¨æ‰§è¡Œè¿‡ç¨‹ä¸­é‡åˆ°äº†å¼‚å¸¸æˆ–é”™è¯¯è€Œå¼‚å¸¸ç»ˆæ­¢</li><li>ç”±äºæ“ä½œç³»ç»Ÿç”¨ç°é”™è¯¯è€Œå¯¼è‡´Javaè™šæ‹Ÿæœºè¿›ç¨‹ç»ˆæ­¢</li><li>æŸçº¿ç¨‹è°ƒç”¨Runtimeç±»æˆ–Systemç±»çš„exit()æ–¹æ³•ï¼Œæˆ–Runtimeç±»çš„halt()æ–¹æ³•ï¼Œå¹¶ä¸”Javaå®‰å…¨ç®¡ç†å™¨ä¹Ÿå…è®¸è¿™æ¬¡exit()æˆ–halt()æ“ä½œã€‚</li><li>é™¤æ­¤ä¹‹å¤–ï¼ŒJNIï¼ˆJava Native Interfaceï¼‰è§„èŒƒæè¿°äº†ç”¨JNI Invocation APIæ¥åŠ è½½æˆ–å¸è½½ Javaè™šæ‹Ÿæœºæ—¶ï¼ŒJavaè™šæ‹Ÿæœºçš„é€€å‡ºæƒ…å†µã€‚</li></ol><h3 id="8ã€å¸¸è§JVMç±»å‹">8ã€å¸¸è§JVMç±»å‹</h3><h4 id="1ã€Sun-Classic-VM">1ã€Sun Classic VM</h4><ol><li>æ—©åœ¨1996å¹´Java1.0ç‰ˆæœ¬çš„æ—¶å€™ï¼ŒSunå…¬å¸å‘å¸ƒäº†ä¸€æ¬¾åä¸ºsun classic VMçš„Javaè™šæ‹Ÿæœºï¼Œå®ƒåŒæ—¶ä¹Ÿæ˜¯<code>ä¸–ç•Œä¸Šç¬¬ä¸€æ¬¾å•†ç”¨Javaè™šæ‹Ÿæœº</code>ï¼ŒJDK1.4æ—¶å®Œå…¨è¢«æ·˜æ±°ã€‚</li><li>è¿™æ¬¾è™šæ‹Ÿæœºå†…éƒ¨åªæä¾›è§£é‡Šå™¨ï¼Œæ²¡æœ‰å³æ—¶ç¼–è¯‘å™¨ï¼Œå› æ­¤æ•ˆç‡æ¯”è¾ƒä½ã€‚ã€å³æ—¶ç¼–è¯‘å™¨ä¼šæŠŠçƒ­ç‚¹ä»£ç çš„æœ¬åœ°æœºå™¨æŒ‡ä»¤ç¼“å­˜èµ·æ¥ï¼Œé‚£ä¹ˆä»¥åä½¿ç”¨çƒ­ç‚¹ä»£ç çš„æ—¶å€™ï¼Œæ•ˆç‡å°±æ¯”è¾ƒé«˜ã€‘</li><li>å¦‚æœä½¿ç”¨JITç¼–è¯‘å™¨ï¼Œå°±éœ€è¦è¿›è¡Œå¤–æŒ‚ã€‚ä½†æ˜¯ä¸€æ—¦ä½¿ç”¨äº†JITç¼–è¯‘å™¨ï¼ŒJITå°±ä¼šæ¥ç®¡è™šæ‹Ÿæœºçš„æ‰§è¡Œç³»ç»Ÿã€‚è§£é‡Šå™¨å°±ä¸å†å·¥ä½œï¼Œè§£é‡Šå™¨å’Œç¼–è¯‘å™¨ä¸èƒ½é…åˆå·¥ä½œã€‚<ul><li>æˆ‘ä»¬å°†å­—èŠ‚ç æŒ‡ä»¤ç¿»è¯‘æˆæœºå™¨æŒ‡ä»¤ä¹Ÿæ˜¯éœ€è¦èŠ±æ—¶é—´çš„ï¼Œå¦‚æœåªä½¿ç”¨JITï¼Œå°±éœ€è¦æŠŠæ‰€æœ‰å­—èŠ‚ç æŒ‡ä»¤éƒ½ç¿»è¯‘æˆæœºå™¨æŒ‡ä»¤ï¼Œå°±ä¼šå¯¼è‡´ç¿»è¯‘æ—¶é—´è¿‡é•¿ï¼Œä¹Ÿå°±æ˜¯è¯´åœ¨ç¨‹åºåˆšå¯åŠ¨çš„æ—¶å€™ï¼Œç­‰å¾…æ—¶é—´ä¼šå¾ˆé•¿ã€‚</li><li>è€Œè§£é‡Šå™¨å°±æ˜¯èµ°åˆ°å“ªï¼Œè§£é‡Šåˆ°å“ªã€‚</li></ul></li><li>ç°åœ¨Hotspotå†…ç½®äº†æ­¤è™šæ‹Ÿæœºã€‚</li></ol><h4 id="2ã€HotSpot-VMï¼ˆé‡ç‚¹ï¼‰">2ã€HotSpot VMï¼ˆé‡ç‚¹ï¼‰</h4><ol><li><p>HotSpotå†å²</p><ul><li>æœ€åˆç”±ä¸€å®¶åä¸ºâ€œLongview Technologiesâ€çš„å°å…¬å¸è®¾è®¡</li><li>1997å¹´ï¼Œæ­¤å…¬å¸è¢«Sunæ”¶è´­ï¼›2009å¹´ï¼ŒSunå…¬å¸è¢«ç”²éª¨æ–‡æ”¶è´­ã€‚</li><li>JDK1.3æ—¶ï¼ŒHotSpot VMæˆä¸ºé»˜è®¤è™šæ‹Ÿæœº</li></ul></li><li><p>ç›®å‰</p><p><code>Hotspotå æœ‰ç»å¯¹çš„å¸‚åœºåœ°ä½ï¼Œç§°éœ¸æ­¦æ—</code></p><ul><li>ä¸ç®¡æ˜¯ç°åœ¨ä»åœ¨å¹¿æ³›ä½¿ç”¨çš„JDK6ï¼Œè¿˜æ˜¯ä½¿ç”¨æ¯”ä¾‹è¾ƒå¤šçš„JDK8ä¸­ï¼Œé»˜è®¤çš„è™šæ‹Ÿæœºéƒ½æ˜¯HotSpot</li><li>Sun/oracle JDKå’ŒopenJDKçš„é»˜è®¤è™šæ‹Ÿæœº</li></ul></li><li><p>ä»æœåŠ¡å™¨ã€æ¡Œé¢åˆ°ç§»åŠ¨ç«¯ã€åµŒå…¥å¼éƒ½æœ‰åº”ç”¨ã€‚</p></li><li><p>åç§°ä¸­çš„HotSpotæŒ‡çš„å°±æ˜¯å®ƒçš„<code>çƒ­ç‚¹ä»£ç æ¢æµ‹æŠ€æœ¯</code>ã€‚</p><ul><li>é€šè¿‡è®¡æ•°å™¨æ‰¾åˆ°æœ€å…·ç¼–è¯‘ä»·å€¼ä»£ç ï¼Œè§¦å‘å³æ—¶ç¼–è¯‘æˆ–æ ˆä¸Šæ›¿æ¢</li><li>é€šè¿‡ç¼–è¯‘å™¨ä¸è§£é‡Šå™¨ååŒå·¥ä½œï¼Œåœ¨æœ€ä¼˜åŒ–çš„ç¨‹åºå“åº”æ—¶é—´ä¸æœ€ä½³æ‰§è¡Œæ€§èƒ½ä¸­å–å¾—å¹³è¡¡</li></ul></li></ol><h4 id="3ã€JRockitï¼ˆå•†ç”¨ä¸‰å¤§è™šæ‹Ÿæœºä¹‹ä¸€ï¼‰">3ã€JRockitï¼ˆå•†ç”¨ä¸‰å¤§è™šæ‹Ÿæœºä¹‹ä¸€ï¼‰</h4><ol><li>ä¸“æ³¨äºæœåŠ¡å™¨ç«¯åº”ç”¨ï¼šå®ƒå¯ä»¥ä¸å¤ªå…³æ³¨ç¨‹åºå¯åŠ¨é€Ÿåº¦ï¼Œå› æ­¤JRockitå†…éƒ¨ä¸åŒ…å«è§£æå™¨å®ç°ï¼Œå…¨éƒ¨ä»£ç éƒ½é å³æ—¶ç¼–è¯‘å™¨ç¼–è¯‘åæ‰§è¡Œã€‚</li><li>å¤§é‡çš„è¡Œä¸šåŸºå‡†æµ‹è¯•æ˜¾ç¤ºï¼Œ<code>JRockit JVMæ˜¯ä¸–ç•Œä¸Šæœ€å¿«çš„JVM</code>ï¼šä½¿ç”¨JRockitäº§å“ï¼Œå®¢æˆ·å·²ç»ä½“éªŒåˆ°äº†æ˜¾è‘—çš„æ€§èƒ½æé«˜ï¼ˆä¸€äº›è¶…è¿‡äº†70%ï¼‰å’Œç¡¬ä»¶æˆæœ¬çš„å‡å°‘ï¼ˆè¾¾50%ï¼‰ã€‚</li><li>ä¼˜åŠ¿ï¼šå…¨é¢çš„Javaè¿è¡Œæ—¶è§£å†³æ–¹æ¡ˆç»„åˆ<ul><li>JRockité¢å‘å»¶è¿Ÿæ•æ„Ÿå‹åº”ç”¨çš„è§£å†³æ–¹æ¡ˆJRockit Real Timeæä¾›ä»¥æ¯«ç§’æˆ–å¾®ç§’çº§çš„JVMå“åº”æ—¶é—´ï¼Œé€‚åˆè´¢åŠ¡ã€å†›äº‹æŒ‡æŒ¥ã€ç”µä¿¡ç½‘ç»œçš„éœ€è¦</li><li>Mission ControlæœåŠ¡å¥—ä»¶ï¼Œå®ƒæ˜¯ä¸€ç»„ä»¥æä½çš„å¼€é”€æ¥ç›‘æ§ã€ç®¡ç†å’Œåˆ†æç”Ÿäº§ç¯å¢ƒä¸­çš„åº”ç”¨ç¨‹åºçš„å·¥å…·ã€‚</li></ul></li><li>2008å¹´ï¼ŒJRockitè¢«Oracleæ”¶è´­ã€‚</li><li>Oracleè¡¨è¾¾äº†æ•´åˆä¸¤å¤§ä¼˜ç§€è™šæ‹Ÿæœºçš„å·¥ä½œï¼Œå¤§è‡´åœ¨JDK8ä¸­å®Œæˆã€‚æ•´åˆçš„æ–¹å¼æ˜¯åœ¨HotSpotçš„åŸºç¡€ä¸Šï¼Œç§»æ¤JRockitçš„ä¼˜ç§€ç‰¹æ€§ã€‚</li><li>é«˜æ–¯æ—ï¼šç›®å‰å°±èŒäºè°·æ­Œï¼Œç ”ç©¶äººå·¥æ™ºèƒ½å’Œæ°´ä¸‹æœºå™¨äºº</li></ol><h4 id="4ã€IBMçš„J9ï¼ˆå•†ç”¨ä¸‰å¤§è™šæ‹Ÿæœºä¹‹ä¸€ï¼‰">4ã€IBMçš„J9ï¼ˆå•†ç”¨ä¸‰å¤§è™šæ‹Ÿæœºä¹‹ä¸€ï¼‰</h4><ol><li>å…¨ç§°ï¼šIBM Technology for Java Virtual Machineï¼Œç®€ç§°IT4Jï¼Œå†…éƒ¨ä»£å·ï¼šJ9</li><li>å¸‚åœºå®šä½ä¸HotSpotæ¥è¿‘ï¼ŒæœåŠ¡å™¨ç«¯ã€æ¡Œé¢åº”ç”¨ã€åµŒå…¥å¼ç­‰å¤šç”¨é€”VMå¹¿æ³›ç”¨äºIBMçš„å„ç§Javaäº§å“ã€‚</li><li>ç›®å‰ï¼Œæœ‰å½±å“åŠ›çš„ä¸‰å¤§å•†ç”¨è™šæ‹Ÿæœºä¹‹ä¸€ï¼Œä¹Ÿå·ç§°æ˜¯ä¸–ç•Œä¸Šæœ€å¿«çš„Javaè™šæ‹Ÿæœºã€‚</li><li>2017å¹´å·¦å³ï¼ŒIBMå‘å¸ƒäº†å¼€æºJ9VMï¼Œå‘½åä¸ºopenJ9ï¼Œäº¤ç»™EclipseåŸºé‡‘ä¼šç®¡ç†ï¼Œä¹Ÿç§°ä¸ºEclipse OpenJ9</li><li>OpenJDK -&gt; æ˜¯JDKå¼€æºäº†ï¼ŒåŒ…æ‹¬äº†è™šæ‹Ÿæœº</li></ol><h4 id="5ã€Graal-VMï¼ˆæœªæ¥è™šæ‹Ÿæœºï¼‰">5ã€Graal VMï¼ˆæœªæ¥è™šæ‹Ÿæœºï¼‰</h4><ol><li>2018å¹´4æœˆï¼ŒOracle Labså…¬å¼€äº†GraalvMï¼Œå·ç§° â€œ<strong>Run Programs Faster Anywhere</strong>â€ï¼Œå‹ƒå‹ƒé‡å¿ƒã€‚ä¸1995å¹´javaçš„â€write onceï¼Œrun anywhereâ€é¥ç›¸å‘¼åº”ã€‚</li><li>GraalVMåœ¨HotSpot VMåŸºç¡€ä¸Šå¢å¼ºè€Œæˆçš„**è·¨è¯­è¨€å…¨æ ˆè™šæ‹Ÿæœºï¼Œå¯ä»¥ä½œä¸ºâ€œä»»ä½•è¯­è¨€â€**çš„è¿è¡Œå¹³å°ä½¿ç”¨ã€‚è¯­è¨€åŒ…æ‹¬ï¼šJavaã€Scalaã€Groovyã€Kotlinï¼›Cã€C++ã€Javascriptã€Rubyã€Pythonã€Rç­‰</li><li>æ”¯æŒä¸åŒè¯­è¨€ä¸­æ··ç”¨å¯¹æ–¹çš„æ¥å£å’Œå¯¹è±¡ï¼Œæ”¯æŒè¿™äº›è¯­è¨€ä½¿ç”¨å·²ç»ç¼–å†™å¥½çš„æœ¬åœ°åº“æ–‡ä»¶</li><li>å·¥ä½œåŸç†æ˜¯å°†è¿™äº›è¯­è¨€çš„æºä»£ç æˆ–æºä»£ç ç¼–è¯‘åçš„ä¸­é—´æ ¼å¼ï¼Œé€šè¿‡è§£é‡Šå™¨è½¬æ¢ä¸ºèƒ½è¢«Graal VMæ¥å—çš„ä¸­é—´è¡¨ç¤ºã€‚Graal VMæä¾›Truffleå·¥å…·é›†å¿«é€Ÿæ„å»ºé¢å‘ä¸€ç§æ–°è¯­è¨€çš„è§£é‡Šå™¨ã€‚åœ¨è¿è¡Œæ—¶è¿˜èƒ½è¿›è¡Œå³æ—¶ç¼–è¯‘ä¼˜åŒ–ï¼Œè·å¾—æ¯”åŸç”Ÿç¼–è¯‘å™¨æ›´ä¼˜ç§€çš„æ‰§è¡Œæ•ˆç‡ã€‚</li><li><code>å¦‚æœè¯´HotSpotæœ‰ä¸€å¤©çœŸçš„è¢«å–ä»£ï¼ŒGraalvmå¸Œæœ›æœ€å¤§</code>ã€‚ä½†æ˜¯Javaçš„è½¯ä»¶ç”Ÿæ€æ²¡æœ‰ä¸æ¯«å˜åŒ–ã€‚</li></ol><h4 id="6ã€å…¶ä»–è™šæ‹Ÿæœº">6ã€å…¶ä»–è™šæ‹Ÿæœº</h4><ol><li><p>Exact VM</p></li><li><p>KVMå’ŒCDC/CLDC Hotspot</p></li><li><p>Azul VM</p></li><li><p>Liquid VM</p></li><li><p>Apache Marmony</p></li><li><p>Micorsoft JVM</p></li><li><p>Taobao JVM</p><ol><li><code>åŸºäºOpenJDKå¼€å‘äº†è‡ªå·±çš„å®šåˆ¶ç‰ˆæœ¬AlibabaJDK</code>ï¼Œç®€ç§°AJDKã€‚æ˜¯æ•´ä¸ªé˜¿é‡ŒJavaä½“ç³»çš„åŸºçŸ³ã€‚</li><li>åŸºäºOpenJDK Hotspot VMå‘å¸ƒçš„å›½å†…ç¬¬ä¸€ä¸ªä¼˜åŒ–ã€æ·±åº¦å®šåˆ¶ä¸”å¼€æºçš„é«˜æ€§èƒ½æœåŠ¡å™¨ç‰ˆJavaè™šæ‹Ÿæœºã€‚<ul><li>åˆ›æ–°çš„GCIHï¼ˆGCinvisible heapï¼‰æŠ€æœ¯å®ç°äº†off-heapï¼Œå³<code>å°†ç”Ÿå‘½å‘¨æœŸè¾ƒé•¿çš„Javaå¯¹è±¡ä»heapä¸­ç§»åˆ°heapä¹‹å¤–ï¼Œå¹¶ä¸”GCä¸èƒ½ç®¡ç†GCIHå†…éƒ¨çš„Javaå¯¹è±¡ï¼Œä»¥æ­¤è¾¾åˆ°é™ä½GCçš„å›æ”¶é¢‘ç‡å’Œæå‡GCçš„å›æ”¶æ•ˆç‡çš„ç›®çš„</code>ã€‚</li><li>GCIHä¸­çš„<code>å¯¹è±¡è¿˜èƒ½å¤Ÿåœ¨å¤šä¸ªJavaè™šæ‹Ÿæœºè¿›ç¨‹ä¸­å®ç°å…±äº«</code></li><li>ä½¿ç”¨crc32æŒ‡ä»¤å®ç°JvM intrinsicé™ä½JNIçš„è°ƒç”¨å¼€é”€</li><li>PMU hardwareçš„Java profiling toolå’Œè¯Šæ–­ååŠ©åŠŸèƒ½</li><li>é’ˆå¯¹å¤§æ•°æ®åœºæ™¯çš„ZenGC</li></ul></li><li>taobao vmåº”ç”¨åœ¨é˜¿é‡Œäº§å“ä¸Šæ€§èƒ½é«˜ï¼Œ<code>ç¡¬ä»¶ä¸¥é‡ä¾èµ–intelçš„cpuï¼ŒæŸå¤±äº†å…¼å®¹æ€§ï¼Œä½†æé«˜äº†æ€§èƒ½</code></li></ol><p>ç›®å‰å·²ç»åœ¨æ·˜å®ã€å¤©çŒ«ä¸Šçº¿ï¼ŒæŠŠOracleå®˜æ–¹JvMç‰ˆæœ¬å…¨éƒ¨æ›¿æ¢äº†ã€‚</p></li><li><p>Dalvik VM</p></li></ol>]]></content>
    
    
    <categories>
      
      <category>JVM</category>
      
    </categories>
    
    
    <tags>
      
      <tag>java</tag>
      
      <tag>JVM</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Z-ã€Šæµè¡Œçš„äº‘ã€‹</title>
    <link href="/2022/10/20/z-liu-xing-de-yun/"/>
    <url>/2022/10/20/z-liu-xing-de-yun/</url>
    
    <content type="html"><![CDATA[<p>ç‰¹æ®Šè°ƒå¼¦</p><p><img src="/2022/10/20/z-liu-xing-de-yun/image-20221020103152306.png"></p><p><img src="/2022/10/20/z-liu-xing-de-yun/image-20221020103212498.png"></p><blockquote><p>æ›²è°±æ¥æº å…ƒå­å¼¹å‰ä»–</p></blockquote>]]></content>
    
    
    <categories>
      
      <category>å‰ä»–</category>
      
    </categories>
    
    
    <tags>
      
      <tag>å‰ä»–</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Gitå¸¸ç”¨å‘½ä»¤</title>
    <link href="/2022/10/19/git-chang-yong-ming-ling/"/>
    <url>/2022/10/19/git-chang-yong-ming-ling/</url>
    
    <content type="html"><![CDATA[<h2 id="1ã€åˆ›å»ºç‰ˆæœ¬åº“"><a href="#1ã€åˆ›å»ºç‰ˆæœ¬åº“" class="headerlink" title="1ã€åˆ›å»ºç‰ˆæœ¬åº“"></a>1ã€åˆ›å»ºç‰ˆæœ¬åº“</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs bash">$ git <span class="hljs-built_in">clone</span> &lt;url&gt; <span class="hljs-comment">#å…‹éš†è¿œç¨‹ç‰ˆæœ¬</span><br><br>$ git init <span class="hljs-comment">#åˆå§‹åŒ–æœ¬åœ°ç‰ˆæœ¬åº“</span><br><br>$ git config --global user.name ç”¨æˆ·å <span class="hljs-comment">#è®¾ç½®ç”¨æˆ·å</span><br><br>$ git config --global user.email é‚®ç®± <span class="hljs-comment">#è®¾ç½®é‚®ç®±</span><br></code></pre></td></tr></table></figure><h2 id="2ã€ä¿®æ”¹å’Œæäº¤ä»£ç "><a href="#2ã€ä¿®æ”¹å’Œæäº¤ä»£ç " class="headerlink" title="2ã€ä¿®æ”¹å’Œæäº¤ä»£ç "></a>2ã€ä¿®æ”¹å’Œæäº¤ä»£ç </h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs bash">$ git status <span class="hljs-comment">#æŸ¥çœ‹çŠ¶æ€</span><br><br>$ git diff <span class="hljs-comment">#æŸ¥çœ‹ä¾¿å˜æ›´å†…å®¹</span><br><br>$ git add . <span class="hljs-comment">#è·Ÿè¸ªæ‰€æœ‰æ”¹åŠ¨çš„æ–‡ä»¶</span><br><br>$ git add &lt;file&gt; <span class="hljs-comment">#è·Ÿè¸ªæŒ‡å®šçš„æ–‡ä»¶</span><br><br>$ git <span class="hljs-built_in">mv</span> &lt;old&gt; &lt;new&gt; <span class="hljs-comment">#æ–‡ä»¶æ”¹å</span><br><br>$ git <span class="hljs-built_in">rm</span> &lt;file&gt; <span class="hljs-comment">#åˆ é™¤æ–‡ä»¶</span><br><br>$ git <span class="hljs-built_in">rm</span> --cached file <span class="hljs-comment">#åœæ­¢è·Ÿè¸ªæ–‡ä»¶ä½†ä¸åˆ é™¤</span><br><br>$ git commit -m <span class="hljs-string">&quot;commit message&quot;</span> <span class="hljs-comment">#æäº¤æ‰€æœ‰æ›´æ–°è¿‡çš„æ–‡ä»¶</span><br><br>$ git commit -- amend <span class="hljs-comment">#ä¿®æ”¹æœ€åä¸€æ¬¡æäº¤</span><br></code></pre></td></tr></table></figure><h2 id="3ã€æŸ¥çœ‹å†å²æäº¤"><a href="#3ã€æŸ¥çœ‹å†å²æäº¤" class="headerlink" title="3ã€æŸ¥çœ‹å†å²æäº¤"></a>3ã€æŸ¥çœ‹å†å²æäº¤</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs bash">$ git long <span class="hljs-comment">#æŸ¥çœ‹æäº¤å†å²</span><br><br>$ git <span class="hljs-built_in">log</span> -p &lt;file&gt; <span class="hljs-comment">#æŸ¥çœ‹æŒ‡å®šæ–‡ä»¶çš„æäº¤å†å²</span><br><br>$ git blame &lt;file&gt; <span class="hljs-comment">#ä»¥åˆ—è¡¨æ–¹å¼æŸ¥çœ‹æŒ‡å®šæ–‡ä»¶çš„æäº¤å†å²</span><br></code></pre></td></tr></table></figure><h2 id="4ã€æ’¤é”€"><a href="#4ã€æ’¤é”€" class="headerlink" title="4ã€æ’¤é”€"></a>4ã€æ’¤é”€</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs bash">$ git reset --hard HEAD <span class="hljs-comment">#æ’¤é”€å·¥ä½œç›®å½•ä¸­æ‰€æœ‰æœªæäº¤æ–‡ä»¶çš„ä¿®æ”¹å†…å®¹</span><br><br>$ git checkout  HEAD file <span class="hljs-comment">#æ’¤é”€æŒ‡å®šçš„æœªæäº¤æ–‡ä»¶çš„ä¿®æ”¹å†…å®¹</span><br><br>$ git revert &lt;commit&gt; <span class="hljs-comment">#æ’¤é”€æŒ‡å®šçš„æäº¤</span><br></code></pre></td></tr></table></figure><h2 id="5ã€åˆ†æ”¯ã€æ ‡ç­¾"><a href="#5ã€åˆ†æ”¯ã€æ ‡ç­¾" class="headerlink" title="5ã€åˆ†æ”¯ã€æ ‡ç­¾"></a>5ã€åˆ†æ”¯ã€æ ‡ç­¾</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs bash">$ git branch <span class="hljs-comment">#æ˜¾ç¤ºæ‰€æœ‰æœ¬åœ°åˆ†æ”¯</span><br><br>$ git checkout &lt;branch/tag&gt; <span class="hljs-comment">#åˆ‡æ¢åˆ°æŒ‡å®šåˆ†æ”¯æˆ–æ ‡ç­¾</span><br><br>$ git branch &lt;new-branch&gt; <span class="hljs-comment">#åˆ›å»ºæ–°çš„åˆ†æ”¯</span><br><br>$ git branch -d &lt;branch&gt; <span class="hljs-comment"># åˆ é™¤æœ¬åœ°åˆ†æ”¯</span><br><br>$ git tag <span class="hljs-comment">#åˆ—å‡ºæ‰€æœ‰æœ¬åœ°æ ‡ç­¾</span><br><br>$ git tag &lt;tagname&gt; <span class="hljs-comment">#åŸºäºæœ€æ–°æäº¤åˆ›å»ºæ ‡ç­¾</span><br><br>$ git tag -d &lt;tagname&gt; <span class="hljs-comment">#åˆ é™¤æ ‡ç­¾</span><br></code></pre></td></tr></table></figure><h2 id="6ã€åˆå¹¶ä¸è¡åˆ"><a href="#6ã€åˆå¹¶ä¸è¡åˆ" class="headerlink" title="6ã€åˆå¹¶ä¸è¡åˆ"></a>6ã€åˆå¹¶ä¸è¡åˆ</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs bash">$ git merge &lt;branch&gt; <span class="hljs-comment">#åˆå¹¶æŒ‡å®šåˆ†æ”¯åˆ°å½“å‰åˆ†æ”¯</span><br><br>$ git rebase &lt;branch&gt; <span class="hljs-comment">#è¡åˆæŒ‡å®šåˆ†æ”¯åˆ°å½“å‰åˆ†æ”¯</span><br></code></pre></td></tr></table></figure><h2 id="7ã€è¿œç¨‹æ“ä½œ"><a href="#7ã€è¿œç¨‹æ“ä½œ" class="headerlink" title="7ã€è¿œç¨‹æ“ä½œ"></a>7ã€è¿œç¨‹æ“ä½œ</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs bash">$ git remote -v <span class="hljs-comment">#æŸ¥çœ‹è¿œç¨‹ç‰ˆæœ¬ä¿¡æ¯</span><br><br>$ git remote show &lt;remote&gt; <span class="hljs-comment"># æŸ¥çœ‹æŒ‡å®šè¿œç¨‹ç‰ˆæœ¬åº“çš„ä¿¡æ¯</span><br><br>$ git remote add &lt;remote&gt; url <span class="hljs-comment">#æ·»åŠ è¿œç¨‹ç‰ˆæœ¬åº“</span><br><br>$ git fetch &lt;remote&gt; <span class="hljs-comment">#ä»è¿œç¨‹è·å–ä»£ç </span><br><br>$ git pull &lt;remote&gt; &lt;branch&gt; <span class="hljs-comment">#ä¸‹è½½ä»£ç åŠå¿«é€Ÿåˆå¹¶</span><br><br>$ git push &lt;remote&gt; &lt;branch&gt; <span class="hljs-comment">#ä¸Šä¼ ä»£ç åŠå¿«é€Ÿåˆå¹¶</span><br><br>$ git push &lt;remote&gt; :&lt;branch/tag-name&gt; <span class="hljs-comment">#åˆ é™¤è¿œç¨‹åˆ†æ”¯æˆ–æ ‡ç­¾</span><br><br>$ git push --tags <span class="hljs-comment">#ä¸Šä¼ æ‰€æœ‰æ ‡ç­¾</span><br></code></pre></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>Linux</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Linux</tag>
      
      <tag>git</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>10-è¡Œä¸ºå‹-å¤‡å¿˜å½•-è®¿é—®è€…</title>
    <link href="/2022/10/19/10-xing-wei-xing-bei-wang-lu-fang-wen-zhe/"/>
    <url>/2022/10/19/10-xing-wei-xing-bei-wang-lu-fang-wen-zhe/</url>
    
    <content type="html"><![CDATA[<h1 id="ä¸€ã€å¤‡å¿˜å½•æ¨¡å¼"><a href="#ä¸€ã€å¤‡å¿˜å½•æ¨¡å¼" class="headerlink" title="ä¸€ã€å¤‡å¿˜å½•æ¨¡å¼"></a>ä¸€ã€å¤‡å¿˜å½•æ¨¡å¼</h1><p>å¤‡å¿˜å½•æ¨¡å¼å®šä¹‰ï¼šå¤‡å¿˜å½•æ¨¡å¼ï¼ˆMemento Patternï¼‰ä¿å­˜ä¸€ä¸ªå¯¹è±¡çš„æŸä¸ªçŠ¶æ€ï¼Œä»¥ä¾¿åœ¨é€‚å½“çš„æ—¶å€™æ¢å¤å¯¹è±¡ã€‚å½“ä½ éœ€è¦è®©å¯¹è±¡è¿”å›ä¹‹å‰çš„çŠ¶æ€æ—¶,å°±ä½¿ç”¨å¤‡å¿˜å½•æ¨¡å¼ã€‚å¤‡å¿˜å½•æ¨¡å¼æœ‰ä¸¤ä¸ªç›®æ ‡:å‚¨å­˜ç³»ç»Ÿå…³é”®å¯¹è±¡çš„é‡è¦çŠ¶æ€ï¼›ç»´æŠ¤å…³é”®å¯¹è±¡çš„å°è£…ã€‚</p><h2 id="1ã€ç»“æ„ä¸å®ç°"><a href="#1ã€ç»“æ„ä¸å®ç°" class="headerlink" title="1ã€ç»“æ„ä¸å®ç°"></a>1ã€ç»“æ„ä¸å®ç°</h2><h3 id="1ã€å¤‡å¿˜å½•æ¨¡å¼ç»“æ„"><a href="#1ã€å¤‡å¿˜å½•æ¨¡å¼ç»“æ„" class="headerlink" title="1ã€å¤‡å¿˜å½•æ¨¡å¼ç»“æ„"></a>1ã€å¤‡å¿˜å½•æ¨¡å¼ç»“æ„</h3><p>å‘èµ·äººï¼ˆOriginatorï¼‰è§’è‰²ï¼šè®°å½•å½“å‰æ—¶åˆ»çš„å†…éƒ¨çŠ¶æ€ä¿¡æ¯ï¼Œæä¾›åˆ›å»ºå¤‡å¿˜å½•å’Œæ¢å¤å¤‡å¿˜å½•æ•°æ®çš„åŠŸèƒ½ï¼Œå®ç°å…¶ä»–ä¸šåŠ¡åŠŸèƒ½ï¼Œå®ƒå¯ä»¥è®¿é—®å¤‡å¿˜å½•é‡Œçš„æ‰€æœ‰ä¿¡æ¯ã€‚</p><p>å¤‡å¿˜å½•ï¼ˆMementoï¼‰è§’è‰²ï¼šè´Ÿè´£å­˜å‚¨å‘èµ·äººçš„å†…éƒ¨çŠ¶æ€ï¼Œåœ¨éœ€è¦çš„æ—¶å€™æä¾›è¿™äº›å†…éƒ¨çŠ¶æ€ç»™å‘èµ·äººã€‚</p><p>ç®¡ç†è€…ï¼ˆCaretakerï¼‰è§’è‰²ï¼šå¯¹å¤‡å¿˜å½•è¿›è¡Œç®¡ç†ï¼Œæä¾›ä¿å­˜ä¸è·å–å¤‡å¿˜å½•çš„åŠŸèƒ½ï¼Œä½†å…¶ä¸èƒ½å¯¹å¤‡å¿˜å½•çš„å†…å®¹è¿›è¡Œè®¿é—®ä¸ä¿®æ”¹ã€‚</p><p>å¤‡å¿˜å½•æœ‰ä¸¤ä¸ªç­‰æ•ˆçš„æ¥å£ï¼š</p><ul><li><strong>çª„æ¥å£</strong>ï¼šç®¡ç†è€…(Caretaker)å¯¹è±¡ï¼ˆå’Œå…¶ä»–å‘èµ·äººå¯¹è±¡ä¹‹å¤–çš„ä»»ä½•å¯¹è±¡ï¼‰çœ‹åˆ°çš„æ˜¯å¤‡å¿˜å½•çš„çª„æ¥å£(narror Interface)ï¼Œè¿™ä¸ªçª„æ¥å£åªå…è®¸ä»–æŠŠå¤‡å¿˜å½•å¯¹è±¡ä¼ ç»™å…¶ä»–çš„å¯¹è±¡ã€‚</li><li><strong>å®½æ¥å£</strong>ï¼šä¸ç®¡ç†è€…çœ‹åˆ°çš„çª„æ¥å£ç›¸åï¼Œå‘èµ·äººå¯¹è±¡å¯ä»¥çœ‹åˆ°ä¸€ä¸ªå®½æ¥å£(wide Interface)ï¼Œè¿™ä¸ªå®½æ¥å£å…è®¸å®ƒè¯»å–æ‰€æœ‰çš„æ•°æ®ï¼Œä»¥ä¾¿æ ¹æ®è¿™äº›æ•°æ®æ¢å¤è¿™ä¸ªå‘èµ·äººå¯¹è±¡çš„å†…éƒ¨çŠ¶æ€ã€‚</li></ul><h3 id="2ã€å¤‡å¿˜å½•æ¨¡å¼ä»£ç å®ç°"><a href="#2ã€å¤‡å¿˜å½•æ¨¡å¼ä»£ç å®ç°" class="headerlink" title="2ã€å¤‡å¿˜å½•æ¨¡å¼ä»£ç å®ç°"></a>2ã€å¤‡å¿˜å½•æ¨¡å¼ä»£ç å®ç°</h3><p>Demoæ¡ˆä¾‹-æ‰“Boss</p><p>æ¸¸æˆä¸­çš„æŸä¸ªåœºæ™¯ï¼Œä¸€æ¸¸æˆè§’è‰²æœ‰ç”Ÿå‘½åŠ›ã€æ”»å‡»åŠ›ã€é˜²å¾¡åŠ›ç­‰æ•°æ®ï¼Œåœ¨æ‰“Bosså‰å’Œåä¸€å®šä¼šä¸ä¸€æ ·çš„ï¼Œæˆ‘ä»¬å…è®¸ç©å®¶å¦‚æœæ„Ÿè§‰ä¸Bosså†³æ–—çš„æ•ˆæœä¸ç†æƒ³å¯ä»¥è®©æ¸¸æˆæ¢å¤åˆ°å†³æ–—ä¹‹å‰çš„çŠ¶æ€ã€‚</p><p>è¦å®ç°ä¸Šè¿°æ¡ˆä¾‹ï¼Œæœ‰ä¸¤ç§æ–¹å¼ï¼š</p><ul><li>â€œç™½ç®±â€å¤‡å¿˜å½•æ¨¡å¼</li><li>â€œé»‘ç®±â€å¤‡å¿˜å½•æ¨¡å¼</li></ul><h4 id="1ã€ç™½ç®±å¤‡å¿˜å½•æ¨¡å¼"><a href="#1ã€ç™½ç®±å¤‡å¿˜å½•æ¨¡å¼" class="headerlink" title="1ã€ç™½ç®±å¤‡å¿˜å½•æ¨¡å¼"></a>1ã€ç™½ç®±å¤‡å¿˜å½•æ¨¡å¼</h4><p>å¤‡å¿˜å½•è§’è‰²å¯¹ä»»ä½•å¯¹è±¡éƒ½æä¾›ä¸€ä¸ªæ¥å£ï¼Œå³å®½æ¥å£ï¼Œå¤‡å¿˜å½•è§’è‰²çš„å†…éƒ¨æ‰€å­˜å‚¨çš„çŠ¶æ€å°±å¯¹æ‰€æœ‰å¯¹è±¡å…¬å¼€</p><p>å…³ç³»ç±»å›¾ï¼š</p><p><img src="/2022/10/19/10-xing-wei-xing-bei-wang-lu-fang-wen-zhe/image-20221020110410991.png"></p><h5 id="1ã€GameRole"><a href="#1ã€GameRole" class="headerlink" title="1ã€GameRole"></a>1ã€GameRole</h5><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">GameRole</span> &#123;<br><br>    <span class="hljs-keyword">private</span> <span class="hljs-type">int</span> vit;<span class="hljs-comment">//ç”Ÿå‘½åŠ›</span><br>    <span class="hljs-keyword">private</span> <span class="hljs-type">int</span> atk;<span class="hljs-comment">//æ”»å‡»åŠ›</span><br>    <span class="hljs-keyword">private</span> <span class="hljs-type">int</span> def;<span class="hljs-comment">//é˜²å¾¡åŠ›</span><br><br>    <span class="hljs-comment">//åˆå§‹åŒ–çŠ¶æ€</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">initState</span><span class="hljs-params">()</span> &#123;<br>        <span class="hljs-built_in">this</span>.vit = <span class="hljs-number">100</span>;<br>        <span class="hljs-built_in">this</span>.atk = <span class="hljs-number">100</span>;<br>        <span class="hljs-built_in">this</span>.def = <span class="hljs-number">100</span>;<br>    &#125;<br><br>    <span class="hljs-comment">//æˆ˜æ–—</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">fight</span><span class="hljs-params">()</span> &#123;<br>        <span class="hljs-built_in">this</span>.vit = <span class="hljs-number">0</span>;<br>        <span class="hljs-built_in">this</span>.atk = <span class="hljs-number">0</span>;<br>        <span class="hljs-built_in">this</span>.def = <span class="hljs-number">0</span>;<br>    &#125;<br><br>    <span class="hljs-comment">//ä¿å­˜è§’è‰²çŠ¶æ€</span><br>    <span class="hljs-keyword">public</span> RoleStateMemento <span class="hljs-title function_">saveState</span><span class="hljs-params">()</span> &#123;<br>        <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">RoleStateMemento</span>(vit, atk, def);<br>    &#125;<br><br>    <span class="hljs-comment">//æ¢å¤è§’è‰²çŠ¶æ€</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">recoverState</span><span class="hljs-params">(RoleStateMemento roleStateMemento)</span> &#123;<br>        <span class="hljs-built_in">this</span>.vit = roleStateMemento.getVit();<br>        <span class="hljs-built_in">this</span>.atk = roleStateMemento.getAtk();<br>        <span class="hljs-built_in">this</span>.def = roleStateMemento.getDef();<br>    &#125;<br><br>    <span class="hljs-comment">//å±•ç¤ºçŠ¶æ€</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">stateDisplay</span><span class="hljs-params">()</span> &#123;<br>        System.out.println(<span class="hljs-string">&quot;è§’è‰²ç”Ÿå‘½åŠ›&quot;</span> + vit);<br>        System.out.println(<span class="hljs-string">&quot;è§’è‰²æ”»å‡»åŠ›&quot;</span> + atk);<br>        System.out.println(<span class="hljs-string">&quot;è§’è‰²é˜²å¾¡åŠ›&quot;</span> + def);<br>    &#125;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-type">int</span> <span class="hljs-title function_">getVit</span><span class="hljs-params">()</span> &#123;<br>        <span class="hljs-keyword">return</span> vit;<br>    &#125;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">setVit</span><span class="hljs-params">(<span class="hljs-type">int</span> vit)</span> &#123;<br>        <span class="hljs-built_in">this</span>.vit = vit;<br>    &#125;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-type">int</span> <span class="hljs-title function_">getAtk</span><span class="hljs-params">()</span> &#123;<br>        <span class="hljs-keyword">return</span> atk;<br>    &#125;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">setAtk</span><span class="hljs-params">(<span class="hljs-type">int</span> atk)</span> &#123;<br>        <span class="hljs-built_in">this</span>.atk = atk;<br>    &#125;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-type">int</span> <span class="hljs-title function_">getDef</span><span class="hljs-params">()</span> &#123;<br>        <span class="hljs-keyword">return</span> def;<br>    &#125;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">setDef</span><span class="hljs-params">(<span class="hljs-type">int</span> def)</span> &#123;<br>        <span class="hljs-built_in">this</span>.def = def;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><h5 id="2ã€RoleStateMemento"><a href="#2ã€RoleStateMemento" class="headerlink" title="2ã€RoleStateMemento"></a>2ã€RoleStateMemento</h5><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">RoleStateMemento</span> &#123;<br>    <span class="hljs-keyword">private</span> <span class="hljs-type">int</span> vit;<br>    <span class="hljs-keyword">private</span> <span class="hljs-type">int</span> atk;<br>    <span class="hljs-keyword">private</span> <span class="hljs-type">int</span> def;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-title function_">RoleStateMemento</span><span class="hljs-params">(<span class="hljs-type">int</span> vit, <span class="hljs-type">int</span> atk, <span class="hljs-type">int</span> def)</span> &#123;<br>        <span class="hljs-built_in">this</span>.vit = vit;<br>        <span class="hljs-built_in">this</span>.atk = atk;<br>        <span class="hljs-built_in">this</span>.def = def;<br>    &#125;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-type">int</span> <span class="hljs-title function_">getVit</span><span class="hljs-params">()</span> &#123;<br>        <span class="hljs-keyword">return</span> vit;<br>    &#125;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">setVit</span><span class="hljs-params">(<span class="hljs-type">int</span> vit)</span> &#123;<br>        <span class="hljs-built_in">this</span>.vit = vit;<br>    &#125;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-type">int</span> <span class="hljs-title function_">getAtk</span><span class="hljs-params">()</span> &#123;<br>        <span class="hljs-keyword">return</span> atk;<br>    &#125;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">setAtk</span><span class="hljs-params">(<span class="hljs-type">int</span> atk)</span> &#123;<br>        <span class="hljs-built_in">this</span>.atk = atk;<br>    &#125;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-type">int</span> <span class="hljs-title function_">getDef</span><span class="hljs-params">()</span> &#123;<br>        <span class="hljs-keyword">return</span> def;<br>    &#125;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">setDef</span><span class="hljs-params">(<span class="hljs-type">int</span> def)</span> &#123;<br>        <span class="hljs-built_in">this</span>.def = def;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><h5 id="3ã€RoleStateCaretaker"><a href="#3ã€RoleStateCaretaker" class="headerlink" title="3ã€RoleStateCaretaker"></a>3ã€RoleStateCaretaker</h5><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">RoleStateCaretaker</span> &#123;<br>    <span class="hljs-keyword">private</span> RoleStateMemento roleStateMemento;<br><br>    <span class="hljs-keyword">public</span> RoleStateMemento <span class="hljs-title function_">getRoleStateMemento</span><span class="hljs-params">()</span> &#123;<br>        <span class="hljs-keyword">return</span> roleStateMemento;<br>    &#125;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">setRoleStateMemento</span><span class="hljs-params">(RoleStateMemento roleStateMemento)</span> &#123;<br>        <span class="hljs-built_in">this</span>.roleStateMemento = roleStateMemento;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><h5 id="4ã€Client"><a href="#4ã€Client" class="headerlink" title="4ã€Client"></a>4ã€Client</h5><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Client</span> &#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span> &#123;<br>        System.out.println(<span class="hljs-string">&quot;--------------å¤§æˆ˜Bosså‰------------------------&quot;</span>);<br>        <span class="hljs-comment">//å¤§æˆ˜Bosså‰</span><br>        <span class="hljs-type">GameRole</span> <span class="hljs-variable">gameRole</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">GameRole</span>();<br>        gameRole.initState();<br>        gameRole.stateDisplay();<br><br>        <span class="hljs-comment">//ä¿å­˜è¿›åº¦</span><br>        <span class="hljs-type">RoleStateCaretaker</span> <span class="hljs-variable">roleStateCaretaker</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">RoleStateCaretaker</span>();<br>        roleStateCaretaker.setRoleStateMemento(gameRole.saveState());<br><br>        System.out.println(<span class="hljs-string">&quot;--------------å¤§æˆ˜Bosså------------------------&quot;</span>);<br>        <span class="hljs-comment">//å¤§æˆ˜Boss æŸè€—ä¸¥é‡</span><br>        gameRole.fight();<br>        gameRole.stateDisplay();<br><br>        System.out.println(<span class="hljs-string">&quot;--------------æ»¡è¡€å¤æ´»------------------------&quot;</span>);<br>        gameRole.recoverState(roleStateCaretaker.getRoleStateMemento());<br>        gameRole.stateDisplay();<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><h5 id="5ã€ç»“æœ"><a href="#5ã€ç»“æœ" class="headerlink" title="5ã€ç»“æœ"></a>5ã€ç»“æœ</h5><p><img src="/2022/10/19/10-xing-wei-xing-bei-wang-lu-fang-wen-zhe/image-20221020105645535.png"></p><h4 id="2ã€é»‘ç®±å¤‡å¿˜å½•æ¨¡å¼"><a href="#2ã€é»‘ç®±å¤‡å¿˜å½•æ¨¡å¼" class="headerlink" title="2ã€é»‘ç®±å¤‡å¿˜å½•æ¨¡å¼"></a>2ã€é»‘ç®±å¤‡å¿˜å½•æ¨¡å¼</h4><p>å°† <code>RoleStateMemento</code> è®¾ä¸º <code>GameRole</code> çš„å†…éƒ¨ç±»ï¼Œä»è€Œå°† <code>RoleStateMemento</code> å¯¹è±¡å°è£…åœ¨ <code>GameRole</code> é‡Œé¢ï¼›åœ¨å¤–é¢æä¾›ä¸€ä¸ªæ ‡è¯†æ¥å£ <code>Memento</code> ç»™ <code>RoleStateCaretaker</code> åŠå…¶ä»–å¯¹è±¡ä½¿ç”¨ã€‚è¿™æ · <code>GameRole</code> ç±»çœ‹åˆ°çš„æ˜¯ <code>RoleStateMemento</code> æ‰€æœ‰çš„æ¥å£ï¼Œè€Œ<code>RoleStateCaretaker</code> åŠå…¶ä»–å¯¹è±¡çœ‹åˆ°çš„ä»…ä»…æ˜¯æ ‡è¯†æ¥å£ <code>Memento</code> æ‰€æš´éœ²å‡ºæ¥çš„æ¥å£ï¼Œä»è€Œç»´æŠ¤äº†å°è£…å‹ã€‚ç±»å›¾å¦‚ä¸‹ï¼š</p><p><img src="/2022/10/19/10-xing-wei-xing-bei-wang-lu-fang-wen-zhe/image-20221020111221487.png"></p><h5 id="1ã€GameRole-1"><a href="#1ã€GameRole-1" class="headerlink" title="1ã€GameRole"></a>1ã€GameRole</h5><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">GameRole</span> &#123;<br><br>    <span class="hljs-keyword">private</span> <span class="hljs-type">int</span> vit;<span class="hljs-comment">//ç”Ÿå‘½åŠ›</span><br>    <span class="hljs-keyword">private</span> <span class="hljs-type">int</span> atk;<span class="hljs-comment">//æ”»å‡»åŠ›</span><br>    <span class="hljs-keyword">private</span> <span class="hljs-type">int</span> def;<span class="hljs-comment">//é˜²å¾¡åŠ›</span><br><br>    <span class="hljs-comment">//åˆå§‹åŒ–çŠ¶æ€</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">initState</span><span class="hljs-params">()</span> &#123;<br>        <span class="hljs-built_in">this</span>.vit = <span class="hljs-number">100</span>;<br>        <span class="hljs-built_in">this</span>.atk = <span class="hljs-number">100</span>;<br>        <span class="hljs-built_in">this</span>.def = <span class="hljs-number">100</span>;<br>    &#125;<br><br>    <span class="hljs-comment">//æˆ˜æ–—</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">fight</span><span class="hljs-params">()</span> &#123;<br>        <span class="hljs-built_in">this</span>.vit = <span class="hljs-number">0</span>;<br>        <span class="hljs-built_in">this</span>.atk = <span class="hljs-number">0</span>;<br>        <span class="hljs-built_in">this</span>.def = <span class="hljs-number">0</span>;<br>    &#125;<br><br>    <span class="hljs-comment">//ä¿å­˜è§’è‰²çŠ¶æ€</span><br>    <span class="hljs-keyword">public</span> Memento <span class="hljs-title function_">saveState</span><span class="hljs-params">()</span> &#123;<br>        <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">RoleStateMemento</span>(vit, atk, def);<br>    &#125;<br><br>    <span class="hljs-comment">//æ¢å¤è§’è‰²çŠ¶æ€</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">recoverState</span><span class="hljs-params">(Memento memento)</span> &#123;<br>        <span class="hljs-type">RoleStateMemento</span> <span class="hljs-variable">roleStateMemento</span> <span class="hljs-operator">=</span> (RoleStateMemento) memento;<br>        <span class="hljs-built_in">this</span>.vit = roleStateMemento.getVit();<br>        <span class="hljs-built_in">this</span>.atk = roleStateMemento.getAtk();<br>        <span class="hljs-built_in">this</span>.def = roleStateMemento.getDef();<br>    &#125;<br><br>    <span class="hljs-comment">//å±•ç¤ºçŠ¶æ€</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">stateDisplay</span><span class="hljs-params">()</span> &#123;<br>        System.out.println(<span class="hljs-string">&quot;è§’è‰²ç”Ÿå‘½åŠ›&quot;</span> + vit);<br>        System.out.println(<span class="hljs-string">&quot;è§’è‰²æ”»å‡»åŠ›&quot;</span> + atk);<br>        System.out.println(<span class="hljs-string">&quot;è§’è‰²é˜²å¾¡åŠ›&quot;</span> + def);<br>    &#125;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-type">int</span> <span class="hljs-title function_">getVit</span><span class="hljs-params">()</span> &#123;<br>        <span class="hljs-keyword">return</span> vit;<br>    &#125;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">setVit</span><span class="hljs-params">(<span class="hljs-type">int</span> vit)</span> &#123;<br>        <span class="hljs-built_in">this</span>.vit = vit;<br>    &#125;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-type">int</span> <span class="hljs-title function_">getAtk</span><span class="hljs-params">()</span> &#123;<br>        <span class="hljs-keyword">return</span> atk;<br>    &#125;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">setAtk</span><span class="hljs-params">(<span class="hljs-type">int</span> atk)</span> &#123;<br>        <span class="hljs-built_in">this</span>.atk = atk;<br>    &#125;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-type">int</span> <span class="hljs-title function_">getDef</span><span class="hljs-params">()</span> &#123;<br>        <span class="hljs-keyword">return</span> def;<br>    &#125;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">setDef</span><span class="hljs-params">(<span class="hljs-type">int</span> def)</span> &#123;<br>        <span class="hljs-built_in">this</span>.def = def;<br>    &#125;<br><br>    <span class="hljs-comment">//åœ¨å†…éƒ¨å®šä¹‰å¤‡å¿˜å½•å†…éƒ¨ç±» RoleStateMementoï¼ˆè¯¥å†…éƒ¨ç±»è®¾ç½®ä¸ºç§æœ‰çš„ï¼‰</span><br><br>    <span class="hljs-keyword">private</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">RoleStateMemento</span> <span class="hljs-keyword">implements</span> <span class="hljs-title class_">Memento</span> &#123;<br>        <span class="hljs-keyword">private</span> <span class="hljs-type">int</span> vit;<br>        <span class="hljs-keyword">private</span> <span class="hljs-type">int</span> atk;<br>        <span class="hljs-keyword">private</span> <span class="hljs-type">int</span> def;<br><br>        <span class="hljs-keyword">public</span> <span class="hljs-title function_">RoleStateMemento</span><span class="hljs-params">(<span class="hljs-type">int</span> vit, <span class="hljs-type">int</span> atk, <span class="hljs-type">int</span> def)</span> &#123;<br>            <span class="hljs-built_in">this</span>.vit = vit;<br>            <span class="hljs-built_in">this</span>.atk = atk;<br>            <span class="hljs-built_in">this</span>.def = def;<br>        &#125;<br><br>        <span class="hljs-keyword">public</span> <span class="hljs-type">int</span> <span class="hljs-title function_">getVit</span><span class="hljs-params">()</span> &#123;<br>            <span class="hljs-keyword">return</span> vit;<br>        &#125;<br><br>        <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">setVit</span><span class="hljs-params">(<span class="hljs-type">int</span> vit)</span> &#123;<br>            <span class="hljs-built_in">this</span>.vit = vit;<br>        &#125;<br><br>        <span class="hljs-keyword">public</span> <span class="hljs-type">int</span> <span class="hljs-title function_">getAtk</span><span class="hljs-params">()</span> &#123;<br>            <span class="hljs-keyword">return</span> atk;<br>        &#125;<br><br>        <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">setAtk</span><span class="hljs-params">(<span class="hljs-type">int</span> atk)</span> &#123;<br>            <span class="hljs-built_in">this</span>.atk = atk;<br>        &#125;<br><br>        <span class="hljs-keyword">public</span> <span class="hljs-type">int</span> <span class="hljs-title function_">getDef</span><span class="hljs-params">()</span> &#123;<br>            <span class="hljs-keyword">return</span> def;<br>        &#125;<br><br>        <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">setDef</span><span class="hljs-params">(<span class="hljs-type">int</span> def)</span> &#123;<br>            <span class="hljs-built_in">this</span>.def = def;<br>        &#125;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><h5 id="2ã€Memento"><a href="#2ã€Memento" class="headerlink" title="2ã€Memento"></a>2ã€Memento</h5><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">interface</span> <span class="hljs-title class_">Memento</span> &#123;<br>&#125;<br></code></pre></td></tr></table></figure><h5 id="3ã€RoleStateCaretaker-1"><a href="#3ã€RoleStateCaretaker-1" class="headerlink" title="3ã€RoleStateCaretaker"></a>3ã€RoleStateCaretaker</h5><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">RoleStateCaretaker</span> &#123;<br>    <span class="hljs-keyword">private</span> Memento memento;<br><br>    <span class="hljs-keyword">public</span> Memento <span class="hljs-title function_">getMemento</span><span class="hljs-params">()</span> &#123;<br>        <span class="hljs-keyword">return</span> memento;<br>    &#125;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">setMemento</span><span class="hljs-params">(Memento memento)</span> &#123;<br>        <span class="hljs-built_in">this</span>.memento = memento;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><h5 id="4ã€Client-1"><a href="#4ã€Client-1" class="headerlink" title="4ã€Client"></a>4ã€Client</h5><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Client</span> &#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span> &#123;<br>        System.out.println(<span class="hljs-string">&quot;--------------å¤§æˆ˜Bosså‰------------------------&quot;</span>);<br>        <span class="hljs-comment">//å¤§æˆ˜Bosså‰</span><br>        <span class="hljs-type">GameRole</span> <span class="hljs-variable">gameRole</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">GameRole</span>();<br>        gameRole.initState();<br>        gameRole.stateDisplay();<br><br>        <span class="hljs-comment">//ä¿å­˜è¿›åº¦</span><br>        <span class="hljs-type">RoleStateCaretaker</span> <span class="hljs-variable">roleStateCaretaker</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">RoleStateCaretaker</span>();<br>        roleStateCaretaker.setMemento(gameRole.saveState());<br><br>        System.out.println(<span class="hljs-string">&quot;--------------å¤§æˆ˜Bosså------------------------&quot;</span>);<br>        <span class="hljs-comment">//å¤§æˆ˜Boss æŸè€—ä¸¥é‡</span><br>        gameRole.fight();<br>        gameRole.stateDisplay();<br><br>        System.out.println(<span class="hljs-string">&quot;--------------æ»¡è¡€å¤æ´»------------------------&quot;</span>);<br>        gameRole.recoverState(roleStateCaretaker.getMemento());<br>        gameRole.stateDisplay();<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><h5 id="5ã€ç»“æœ-1"><a href="#5ã€ç»“æœ-1" class="headerlink" title="5ã€ç»“æœ"></a>5ã€ç»“æœ</h5><p><img src="/2022/10/19/10-xing-wei-xing-bei-wang-lu-fang-wen-zhe/image-20221020111438140.png"></p><h2 id="2ã€ä¼˜ç¼ºç‚¹"><a href="#2ã€ä¼˜ç¼ºç‚¹" class="headerlink" title="2ã€ä¼˜ç¼ºç‚¹"></a>2ã€ä¼˜ç¼ºç‚¹</h2><p><strong>ä¼˜ç‚¹ï¼š</strong></p><ul><li>å®ƒæä¾›äº†ä¸€ç§çŠ¶æ€æ¢å¤çš„å®ç°æœºåˆ¶ï¼Œä½¿å¾—ç”¨æˆ·å¯ä»¥æ–¹ä¾¿åœ°å›åˆ°ä¸€ä¸ªç‰¹å®šçš„å†å²æ­¥éª¤ï¼Œå½“æ–°çš„çŠ¶æ€æ— æ•ˆæˆ–è€…å­˜åœ¨é—®é¢˜æ—¶ï¼Œå¯ä»¥ä½¿ç”¨æš‚æ—¶å­˜å‚¨èµ·æ¥çš„å¤‡å¿˜å½•å°†çŠ¶æ€å¤åŸã€‚</li><li>å¤‡å¿˜å½•å®ç°äº†å¯¹ä¿¡æ¯çš„å°è£…ï¼Œä¸€ä¸ªå¤‡å¿˜å½•å¯¹è±¡æ˜¯ä¸€ç§åŸå‘å™¨å¯¹è±¡çŠ¶æ€çš„è¡¨ç¤ºï¼Œä¸ä¼šè¢«å…¶ä»–ä»£ç æ‰€æ”¹åŠ¨ã€‚å¤‡å¿˜å½•ä¿å­˜äº†åŸå‘å™¨çš„çŠ¶æ€ï¼Œé‡‡ç”¨åˆ—è¡¨ã€å †æ ˆç­‰é›†åˆæ¥å­˜å‚¨å¤‡å¿˜å½•å¯¹è±¡å¯ä»¥å®ç°å¤šæ¬¡æ’¤é”€æ“ä½œã€‚</li></ul><p><strong>ç¼ºç‚¹ï¼š</strong></p><ul><li>èµ„æºæ¶ˆè€—è¿‡å¤§ï¼Œå¦‚æœéœ€è¦ä¿å­˜çš„åŸå‘å™¨ç±»çš„æˆå‘˜å˜é‡å¤ªå¤šï¼Œå°±ä¸å¯é¿å…éœ€è¦å ç”¨å¤§é‡çš„å­˜å‚¨ç©ºé—´ï¼Œæ¯ä¿å­˜ä¸€æ¬¡å¯¹è±¡çš„çŠ¶æ€éƒ½éœ€è¦æ¶ˆè€—ä¸€å®šçš„ç³»ç»Ÿèµ„æºã€‚</li></ul><h2 id="3ã€åº”ç”¨åœºæ™¯"><a href="#3ã€åº”ç”¨åœºæ™¯" class="headerlink" title="3ã€åº”ç”¨åœºæ™¯"></a>3ã€åº”ç”¨åœºæ™¯</h2><ul><li>éœ€è¦ä¿å­˜ä¸æ¢å¤æ•°æ®çš„åœºæ™¯ï¼Œå¦‚ç©æ¸¸æˆæ—¶çš„ä¸­é—´ç»“æœçš„å­˜æ¡£åŠŸèƒ½ã€‚</li><li>éœ€è¦æä¾›ä¸€ä¸ªå¯å›æ»šæ“ä½œçš„åœºæ™¯ï¼Œå¦‚ Wordã€è®°äº‹æœ¬ã€Photoshopï¼Œideaç­‰è½¯ä»¶åœ¨ç¼–è¾‘æ—¶æŒ‰ Ctrl+Z ç»„åˆé”®ï¼Œè¿˜æœ‰æ•°æ®åº“ä¸­äº‹åŠ¡æ“ä½œã€‚</li></ul><p>å‚è€ƒï¼š<a href="https://juejin.cn/post/6975288482927214605">è®¾è®¡æ¨¡å¼å­¦ä¹ 21-å¤‡å¿˜å½•æ¨¡å¼</a></p><h1 id="äºŒã€è®¿é—®è€…æ¨¡å¼"><a href="#äºŒã€è®¿é—®è€…æ¨¡å¼" class="headerlink" title="äºŒã€è®¿é—®è€…æ¨¡å¼"></a>äºŒã€è®¿é—®è€…æ¨¡å¼</h1><p>å®šä¹‰ï¼šè®¿é—®è€…ï¼ˆVisitorï¼‰æ¨¡å¼çš„å®šä¹‰ï¼š<strong>å°†ä½œç”¨äºæŸç§æ•°æ®ç»“æ„ä¸­çš„å„å…ƒç´ çš„æ“ä½œåˆ†ç¦»å‡ºæ¥å°è£…æˆç‹¬ç«‹çš„ç±»ï¼Œä½¿å…¶åœ¨ä¸æ”¹å˜æ•°æ®ç»“æ„çš„å‰æä¸‹å¯ä»¥æ·»åŠ ä½œç”¨äºè¿™äº›å…ƒç´ çš„æ–°çš„æ“ä½œï¼Œä¸ºæ•°æ®ç»“æ„ä¸­çš„æ¯ä¸ªå…ƒç´ æä¾›å¤šç§è®¿é—®æ–¹å¼ã€‚</strong>å®ƒå°†å¯¹æ•°æ®çš„æ“ä½œä¸æ•°æ®ç»“æ„è¿›è¡Œåˆ†ç¦»ï¼Œæ˜¯è¡Œä¸ºç±»æ¨¡å¼ä¸­æœ€å¤æ‚çš„ä¸€ç§æ¨¡å¼ã€‚</p><h2 id="1ã€ç»“æ„ä¸å®ç°-1"><a href="#1ã€ç»“æ„ä¸å®ç°-1" class="headerlink" title="1ã€ç»“æ„ä¸å®ç°"></a>1ã€ç»“æ„ä¸å®ç°</h2><h3 id="1ã€è®¿é—®è€…æ¨¡å¼ç»“æ„"><a href="#1ã€è®¿é—®è€…æ¨¡å¼ç»“æ„" class="headerlink" title="1ã€è®¿é—®è€…æ¨¡å¼ç»“æ„"></a>1ã€è®¿é—®è€…æ¨¡å¼ç»“æ„</h3><p>æŠ½è±¡è®¿é—®è€…ï¼ˆVisitorï¼‰è§’è‰²ï¼šå®šä¹‰ä¸€ä¸ªè®¿é—®å…·ä½“å…ƒç´ çš„æ¥å£ï¼Œä¸ºæ¯ä¸ªå…·ä½“å…ƒç´ ç±»å¯¹åº”ä¸€ä¸ªè®¿é—®æ“ä½œ visit() ï¼Œè¯¥æ“ä½œä¸­çš„å‚æ•°ç±»å‹æ ‡è¯†äº†è¢«è®¿é—®çš„å…·ä½“å…ƒç´ ã€‚</p><p>å…·ä½“è®¿é—®è€…ï¼ˆConcreteVisitorï¼‰è§’è‰²ï¼šå®ç°æŠ½è±¡è®¿é—®è€…è§’è‰²ä¸­å£°æ˜çš„å„ä¸ªè®¿é—®æ“ä½œï¼Œç¡®å®šè®¿é—®è€…è®¿é—®ä¸€ä¸ªå…ƒç´ æ—¶è¯¥åšä»€ä¹ˆã€‚</p><p>æŠ½è±¡å…ƒç´ ï¼ˆElementï¼‰è§’è‰²ï¼šå£°æ˜ä¸€ä¸ªåŒ…å«æ¥å—æ“ä½œ accept() çš„æ¥å£ï¼Œè¢«æ¥å—çš„è®¿é—®è€…å¯¹è±¡ä½œä¸º accept() æ–¹æ³•çš„å‚æ•°ã€‚</p><p>å…·ä½“å…ƒç´ ï¼ˆConcreteElementï¼‰è§’è‰²ï¼šå®ç°æŠ½è±¡å…ƒç´ è§’è‰²æä¾›çš„ accept() æ“ä½œï¼Œå…¶æ–¹æ³•ä½“é€šå¸¸éƒ½æ˜¯ visitor.visit(this) ï¼Œå¦å¤–å…·ä½“å…ƒç´ ä¸­å¯èƒ½è¿˜åŒ…å«æœ¬èº«ä¸šåŠ¡é€»è¾‘çš„ç›¸å…³æ“ä½œã€‚</p><p>å¯¹è±¡ç»“æ„ï¼ˆObject Structureï¼‰è§’è‰²ï¼šæ˜¯ä¸€ä¸ªåŒ…å«å…ƒç´ è§’è‰²çš„å®¹å™¨ï¼Œæä¾›è®©è®¿é—®è€…å¯¹è±¡éå†å®¹å™¨ä¸­çš„æ‰€æœ‰å…ƒç´ çš„æ–¹æ³•ï¼Œé€šå¸¸ç”± Listã€Setã€Map ç­‰èšåˆç±»å®ç°ã€‚</p><h3 id="2ã€è®¿é—®è€…æ¨¡å¼ä»£ç å®ç°"><a href="#2ã€è®¿é—®è€…æ¨¡å¼ä»£ç å®ç°" class="headerlink" title="2ã€è®¿é—®è€…æ¨¡å¼ä»£ç å®ç°"></a>2ã€è®¿é—®è€…æ¨¡å¼ä»£ç å®ç°</h3><p>ä¸€ä¸ªDemoæ¡ˆä¾‹-å–‚å…»å® ç‰©</p><p>ç°åœ¨å…»å® ç‰©çš„äººç‰¹åˆ«å¤šï¼Œå°±ä»¥è¿™ä¸ªä¸ºä¾‹ï¼Œå½“ç„¶å® ç‰©è¿˜åˆ†ä¸ºç‹—ï¼ŒçŒ«ç­‰ï¼Œè¦ç»™å® ç‰©å–‚é£Ÿçš„è¯ï¼Œä¸»äººå¯ä»¥å–‚ï¼Œå…¶ä»–äººä¹Ÿå¯ä»¥å–‚é£Ÿã€‚</p><p>ä»¥ä¸Šäº”ä¸ªç»“æ„åˆ†åˆ«å¯¹åº”å¦‚ä¸‹:</p><ul><li>è®¿é—®è€…è§’è‰²ï¼šç»™å® ç‰©å–‚é£Ÿçš„äºº</li><li>å…·ä½“è®¿é—®è€…è§’è‰²ï¼šä¸»äººã€å…¶ä»–äºº</li><li>æŠ½è±¡å…ƒç´ è§’è‰²ï¼šåŠ¨ç‰©æŠ½è±¡ç±»</li><li>å…·ä½“å…ƒç´ è§’è‰²ï¼šå® ç‰©ç‹—ã€å® ç‰©çŒ«</li><li>ç»“æ„å¯¹è±¡è§’è‰²ï¼šä¸»äººå®¶</li></ul><h4 id="1ã€Person"><a href="#1ã€Person" class="headerlink" title="1ã€Person"></a>1ã€Person</h4><p><em>æŠ½è±¡è®¿é—®è€…æ¥å£</em></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">interface</span> <span class="hljs-title class_">Person</span> &#123;<br>    <span class="hljs-comment">//å–‚å® ç‰©ç‹—</span><br>    <span class="hljs-keyword">void</span> <span class="hljs-title function_">feed</span><span class="hljs-params">(Dog dog)</span>;<br><br>    <span class="hljs-comment">//å–‚å® ç‰©çŒ«</span><br>    <span class="hljs-keyword">void</span> <span class="hljs-title function_">feed</span><span class="hljs-params">(Cat cat)</span>;<br>&#125;<br></code></pre></td></tr></table></figure><h4 id="2ã€Owner"><a href="#2ã€Owner" class="headerlink" title="2ã€Owner"></a>2ã€Owner</h4><p><em>å…·ä½“è®¿é—®è€…è§’è‰² ä¸»äººç±»</em></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Owner</span> <span class="hljs-keyword">implements</span> <span class="hljs-title class_">Person</span> &#123;<br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">feed</span><span class="hljs-params">(Dog dog)</span> &#123;<br>        System.out.println(<span class="hljs-string">&quot;ä¸»äººå–‚é£Ÿå® ç‰©ç‹—...&quot;</span>);<br>    &#125;<br><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">feed</span><span class="hljs-params">(Cat cat)</span> &#123;<br>        System.out.println(<span class="hljs-string">&quot;ä¸»äººå–‚é£Ÿå® ç‰©çŒ«...&quot;</span>);<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><h4 id="3ã€Someone"><a href="#3ã€Someone" class="headerlink" title="3ã€Someone"></a>3ã€Someone</h4><p><em>å…·ä½“è®¿é—®è€…è§’è‰² å…¶ä»–äººç±»</em></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Someone</span> <span class="hljs-keyword">implements</span> <span class="hljs-title class_">Person</span> &#123;<br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">feed</span><span class="hljs-params">(Dog dog)</span> &#123;<br>        System.out.println(<span class="hljs-string">&quot;å…¶ä»–äººå–‚é£Ÿå® ç‰©ç‹—...&quot;</span>);<br>    &#125;<br><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">feed</span><span class="hljs-params">(Cat cat)</span> &#123;<br>        System.out.println(<span class="hljs-string">&quot;å…¶ä»–äººå–‚é£Ÿå® ç‰©çŒ«...&quot;</span>);<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><h4 id="4ã€Animal"><a href="#4ã€Animal" class="headerlink" title="4ã€Animal"></a>4ã€Animal</h4><p><em>å®šä¹‰åŠ¨ç‰©æ¥å£</em></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">interface</span> <span class="hljs-title class_">Animal</span> &#123;<br>    <span class="hljs-keyword">void</span> <span class="hljs-title function_">accept</span><span class="hljs-params">(Person person)</span>;<br>&#125;<br></code></pre></td></tr></table></figure><h4 id="5ã€Dog"><a href="#5ã€Dog" class="headerlink" title="5ã€Dog"></a>5ã€Dog</h4><p><em>å®ç°Animalæ¥å£</em></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Dog</span> <span class="hljs-keyword">implements</span> <span class="hljs-title class_">Animal</span> &#123;<br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">accept</span><span class="hljs-params">(Person person)</span> &#123;<br>        person.feed(<span class="hljs-built_in">this</span>);<br>        System.out.println(<span class="hljs-string">&quot;çœŸé¦™~ï¼Œæ±ªæ±ªæ±ªï¼ï¼ï¼&quot;</span>);<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><h4 id="6ã€Cat"><a href="#6ã€Cat" class="headerlink" title="6ã€Cat"></a>6ã€Cat</h4><p><em>å®ç°Animalæ¥å£</em></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Cat</span> <span class="hljs-keyword">implements</span> <span class="hljs-title class_">Animal</span> &#123;<br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">accept</span><span class="hljs-params">(Person person)</span> &#123;<br>        person.feed(<span class="hljs-built_in">this</span>);<br>        System.out.println(<span class="hljs-string">&quot;çœŸé¦™~ï¼Œå–µå–µå–µï¼ï¼ï¼&quot;</span>);<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><h4 id="7ã€Home"><a href="#7ã€Home" class="headerlink" title="7ã€Home"></a>7ã€Home</h4><p><em>å®šä¹‰å¯¹è±¡ç»“æ„  ä¸»äººçš„å®¶</em></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Home</span> &#123;<br>    <span class="hljs-keyword">private</span> List&lt;Animal&gt; nodeList = <span class="hljs-keyword">new</span> <span class="hljs-title class_">ArrayList</span>&lt;Animal&gt;();<br><br>    <span class="hljs-comment">//æ·»åŠ æ–¹æ³•</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">add</span><span class="hljs-params">(Animal animal)</span> &#123;<br>        nodeList.add(animal);<br>    &#125;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">aciton</span><span class="hljs-params">(Person person)</span> &#123;<br>        <span class="hljs-keyword">for</span> (Animal node : nodeList) &#123;<br>            node.accept(person);<br>        &#125;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><h4 id="8ã€Client"><a href="#8ã€Client" class="headerlink" title="8ã€Client"></a>8ã€Client</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Client</span> &#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span> &#123;<br>        <span class="hljs-type">Home</span> <span class="hljs-variable">home</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Home</span>();<br>        home.add(<span class="hljs-keyword">new</span> <span class="hljs-title class_">Dog</span>());<br>        home.add(<span class="hljs-keyword">new</span> <span class="hljs-title class_">Cat</span>());<br><br>        <span class="hljs-type">Owner</span> <span class="hljs-variable">owner</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Owner</span>();<br>        home.aciton(owner);<br>        System.out.println(<span class="hljs-string">&quot;===========================&quot;</span>);<br>        <span class="hljs-type">Someone</span> <span class="hljs-variable">someone</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Someone</span>();<br>        home.aciton(someone);<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><h4 id="9ã€ç»“æœ"><a href="#9ã€ç»“æœ" class="headerlink" title="9ã€ç»“æœ"></a>9ã€ç»“æœ</h4><p><img src="/2022/10/19/10-xing-wei-xing-bei-wang-lu-fang-wen-zhe/image-20221020113116173.png"></p><h2 id="2ã€ä¼˜ç¼ºç‚¹-1"><a href="#2ã€ä¼˜ç¼ºç‚¹-1" class="headerlink" title="2ã€ä¼˜ç¼ºç‚¹"></a>2ã€ä¼˜ç¼ºç‚¹</h2><p><strong>ä¼˜ç‚¹ï¼š</strong></p><ul><li>æ‰©å±•æ€§å¥½ã€‚èƒ½å¤Ÿåœ¨ä¸ä¿®æ”¹å¯¹è±¡ç»“æ„ä¸­çš„å…ƒç´ çš„æƒ…å†µä¸‹ï¼Œä¸ºå¯¹è±¡ç»“æ„ä¸­çš„å…ƒç´ æ·»åŠ æ–°çš„åŠŸèƒ½ã€‚</li><li>å¤ç”¨æ€§å¥½ã€‚å¯ä»¥é€šè¿‡è®¿é—®è€…æ¥å®šä¹‰æ•´ä¸ªå¯¹è±¡ç»“æ„é€šç”¨çš„åŠŸèƒ½ï¼Œä»è€Œæé«˜ç³»ç»Ÿçš„å¤ç”¨ç¨‹åº¦ã€‚</li><li>çµæ´»æ€§å¥½ã€‚è®¿é—®è€…æ¨¡å¼å°†æ•°æ®ç»“æ„ä¸ä½œç”¨äºç»“æ„ä¸Šçš„æ“ä½œè§£è€¦ï¼Œä½¿å¾—æ“ä½œé›†åˆå¯ç›¸å¯¹è‡ªç”±åœ°æ¼”åŒ–è€Œä¸å½±å“ç³»ç»Ÿçš„æ•°æ®ç»“æ„ã€‚</li><li>ç¬¦åˆå•ä¸€èŒè´£åŸåˆ™ã€‚è®¿é—®è€…æ¨¡å¼æŠŠç›¸å…³çš„è¡Œä¸ºå°è£…åœ¨ä¸€èµ·ï¼Œæ„æˆä¸€ä¸ªè®¿é—®è€…ï¼Œä½¿æ¯ä¸€ä¸ªè®¿é—®è€…çš„åŠŸèƒ½éƒ½æ¯”è¾ƒå•ä¸€ã€‚</li></ul><p><strong>ç¼ºç‚¹ï¼š</strong></p><ul><li>å¢åŠ æ–°çš„å…ƒç´ ç±»å¾ˆå›°éš¾ã€‚åœ¨è®¿é—®è€…æ¨¡å¼ä¸­ï¼Œæ¯å¢åŠ ä¸€ä¸ªæ–°çš„å…ƒç´ ç±»ï¼Œéƒ½è¦åœ¨æ¯ä¸€ä¸ªå…·ä½“è®¿é—®è€…ç±»ä¸­å¢åŠ ç›¸åº”çš„å…·ä½“æ“ä½œï¼Œè¿™è¿èƒŒäº†â€œå¼€é—­åŸåˆ™â€ã€‚</li><li>ç ´åå°è£…ã€‚è®¿é—®è€…æ¨¡å¼ä¸­å…·ä½“å…ƒç´ å¯¹è®¿é—®è€…å…¬å¸ƒç»†èŠ‚ï¼Œè¿™ç ´åäº†å¯¹è±¡çš„å°è£…æ€§ã€‚</li><li>è¿åäº†ä¾èµ–å€’ç½®åŸåˆ™ã€‚è®¿é—®è€…æ¨¡å¼ä¾èµ–äº†å…·ä½“ç±»ï¼Œè€Œæ²¡æœ‰ä¾èµ–æŠ½è±¡ç±»ã€‚</li></ul><p>å‚è€ƒï¼š<a href="https://juejin.cn/post/6974984329654960165">è®¾è®¡æ¨¡å¼å­¦ä¹ 17-è®¿é—®è€…æ¨¡å¼</a></p>]]></content>
    
    
    <categories>
      
      <category>è®¾è®¡æ¨¡å¼</category>
      
    </categories>
    
    
    <tags>
      
      <tag>è®¾è®¡æ¨¡å¼</tag>
      
      <tag>å¤‡å¿˜å½•</tag>
      
      <tag>è®¿é—®è€…</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>09-è¡Œä¸ºå‹-å‘½ä»¤-è§£é‡Šå™¨-ä¸­ä»‹</title>
    <link href="/2022/10/19/09-xing-wei-xing-ming-ling-jie-shi-qi-zhong-jie/"/>
    <url>/2022/10/19/09-xing-wei-xing-ming-ling-jie-shi-qi-zhong-jie/</url>
    
    <content type="html"><![CDATA[<h1 id="ä¸€ã€å‘½ä»¤æ¨¡å¼"><a href="#ä¸€ã€å‘½ä»¤æ¨¡å¼" class="headerlink" title="ä¸€ã€å‘½ä»¤æ¨¡å¼"></a>ä¸€ã€å‘½ä»¤æ¨¡å¼</h1><p>å‘½ä»¤æ¨¡å¼(Command Pattern)ï¼šå°†ä¸€ä¸ªè¯·æ±‚å°è£…ä¸ºä¸€ä¸ªå¯¹è±¡ï¼Œä»è€Œè®©æˆ‘ä»¬å¯ç”¨ä¸åŒçš„è¯·æ±‚å¯¹å®¢æˆ·è¿›è¡Œå‚æ•°åŒ–ï¼›å¯¹è¯·æ±‚æ’é˜Ÿæˆ–è€…è®°å½•è¯·æ±‚æ—¥å¿—ï¼Œä»¥åŠæ”¯æŒå¯æ’¤é”€çš„æ“ä½œã€‚å‘½ä»¤æ¨¡å¼æ˜¯ä¸€ç§å¯¹è±¡è¡Œä¸ºå‹æ¨¡å¼ï¼Œå…¶åˆ«åä¸ºåŠ¨ä½œ(Action)æ¨¡å¼æˆ–äº‹åŠ¡(Transaction)æ¨¡å¼ã€‚</p><p>å‘½ä»¤æ¨¡å¼é€šä¿—ç‚¹æ¥è®²ï¼Œä¸¾ä¸ªä¾‹å­ï¼Œå¸ä»¤å‘˜ä¸‹ä»¤è®©å£«å…µå»å¹²ä»¶äº‹æƒ…ï¼Œä»æ•´ä¸ªäº‹æƒ…çš„è§’åº¦æ¥è€ƒè™‘ï¼Œå¸ä»¤å‘˜çš„ä½œç”¨æ˜¯ï¼Œå‘å‡ºå£ä»¤ï¼Œå£ä»¤ç»è¿‡ä¼ é€’ï¼Œä¼ åˆ°äº†å£«å…µè€³æœµé‡Œï¼Œå£«å…µå»æ‰§è¡Œã€‚è¿™ä¸ªè¿‡ç¨‹å¥½åœ¨ï¼Œä¸‰è€…ç›¸äº’è§£è€¦ï¼Œä»»ä½•ä¸€æ–¹éƒ½ä¸ç”¨å»ä¾èµ–å…¶ä»–äººï¼Œåªéœ€è¦åšå¥½è‡ªå·±çš„äº‹å„¿å°±è¡Œï¼Œå¸ä»¤å‘˜è¦çš„æ˜¯ç»“æœï¼Œä¸ä¼šå»å…³æ³¨åˆ°åº•å£«å…µæ˜¯æ€ä¹ˆå®ç°çš„ã€‚</p><p>å…³ç³»å›¾å¦‚ä¸‹ï¼š</p><p><img src="/2022/10/19/09-xing-wei-xing-ming-ling-jie-shi-qi-zhong-jie/image-20221019183821026.png"></p><ul><li><strong>Command</strong>  ä¸€ä¸ªå…·ä½“å‘½ä»¤çš„æŠ½è±¡æ¥å£ã€‚</li><li><strong>ConcreteCommand</strong>  å°±æ˜¯å…¶å…·ä½“çš„ä¸€ä¸ªå®ç°ï¼Œä½ å¯ä»¥æœ‰å¤šä¸ª<code>Command</code>æ¥å£çš„å®ç°ã€‚å…·ä½“å‘½ä»¤æœ¬èº«å¹¶ä¸å®ç°å…·ä½“çš„ä¸šåŠ¡å‘½ä»¤ï¼Œ è€Œæ˜¯ä¼šå°†è°ƒç”¨å§”æ´¾ç»™ä¸€ä¸ªä¸šåŠ¡é€»è¾‘å¯¹è±¡å»æ‰§è¡Œã€‚</li><li><strong>Receiver</strong>  ä½œä¸ºå…·ä½“å‘½ä»¤çš„æœ€ç»ˆæ¥æ”¶è€…ã€‚å‡ ä¹ä»»ä½•å¯¹è±¡éƒ½å¯ä»¥ä½œä¸ºæ¥æ”¶è€…ï¼Œå‘½ä»¤çš„ç»†èŠ‚ç”±<strong>Receiver</strong>æ¥å®ç°ã€‚</li><li><strong>Invoker</strong>  æºå¸¦å‘½ä»¤æ‰§è¡Œ <code>action</code>è¯·æ±‚ã€‚å®ƒä¸è´Ÿè´£åˆ›å»ºå‘½ä»¤å¯¹è±¡ï¼Œå®ƒé€šå¸¸ä¼šé€šè¿‡æ„é€ å‡½æ•°ä»å®¢æˆ·ç«¯å¤„è·å¾—é¢„å…ˆç”Ÿæˆçš„å‘½ä»¤ã€‚</li><li><strong>Client</strong>  å‘èµ·å…·ä½“çš„å‘½ä»¤äº¤ç»™<strong>Invoker</strong>å»æ‰§è¡Œã€‚</li></ul><p>çœ‹å®ç°ä»£ç ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">interface</span> <span class="hljs-title class_">Command</span> &#123;  <br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">exe</span><span class="hljs-params">()</span>;  <br>&#125;  <br><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">MyCommand</span> <span class="hljs-keyword">implements</span> <span class="hljs-title class_">Command</span> &#123;  <br>  <br>    <span class="hljs-keyword">private</span> Receiver receiver;  <br>      <br>    <span class="hljs-keyword">public</span> <span class="hljs-title function_">MyCommand</span><span class="hljs-params">(Receiver receiver)</span> &#123;  <br>        <span class="hljs-built_in">this</span>.receiver = receiver;  <br>    &#125;  <br>  <br>    <span class="hljs-meta">@Override</span>  <br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">exe</span><span class="hljs-params">()</span> &#123;  <br>        receiver.action();  <br>    &#125;  <br>&#125;  <br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Receiver</span> &#123;  <br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">action</span><span class="hljs-params">()</span>&#123;  <br>        System.out.println(<span class="hljs-string">&quot;command received!&quot;</span>);  <br>    &#125;  <br>&#125;  <br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Invoker</span> &#123;  <br>      <br>    <span class="hljs-keyword">private</span> Command command;  <br>      <br>    <span class="hljs-keyword">public</span> <span class="hljs-title function_">Invoker</span><span class="hljs-params">(Command command)</span> &#123;  <br>        <span class="hljs-built_in">this</span>.command = command;  <br>    &#125;  <br>  <br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">action</span><span class="hljs-params">()</span>&#123;  <br>        command.exe();  <br>    &#125;  <br>&#125;  <br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Test</span> &#123;  <br>  <br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span> &#123;  <br>        <span class="hljs-type">Receiver</span> <span class="hljs-variable">receiver</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Receiver</span>();  <br>        <span class="hljs-type">Command</span> <span class="hljs-variable">cmd</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">MyCommand</span>(receiver);  <br>        <span class="hljs-type">Invoker</span> <span class="hljs-variable">invoker</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Invoker</span>(cmd);  <br>        invoker.action();  <br>    &#125;  <br>&#125;  <br><br></code></pre></td></tr></table></figure><p>å‘½ä»¤æ¨¡å¼çš„ç›®çš„å°±æ˜¯è¾¾åˆ°å‘½ä»¤çš„å‘å‡ºè€…å’Œæ‰§è¡Œè€…ä¹‹é—´è§£è€¦ï¼Œå®ç°è¯·æ±‚å’Œæ‰§è¡Œåˆ†å¼€ï¼Œç†Ÿæ‚‰Strutsçš„åŒå­¦åº”è¯¥çŸ¥é“ï¼ŒStrutså…¶å®å°±æ˜¯ä¸€ç§å°†è¯·æ±‚å’Œå‘ˆç°åˆ†ç¦»çš„æŠ€æœ¯ï¼Œå…¶ä¸­å¿…ç„¶æ¶‰åŠå‘½ä»¤æ¨¡å¼çš„æ€æƒ³ï¼</p><p>å‘½ä»¤æ¨¡å¼åº”ç”¨éå¸¸æ™®éï¼Œæˆ‘ä»¬å¸¸è§çš„æ–­è·¯å™¨ç»„ä»¶<strong>Hystrix</strong>ï¼Œè¿˜æœ‰<strong>Java</strong>å¤šçº¿ç¨‹ä¸­çš„çº¿ç¨‹æ± <code>ThreadPoolExecutor</code>éƒ½ç”¨åˆ°äº†å‘½ä»¤æ¨¡å¼ã€‚</p><p><strong>ä¼˜ç‚¹ï¼š</strong></p><ul><li>é™ä½ç³»ç»Ÿçš„è€¦åˆåº¦ã€‚ç”±äºè¯·æ±‚è€…ä¸æ¥æ”¶è€…ä¹‹é—´ä¸å­˜åœ¨ç›´æ¥å¼•ç”¨ï¼Œå› æ­¤è¯·æ±‚è€…ä¸æ¥æ”¶è€…ä¹‹é—´å®ç°å®Œå…¨è§£è€¦ï¼Œç›¸åŒçš„è¯·æ±‚è€…å¯ä»¥å¯¹åº”ä¸åŒçš„æ¥æ”¶è€…ï¼ŒåŒæ ·ï¼Œç›¸åŒçš„æ¥æ”¶è€…ä¹Ÿå¯ä»¥ä¾›ä¸åŒçš„è¯·æ±‚è€…ä½¿ç”¨ï¼Œä¸¤è€…ä¹‹é—´å…·æœ‰è‰¯å¥½çš„ç‹¬ç«‹æ€§ã€‚</li><li>æ–°çš„å‘½ä»¤å¯ä»¥å¾ˆå®¹æ˜“åœ°åŠ å…¥åˆ°ç³»ç»Ÿä¸­ã€‚ç”±äºå¢åŠ æ–°çš„å…·ä½“å‘½ä»¤ç±»ä¸ä¼šå½±å“åˆ°å…¶ä»–ç±»ï¼Œå› æ­¤å¢åŠ æ–°çš„å…·ä½“å‘½ä»¤ç±»å¾ˆå®¹æ˜“ï¼Œæ— é¡»ä¿®æ”¹åŸæœ‰ç³»ç»Ÿæºä»£ç ï¼Œç”šè‡³å®¢æˆ·ç±»ä»£ç ï¼Œæ»¡è¶³â€œå¼€é—­åŸåˆ™â€çš„è¦æ±‚ã€‚</li><li>å¯ä»¥æ¯”è¾ƒå®¹æ˜“åœ°è®¾è®¡ä¸€ä¸ªå‘½ä»¤é˜Ÿåˆ—æˆ–å®å‘½ä»¤ï¼ˆç»„åˆå‘½ä»¤ï¼‰ã€‚</li><li>ä¸ºè¯·æ±‚çš„æ’¤é”€(Undo)å’Œæ¢å¤(Redo)æ“ä½œæä¾›äº†ä¸€ç§è®¾è®¡å’Œå®ç°æ–¹æ¡ˆã€‚</li></ul><p><strong>ç¼ºç‚¹ï¼š</strong></p><ul><li>ä½¿ç”¨å‘½ä»¤æ¨¡å¼å¯èƒ½ä¼šå¯¼è‡´æŸäº›ç³»ç»Ÿæœ‰è¿‡å¤šçš„å…·ä½“å‘½ä»¤ç±»ã€‚å› ä¸ºé’ˆå¯¹æ¯ä¸€ä¸ªå¯¹è¯·æ±‚æ¥æ”¶è€…çš„è°ƒç”¨æ“ä½œéƒ½éœ€è¦è®¾è®¡ä¸€ä¸ªå…·ä½“å‘½ä»¤ç±»ï¼Œå› æ­¤åœ¨æŸäº›ç³»ç»Ÿä¸­å¯èƒ½éœ€è¦æä¾›å¤§é‡çš„å…·ä½“å‘½ä»¤ç±»ï¼Œè¿™å°†å½±å“å‘½ä»¤æ¨¡å¼çš„ä½¿ç”¨ã€‚</li></ul><h1 id="äºŒã€è§£é‡Šå™¨æ¨¡å¼"><a href="#äºŒã€è§£é‡Šå™¨æ¨¡å¼" class="headerlink" title="äºŒã€è§£é‡Šå™¨æ¨¡å¼"></a>äºŒã€è§£é‡Šå™¨æ¨¡å¼</h1><p>è§£é‡Šå™¨æ¨¡å¼æ˜¯ç±»çš„è¡Œä¸ºæ¨¡å¼ã€‚ç»™å®šä¸€ä¸ªè¯­è¨€ä¹‹åï¼Œè§£é‡Šå™¨æ¨¡å¼å¯ä»¥å®šä¹‰å‡ºå…¶æ–‡æ³•çš„ä¸€ç§è¡¨ç¤ºï¼Œå¹¶åŒæ—¶æä¾›ä¸€ä¸ªè§£é‡Šå™¨ã€‚å®¢æˆ·ç«¯å¯ä»¥ä½¿ç”¨è¿™ä¸ªè§£é‡Šå™¨æ¥è§£é‡Šè¿™ä¸ªè¯­è¨€ä¸­çš„å¥å­ã€‚</p><p>è¿›è¡ŒåŠ å‡è¿ç®—ï¼Œæ€ä¹ˆå®ç°ï¼Ÿç¬¬ä¸€æƒ³æ³•æ˜¯ä½¿ç”¨å·¥å…·ç±»ï¼Œæä¾›å¯¹åº”çš„åŠ æ³•å’Œå‡æ³•çš„å·¥å…·æ–¹æ³•ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-comment">//ç”¨äºä¸¤ä¸ªæ•´æ•°ç›¸åŠ </span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-type">int</span> <span class="hljs-title function_">add</span><span class="hljs-params">(<span class="hljs-type">int</span> a,<span class="hljs-type">int</span> b)</span>&#123;<br>    <span class="hljs-keyword">return</span> a + b;<br>&#125;<br><br><span class="hljs-comment">//ç”¨äºä¸¤ä¸ªæ•´æ•°ç›¸åŠ </span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-type">int</span> <span class="hljs-title function_">add</span><span class="hljs-params">(<span class="hljs-type">int</span> a,<span class="hljs-type">int</span> b,<span class="hljs-type">int</span> c)</span>&#123;<br>    <span class="hljs-keyword">return</span> a + b + c;<br>&#125;<br><br><span class="hljs-comment">//ç”¨äºnä¸ªæ•´æ•°ç›¸åŠ </span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-type">int</span> <span class="hljs-title function_">add</span><span class="hljs-params">(Integer ... arr)</span> &#123;<br>    <span class="hljs-type">int</span> <span class="hljs-variable">sum</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>;<br>    <span class="hljs-keyword">for</span> (Integer i : arr) &#123;<br>        sum += i;<br>    &#125;<br>    <span class="hljs-keyword">return</span> sum;<br>&#125;<br></code></pre></td></tr></table></figure><p>ä¸Šé¢çš„å½¢å¼æ¯”è¾ƒå•ä¸€ã€æœ‰é™ï¼Œå¦‚æœå½¢å¼å˜åŒ–éå¸¸å¤šï¼Œè¿™å°±ä¸ç¬¦åˆè¦æ±‚ï¼Œå› ä¸ºåŠ æ³•å’Œå‡æ³•è¿ç®—ï¼Œä¸¤ä¸ªè¿ç®—ç¬¦ä¸æ•°å€¼å¯ä»¥æœ‰æ— é™ç§ç»„åˆæ–¹å¼ã€‚æ¯”å¦‚ 1+2+3+4+5ã€1+2+3-4ç­‰ç­‰ã€‚</p><p>ç°åœ¨éœ€è¦ä¸€ç§ç¿»è¯‘è¯†åˆ«æœºå™¨ï¼Œèƒ½å¤Ÿè§£æç”±æ•°å­—ä»¥åŠ + - ç¬¦å·æ„æˆçš„åˆæ³•çš„è¿ç®—åºåˆ—ã€‚å¦‚æœæŠŠè¿ç®—ç¬¦å’Œæ•°å­—éƒ½çœ‹ä½œèŠ‚ç‚¹çš„è¯ï¼Œèƒ½å¤Ÿé€ä¸ªèŠ‚ç‚¹çš„è¿›è¡Œè¯»å–è§£æè¿ç®—ï¼Œè¿™å°±æ˜¯è§£é‡Šå™¨æ¨¡å¼çš„æ€ç»´ã€‚</p><p>ç±»å›¾ï¼š</p><p><img src="/2022/10/19/09-xing-wei-xing-ming-ling-jie-shi-qi-zhong-jie/image-20221019184910429.png"></p><p>è§£é‡Šå™¨çš„ä¸»è¦è§’è‰²ï¼š</p><ul><li>æŠ½è±¡è§£é‡Šå™¨(AbstractExpression/Expression)ï¼šå£°æ˜ä¸€ä¸ªæ‰€æœ‰å…·ä½“è¡¨è¾¾å¼éƒ½è¦å®ç°çš„æŠ½è±¡æ¥å£ï¼ˆæˆ–è€…æŠ½è±¡ç±»ï¼‰ï¼Œæ¥å£ä¸­ä¸»è¦æ˜¯ä¸€ä¸ªinterpret()æ–¹æ³•ï¼Œç§°ä¸ºè§£é‡Šæ“ä½œã€‚å…·ä½“è§£é‡Šä»»åŠ¡ç”±å®ƒçš„å„ä¸ªå®ç°ç±»æ¥å®Œæˆï¼Œå…·ä½“çš„è§£é‡Šå™¨åˆ†åˆ«ç”±ç»ˆç»“ç¬¦è§£é‡Šå™¨TerminalExpressionå’Œéç»ˆç»“ç¬¦è§£é‡Šå™¨NonterminalExpressionå®Œæˆã€‚</li><li>ç»ˆç»“ç¬¦è¡¨è¾¾å¼(TerminalExpression)ï¼šå®ç°ä¸æ–‡æ³•ä¸­çš„å…ƒç´ ç›¸å…³è”çš„è§£é‡Šæ“ä½œï¼Œé€šå¸¸ä¸€ä¸ªè§£é‡Šå™¨æ¨¡å¼ä¸­åªæœ‰ä¸€ä¸ªç»ˆç»“ç¬¦è¡¨è¾¾å¼ï¼Œä½†æœ‰å¤šä¸ªå®ä¾‹ï¼Œå¯¹åº”ä¸åŒçš„ç»ˆç»“ç¬¦ã€‚ç»ˆç»“ç¬¦ä¸€åŠæ˜¯æ–‡æ³•ä¸­çš„è¿ç®—å•å…ƒï¼Œæ¯”å¦‚æœ‰ä¸€ä¸ªç®€å•çš„å…¬å¼R=R1+R2ï¼Œåœ¨é‡Œé¢R1å’ŒR2å°±æ˜¯ç»ˆç»“ç¬¦ï¼Œå¯¹åº”çš„è§£æR1å’ŒR2çš„è§£é‡Šå™¨å°±æ˜¯ç»ˆç»“ç¬¦è¡¨è¾¾å¼ã€‚</li><li>éç»ˆç»“ç¬¦è¡¨è¾¾å¼(NonterminalExpression)ï¼šæ–‡æ³•ä¸­çš„æ¯æ¡è§„åˆ™å¯¹åº”äºä¸€ä¸ªéç»ˆç»“ç¬¦è¡¨è¾¾å¼ï¼Œéç»ˆç»“ç¬¦è¡¨è¾¾å¼ä¸€èˆ¬æ˜¯æ–‡æ³•ä¸­çš„è¿ç®—ç¬¦æˆ–è€…å…¶ä»–å…³é”®å­—ï¼Œæ¯”å¦‚å…¬å¼R=R1+R2ä¸­ï¼Œ+å°±æ˜¯éç»ˆç»“ç¬¦ï¼Œè§£æ+çš„è§£é‡Šå™¨å°±æ˜¯ä¸€ä¸ªéç»ˆç»“ç¬¦è¡¨è¾¾å¼ã€‚éç»ˆç»“ç¬¦è¡¨è¾¾å¼æ ¹æ®é€»è¾‘çš„å¤æ‚ç¨‹åº¦è€Œå¢åŠ ï¼ŒåŸåˆ™ä¸Šæ¯ä¸ªæ–‡æ³•è§„åˆ™éƒ½å¯¹åº”ä¸€ä¸ªéç»ˆç»“ç¬¦è¡¨è¾¾å¼ã€‚</li><li>ç¯å¢ƒè§’è‰²(Context)ï¼šè¿™ä¸ªè§’è‰²çš„ä»»åŠ¡ä¸€èˆ¬æ˜¯ç”¨æ¥å­˜æ”¾æ–‡æ³•ä¸­å„ä¸ªç»ˆç»“ç¬¦æ‰€å¯¹åº”çš„å…·ä½“å€¼ï¼Œæ¯”å¦‚R=R1+R2ï¼Œæˆ‘ä»¬ç»™R1èµ‹å€¼100ï¼Œç»™R2èµ‹å€¼200ã€‚è¿™äº›ä¿¡æ¯éœ€è¦å­˜æ”¾åˆ°ç¯å¢ƒè§’è‰²ä¸­ï¼Œå¾ˆå¤šæƒ…å†µä¸‹æˆ‘ä»¬ä½¿ç”¨Mapæ¥å……å½“ç¯å¢ƒè§’è‰²å°±è¶³å¤Ÿäº†ã€‚</li></ul><h2 id="1ã€Demoæ¡ˆä¾‹-è®¡ç®—åŠ å‡ä¹˜é™¤ç®—æ³•"><a href="#1ã€Demoæ¡ˆä¾‹-è®¡ç®—åŠ å‡ä¹˜é™¤ç®—æ³•" class="headerlink" title="1ã€Demoæ¡ˆä¾‹-è®¡ç®—åŠ å‡ä¹˜é™¤ç®—æ³•"></a>1ã€Demoæ¡ˆä¾‹-è®¡ç®—åŠ å‡ä¹˜é™¤ç®—æ³•</h2><p>ç®€å•çš„ä¸€ä¸ªè§£é‡Šå™¨è®¡ç®—åŠ å‡ä¹˜é™¤ç®—æ³•</p><h3 id="1ã€AbstractExpression"><a href="#1ã€AbstractExpression" class="headerlink" title="1ã€AbstractExpression"></a>1ã€AbstractExpression</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-comment">//æŠ½è±¡è§£é‡Šå™¨</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">abstract</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">AbstractExpression</span> &#123;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">abstract</span> <span class="hljs-type">int</span> <span class="hljs-title function_">interpreter</span><span class="hljs-params">(Context context)</span>;<br>&#125;<br></code></pre></td></tr></table></figure><h3 id="2ã€Add"><a href="#2ã€Add" class="headerlink" title="2ã€Add"></a>2ã€Add</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-comment">//éç»ˆç»“è¡¨è¾¾å¼ï¼šåŠ æ³•</span><br><span class="hljs-meta">@Data</span><br><span class="hljs-meta">@AllArgsConstructor</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Add</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_">AbstractExpression</span> &#123;<br><br>    <span class="hljs-keyword">private</span> <span class="hljs-keyword">final</span> AbstractExpression left;<br><br>    <span class="hljs-keyword">private</span> <span class="hljs-keyword">final</span> AbstractExpression right;<br><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-type">int</span> <span class="hljs-title function_">interpreter</span><span class="hljs-params">(Context context)</span> &#123;<br>        <span class="hljs-keyword">return</span> left.interpreter(context) + right.interpreter(context);<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><h3 id="3ã€Subtract"><a href="#3ã€Subtract" class="headerlink" title="3ã€Subtract"></a>3ã€Subtract</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-comment">//éç»ˆç»“è¡¨è¾¾å¼ï¼šå‡æ³•</span><br><span class="hljs-meta">@Data</span><br><span class="hljs-meta">@AllArgsConstructor</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Subtract</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_">AbstractExpression</span> &#123;<br><br>    <span class="hljs-keyword">private</span> <span class="hljs-keyword">final</span> AbstractExpression left;<br><br>    <span class="hljs-keyword">private</span> <span class="hljs-keyword">final</span> AbstractExpression right;<br><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-type">int</span> <span class="hljs-title function_">interpreter</span><span class="hljs-params">(Context context)</span> &#123;<br>        <span class="hljs-keyword">return</span> left.interpreter(context) - right.interpreter(context);<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><h3 id="4ã€Multiply"><a href="#4ã€Multiply" class="headerlink" title="4ã€Multiply"></a>4ã€Multiply</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-comment">//éç»ˆç»“è¡¨è¾¾å¼ï¼šä¹˜æ³•</span><br><span class="hljs-meta">@Data</span><br><span class="hljs-meta">@AllArgsConstructor</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Multiply</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_">AbstractExpression</span> &#123;<br><br>    <span class="hljs-keyword">private</span> <span class="hljs-keyword">final</span> AbstractExpression left;<br><br>    <span class="hljs-keyword">private</span> <span class="hljs-keyword">final</span> AbstractExpression right;<br><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-type">int</span> <span class="hljs-title function_">interpreter</span><span class="hljs-params">(Context context)</span> &#123;<br>        <span class="hljs-keyword">return</span> left.interpreter(context) * right.interpreter(context);<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><h3 id="5ã€Division"><a href="#5ã€Division" class="headerlink" title="5ã€Division"></a>5ã€Division</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-comment">//éç»ˆç»“è¡¨è¾¾å¼ï¼šé™¤æ³•</span><br><span class="hljs-meta">@Data</span><br><span class="hljs-meta">@AllArgsConstructor</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Division</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_">AbstractExpression</span> &#123;<br><br>    <span class="hljs-keyword">private</span> <span class="hljs-keyword">final</span> AbstractExpression left;<br><br>    <span class="hljs-keyword">private</span> <span class="hljs-keyword">final</span> AbstractExpression right;<br><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-type">int</span> <span class="hljs-title function_">interpreter</span><span class="hljs-params">(Context context)</span> &#123;<br>        <span class="hljs-type">int</span> <span class="hljs-variable">right</span> <span class="hljs-operator">=</span> <span class="hljs-built_in">this</span>.right.interpreter(context);<br>        <span class="hljs-keyword">if</span> (right != <span class="hljs-number">0</span>) &#123;<br>            <span class="hljs-keyword">return</span> left.interpreter(context) / right;<br>        &#125;<br><br>        <span class="hljs-keyword">return</span> -<span class="hljs-number">1</span>;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><h3 id="6ã€Variable"><a href="#6ã€Variable" class="headerlink" title="6ã€Variable"></a>6ã€Variable</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-comment">//ç»ˆç»“è¡¨è¾¾å¼ï¼šå˜é‡</span><br><span class="hljs-meta">@Data</span><br><span class="hljs-meta">@AllArgsConstructor</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Variable</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_">AbstractExpression</span> &#123;<br><br>    <span class="hljs-keyword">private</span> <span class="hljs-keyword">final</span> String key;<br><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-type">int</span> <span class="hljs-title function_">interpreter</span><span class="hljs-params">(Context context)</span> &#123;<br>        <span class="hljs-keyword">return</span> context.getValue(key);<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><h3 id="7ã€Context"><a href="#7ã€Context" class="headerlink" title="7ã€Context"></a>7ã€Context</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-comment">//ç¯å¢ƒä¸Šä¸‹æ–‡</span><br><span class="hljs-meta">@Getter</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Context</span> &#123;<br><br>    <span class="hljs-keyword">private</span> <span class="hljs-keyword">final</span> Map&lt;String, Integer&gt; valueMap = Maps.newHashMap();<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">addValue</span><span class="hljs-params">(<span class="hljs-keyword">final</span> String key, <span class="hljs-keyword">final</span> <span class="hljs-type">int</span> value)</span> &#123;<br>        valueMap.put(key, Integer.valueOf(value));<br>    &#125;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-type">int</span> <span class="hljs-title function_">getValue</span><span class="hljs-params">(<span class="hljs-keyword">final</span> String key)</span> &#123;<br>        <span class="hljs-keyword">return</span> valueMap.get(key).intValue();<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><h3 id="8ã€Application"><a href="#8ã€Application" class="headerlink" title="8ã€Application"></a>8ã€Application</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Application</span> &#123;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span> &#123;<br>        <span class="hljs-type">Context</span> <span class="hljs-variable">context</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Context</span>();<br>        context.addValue(<span class="hljs-string">&quot;a&quot;</span>, <span class="hljs-number">6</span>);<br>        context.addValue(<span class="hljs-string">&quot;b&quot;</span>, <span class="hljs-number">9</span>);<br>        context.addValue(<span class="hljs-string">&quot;c&quot;</span>, <span class="hljs-number">1</span>);<br><br>        <span class="hljs-type">Variable</span> <span class="hljs-variable">a</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Variable</span>(<span class="hljs-string">&quot;a&quot;</span>);<br>        <span class="hljs-type">Variable</span> <span class="hljs-variable">b</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Variable</span>(<span class="hljs-string">&quot;b&quot;</span>);<br>        <span class="hljs-type">Variable</span> <span class="hljs-variable">c</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Variable</span>(<span class="hljs-string">&quot;c&quot;</span>);<br><br>        <span class="hljs-type">AbstractExpression</span> <span class="hljs-variable">multiplyValue</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Multiply</span>(a, b);<br>        <span class="hljs-type">AbstractExpression</span> <span class="hljs-variable">subtractValue</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Subtract</span>(a, b);<br>        <span class="hljs-type">AbstractExpression</span> <span class="hljs-variable">addValue</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Add</span>(subtractValue, c);<br>        <span class="hljs-type">AbstractExpression</span> <span class="hljs-variable">divisionValue</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Division</span>(multiplyValue, addValue);<br><br>        log.info(<span class="hljs-string">&quot;&#123;&#125;&quot;</span>, context.getValueMap());<br>        log.info(<span class="hljs-string">&quot;(a*b)/(a-b+c) = &#123;&#125;&quot;</span>, divisionValue.interpreter(context));<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><h3 id="9ã€ç»“æœ"><a href="#9ã€ç»“æœ" class="headerlink" title="9ã€ç»“æœ"></a>9ã€ç»“æœ</h3><p><img src="/2022/10/19/09-xing-wei-xing-ming-ling-jie-shi-qi-zhong-jie/image-20221019205702816.png"></p><h2 id="2ã€è§£é‡Šå™¨æ¨¡å¼ä½¿ç”¨åœºæ™¯"><a href="#2ã€è§£é‡Šå™¨æ¨¡å¼ä½¿ç”¨åœºæ™¯" class="headerlink" title="2ã€è§£é‡Šå™¨æ¨¡å¼ä½¿ç”¨åœºæ™¯"></a>2ã€è§£é‡Šå™¨æ¨¡å¼ä½¿ç”¨åœºæ™¯</h2><ul><li>å½“è¯­è¨€çš„æ–‡æ³•è¾ƒä¸ºç®€å•ï¼Œä¸”æ‰§è¡Œæ•ˆç‡ä¸æ˜¯å…³é”®é—®é¢˜æ—¶ã€‚</li><li>å½“é—®é¢˜é‡å¤å‡ºç°ï¼Œä¸”å¯ä»¥ç”¨ä¸€ç§ç®€å•çš„è¯­è¨€æ¥è¿›è¡Œè¡¨è¾¾æ—¶ã€‚</li><li>å½“ä¸€ä¸ªè¯­è¨€éœ€è¦è§£é‡Šæ‰§è¡Œï¼Œå¹¶ä¸”è¯­è¨€ä¸­çš„å¥å­å¯ä»¥è¡¨ç¤ºä¸ºä¸€ä¸ªæŠ½è±¡è¯­æ³•æ ‘çš„æ—¶å€™ã€‚</li></ul><h2 id="3ã€åœ¨jdkä¸­çš„åº”ç”¨"><a href="#3ã€åœ¨jdkä¸­çš„åº”ç”¨" class="headerlink" title="3ã€åœ¨jdkä¸­çš„åº”ç”¨"></a>3ã€åœ¨jdkä¸­çš„åº”ç”¨</h2><p>è¿™ä¸ªæ¨¡å¼é€šå¸¸å®šä¹‰äº†ä¸€ä¸ªè¯­è¨€çš„è¯­æ³•ï¼Œç„¶åè§£æç›¸åº”è¯­æ³•çš„è¯­å¥ã€‚</p><ol><li>java.util.Pattern</li><li>java.text.Normalizer</li><li>java.text.Format</li></ol><h1 id="ä¸‰ã€ä¸­ä»‹æ¨¡å¼"><a href="#ä¸‰ã€ä¸­ä»‹æ¨¡å¼" class="headerlink" title="ä¸‰ã€ä¸­ä»‹æ¨¡å¼"></a>ä¸‰ã€ä¸­ä»‹æ¨¡å¼</h1><p>ä¸­ä»‹è€…æ¨¡å¼(Mediator Pattern)ï¼šç”¨ä¸€ä¸ªä¸­ä»‹å¯¹è±¡ï¼ˆä¸­ä»‹è€…ï¼‰æ¥å°è£…ä¸€ç³»åˆ—çš„å¯¹è±¡äº¤äº’ï¼Œä¸­ä»‹è€…ä½¿å„å¯¹è±¡ä¸éœ€è¦æ˜¾å¼åœ°ç›¸äº’å¼•ç”¨ï¼Œä»è€Œä½¿å…¶è€¦åˆæ¾æ•£ï¼Œè€Œä¸”å¯ä»¥ç‹¬ç«‹åœ°æ”¹å˜å®ƒä»¬ä¹‹é—´çš„äº¤äº’ã€‚ä¸­ä»‹è€…æ¨¡å¼åˆç§°ä¸ºè°ƒåœè€…æ¨¡å¼ï¼Œå®ƒæ˜¯ä¸€ç§å¯¹è±¡è¡Œä¸ºå‹æ¨¡å¼ã€‚</p><p>ä¸‹é¢çš„å›¾å¯ä»¥æ›´å¥½çš„ç†è§£ä¸­ä»‹æ¨¡å¼ã€‚</p><p><img src="/2022/10/19/09-xing-wei-xing-ming-ling-jie-shi-qi-zhong-jie/image-20221019212125724.png"></p><h2 id="1ã€Demoæ¡ˆä¾‹-ç§Ÿæˆ¿é—®é¢˜"><a href="#1ã€Demoæ¡ˆä¾‹-ç§Ÿæˆ¿é—®é¢˜" class="headerlink" title="1ã€Demoæ¡ˆä¾‹-ç§Ÿæˆ¿é—®é¢˜"></a>1ã€Demoæ¡ˆä¾‹-ç§Ÿæˆ¿é—®é¢˜</h2><p>ç°åœ¨ç§Ÿæˆ¿åŸºæœ¬éƒ½æ˜¯é€šè¿‡æˆ¿å±‹ä¸­ä»‹ï¼Œæˆ¿ä¸»å°†æˆ¿å±‹æ‰˜ç®¡ç»™æˆ¿å±‹ä¸­ä»‹ï¼Œè€Œç§Ÿæˆ¿è€…ä»æˆ¿å±‹ä¸­ä»‹è·å–æˆ¿å±‹ä¿¡æ¯ã€‚æˆ¿å±‹ä¸­ä»‹å……å½“ç§Ÿæˆ¿è€…ä¸æˆ¿å±‹æ‰€æœ‰è€…ä¹‹é—´çš„ä¸­ä»‹è€…</p><p>ç±»å›¾å¦‚ä¸‹ï¼š</p><p><img src="/2022/10/19/09-xing-wei-xing-ming-ling-jie-shi-qi-zhong-jie/image-20221019213747108.png"></p><h3 id="1ã€Mediator"><a href="#1ã€Mediator" class="headerlink" title="1ã€Mediator"></a>1ã€Mediator</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">abstract</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Mediator</span> &#123;<br>    <span class="hljs-comment">//å£°æ˜ä¸€ä¸ªè”ç»œæ–¹æ³•</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">abstract</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">constact</span><span class="hljs-params">(String message, Person person)</span>;<br>&#125;<br></code></pre></td></tr></table></figure><h3 id="2ã€Person"><a href="#2ã€Person" class="headerlink" title="2ã€Person"></a>2ã€Person</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">abstract</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Person</span> &#123;<br>    <span class="hljs-keyword">protected</span> String name;<br>    <span class="hljs-keyword">protected</span> Mediator mediator;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-title function_">Person</span><span class="hljs-params">(String name, Mediator mediator)</span> &#123;<br>        <span class="hljs-built_in">this</span>.name = name;<br>        <span class="hljs-built_in">this</span>.mediator = mediator;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><h3 id="3ã€HouseOwner"><a href="#3ã€HouseOwner" class="headerlink" title="3ã€HouseOwner"></a>3ã€HouseOwner</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">HouseOwner</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_">Person</span>&#123;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-title function_">HouseOwner</span><span class="hljs-params">(String name, Mediator mediator)</span> &#123;<br>        <span class="hljs-built_in">super</span>(name, mediator);<br>    &#125;<br><br>    <span class="hljs-comment">//ä¸ä¸­ä»‹è€…è”ç³»</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">constact</span><span class="hljs-params">(String message)</span>&#123;<br>        mediator.constact(message,<span class="hljs-built_in">this</span>);<br>    &#125;<br><br>    <span class="hljs-comment">//è·å–ä¿¡æ¯</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">getMessage</span><span class="hljs-params">(String message)</span>&#123;<br>        System.out.println(<span class="hljs-string">&quot;æˆ¿ä¸»&quot;</span>+name+<span class="hljs-string">&quot;è·å–çš„ä¿¡æ¯:&quot;</span>+message);<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><h3 id="4ã€Tenant"><a href="#4ã€Tenant" class="headerlink" title="4ã€Tenant"></a>4ã€Tenant</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Tenant</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_">Person</span>&#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-title function_">Tenant</span><span class="hljs-params">(String name, Mediator mediator)</span> &#123;<br>        <span class="hljs-built_in">super</span>(name, mediator);<br>    &#125;<br><br>    <span class="hljs-comment">//ä¸ä¸­ä»‹è€…è”ç³»</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">constact</span><span class="hljs-params">(String message)</span>&#123;<br>        mediator.constact(message,<span class="hljs-built_in">this</span>);<br>    &#125;<br><br>    <span class="hljs-comment">//è·å–ä¿¡æ¯</span><br>    <span class="hljs-comment">//è·å–ä¿¡æ¯</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">getMessage</span><span class="hljs-params">(String message)</span>&#123;<br>        System.out.println(<span class="hljs-string">&quot;ç§Ÿæˆ¿è€…&quot;</span>+name+<span class="hljs-string">&quot;è·å–çš„ä¿¡æ¯:&quot;</span>+message);<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><h3 id="5ã€MediatorStructure"><a href="#5ã€MediatorStructure" class="headerlink" title="5ã€MediatorStructure"></a>5ã€MediatorStructure</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">MediatorStructure</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_">Mediator</span> &#123;<br><br>    <span class="hljs-comment">//ä¸­ä»‹ç»“æ„å¿…é¡»çŸ¥é“æ‰€æœ‰æˆ¿ä¸»å’Œç§Ÿæˆ¿è€…çš„ä¿¡æ¯</span><br>    <span class="hljs-keyword">private</span> HouseOwner houseOwner;<br>    <span class="hljs-keyword">private</span> Tenant tenant;<br><br>    <span class="hljs-keyword">public</span> HouseOwner <span class="hljs-title function_">getHouseOwner</span><span class="hljs-params">()</span> &#123;<br>        <span class="hljs-keyword">return</span> houseOwner;<br>    &#125;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">setHouseOwner</span><span class="hljs-params">(HouseOwner houseOwner)</span> &#123;<br>        <span class="hljs-built_in">this</span>.houseOwner = houseOwner;<br>    &#125;<br><br>    <span class="hljs-keyword">public</span> Tenant <span class="hljs-title function_">getTenant</span><span class="hljs-params">()</span> &#123;<br>        <span class="hljs-keyword">return</span> tenant;<br>    &#125;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">setTenant</span><span class="hljs-params">(Tenant tenant)</span> &#123;<br>        <span class="hljs-built_in">this</span>.tenant = tenant;<br>    &#125;<br><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">constact</span><span class="hljs-params">(String message, Person person)</span> &#123;<br>        <span class="hljs-keyword">if</span> (person == houseOwner) &#123;<br>            <span class="hljs-comment">//å¦‚æœæ˜¯æˆ¿ä¸»ï¼Œåˆ™ç§Ÿæˆ¿è€…è·å¾—ä¿¡æ¯</span><br>            tenant.getMessage(message);<br>        &#125; <span class="hljs-keyword">else</span> &#123;<br>            <span class="hljs-comment">//åä¹‹æ˜¯æˆ¿ä¸»è·å¾—ä¿¡æ¯</span><br>            houseOwner.getMessage(message);<br>        &#125;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><h3 id="6ã€Client"><a href="#6ã€Client" class="headerlink" title="6ã€Client"></a>6ã€Client</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Client</span> &#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span> &#123;<br>        <span class="hljs-comment">//æˆ¿ä¸» ç§Ÿæˆ¿è€… ä¸­ä»‹æœºæ„</span><br>        <span class="hljs-type">MediatorStructure</span> <span class="hljs-variable">mediator</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">MediatorStructure</span>();<br><br>        <span class="hljs-comment">//æˆ¿ä¸»å’Œç§Ÿæˆ¿è€…åªéœ€è¦çŸ¥é“ä¸­ä»‹æœºæ„å³å¯</span><br>        <span class="hljs-type">HouseOwner</span> <span class="hljs-variable">houseOwner</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">HouseOwner</span>(<span class="hljs-string">&quot;å¼ ä¸‰&quot;</span>, mediator);<br>        <span class="hljs-type">Tenant</span> <span class="hljs-variable">tenant</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Tenant</span>(<span class="hljs-string">&quot;æå››&quot;</span>, mediator);<br><br>        <span class="hljs-comment">//ä¸­ä»‹æœºæ„éœ€è¦çŸ¥é“æˆ¿ä¸»å’Œç§Ÿæˆ¿è€…</span><br>        mediator.setHouseOwner(houseOwner);<br>        mediator.setTenant(tenant);<br><br>        tenant.constact(<span class="hljs-string">&quot;éœ€è¦ç§Ÿä¸€é—´æˆ¿å­&quot;</span>);<br>        houseOwner.constact(<span class="hljs-string">&quot;æˆ‘æœ‰ä¸€é—´æˆ¿å­ï¼Œä½ è¦ç§Ÿå—ï¼Ÿï¼Ÿï¼Ÿ&quot;</span>);<br><br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><h3 id="7ã€ç»“æœ"><a href="#7ã€ç»“æœ" class="headerlink" title="7ã€ç»“æœ"></a>7ã€ç»“æœ</h3><p><img src="/2022/10/19/09-xing-wei-xing-ming-ling-jie-shi-qi-zhong-jie/image-20221019212554026.png"></p><h2 id="2ã€ä¼˜ç¼ºç‚¹"><a href="#2ã€ä¼˜ç¼ºç‚¹" class="headerlink" title="2ã€ä¼˜ç¼ºç‚¹"></a>2ã€ä¼˜ç¼ºç‚¹</h2><p><strong>ä¼˜ç‚¹ï¼š</strong></p><ul><li>ä¸­ä»‹è€…æ¨¡å¼ç®€åŒ–äº†å¯¹è±¡ä¹‹é—´çš„äº¤äº’ï¼Œå®ƒç”¨ä¸­ä»‹è€…å’ŒåŒäº‹çš„ä¸€å¯¹å¤šäº¤äº’ä»£æ›¿äº†åŸæ¥åŒäº‹ä¹‹é—´çš„å¤šå¯¹å¤šäº¤äº’ï¼Œä¸€å¯¹å¤šå…³ç³»æ›´å®¹æ˜“ç†è§£ã€ç»´æŠ¤å’Œæ‰©å±•ï¼Œå°†åŸæœ¬éš¾ä»¥ç†è§£çš„ç½‘çŠ¶ç»“æ„è½¬æ¢æˆç›¸å¯¹ç®€å•çš„æ˜Ÿå‹ç»“æ„ã€‚</li><li>ä¸­ä»‹è€…æ¨¡å¼å¯å°†å„åŒäº‹å¯¹è±¡è§£è€¦ã€‚ä¸­ä»‹è€…æœ‰åˆ©äºå„åŒäº‹ä¹‹é—´çš„æ¾è€¦åˆï¼Œæˆ‘ä»¬å¯ä»¥ç‹¬ç«‹çš„æ”¹å˜å’Œå¤ç”¨æ¯ä¸€ä¸ªåŒäº‹å’Œä¸­ä»‹è€…ï¼Œå¢åŠ æ–°çš„ä¸­ä»‹è€…å’Œæ–°çš„åŒäº‹ç±»éƒ½æ¯”è¾ƒæ–¹ä¾¿ï¼Œæ›´å¥½åœ°ç¬¦åˆâ€œå¼€é—­åŸåˆ™â€ã€‚</li><li>å¯ä»¥å‡å°‘å­ç±»ç”Ÿæˆï¼Œä¸­ä»‹è€…å°†åŸæœ¬åˆ†å¸ƒäºå¤šä¸ªå¯¹è±¡é—´çš„è¡Œä¸ºé›†ä¸­åœ¨ä¸€èµ·ï¼Œæ”¹å˜è¿™äº›è¡Œä¸ºåªéœ€ç”Ÿæˆæ–°çš„ä¸­ä»‹è€…å­ç±»å³å¯ï¼Œè¿™ä½¿å„ä¸ªåŒäº‹ç±»å¯è¢«é‡ç”¨ï¼Œæ— é¡»å¯¹åŒäº‹ç±»è¿›è¡Œæ‰©å±•ã€‚</li></ul><p><strong>ç¼ºç‚¹ï¼š</strong></p><ul><li>åœ¨å…·ä½“ä¸­ä»‹è€…ç±»ä¸­åŒ…å«äº†å¤§é‡åŒäº‹ä¹‹é—´çš„äº¤äº’ç»†èŠ‚ï¼Œå¯èƒ½ä¼šå¯¼è‡´å…·ä½“ä¸­ä»‹è€…ç±»éå¸¸å¤æ‚ï¼Œä½¿å¾—ç³»ç»Ÿéš¾ä»¥ç»´æŠ¤ã€‚</li></ul><h2 id="3ã€åº”ç”¨åœºæ™¯"><a href="#3ã€åº”ç”¨åœºæ™¯" class="headerlink" title="3ã€åº”ç”¨åœºæ™¯"></a>3ã€åº”ç”¨åœºæ™¯</h2><ul><li>å½“å¯¹è±¡ä¹‹é—´å­˜åœ¨å¤æ‚çš„ç½‘çŠ¶ç»“æ„å…³ç³»è€Œå¯¼è‡´ä¾èµ–å…³ç³»æ··ä¹±ä¸”éš¾ä»¥å¤ç”¨æ—¶ã€‚</li><li>å½“æƒ³åˆ›å»ºä¸€ä¸ªè¿è¡Œäºå¤šä¸ªç±»ä¹‹é—´çš„å¯¹è±¡ï¼Œåˆä¸æƒ³ç”Ÿæˆæ–°çš„å­ç±»æ—¶ã€‚</li></ul><blockquote><p>å‚è€ƒï¼š<a href="https://juejin.cn/post/6974984853402058760#heading-5">ä¸­ä»‹è€…æ¨¡å¼</a>ã€<a href="https://juejin.cn/post/6844903795017646094#heading-38">å­¦ä¹ å¹¶ç†è§£23ç§è®¾è®¡æ¨¡å¼</a></p></blockquote>]]></content>
    
    
    <categories>
      
      <category>è®¾è®¡æ¨¡å¼</category>
      
    </categories>
    
    
    <tags>
      
      <tag>è®¾è®¡æ¨¡å¼</tag>
      
      <tag>å‘½ä»¤</tag>
      
      <tag>è§£é‡Šå™¨</tag>
      
      <tag>ä¸­ä»‹</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>nohupä»€ä¹ˆä¸œè¥¿ï¼Ÿ</title>
    <link href="/2022/10/18/nohup-shi-me-dong-xi/"/>
    <url>/2022/10/18/nohup-shi-me-dong-xi/</url>
    
    <content type="html"><![CDATA[<p>æ‰€ä»¥nohupæ˜¯ä»€ä¹ˆä¸œè¥¿ï¼Ÿ</p><p><code>nohup</code>æ˜¯è‹±è¯­ no hangup çš„ç¼©å†™ï¼Œæ˜¯ä¸æŒ‚æ–­çš„æ„æ€ï¼Œä¹Ÿå°±æ˜¯æŒ‡ç¨‹åºä¸é€€å‡ºï¼Œç”¨åœ¨ç³»ç»Ÿåå°ä¸æŒ‚æ–­åœ°è¿è¡Œå‘½ä»¤ï¼Œé€€å‡ºç»ˆç«¯ä¸ä¼šå½±å“ç¨‹åºçš„è¿è¡Œã€‚</p><p>åœ¨å·¥ä½œä¸­ï¼Œæˆ‘ä»¬å¯èƒ½ç»å¸¸è¦åœ¨æœåŠ¡å™¨ä¸Šè·‘ç¨‹åºï¼Œæœ‰å¯èƒ½è¦è·‘çš„ç¨‹åºè€—æ—¶å¾ˆé•¿ï¼Œéœ€è¦è¿è¡Œä¸€æ®µæ—¶é—´ï¼Œæˆ‘ä»¬å¸Œæœ›å³ä½¿å…³é—­ç»ˆç«¯ï¼Œç¨‹åºä¸å—å½±å“ï¼Œç»§ç»­è¿è¡Œã€‚åœ¨Linuxä¸­çš„<code>nohup</code>å‘½ä»¤å¯ä»¥è¾¾åˆ°è¿™ç§æ•ˆæœã€‚</p><h2 id="å‘½ä»¤è¯­æ³•"><a href="#å‘½ä»¤è¯­æ³•" class="headerlink" title="å‘½ä»¤è¯­æ³•"></a>å‘½ä»¤è¯­æ³•</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-built_in">nohup</span> å‘½ä»¤ å‚æ•°<br><span class="hljs-built_in">nohup</span> é€‰é¡¹<br></code></pre></td></tr></table></figure><p>è¯´æ˜ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs bash">--<span class="hljs-built_in">help</span>     <span class="hljs-comment"># æ˜¾ç¤ºæ­¤å¸®åŠ©ä¿¡æ¯å¹¶é€€å‡º</span><br>--version  <span class="hljs-comment"># æ˜¾ç¤ºç‰ˆæœ¬ä¿¡æ¯å¹¶é€€å‡º</span><br></code></pre></td></tr></table></figure><h2 id="Demoæ¡ˆä¾‹"><a href="#Demoæ¡ˆä¾‹" class="headerlink" title="Demoæ¡ˆä¾‹"></a>Demoæ¡ˆä¾‹</h2><p>å‡†å¤‡ä¸€ä¸ªtest.pyç¨‹åºï¼ŒåŠŸèƒ½æ˜¯æ¯éš”2ç§’ä¼šè¾“å‡ºâ€hello nohup!â€ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> time <br><br><span class="hljs-keyword">while</span> <span class="hljs-literal">True</span>:<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;hello nohup!&quot;</span>)<br>    time.sleep(<span class="hljs-number">2</span>)<br></code></pre></td></tr></table></figure><p>ç„¶åä½¿ç”¨<code>nohup python3 test.py</code>è¿è¡Œã€‚</p><p>ä½¿ç”¨nohupå‘½ä»¤æ—¶ï¼Œç¨‹åºçš„è¾“å‡ºä¼šé»˜è®¤é‡å®šå‘åˆ°ä¸€ä¸ªnohup.outæ–‡ä»¶ä¸‹ã€‚è‹¥æ˜¯æƒ³è¦è¾“å‡ºåˆ°æŒ‡å®šçš„æ–‡ä»¶ï¼Œåˆ™å¯ä»¥å¦å¤–æŒ‡å®šè¾“å‡ºæ–‡ä»¶ã€‚</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-built_in">nohup</span> python3 test.py &gt; out.txt<br></code></pre></td></tr></table></figure><p>ä½†æ˜¯ç°åœ¨è¿˜åšä¸åˆ°è®©ç¨‹åºåœ¨åå°è¿è¡Œï¼Œå¦‚æœæƒ³è¦è®©ç¨‹åºåœ¨åå°è¿è¡Œçš„è¯ï¼Œå¯ä»¥åŠ ä¸Š &amp; </p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-built_in">nohup</span> python3 test.py &gt; out.txt &amp; <br></code></pre></td></tr></table></figure><p>æ­¤æ—¶å…³æ‰ç»ˆç«¯å†é‡æ–°æ‰“å¼€ï¼Œä½¿ç”¨pså‘½ä»¤æŸ¥çœ‹ä¸€ä¸‹è¿›ç¨‹ï¼Œå‘ç°ç¨‹åºè¿˜åœ¨è¿è¡Œã€‚</p><p>è¿™é‡Œå¦‚æœæƒ³è¦æŠŠæ ‡å‡†é”™è¯¯å’Œæ ‡å‡†è¾“å‡ºéƒ½é‡å®šå‘åˆ°æŒ‡å®šçš„out.txtæ–‡ä»¶ä¸­ï¼Œå¯ä»¥ä½¿ç”¨<code>2&gt;&amp;1</code>ç¬¦å·ï¼Œ<code>2&gt;&amp;1</code>ç¬¦å·çš„æ„æ€æ˜¯å°†å°†æ ‡å‡†é”™è¯¯ 2 é‡å®šå‘åˆ°æ ‡å‡†è¾“å‡º &amp;1ã€‚</p><ul><li>0 stdin (standard inputï¼Œæ ‡å‡†è¾“å…¥)</li><li>1 stdout (standard outputï¼Œæ ‡å‡†è¾“å‡º)</li><li>2 stderr (standard errorï¼Œæ ‡å‡†é”™è¯¯è¾“å‡º)</li></ul><p>å…·ä½“è¯¦æƒ…è§ï¼š<a href>2&gt;&amp;1åˆ°åº•æ˜¯ä»€ä¹ˆæ„æ€ï¼Ÿ</a></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-built_in">nohup</span> python3 test.py &gt; out.txt 2&gt;&amp;1 &amp; <br></code></pre></td></tr></table></figure><p><code>nohup</code>å‘½ä»¤ç»“åˆ<code>&amp;</code>ç¬¦å·å¯ä»¥ä½¿è¿›ç¨‹åœ¨åå°è¿è¡Œï¼Œå³ä½¿å…³é—­äº†ç»ˆç«¯ä¾ç„¶ä¸å—å½±å“ã€‚</p><p>é‚£ä¹ˆå¦‚ä½•ç»“æŸè¿›ç¨‹å‘¢ï¼Ÿ</p><h2 id="kill"><a href="#kill" class="headerlink" title="kill"></a>kill</h2><p>æ‰§è¡Œä¸€ä¸ª<code>kill</code>å‘½ä»¤æ—¶ï¼Œå®é™…ä¸Šæ˜¯å‘é€äº†ä¸€ä¸ªä¿¡å·ç»™ç³»ç»Ÿï¼Œè®©å®ƒå»ç»“æŸæ‰ä¸€äº›ä¸æ­£å¸¸çš„åº”ç”¨è¿›ç¨‹ã€‚ å¯ä»¥ä½¿ç”¨<code>kill -l</code>å‘½ä»¤çœ‹åˆ°æ‰€æœ‰ä¿¡å·çš„åˆ—è¡¨ï¼š</p><p><img src="/2022/10/18/nohup-shi-me-dong-xi/image-20221018215614795.png"></p><p>ä¸‹é¢æ˜¯ä¸€äº›å¸¸ç”¨ä¿¡å·çš„å«ä¹‰ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs bash">(1)SIGHUP ç»ˆç«¯çº¿è·¯æŒ‚æ–­ï¼Œç»ˆæ­¢è¿›ç¨‹<br>(2)SIGINT ä¸­æ–­è¿›ç¨‹ï¼ˆåŒ Ctrl + Cï¼‰<br>(3)SIGQUIT é€€å‡ºè¿›ç¨‹ï¼ˆåŒ Ctrl + \ï¼‰<br>(15)SIGTERM ç»ˆæ­¢è¿›ç¨‹<br>(9)SIGKILL å¼ºåˆ¶ç»ˆæ­¢è¿›ç¨‹<br>(18)SIGCONT ç»§ç»­ï¼ˆä¸SIGSTOPç›¸åï¼Œ <span class="hljs-built_in">fg</span>/bgå‘½ä»¤ï¼‰<br>(19)SIGSTOP æš‚åœï¼ˆåŒ Ctrl + Zï¼‰<br></code></pre></td></tr></table></figure><p>å¸¸ç”¨åˆ°çš„æœ‰15 å’Œ 9</p><p>(15)SIGTERMï¼šä¹Ÿå°±æ˜¯æ‰§è¡Œ<code>kill -15 pid</code>å‘½ä»¤ï¼Œè¿™é‡Œâ€-15â€å³ä»£è¡¨SIGTERMä¿¡å·ã€‚<br> æ³¨æ„ï¼šSIGTERMæ˜¯é»˜è®¤é€‰é¡¹ï¼Œä¹Ÿå°±æ˜¯è¯´æ‰§è¡Œ<code>kill pid</code>å’Œ<code>kill -15 pid</code>æ˜¯ç­‰ä»·çš„ã€‚<br> æ‰§è¡Œæ­¤æŒ‡ä»¤æ—¶æ“ä½œç³»ç»Ÿä¼šå‘é€ä¸€ä¸ªSIGTERMä¿¡å·ç»™å¯¹åº”çš„ç¨‹åºï¼Œå½“ç¨‹åºæ¥æ”¶åˆ°è¯¥ä¿¡å·åï¼Œå¯ä»¥ç”¨ä¸€æ®µæ—¶é—´æ¥æ­£å¸¸å…³é—­ï¼Œä¸€èˆ¬ä¼šå…ˆä¿å­˜è¿›åº¦å¹¶é‡Šæ”¾èµ„æºï¼Œç„¶åå†åœæ­¢ï¼Œä¹Ÿå°±æ˜¯ä¸ä¸€å®šä¼šç«‹å³åœæ­¢è¿›ç¨‹ï¼Œæ¯”å¦‚ç¨‹åºæ­£åœ¨ç­‰å¾…IOï¼Œå¯èƒ½å°±ä¸ä¼šç«‹é©¬åœæ­¢è¿è¡Œã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œ(15)SIGTERMä¿¡å·ä¸æ˜¯å¼ºåˆ¶åœæ­¢ï¼Œæ˜¯å¯ä»¥è¢«å¿½ç•¥çš„ã€‚</p><p>(9)SIGKILLï¼šä¹Ÿå°±æ˜¯æ‰§è¡Œ<code>kill -9 pid</code>å‘½ä»¤ï¼Œè¿™é‡Œâ€-9â€å³ä»£è¡¨SIGKILLä¿¡å·ã€‚<br> æ˜¯å¿…æ€ä¿¡å·ï¼Œæ­¤ä¿¡å·å¼ºåˆ¶è¿›ç¨‹ç«‹å³åœæ­¢è¿è¡Œã€‚ç¨‹åºä¸èƒ½å¿½ç•¥æ­¤ä¿¡å·ï¼Œè€Œæœªä¿å­˜çš„è¿›åº¦å°†ä¼šä¸¢å¤±ï¼Œä»è€Œå¯èƒ½ä¼šå½±å“æœåŠ¡çš„å†æ¬¡å¯åŠ¨ï¼Œæ­¤å‘½ä»¤åº”è¯¥æ…ç”¨ã€‚</p><p>killè¯­æ³•ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-built_in">kill</span> ä¿¡å·æˆ–é€‰é¡¹ pid<br></code></pre></td></tr></table></figure><p>é»˜è®¤ä¿¡å·ï¼ˆå½“æ²¡æœ‰æŒ‡å®šçš„æ—¶å€™ï¼‰æ˜¯SIGTERMã€‚å½“å®ƒä¸èµ·ä½œç”¨æ—¶ï¼Œå¯ä»¥ä½¿ç”¨<code>kill -9 pid</code>å‘½ä»¤æ¥å¼ºåˆ¶killæ‰ä¸€ä¸ªè¿›ç¨‹ã€‚</p><p>åº”ç”¨çš„pidå¯ä»¥ä½¿ç”¨ä»¥ä¸‹çš„å‘½ä»¤æŸ¥çœ‹ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs bash">ps -ef<br>ps -aux<br></code></pre></td></tr></table></figure><p>äºŒè€…éƒ½å¯ä»¥æŸ¥çœ‹åˆ°pid</p><p><img src="/2022/10/18/nohup-shi-me-dong-xi/image-20221018215918762.png"></p><p>æ¯”å¦‚æƒ³è¦killæ‰PIDä¸º108çš„è¿›ç¨‹ï¼Œåªéœ€è¦æ‰§è¡Œ<code>kill -9 108</code>å³å¯ã€‚</p>]]></content>
    
    
    <categories>
      
      <category>Linux</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Linux</tag>
      
      <tag>nohup</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>SpringBoot-æ•°æ®åº“</title>
    <link href="/2022/10/17/springboot-shu-ju-ku/"/>
    <url>/2022/10/17/springboot-shu-ju-ku/</url>
    
    <content type="html"><![CDATA[<h2 id="ä¸€ã€spring-boot-é›†æˆ-Jdbc-Template"><a href="#ä¸€ã€spring-boot-é›†æˆ-Jdbc-Template" class="headerlink" title="ä¸€ã€spring-boot é›†æˆ Jdbc Template"></a>ä¸€ã€spring-boot é›†æˆ Jdbc Template</h2><p>æ•´ä½“ç»“æ„ï¼š</p><p><img src="/2022/10/17/springboot-shu-ju-ku/image-20221017184658161.png" alt="æ•´ä½“ç»“æ„"></p><h3 id="1ã€å¯¼å…¥ä¾èµ–"><a href="#1ã€å¯¼å…¥ä¾èµ–" class="headerlink" title="1ã€å¯¼å…¥ä¾èµ–"></a>1ã€å¯¼å…¥ä¾èµ–</h3><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span><br>         <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>mysql<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span><br>         <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>mysql-connector-java<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span><br>      <span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span><br><br>      <span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span><br>         <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>cn.hutool<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span><br>         <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>hutool-all<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span><br>      <span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span><br><br>      <span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span><br>         <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>org.projectlombok<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span><br>         <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>lombok<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span><br>         <span class="hljs-tag">&lt;<span class="hljs-name">optional</span>&gt;</span>true<span class="hljs-tag">&lt;/<span class="hljs-name">optional</span>&gt;</span><br>      <span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span><br></code></pre></td></tr></table></figure><h3 id="2ã€application-yml"><a href="#2ã€application-yml" class="headerlink" title="2ã€application.yml"></a>2ã€application.yml</h3><figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><code class="hljs yml"><span class="hljs-attr">server:</span><br>  <span class="hljs-attr">port:</span> <span class="hljs-number">8080</span><br>  <span class="hljs-attr">servlet:</span><br>    <span class="hljs-attr">context-path:</span> <span class="hljs-string">/demo</span><br><span class="hljs-attr">spring:</span><br>  <span class="hljs-attr">datasource:</span><br>    <span class="hljs-attr">url:</span> <span class="hljs-string">jdbc:mysql://127.0.0.1:3306/spring-boot-demo?useUnicode=true&amp;characterEncoding=UTF-8&amp;useSSL=false&amp;autoReconnect=true&amp;failOverReadOnly=false&amp;serverTimezone=GMT%2B8</span><br>    <span class="hljs-attr">username:</span> <span class="hljs-string">root</span><br>    <span class="hljs-attr">password:</span> <span class="hljs-number">123456</span><br>    <span class="hljs-attr">driver-class-name:</span> <span class="hljs-string">com.mysql.cj.jdbc.Driver</span><br>    <span class="hljs-attr">type:</span> <span class="hljs-string">com.zaxxer.hikari.HikariDataSource</span><br>    <span class="hljs-attr">initialization-mode:</span> <span class="hljs-string">always</span><br>    <span class="hljs-attr">continue-on-error:</span> <span class="hljs-literal">true</span><br>    <span class="hljs-attr">schema:</span><br>    <span class="hljs-bullet">-</span> <span class="hljs-string">&quot;classpath:db/schema.sql&quot;</span><br>    <span class="hljs-attr">data:</span><br>    <span class="hljs-bullet">-</span> <span class="hljs-string">&quot;classpath:db/data.sql&quot;</span><br>    <span class="hljs-attr">hikari:</span><br>      <span class="hljs-attr">minimum-idle:</span> <span class="hljs-number">5</span><br>      <span class="hljs-attr">connection-test-query:</span> <span class="hljs-string">SELECT</span> <span class="hljs-number">1</span> <span class="hljs-string">FROM</span> <span class="hljs-string">DUAL</span><br>      <span class="hljs-attr">maximum-pool-size:</span> <span class="hljs-number">20</span><br>      <span class="hljs-attr">auto-commit:</span> <span class="hljs-literal">true</span><br>      <span class="hljs-attr">idle-timeout:</span> <span class="hljs-number">30000</span><br>      <span class="hljs-attr">pool-name:</span> <span class="hljs-string">SpringBootDemoHikariCP</span><br>      <span class="hljs-attr">max-lifetime:</span> <span class="hljs-number">60000</span><br>      <span class="hljs-attr">connection-timeout:</span> <span class="hljs-number">30000</span><br><span class="hljs-attr">logging:</span><br>  <span class="hljs-attr">level:</span><br>    <span class="hljs-attr">com.xkcoding:</span> <span class="hljs-string">debug</span><br></code></pre></td></tr></table></figure><h3 id="3ã€å®ä½“ç±»User"><a href="#3ã€å®ä½“ç±»User" class="headerlink" title="3ã€å®ä½“ç±»User"></a>3ã€å®ä½“ç±»User</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-meta">@Data</span><br><span class="hljs-meta">@Table(name = &quot;orm_user&quot;)</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">User</span> <span class="hljs-keyword">implements</span> <span class="hljs-title class_">Serializable</span> &#123;<br>    <span class="hljs-comment">/**</span><br><span class="hljs-comment">     * ä¸»é”®</span><br><span class="hljs-comment">     */</span><br>    <span class="hljs-meta">@Pk</span><br>    <span class="hljs-keyword">private</span> Long id;<br><br>    <span class="hljs-comment">/**</span><br><span class="hljs-comment">     * ç”¨æˆ·å</span><br><span class="hljs-comment">     */</span><br>    <span class="hljs-keyword">private</span> String name;<br><br>    <span class="hljs-comment">/**</span><br><span class="hljs-comment">     * åŠ å¯†åçš„å¯†ç </span><br><span class="hljs-comment">     */</span><br>    <span class="hljs-keyword">private</span> String password;<br><br>    <span class="hljs-comment">/**</span><br><span class="hljs-comment">     * åŠ å¯†ä½¿ç”¨çš„ç›</span><br><span class="hljs-comment">     */</span><br>    <span class="hljs-keyword">private</span> String salt;<br><br>    <span class="hljs-comment">/**</span><br><span class="hljs-comment">     * é‚®ç®±</span><br><span class="hljs-comment">     */</span><br>    <span class="hljs-keyword">private</span> String email;<br><br>    <span class="hljs-comment">/**</span><br><span class="hljs-comment">     * æ‰‹æœºå·ç </span><br><span class="hljs-comment">     */</span><br>    <span class="hljs-meta">@Column(name = &quot;phone_number&quot;)</span><br>    <span class="hljs-keyword">private</span> String phoneNumber;<br><br>    <span class="hljs-comment">/**</span><br><span class="hljs-comment">     * çŠ¶æ€ï¼Œ-1ï¼šé€»è¾‘åˆ é™¤ï¼Œ0ï¼šç¦ç”¨ï¼Œ1ï¼šå¯ç”¨</span><br><span class="hljs-comment">     */</span><br>    <span class="hljs-keyword">private</span> Integer status;<br><br>    <span class="hljs-comment">/**</span><br><span class="hljs-comment">     * åˆ›å»ºæ—¶é—´</span><br><span class="hljs-comment">     */</span><br>    <span class="hljs-meta">@Column(name = &quot;create_time&quot;)</span><br>    <span class="hljs-keyword">private</span> Date createTime;<br><br>    <span class="hljs-comment">/**</span><br><span class="hljs-comment">     * ä¸Šæ¬¡ç™»å½•æ—¶é—´</span><br><span class="hljs-comment">     */</span><br>    <span class="hljs-meta">@Column(name = &quot;last_login_time&quot;)</span><br>    <span class="hljs-keyword">private</span> Date lastLoginTime;<br><br>    <span class="hljs-comment">/**</span><br><span class="hljs-comment">     * ä¸Šæ¬¡æ›´æ–°æ—¶é—´</span><br><span class="hljs-comment">     */</span><br>    <span class="hljs-meta">@Column(name = &quot;last_update_time&quot;)</span><br>    <span class="hljs-keyword">private</span> Date lastUpdateTime;<br>&#125;<br></code></pre></td></tr></table></figure><h3 id="4ã€UserDaoç»§æ‰¿BaseDao"><a href="#4ã€UserDaoç»§æ‰¿BaseDao" class="headerlink" title="4ã€UserDaoç»§æ‰¿BaseDao"></a>4ã€UserDaoç»§æ‰¿BaseDao</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-meta">@Repository</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">UserDao</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_">BaseDao</span>&lt;User, Long&gt; &#123;<br><br>    <span class="hljs-meta">@Autowired</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-title function_">UserDao</span><span class="hljs-params">(JdbcTemplate jdbcTemplate)</span> &#123;<br>        <span class="hljs-built_in">super</span>(jdbcTemplate);<br>    &#125;<br><br>    <span class="hljs-comment">/**</span><br><span class="hljs-comment">     * ä¿å­˜ç”¨æˆ·</span><br><span class="hljs-comment">     *</span><br><span class="hljs-comment">     * <span class="hljs-doctag">@param</span> user ç”¨æˆ·å¯¹è±¡</span><br><span class="hljs-comment">     * <span class="hljs-doctag">@return</span> æ“ä½œå½±å“è¡Œæ•°</span><br><span class="hljs-comment">     */</span><br>    <span class="hljs-keyword">public</span> Integer <span class="hljs-title function_">insert</span><span class="hljs-params">(User user)</span> &#123;<br>        <span class="hljs-keyword">return</span> <span class="hljs-built_in">super</span>.insert(user, <span class="hljs-literal">true</span>);<br>    &#125;<br><br>    <span class="hljs-comment">/**</span><br><span class="hljs-comment">     * æ ¹æ®ä¸»é”®åˆ é™¤ç”¨æˆ·</span><br><span class="hljs-comment">     *</span><br><span class="hljs-comment">     * <span class="hljs-doctag">@param</span> id ä¸»é”®id</span><br><span class="hljs-comment">     * <span class="hljs-doctag">@return</span> æ“ä½œå½±å“è¡Œæ•°</span><br><span class="hljs-comment">     */</span><br>    <span class="hljs-keyword">public</span> Integer <span class="hljs-title function_">delete</span><span class="hljs-params">(Long id)</span> &#123;<br>        <span class="hljs-keyword">return</span> <span class="hljs-built_in">super</span>.deleteById(id);<br>    &#125;<br><br>    <span class="hljs-comment">/**</span><br><span class="hljs-comment">     * æ›´æ–°ç”¨æˆ·</span><br><span class="hljs-comment">     *</span><br><span class="hljs-comment">     * <span class="hljs-doctag">@param</span> user ç”¨æˆ·å¯¹è±¡</span><br><span class="hljs-comment">     * <span class="hljs-doctag">@param</span> id   ä¸»é”®id</span><br><span class="hljs-comment">     * <span class="hljs-doctag">@return</span> æ“ä½œå½±å“è¡Œæ•°</span><br><span class="hljs-comment">     */</span><br>    <span class="hljs-keyword">public</span> Integer <span class="hljs-title function_">update</span><span class="hljs-params">(User user, Long id)</span> &#123;<br>        <span class="hljs-keyword">return</span> <span class="hljs-built_in">super</span>.updateById(user, id, <span class="hljs-literal">true</span>);<br>    &#125;<br><br>    <span class="hljs-comment">/**</span><br><span class="hljs-comment">     * æ ¹æ®ä¸»é”®è·å–ç”¨æˆ·</span><br><span class="hljs-comment">     *</span><br><span class="hljs-comment">     * <span class="hljs-doctag">@param</span> id ä¸»é”®id</span><br><span class="hljs-comment">     * <span class="hljs-doctag">@return</span> idå¯¹åº”çš„ç”¨æˆ·</span><br><span class="hljs-comment">     */</span><br>    <span class="hljs-keyword">public</span> User <span class="hljs-title function_">selectById</span><span class="hljs-params">(Long id)</span> &#123;<br>        <span class="hljs-keyword">return</span> <span class="hljs-built_in">super</span>.findOneById(id);<br>    &#125;<br><br>    <span class="hljs-comment">/**</span><br><span class="hljs-comment">     * æ ¹æ®æŸ¥è¯¢æ¡ä»¶è·å–ç”¨æˆ·åˆ—è¡¨</span><br><span class="hljs-comment">     *</span><br><span class="hljs-comment">     * <span class="hljs-doctag">@param</span> user ç”¨æˆ·æŸ¥è¯¢æ¡ä»¶</span><br><span class="hljs-comment">     * <span class="hljs-doctag">@return</span> ç”¨æˆ·åˆ—è¡¨</span><br><span class="hljs-comment">     */</span><br>    <span class="hljs-keyword">public</span> List&lt;User&gt; <span class="hljs-title function_">selectUserList</span><span class="hljs-params">(User user)</span> &#123;<br>        <span class="hljs-keyword">return</span> <span class="hljs-built_in">super</span>.findByExample(user);<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><h3 id="5ã€UserServiceImplå®ç°IUserServiceæ¥å£"><a href="#5ã€UserServiceImplå®ç°IUserServiceæ¥å£" class="headerlink" title="5ã€UserServiceImplå®ç°IUserServiceæ¥å£"></a>5ã€UserServiceImplå®ç°IUserServiceæ¥å£</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-meta">@Service</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">UserServiceImpl</span> <span class="hljs-keyword">implements</span> <span class="hljs-title class_">IUserService</span> &#123;<br>    <span class="hljs-keyword">private</span> <span class="hljs-keyword">final</span> UserDao userDao;<br><br>    <span class="hljs-meta">@Autowired</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-title function_">UserServiceImpl</span><span class="hljs-params">(UserDao userDao)</span> &#123;<br>        <span class="hljs-built_in">this</span>.userDao = userDao;<br>    &#125;<br><br>    <span class="hljs-comment">/**</span><br><span class="hljs-comment">     * ä¿å­˜ç”¨æˆ·</span><br><span class="hljs-comment">     *</span><br><span class="hljs-comment">     * <span class="hljs-doctag">@param</span> user ç”¨æˆ·å®ä½“</span><br><span class="hljs-comment">     * <span class="hljs-doctag">@return</span> ä¿å­˜æˆåŠŸ &#123;<span class="hljs-doctag">@code</span> true&#125; ä¿å­˜å¤±è´¥ &#123;<span class="hljs-doctag">@code</span> false&#125;</span><br><span class="hljs-comment">     */</span><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-keyword">public</span> Boolean <span class="hljs-title function_">save</span><span class="hljs-params">(User user)</span> &#123;<br>        <span class="hljs-type">String</span> <span class="hljs-variable">rawPass</span> <span class="hljs-operator">=</span> user.getPassword();<br>        <span class="hljs-type">String</span> <span class="hljs-variable">salt</span> <span class="hljs-operator">=</span> IdUtil.simpleUUID();<br>        <span class="hljs-type">String</span> <span class="hljs-variable">pass</span> <span class="hljs-operator">=</span> SecureUtil.md5(rawPass + Const.SALT_PREFIX + salt);<br>        user.setPassword(pass);<br>        user.setSalt(salt);<br>        <span class="hljs-keyword">return</span> userDao.insert(user) &gt; <span class="hljs-number">0</span>;<br>    &#125;<br><br>    <span class="hljs-comment">/**</span><br><span class="hljs-comment">     * åˆ é™¤ç”¨æˆ·</span><br><span class="hljs-comment">     *</span><br><span class="hljs-comment">     * <span class="hljs-doctag">@param</span> id ä¸»é”®id</span><br><span class="hljs-comment">     * <span class="hljs-doctag">@return</span> åˆ é™¤æˆåŠŸ &#123;<span class="hljs-doctag">@code</span> true&#125; åˆ é™¤å¤±è´¥ &#123;<span class="hljs-doctag">@code</span> false&#125;</span><br><span class="hljs-comment">     */</span><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-keyword">public</span> Boolean <span class="hljs-title function_">delete</span><span class="hljs-params">(Long id)</span> &#123;<br>        <span class="hljs-keyword">return</span> userDao.delete(id) &gt; <span class="hljs-number">0</span>;<br>    &#125;<br><br>    <span class="hljs-comment">/**</span><br><span class="hljs-comment">     * æ›´æ–°ç”¨æˆ·</span><br><span class="hljs-comment">     *</span><br><span class="hljs-comment">     * <span class="hljs-doctag">@param</span> user ç”¨æˆ·å®ä½“</span><br><span class="hljs-comment">     * <span class="hljs-doctag">@param</span> id   ä¸»é”®id</span><br><span class="hljs-comment">     * <span class="hljs-doctag">@return</span> æ›´æ–°æˆåŠŸ &#123;<span class="hljs-doctag">@code</span> true&#125; æ›´æ–°å¤±è´¥ &#123;<span class="hljs-doctag">@code</span> false&#125;</span><br><span class="hljs-comment">     */</span><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-keyword">public</span> Boolean <span class="hljs-title function_">update</span><span class="hljs-params">(User user, Long id)</span> &#123;<br>        <span class="hljs-type">User</span> <span class="hljs-variable">exist</span> <span class="hljs-operator">=</span> getUser(id);<br>        <span class="hljs-keyword">if</span> (StrUtil.isNotBlank(user.getPassword())) &#123;<br>            <span class="hljs-type">String</span> <span class="hljs-variable">rawPass</span> <span class="hljs-operator">=</span> user.getPassword();<br>            <span class="hljs-type">String</span> <span class="hljs-variable">salt</span> <span class="hljs-operator">=</span> IdUtil.simpleUUID();<br>            <span class="hljs-type">String</span> <span class="hljs-variable">pass</span> <span class="hljs-operator">=</span> SecureUtil.md5(rawPass + Const.SALT_PREFIX + salt);<br>            user.setPassword(pass);<br>            user.setSalt(salt);<br>        &#125;<br>        BeanUtil.copyProperties(user, exist, CopyOptions.create().setIgnoreNullValue(<span class="hljs-literal">true</span>));<br>        exist.setLastUpdateTime(<span class="hljs-keyword">new</span> <span class="hljs-title class_">DateTime</span>());<br>        <span class="hljs-keyword">return</span> userDao.update(exist, id) &gt; <span class="hljs-number">0</span>;<br>    &#125;<br><br>    <span class="hljs-comment">/**</span><br><span class="hljs-comment">     * è·å–å•ä¸ªç”¨æˆ·</span><br><span class="hljs-comment">     *</span><br><span class="hljs-comment">     * <span class="hljs-doctag">@param</span> id ä¸»é”®id</span><br><span class="hljs-comment">     * <span class="hljs-doctag">@return</span> å•ä¸ªç”¨æˆ·å¯¹è±¡</span><br><span class="hljs-comment">     */</span><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-keyword">public</span> User <span class="hljs-title function_">getUser</span><span class="hljs-params">(Long id)</span> &#123;<br>        <span class="hljs-keyword">return</span> userDao.findOneById(id);<br>    &#125;<br><br>    <span class="hljs-comment">/**</span><br><span class="hljs-comment">     * è·å–ç”¨æˆ·åˆ—è¡¨</span><br><span class="hljs-comment">     *</span><br><span class="hljs-comment">     * <span class="hljs-doctag">@param</span> user ç”¨æˆ·å®ä½“</span><br><span class="hljs-comment">     * <span class="hljs-doctag">@return</span> ç”¨æˆ·åˆ—è¡¨</span><br><span class="hljs-comment">     */</span><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-keyword">public</span> List&lt;User&gt; <span class="hljs-title function_">getUser</span><span class="hljs-params">(User user)</span> &#123;<br>        <span class="hljs-keyword">return</span> userDao.findByExample(user);<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><h3 id="6ã€ç»“æœ"><a href="#6ã€ç»“æœ" class="headerlink" title="6ã€ç»“æœ"></a>6ã€ç»“æœ</h3><p><img src="/2022/10/17/springboot-shu-ju-ku/image-20221017184607196.png"></p><h2 id="äºŒã€spring-boot-é›†æˆåŸç”Ÿmybatis"><a href="#äºŒã€spring-boot-é›†æˆåŸç”Ÿmybatis" class="headerlink" title="äºŒã€spring-boot é›†æˆåŸç”Ÿmybatis"></a>äºŒã€spring-boot é›†æˆåŸç”Ÿmybatis</h2><p>spring-boot é›†æˆåŸç”Ÿmybatisï¼Œä½¿ç”¨ <a href="https://github.com/mybatis/spring-boot-starter">mybatis-spring-boot-starter</a> é›†æˆ</p><h3 id="1ã€å¯¼å…¥ä¾èµ–-1"><a href="#1ã€å¯¼å…¥ä¾èµ–-1" class="headerlink" title="1ã€å¯¼å…¥ä¾èµ–"></a>1ã€å¯¼å…¥ä¾èµ–</h3><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span><br>          <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>org.mybatis.spring.boot<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span><br>          <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>mybatis-spring-boot-starter<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span><br>          <span class="hljs-tag">&lt;<span class="hljs-name">version</span>&gt;</span>$&#123;mybatis.version&#125;<span class="hljs-tag">&lt;/<span class="hljs-name">version</span>&gt;</span><br>      <span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span><br><br>      <span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span><br>          <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>mysql<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span><br>          <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>mysql-connector-java<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span><br>      <span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span><br></code></pre></td></tr></table></figure><h3 id="2ã€ä¸»å¯åŠ¨ç±»"><a href="#2ã€ä¸»å¯åŠ¨ç±»" class="headerlink" title="2ã€ä¸»å¯åŠ¨ç±»"></a>2ã€ä¸»å¯åŠ¨ç±»</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-meta">@MapperScan(basePackages = &#123;&quot;com.xkcoding.orm.mybatis.mapper&quot;&#125;)</span><br><span class="hljs-meta">@SpringBootApplication</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">SpringBootDemoOrmMybatisApplication</span> &#123;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span> &#123;<br>        SpringApplication.run(SpringBootDemoOrmMybatisApplication.class, args);<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>è®°å¾—åŠ  @MapperScan æ³¨è§£</p><h3 id="3ã€application-yml"><a href="#3ã€application-yml" class="headerlink" title="3ã€application.yml"></a>3ã€application.yml</h3><figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><code class="hljs yml"><span class="hljs-attr">spring:</span><br>  <span class="hljs-attr">datasource:</span><br>    <span class="hljs-attr">url:</span> <span class="hljs-string">jdbc:mysql://127.0.0.1:3306/spring-boot-demo?useUnicode=true&amp;characterEncoding=UTF-8&amp;useSSL=false&amp;autoReconnect=true&amp;failOverReadOnly=false&amp;serverTimezone=GMT%2B8</span><br>    <span class="hljs-attr">username:</span> <span class="hljs-string">root</span><br>    <span class="hljs-attr">password:</span> <span class="hljs-number">123456</span><br>    <span class="hljs-attr">driver-class-name:</span> <span class="hljs-string">com.mysql.cj.jdbc.Driver</span><br>    <span class="hljs-attr">type:</span> <span class="hljs-string">com.zaxxer.hikari.HikariDataSource</span><br>    <span class="hljs-attr">initialization-mode:</span> <span class="hljs-string">always</span><br>    <span class="hljs-attr">continue-on-error:</span> <span class="hljs-literal">true</span><br>    <span class="hljs-attr">schema:</span><br>    <span class="hljs-bullet">-</span> <span class="hljs-string">&quot;classpath:db/schema.sql&quot;</span><br>    <span class="hljs-attr">data:</span><br>    <span class="hljs-bullet">-</span> <span class="hljs-string">&quot;classpath:db/data.sql&quot;</span><br>    <span class="hljs-attr">hikari:</span><br>      <span class="hljs-attr">minimum-idle:</span> <span class="hljs-number">5</span><br>      <span class="hljs-attr">connection-test-query:</span> <span class="hljs-string">SELECT</span> <span class="hljs-number">1</span> <span class="hljs-string">FROM</span> <span class="hljs-string">DUAL</span><br>      <span class="hljs-attr">maximum-pool-size:</span> <span class="hljs-number">20</span><br>      <span class="hljs-attr">auto-commit:</span> <span class="hljs-literal">true</span><br>      <span class="hljs-attr">idle-timeout:</span> <span class="hljs-number">30000</span><br>      <span class="hljs-attr">pool-name:</span> <span class="hljs-string">SpringBootDemoHikariCP</span><br>      <span class="hljs-attr">max-lifetime:</span> <span class="hljs-number">60000</span><br>      <span class="hljs-attr">connection-timeout:</span> <span class="hljs-number">30000</span><br><span class="hljs-attr">logging:</span><br>  <span class="hljs-attr">level:</span><br>    <span class="hljs-attr">com.xkcoding:</span> <span class="hljs-string">debug</span><br>    <span class="hljs-attr">com.xkcoding.orm.mybatis.mapper:</span> <span class="hljs-string">trace</span><br><span class="hljs-attr">mybatis:</span><br>  <span class="hljs-attr">configuration:</span><br>    <span class="hljs-comment"># ä¸‹åˆ’çº¿è½¬é©¼å³°</span><br>    <span class="hljs-attr">map-underscore-to-camel-case:</span> <span class="hljs-literal">true</span><br>  <span class="hljs-attr">mapper-locations:</span> <span class="hljs-string">classpath:mappers/*.xml</span><br>  <span class="hljs-attr">type-aliases-package:</span> <span class="hljs-string">com.xkcoding.orm.mybatis.entity</span><br></code></pre></td></tr></table></figure><h3 id="4ã€UserMapperæ¥å£"><a href="#4ã€UserMapperæ¥å£" class="headerlink" title="4ã€UserMapperæ¥å£"></a>4ã€UserMapperæ¥å£</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-meta">@Mapper</span><br><span class="hljs-meta">@Component</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">interface</span> <span class="hljs-title class_">UserMapper</span> &#123;<br><br>    <span class="hljs-comment">/**</span><br><span class="hljs-comment">     * æŸ¥è¯¢æ‰€æœ‰ç”¨æˆ·</span><br><span class="hljs-comment">     *</span><br><span class="hljs-comment">     * <span class="hljs-doctag">@return</span> ç”¨æˆ·åˆ—è¡¨</span><br><span class="hljs-comment">     */</span><br>    <span class="hljs-meta">@Select(&quot;SELECT * FROM orm_user&quot;)</span><br>    List&lt;User&gt; <span class="hljs-title function_">selectAllUser</span><span class="hljs-params">()</span>;<br><br>    <span class="hljs-comment">/**</span><br><span class="hljs-comment">     * æ ¹æ®idæŸ¥è¯¢ç”¨æˆ·</span><br><span class="hljs-comment">     *</span><br><span class="hljs-comment">     * <span class="hljs-doctag">@param</span> id ä¸»é”®id</span><br><span class="hljs-comment">     * <span class="hljs-doctag">@return</span> å½“å‰idçš„ç”¨æˆ·ï¼Œä¸å­˜åœ¨åˆ™æ˜¯ &#123;<span class="hljs-doctag">@code</span> null&#125;</span><br><span class="hljs-comment">     */</span><br>    <span class="hljs-meta">@Select(&quot;SELECT * FROM orm_user WHERE id = #&#123;id&#125;&quot;)</span><br>    User <span class="hljs-title function_">selectUserById</span><span class="hljs-params">(<span class="hljs-meta">@Param(&quot;id&quot;)</span> Long id)</span>;<br><br>    <span class="hljs-comment">/**</span><br><span class="hljs-comment">     * ä¿å­˜ç”¨æˆ·</span><br><span class="hljs-comment">     *</span><br><span class="hljs-comment">     * <span class="hljs-doctag">@param</span> user ç”¨æˆ·</span><br><span class="hljs-comment">     * <span class="hljs-doctag">@return</span> æˆåŠŸ - &#123;<span class="hljs-doctag">@code</span> 1&#125; å¤±è´¥ - &#123;<span class="hljs-doctag">@code</span> 0&#125;</span><br><span class="hljs-comment">     */</span><br>    <span class="hljs-type">int</span> <span class="hljs-title function_">saveUser</span><span class="hljs-params">(<span class="hljs-meta">@Param(&quot;user&quot;)</span> User user)</span>;<br><br>    <span class="hljs-comment">/**</span><br><span class="hljs-comment">     * åˆ é™¤ç”¨æˆ·</span><br><span class="hljs-comment">     *</span><br><span class="hljs-comment">     * <span class="hljs-doctag">@param</span> id ä¸»é”®id</span><br><span class="hljs-comment">     * <span class="hljs-doctag">@return</span> æˆåŠŸ - &#123;<span class="hljs-doctag">@code</span> 1&#125; å¤±è´¥ - &#123;<span class="hljs-doctag">@code</span> 0&#125;</span><br><span class="hljs-comment">     */</span><br>    <span class="hljs-type">int</span> <span class="hljs-title function_">deleteById</span><span class="hljs-params">(<span class="hljs-meta">@Param(&quot;id&quot;)</span> Long id)</span>;<br><br>&#125;<br></code></pre></td></tr></table></figure><h3 id="5ã€UserMapper-xml"><a href="#5ã€UserMapper-xml" class="headerlink" title="5ã€UserMapper.xml"></a>5ã€UserMapper.xml</h3><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-meta">&lt;?xml version=<span class="hljs-string">&quot;1.0&quot;</span> encoding=<span class="hljs-string">&quot;UTF-8&quot;</span>?&gt;</span><br><span class="hljs-meta">&lt;!DOCTYPE <span class="hljs-keyword">mapper</span> <span class="hljs-keyword">PUBLIC</span> <span class="hljs-string">&quot;-//mybatis.org//DTD Mapper 3.0//EN&quot;</span> <span class="hljs-string">&quot;http://mybatis.org/dtd/mybatis-3-mapper.dtd&quot;</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">mapper</span> <span class="hljs-attr">namespace</span>=<span class="hljs-string">&quot;com.xkcoding.orm.mybatis.mapper.UserMapper&quot;</span>&gt;</span><br><br>    <span class="hljs-tag">&lt;<span class="hljs-name">insert</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;saveUser&quot;</span>&gt;</span><br>        INSERT INTO `orm_user` (`name`,<br>                                `password`,<br>                                `salt`,<br>                                `email`,<br>                                `phone_number`,<br>                                `status`,<br>                                `create_time`,<br>                                `last_login_time`,<br>                                `last_update_time`)<br>        VALUES (#&#123;user.name&#125;,<br>                #&#123;user.password&#125;,<br>                #&#123;user.salt&#125;,<br>                #&#123;user.email&#125;,<br>                #&#123;user.phoneNumber&#125;,<br>                #&#123;user.status&#125;,<br>                #&#123;user.createTime&#125;,<br>                #&#123;user.lastLoginTime&#125;,<br>                #&#123;user.lastUpdateTime&#125;)<br>    <span class="hljs-tag">&lt;/<span class="hljs-name">insert</span>&gt;</span><br><br>    <span class="hljs-tag">&lt;<span class="hljs-name">delete</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;deleteById&quot;</span>&gt;</span><br>        DELETE<br>        FROM `orm_user`<br>        WHERE `id` = #&#123;id&#125;<br>    <span class="hljs-tag">&lt;/<span class="hljs-name">delete</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">mapper</span>&gt;</span><br></code></pre></td></tr></table></figure><h3 id="6ã€æµ‹è¯•"><a href="#6ã€æµ‹è¯•" class="headerlink" title="6ã€æµ‹è¯•"></a>6ã€æµ‹è¯•</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-meta">@Slf4j</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">UserMapperTest</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_">SpringBootDemoOrmMybatisApplicationTests</span> &#123;<br>    <span class="hljs-meta">@Autowired</span><br>    <span class="hljs-keyword">private</span> UserMapper userMapper;<br><br>    <span class="hljs-meta">@Test</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">selectAllUser</span><span class="hljs-params">()</span> &#123;<br>        List&lt;User&gt; userList = userMapper.selectAllUser();<br>        Assert.assertTrue(CollUtil.isNotEmpty(userList));<br>        log.debug(<span class="hljs-string">&quot;ã€userListã€‘= &#123;&#125;&quot;</span>, userList);<br>    &#125;<br><br>    <span class="hljs-meta">@Test</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">selectUserById</span><span class="hljs-params">()</span> &#123;<br>        <span class="hljs-type">User</span> <span class="hljs-variable">user</span> <span class="hljs-operator">=</span> userMapper.selectUserById(<span class="hljs-number">1L</span>);<br>        Assert.assertNotNull(user);<br>        log.debug(<span class="hljs-string">&quot;ã€userã€‘= &#123;&#125;&quot;</span>, user);<br>    &#125;<br><br>    <span class="hljs-meta">@Test</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">saveUser</span><span class="hljs-params">()</span> &#123;<br>        <span class="hljs-type">String</span> <span class="hljs-variable">salt</span> <span class="hljs-operator">=</span> IdUtil.fastSimpleUUID();<br>        <span class="hljs-type">User</span> <span class="hljs-variable">user</span> <span class="hljs-operator">=</span> User.builder().name(<span class="hljs-string">&quot;testSave3&quot;</span>).password(SecureUtil.md5(<span class="hljs-string">&quot;123456&quot;</span> + salt)).salt(salt).email(<span class="hljs-string">&quot;testSave3@xkcoding.com&quot;</span>).phoneNumber(<span class="hljs-string">&quot;17300000003&quot;</span>).status(<span class="hljs-number">1</span>).lastLoginTime(<span class="hljs-keyword">new</span> <span class="hljs-title class_">DateTime</span>()).createTime(<span class="hljs-keyword">new</span> <span class="hljs-title class_">DateTime</span>()).lastUpdateTime(<span class="hljs-keyword">new</span> <span class="hljs-title class_">DateTime</span>()).build();<br>        <span class="hljs-type">int</span> <span class="hljs-variable">i</span> <span class="hljs-operator">=</span> userMapper.saveUser(user);<br>        Assert.assertEquals(<span class="hljs-number">1</span>, i);<br>    &#125;<br><br>    <span class="hljs-meta">@Test</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">deleteById</span><span class="hljs-params">()</span> &#123;<br>        <span class="hljs-type">int</span> <span class="hljs-variable">i</span> <span class="hljs-operator">=</span> userMapper.deleteById(<span class="hljs-number">1L</span>);<br>        Assert.assertEquals(<span class="hljs-number">1</span>, i);<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><h3 id="7ã€å‚è€ƒ"><a href="#7ã€å‚è€ƒ" class="headerlink" title="7ã€å‚è€ƒ"></a>7ã€å‚è€ƒ</h3><ul><li>Mybatiså®˜æ–¹æ–‡æ¡£ï¼š<a href="http://www.mybatis.org/mybatis-3/zh/index.html">http://www.mybatis.org/mybatis-3/zh/index.html</a></li><li>Mybatiså®˜æ–¹è„šæ‰‹æ¶æ–‡æ¡£ï¼š<a href="http://www.mybatis.org/spring-boot-starter/mybatis-spring-boot-autoconfigure/">http://www.mybatis.org/spring-boot-starter/mybatis-spring-boot-autoconfigure/</a></li><li>Mybatisæ•´åˆSpring Bootå®˜æ–¹demoï¼š<a href="https://github.com/mybatis/spring-boot-starter/tree/master/mybatis-spring-boot-samples">https://github.com/mybatis/spring-boot-starter/tree/master/mybatis-spring-boot-samples</a></li></ul>]]></content>
    
    
    <categories>
      
      <category>åç«¯</category>
      
    </categories>
    
    
    <tags>
      
      <tag>java</tag>
      
      <tag>SpringBoot</tag>
      
      <tag>æ•°æ®åº“</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>SpringBoot-é…ç½®æ–‡ä»¶ä»¥åŠæ—¥å¿—</title>
    <link href="/2022/10/14/springboot-pei-zhi-wen-jian-yi-ji-ri-zhi/"/>
    <url>/2022/10/14/springboot-pei-zhi-wen-jian-yi-ji-ri-zhi/</url>
    
    <content type="html"><![CDATA[<h2 id="ä¸€ã€å¤šä¸ªé…ç½®æ–‡ä»¶çš„è¯»å–"><a href="#ä¸€ã€å¤šä¸ªé…ç½®æ–‡ä»¶çš„è¯»å–" class="headerlink" title="ä¸€ã€å¤šä¸ªé…ç½®æ–‡ä»¶çš„è¯»å–"></a>ä¸€ã€å¤šä¸ªé…ç½®æ–‡ä»¶çš„è¯»å–</h2><p>ç°åœ¨æœ‰å¤šä¸ªé…ç½®æ–‡ä»¶ï¼Œè¿è¡Œæ—¶è¦è¯»å–å…¶ä¸­ä¸€ä¸ªé…ç½®æ–‡ä»¶ï¼Œæ€ä¹ˆé€‰æ‹©ï¼Ÿ</p><p><img src="/2022/10/14/springboot-pei-zhi-wen-jian-yi-ji-ri-zhi/image-20221014172131119.png"></p><p>å¤šä¸ªé…ç½®æ–‡ä»¶çš„è¯»å–ï¼Œåœ¨è®¾ç½®å¥½propertyç±»åï¼Œå¯ä»¥åœ¨applicationä¸­é€‰æ‹©è¦è¯»å–çš„å¯¹è±¡ï¼Œå¦‚ä¸‹ï¼š</p><figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs yml"><span class="hljs-attr">server:</span><br>  <span class="hljs-attr">port:</span> <span class="hljs-number">8080</span><br>  <span class="hljs-attr">servlet:</span><br>    <span class="hljs-attr">context-path:</span> <span class="hljs-string">/demo</span><br><span class="hljs-attr">spring:</span><br>  <span class="hljs-attr">profiles:</span><br>    <span class="hljs-attr">active:</span> <span class="hljs-string">dev</span><br></code></pre></td></tr></table></figure><p>å½“è¦è¯»å– application-dev æ—¶ï¼Œåªéœ€å°†ç¬¬ä¸ƒè¡Œä»£ç æ”¹ä¸ºdevï¼Œå½“è¦è¯»å–application-prodæ—¶ï¼Œåªéœ€å°†ç¬¬ä¸ƒè¡Œä»£ç æ”¹ä¸ºprodã€‚</p><p>å¦‚ä¸‹æ˜¯è®¾ç½®ä¸ºdevçš„è¿è¡Œç»“æœï¼š</p><p><img src="/2022/10/14/springboot-pei-zhi-wen-jian-yi-ji-ri-zhi/image-20221014172456012.png"></p><h2 id="äºŒã€spring-boot-é›†æˆ-spring-boot-starter-actuator"><a href="#äºŒã€spring-boot-é›†æˆ-spring-boot-starter-actuator" class="headerlink" title="äºŒã€spring-boot é›†æˆ spring-boot-starter-actuator"></a>äºŒã€spring-boot é›†æˆ spring-boot-starter-actuator</h2><p>actuatorç”¨äºç›‘æ§ spring-boot çš„å¯åŠ¨å’Œè¿è¡ŒçŠ¶æ€</p><h3 id="1ã€pomæ–‡ä»¶"><a href="#1ã€pomæ–‡ä»¶" class="headerlink" title="1ã€pomæ–‡ä»¶"></a>1ã€pomæ–‡ä»¶</h3><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>org.springframework.boot<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>spring-boot-starter-actuator<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span><br><br><span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>org.springframework.boot<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>spring-boot-starter-security<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>org.springframework.security<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>spring-security-test<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">scope</span>&gt;</span>test<span class="hljs-tag">&lt;/<span class="hljs-name">scope</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span><br></code></pre></td></tr></table></figure><h3 id="2ã€application-yml"><a href="#2ã€application-yml" class="headerlink" title="2ã€application.yml"></a>2ã€application.yml</h3><figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><code class="hljs yml"><span class="hljs-attr">server:</span><br>  <span class="hljs-attr">port:</span> <span class="hljs-number">8080</span><br>  <span class="hljs-attr">servlet:</span><br>    <span class="hljs-attr">context-path:</span> <span class="hljs-string">/demo</span><br><span class="hljs-comment"># è‹¥è¦è®¿é—®ç«¯ç‚¹ä¿¡æ¯ï¼Œéœ€è¦é…ç½®ç”¨æˆ·åå’Œå¯†ç </span><br><span class="hljs-attr">spring:</span><br>  <span class="hljs-attr">security:</span><br>    <span class="hljs-attr">user:</span><br>      <span class="hljs-attr">name:</span> <span class="hljs-string">zhaibiao</span><br>      <span class="hljs-attr">password:</span> <span class="hljs-number">123456</span><br>      <br><span class="hljs-attr">management:</span><br>  <span class="hljs-comment"># ç«¯ç‚¹ä¿¡æ¯æ¥å£ä½¿ç”¨çš„ç«¯å£ï¼Œä¸ºäº†å’Œä¸»ç³»ç»Ÿæ¥å£ä½¿ç”¨çš„ç«¯å£è¿›è¡Œåˆ†ç¦»</span><br>  <span class="hljs-attr">server:</span><br>    <span class="hljs-attr">port:</span> <span class="hljs-number">8090</span><br>    <span class="hljs-attr">servlet:</span><br>      <span class="hljs-attr">context-path:</span> <span class="hljs-string">/sys</span><br>  <span class="hljs-comment"># ç«¯ç‚¹å¥åº·æƒ…å†µï¼Œé»˜è®¤å€¼&quot;never&quot;ï¼Œè®¾ç½®ä¸º&quot;always&quot;å¯ä»¥æ˜¾ç¤ºç¡¬ç›˜ä½¿ç”¨æƒ…å†µå’Œçº¿ç¨‹æƒ…å†µ</span><br>  <span class="hljs-attr">endpoint:</span><br>    <span class="hljs-attr">health:</span><br>      <span class="hljs-attr">show-details:</span> <span class="hljs-string">always</span><br>  <span class="hljs-comment"># è®¾ç½®ç«¯ç‚¹æš´éœ²çš„å“ªäº›å†…å®¹ï¼Œé»˜è®¤[&quot;health&quot;,&quot;info&quot;]ï¼Œè®¾ç½®&quot;*&quot;ä»£è¡¨æš´éœ²æ‰€æœ‰å¯è®¿é—®çš„ç«¯ç‚¹</span><br>  <span class="hljs-attr">endpoints:</span><br>    <span class="hljs-attr">web:</span><br>      <span class="hljs-attr">exposure:</span><br>        <span class="hljs-attr">include:</span> <span class="hljs-string">&#x27;*&#x27;</span><br></code></pre></td></tr></table></figure><h3 id="3ã€ç«¯ç‚¹æš´éœ²åœ°å€"><a href="#3ã€ç«¯ç‚¹æš´éœ²åœ°å€" class="headerlink" title="3ã€ç«¯ç‚¹æš´éœ²åœ°å€"></a>3ã€ç«¯ç‚¹æš´éœ²åœ°å€</h3><ol><li>æ‰“å¼€æµè§ˆå™¨ï¼Œè®¿é—®ï¼š<a href="http://localhost:8090/sys/actuator/mappings">http://localhost:8090/sys/actuator/mappings</a> ï¼Œè¾“å…¥ç”¨æˆ·å(zhaibiao)å¯†ç (123456)å³å¯çœ‹åˆ°æ‰€æœ‰çš„mappingä¿¡æ¯</li><li>è®¿é—®ï¼š<a href="http://localhost:8090/sys/actuator/beans">http://localhost:8090/sys/actuator/beans</a> ï¼Œè¾“å…¥ç”¨æˆ·å(zhaibiao)å¯†ç (123456)å³å¯çœ‹åˆ°æ‰€æœ‰ Spring ç®¡ç†çš„Bean</li></ol><ul><li>actuatoræ–‡æ¡£ï¼š<a href="https://docs.spring.io/spring-boot/docs/2.0.5.RELEASE/reference/htmlsingle/#production-ready">https://docs.spring.io/spring-boot/docs/2.0.5.RELEASE/reference/htmlsingle/#production-ready</a></li></ul><h3 id="4ã€ç»“æœ"><a href="#4ã€ç»“æœ" class="headerlink" title="4ã€ç»“æœ"></a>4ã€ç»“æœ</h3><p><img src="/2022/10/14/springboot-pei-zhi-wen-jian-yi-ji-ri-zhi/image-20221017161554284.png" alt="beans"></p><p><img src="/2022/10/14/springboot-pei-zhi-wen-jian-yi-ji-ri-zhi/image-20221017161608902.png" alt="mappings"></p><h2 id="ä¸‰ã€spring-booté›†æˆadmin"><a href="#ä¸‰ã€spring-booté›†æˆadmin" class="headerlink" title="ä¸‰ã€spring-booté›†æˆadmin"></a>ä¸‰ã€spring-booté›†æˆadmin</h2><h3 id="1ã€æœåŠ¡ç«¯"><a href="#1ã€æœåŠ¡ç«¯" class="headerlink" title="1ã€æœåŠ¡ç«¯"></a>1ã€æœåŠ¡ç«¯</h3><h4 id="1ã€å¯¼å…¥ä¾èµ–"><a href="#1ã€å¯¼å…¥ä¾èµ–" class="headerlink" title="1ã€å¯¼å…¥ä¾èµ–"></a>1ã€å¯¼å…¥ä¾èµ–</h4><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span><br>  <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>de.codecentric<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span><br>  <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>spring-boot-admin-starter-server<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span><br></code></pre></td></tr></table></figure><h4 id="2ã€é…ç½®æ–‡ä»¶"><a href="#2ã€é…ç½®æ–‡ä»¶" class="headerlink" title="2ã€é…ç½®æ–‡ä»¶"></a>2ã€é…ç½®æ–‡ä»¶</h4><p>æœåŠ¡ç«¯é…ç½®æ–‡ä»¶ä¸éœ€è¦å¤ªå¤šé…ç½®ï¼Œç«¯å£å·å³å¯</p><figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs yml"><span class="hljs-attr">server:</span><br>  <span class="hljs-attr">port:</span> <span class="hljs-number">8000</span><br></code></pre></td></tr></table></figure><h4 id="3ã€ä¸»å¯åŠ¨ç±»"><a href="#3ã€ä¸»å¯åŠ¨ç±»" class="headerlink" title="3ã€ä¸»å¯åŠ¨ç±»"></a>3ã€ä¸»å¯åŠ¨ç±»</h4><p>å¿…é¡»è¦åœ¨ä¸»å¯åŠ¨ç±»ä¸ŠåŠ  <code>@EnableAdminServer</code> æ³¨è§£</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-meta">@EnableAdminServer</span><br><span class="hljs-meta">@SpringBootApplication</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">SpringBootDemoAdminServerApplication</span> &#123;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span> &#123;<br>        SpringApplication.run(SpringBootDemoAdminServerApplication.class, args);<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><h3 id="2ã€å®¢æˆ·ç«¯"><a href="#2ã€å®¢æˆ·ç«¯" class="headerlink" title="2ã€å®¢æˆ·ç«¯"></a>2ã€å®¢æˆ·ç«¯</h3><h4 id="1ã€å¯¼å…¥ä¾èµ–-1"><a href="#1ã€å¯¼å…¥ä¾èµ–-1" class="headerlink" title="1ã€å¯¼å…¥ä¾èµ–"></a>1ã€å¯¼å…¥ä¾èµ–</h4><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span><br>  <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>de.codecentric<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span><br>  <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>spring-boot-admin-starter-client<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span><br><br><span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span><br>  <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>org.springframework.boot<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span><br>  <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>spring-boot-starter-security<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span><br></code></pre></td></tr></table></figure><h4 id="2ã€é…ç½®æ–‡ä»¶-1"><a href="#2ã€é…ç½®æ–‡ä»¶-1" class="headerlink" title="2ã€é…ç½®æ–‡ä»¶"></a>2ã€é…ç½®æ–‡ä»¶</h4><figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><code class="hljs yml"><span class="hljs-attr">server:</span><br>  <span class="hljs-attr">port:</span> <span class="hljs-number">8080</span><br>  <span class="hljs-attr">servlet:</span><br>    <span class="hljs-attr">context-path:</span> <span class="hljs-string">/demo</span><br><span class="hljs-attr">spring:</span><br>  <span class="hljs-attr">application:</span><br>    <span class="hljs-comment"># Spring Boot Adminå±•ç¤ºçš„å®¢æˆ·ç«¯é¡¹ç›®åï¼Œä¸è®¾ç½®ï¼Œä¼šä½¿ç”¨è‡ªåŠ¨ç”Ÿæˆçš„éšæœºid</span><br>    <span class="hljs-attr">name:</span> <span class="hljs-string">spring-boot-demo-admin-client</span><br>  <span class="hljs-attr">boot:</span><br>    <span class="hljs-attr">admin:</span><br>      <span class="hljs-attr">client:</span><br>        <span class="hljs-comment"># Spring Boot Admin æœåŠ¡ç«¯åœ°å€</span><br>        <span class="hljs-attr">url:</span> <span class="hljs-string">&quot;http://localhost:8000/&quot;</span><br>        <span class="hljs-attr">instance:</span><br>          <span class="hljs-attr">metadata:</span><br>            <span class="hljs-comment"># å®¢æˆ·ç«¯ç«¯ç‚¹ä¿¡æ¯çš„å®‰å…¨è®¤è¯ä¿¡æ¯</span><br>            <span class="hljs-attr">user.name:</span> <span class="hljs-string">$&#123;spring.security.user.name&#125;</span><br>            <span class="hljs-attr">user.password:</span> <span class="hljs-string">$&#123;spring.security.user.password&#125;</span><br>  <span class="hljs-attr">security:</span><br>    <span class="hljs-attr">user:</span><br>      <span class="hljs-attr">name:</span> <span class="hljs-string">zhaibiao</span><br>      <span class="hljs-attr">password:</span> <span class="hljs-number">123456</span><br><span class="hljs-attr">management:</span><br>  <span class="hljs-attr">endpoint:</span><br>    <span class="hljs-attr">health:</span><br>      <span class="hljs-comment"># ç«¯ç‚¹å¥åº·æƒ…å†µï¼Œé»˜è®¤å€¼&quot;never&quot;ï¼Œè®¾ç½®ä¸º&quot;always&quot;å¯ä»¥æ˜¾ç¤ºç¡¬ç›˜ä½¿ç”¨æƒ…å†µå’Œçº¿ç¨‹æƒ…å†µ</span><br>      <span class="hljs-attr">show-details:</span> <span class="hljs-string">always</span><br>  <span class="hljs-attr">endpoints:</span><br>    <span class="hljs-attr">web:</span><br>      <span class="hljs-attr">exposure:</span><br>        <span class="hljs-comment"># è®¾ç½®ç«¯ç‚¹æš´éœ²çš„å“ªäº›å†…å®¹ï¼Œé»˜è®¤[&quot;health&quot;,&quot;info&quot;]ï¼Œè®¾ç½®&quot;*&quot;ä»£è¡¨æš´éœ²æ‰€æœ‰å¯è®¿é—®çš„ç«¯ç‚¹</span><br>        <span class="hljs-attr">include:</span> <span class="hljs-string">&quot;*&quot;</span><br></code></pre></td></tr></table></figure><h4 id="3ã€æ§åˆ¶ç±»ï¼ˆç”¨æ¥æµ‹è¯•ï¼‰"><a href="#3ã€æ§åˆ¶ç±»ï¼ˆç”¨æ¥æµ‹è¯•ï¼‰" class="headerlink" title="3ã€æ§åˆ¶ç±»ï¼ˆç”¨æ¥æµ‹è¯•ï¼‰"></a>3ã€æ§åˆ¶ç±»ï¼ˆç”¨æ¥æµ‹è¯•ï¼‰</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-meta">@RestController</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">IndexController</span> &#123;<br>    <span class="hljs-meta">@GetMapping(value = &#123;&quot;&quot;, &quot;/&quot;&#125;)</span><br>    <span class="hljs-keyword">public</span> String <span class="hljs-title function_">index</span><span class="hljs-params">()</span> &#123;<br>        <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;This is a Spring Boot Admin Client.&quot;</span>;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><h3 id="3ã€ç»“æœ"><a href="#3ã€ç»“æœ" class="headerlink" title="3ã€ç»“æœ"></a>3ã€ç»“æœ</h3><p>è¿è¡Œæ­¥éª¤ï¼š</p><ol><li>å…ˆå¯åŠ¨serveræœåŠ¡ç«¯ï¼Œå¯åŠ¨ç®¡æ§å°æœåŠ¡ç«¯ç¨‹åº</li><li>å†å¯åŠ¨clientå®¢æˆ·ç«¯ï¼Œæ³¨å†Œåˆ°æœåŠ¡ç«¯</li><li>è§‚å¯ŸæœåŠ¡ç«¯é‡Œï¼Œå®¢æˆ·ç«¯ç¨‹åºçš„è¿è¡ŒçŠ¶æ€ç­‰ä¿¡æ¯</li></ol><p><img src="/2022/10/14/springboot-pei-zhi-wen-jian-yi-ji-ri-zhi/image-20221017163939849.png" alt="server"></p><p><img src="/2022/10/14/springboot-pei-zhi-wen-jian-yi-ji-ri-zhi/image-20221017164045955.png" alt="client"></p><h2 id="å››ã€spring-booté›†æˆlogback"><a href="#å››ã€spring-booté›†æˆlogback" class="headerlink" title="å››ã€spring-booté›†æˆlogback"></a>å››ã€spring-booté›†æˆlogback</h2><p>æ¼”ç¤ºå¦‚ä½•ä½¿ç”¨ logback è®°å½•ç¨‹åºè¿è¡Œè¿‡ç¨‹ä¸­çš„æ—¥å¿—ï¼Œä»¥åŠå¦‚ä½•é…ç½® logbackï¼Œå¯ä»¥åŒæ—¶ç”Ÿæˆæ§åˆ¶å°æ—¥å¿—å’Œæ–‡ä»¶æ—¥å¿—è®°å½•ï¼Œæ–‡ä»¶æ—¥å¿—ä»¥æ—¥æœŸå’Œå¤§å°è¿›è¡Œæ‹†åˆ†ç”Ÿæˆã€‚</p><h3 id="1ã€å¯¼å…¥ä¾èµ–-2"><a href="#1ã€å¯¼å…¥ä¾èµ–-2" class="headerlink" title="1ã€å¯¼å…¥ä¾èµ–"></a>1ã€å¯¼å…¥ä¾èµ–</h3><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">dependencies</span>&gt;</span><br> <span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span><br>  <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>org.springframework.boot<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span><br>  <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>spring-boot-starter-web<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span><br> <span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span><br><br> <span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span><br>  <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>org.springframework.boot<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span><br>  <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>spring-boot-starter-test<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span><br>  <span class="hljs-tag">&lt;<span class="hljs-name">scope</span>&gt;</span>test<span class="hljs-tag">&lt;/<span class="hljs-name">scope</span>&gt;</span><br> <span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span><br><br> <span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span><br>  <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>org.projectlombok<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span><br>  <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>lombok<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span><br>  <span class="hljs-tag">&lt;<span class="hljs-name">optional</span>&gt;</span>true<span class="hljs-tag">&lt;/<span class="hljs-name">optional</span>&gt;</span><br> <span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">dependencies</span>&gt;</span><br><br>   <span class="hljs-tag">&lt;<span class="hljs-name">build</span>&gt;</span><br>       <span class="hljs-tag">&lt;<span class="hljs-name">finalName</span>&gt;</span>demo-logback<span class="hljs-tag">&lt;/<span class="hljs-name">finalName</span>&gt;</span><br>       <span class="hljs-tag">&lt;<span class="hljs-name">plugins</span>&gt;</span><br>           <span class="hljs-tag">&lt;<span class="hljs-name">plugin</span>&gt;</span><br>               <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>org.springframework.boot<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span><br>               <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>spring-boot-maven-plugin<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span><br>           <span class="hljs-tag">&lt;/<span class="hljs-name">plugin</span>&gt;</span><br>       <span class="hljs-tag">&lt;/<span class="hljs-name">plugins</span>&gt;</span><br>   <span class="hljs-tag">&lt;/<span class="hljs-name">build</span>&gt;</span><br></code></pre></td></tr></table></figure><h3 id="2ã€é…ç½®æ–‡ä»¶-2"><a href="#2ã€é…ç½®æ–‡ä»¶-2" class="headerlink" title="2ã€é…ç½®æ–‡ä»¶"></a>2ã€é…ç½®æ–‡ä»¶</h3><figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs yml"><span class="hljs-attr">server:</span><br>  <span class="hljs-attr">port:</span> <span class="hljs-number">8080</span><br>  <span class="hljs-attr">servlet:</span><br>    <span class="hljs-attr">context-path:</span> <span class="hljs-string">/demo</span><br></code></pre></td></tr></table></figure><p>é…ç½®ç«¯å£</p><h3 id="3ã€logback-spring-xml"><a href="#3ã€logback-spring-xml" class="headerlink" title="3ã€logback-spring.xml"></a>3ã€logback-spring.xml</h3><p>åœ¨resourcesä¸‹å»ºç«‹logback-spring.xmlç”¨äºé…ç½®logback</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-meta">&lt;?xml version=<span class="hljs-string">&quot;1.0&quot;</span> encoding=<span class="hljs-string">&quot;UTF-8&quot;</span>?&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">configuration</span>&gt;</span><br>  <span class="hljs-tag">&lt;<span class="hljs-name">property</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;FILE_ERROR_PATTERN&quot;</span></span><br><span class="hljs-tag">            <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;$&#123;FILE_LOG_PATTERN:-%d&#123;$&#123;LOG_DATEFORMAT_PATTERN:-yyyy-MM-dd HH:mm:ss.SSS&#125;&#125; $&#123;LOG_LEVEL_PATTERN:-%5p&#125; $&#123;PID:- &#125; --- [%t] %-40.40logger&#123;39&#125; %file:%line: %m%n$&#123;LOG_EXCEPTION_CONVERSION_WORD:-%wEx&#125;&#125;&quot;</span>/&gt;</span><br>  <span class="hljs-tag">&lt;<span class="hljs-name">include</span> <span class="hljs-attr">resource</span>=<span class="hljs-string">&quot;org/springframework/boot/logging/logback/defaults.xml&quot;</span>/&gt;</span><br> <span class="hljs-tag">&lt;<span class="hljs-name">appender</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;CONSOLE&quot;</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;ch.qos.logback.core.ConsoleAppender&quot;</span>&gt;</span><br>  <span class="hljs-tag">&lt;<span class="hljs-name">filter</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;ch.qos.logback.classic.filter.LevelFilter&quot;</span>&gt;</span><br>   <span class="hljs-tag">&lt;<span class="hljs-name">level</span>&gt;</span>INFO<span class="hljs-tag">&lt;/<span class="hljs-name">level</span>&gt;</span><br>  <span class="hljs-tag">&lt;/<span class="hljs-name">filter</span>&gt;</span><br>  <span class="hljs-tag">&lt;<span class="hljs-name">encoder</span>&gt;</span><br>   <span class="hljs-tag">&lt;<span class="hljs-name">pattern</span>&gt;</span>$&#123;CONSOLE_LOG_PATTERN&#125;<span class="hljs-tag">&lt;/<span class="hljs-name">pattern</span>&gt;</span><br>   <span class="hljs-tag">&lt;<span class="hljs-name">charset</span>&gt;</span>UTF-8<span class="hljs-tag">&lt;/<span class="hljs-name">charset</span>&gt;</span><br>  <span class="hljs-tag">&lt;/<span class="hljs-name">encoder</span>&gt;</span><br> <span class="hljs-tag">&lt;/<span class="hljs-name">appender</span>&gt;</span><br><br> <span class="hljs-tag">&lt;<span class="hljs-name">appender</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;FILE_INFO&quot;</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;ch.qos.logback.core.rolling.RollingFileAppender&quot;</span>&gt;</span><br>  <span class="hljs-comment">&lt;!--å¦‚æœåªæ˜¯æƒ³è¦ Info çº§åˆ«çš„æ—¥å¿—ï¼Œåªæ˜¯è¿‡æ»¤ info è¿˜æ˜¯ä¼šè¾“å‡º Error æ—¥å¿—ï¼Œå› ä¸º Error çš„çº§åˆ«é«˜ï¼Œ æ‰€ä»¥æˆ‘ä»¬ä½¿ç”¨ä¸‹é¢çš„ç­–ç•¥ï¼Œå¯ä»¥é¿å…è¾“å‡º Error çš„æ—¥å¿—--&gt;</span><br>  <span class="hljs-tag">&lt;<span class="hljs-name">filter</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;ch.qos.logback.classic.filter.LevelFilter&quot;</span>&gt;</span><br>   <span class="hljs-comment">&lt;!--è¿‡æ»¤ Error--&gt;</span><br>   <span class="hljs-tag">&lt;<span class="hljs-name">level</span>&gt;</span>ERROR<span class="hljs-tag">&lt;/<span class="hljs-name">level</span>&gt;</span><br>   <span class="hljs-comment">&lt;!--åŒ¹é…åˆ°å°±ç¦æ­¢--&gt;</span><br>   <span class="hljs-tag">&lt;<span class="hljs-name">onMatch</span>&gt;</span>DENY<span class="hljs-tag">&lt;/<span class="hljs-name">onMatch</span>&gt;</span><br>   <span class="hljs-comment">&lt;!--æ²¡æœ‰åŒ¹é…åˆ°å°±å…è®¸--&gt;</span><br>   <span class="hljs-tag">&lt;<span class="hljs-name">onMismatch</span>&gt;</span>ACCEPT<span class="hljs-tag">&lt;/<span class="hljs-name">onMismatch</span>&gt;</span><br>  <span class="hljs-tag">&lt;/<span class="hljs-name">filter</span>&gt;</span><br>  <span class="hljs-comment">&lt;!--æ—¥å¿—åç§°ï¼Œå¦‚æœæ²¡æœ‰File å±æ€§ï¼Œé‚£ä¹ˆåªä¼šä½¿ç”¨FileNamePatternçš„æ–‡ä»¶è·¯å¾„è§„åˆ™å¦‚æœåŒæ—¶æœ‰&lt;File&gt;å’Œ&lt;FileNamePattern&gt;ï¼Œé‚£ä¹ˆå½“å¤©æ—¥å¿—æ˜¯&lt;File&gt;ï¼Œæ˜å¤©ä¼šè‡ªåŠ¨æŠŠä»Šå¤©çš„æ—¥å¿—æ”¹åä¸ºä»Šå¤©çš„æ—¥æœŸã€‚å³ï¼Œ&lt;File&gt; çš„æ—¥å¿—éƒ½æ˜¯å½“å¤©çš„ã€‚--&gt;</span><br>  <span class="hljs-comment">&lt;!--&lt;File&gt;logs/info.demo-logback.log&lt;/File&gt;--&gt;</span><br>  <span class="hljs-comment">&lt;!--æ»šåŠ¨ç­–ç•¥ï¼ŒæŒ‰ç…§æ—¶é—´æ»šåŠ¨ TimeBasedRollingPolicy--&gt;</span><br>  <span class="hljs-tag">&lt;<span class="hljs-name">rollingPolicy</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;ch.qos.logback.core.rolling.TimeBasedRollingPolicy&quot;</span>&gt;</span><br>   <span class="hljs-comment">&lt;!--æ–‡ä»¶è·¯å¾„,å®šä¹‰äº†æ—¥å¿—çš„åˆ‡åˆ†æ–¹å¼â€”â€”æŠŠæ¯ä¸€å¤©çš„æ—¥å¿—å½’æ¡£åˆ°ä¸€ä¸ªæ–‡ä»¶ä¸­,ä»¥é˜²æ­¢æ—¥å¿—å¡«æ»¡æ•´ä¸ªç£ç›˜ç©ºé—´--&gt;</span><br>   <span class="hljs-tag">&lt;<span class="hljs-name">FileNamePattern</span>&gt;</span>logs/demo-logback/info.created_on_%d&#123;yyyy-MM-dd&#125;.part_%i.log<span class="hljs-tag">&lt;/<span class="hljs-name">FileNamePattern</span>&gt;</span><br>   <span class="hljs-comment">&lt;!--åªä¿ç•™æœ€è¿‘90å¤©çš„æ—¥å¿—--&gt;</span><br>   <span class="hljs-tag">&lt;<span class="hljs-name">maxHistory</span>&gt;</span>90<span class="hljs-tag">&lt;/<span class="hljs-name">maxHistory</span>&gt;</span><br>   <span class="hljs-comment">&lt;!--ç”¨æ¥æŒ‡å®šæ—¥å¿—æ–‡ä»¶çš„ä¸Šé™å¤§å°ï¼Œé‚£ä¹ˆåˆ°äº†è¿™ä¸ªå€¼ï¼Œå°±ä¼šåˆ é™¤æ—§çš„æ—¥å¿—--&gt;</span><br>   <span class="hljs-comment">&lt;!--&lt;totalSizeCap&gt;1GB&lt;/totalSizeCap&gt;--&gt;</span><br>   <span class="hljs-tag">&lt;<span class="hljs-name">timeBasedFileNamingAndTriggeringPolicy</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;ch.qos.logback.core.rolling.SizeAndTimeBasedFNATP&quot;</span>&gt;</span><br>    <span class="hljs-comment">&lt;!-- maxFileSize:è¿™æ˜¯æ´»åŠ¨æ–‡ä»¶çš„å¤§å°ï¼Œé»˜è®¤å€¼æ˜¯10MB,æœ¬ç¯‡è®¾ç½®ä¸º1KBï¼Œåªæ˜¯ä¸ºäº†æ¼”ç¤º --&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">maxFileSize</span>&gt;</span>2MB<span class="hljs-tag">&lt;/<span class="hljs-name">maxFileSize</span>&gt;</span><br>   <span class="hljs-tag">&lt;/<span class="hljs-name">timeBasedFileNamingAndTriggeringPolicy</span>&gt;</span><br>  <span class="hljs-tag">&lt;/<span class="hljs-name">rollingPolicy</span>&gt;</span><br>  <span class="hljs-comment">&lt;!--&lt;triggeringPolicy class=&quot;ch.qos.logback.core.rolling.SizeBasedTriggeringPolicy&quot;&gt;--&gt;</span><br>  <span class="hljs-comment">&lt;!--&lt;maxFileSize&gt;1KB&lt;/maxFileSize&gt;--&gt;</span><br>  <span class="hljs-comment">&lt;!--&lt;/triggeringPolicy&gt;--&gt;</span><br>  <span class="hljs-tag">&lt;<span class="hljs-name">encoder</span>&gt;</span><br>   <span class="hljs-tag">&lt;<span class="hljs-name">pattern</span>&gt;</span>$&#123;FILE_LOG_PATTERN&#125;<span class="hljs-tag">&lt;/<span class="hljs-name">pattern</span>&gt;</span><br>   <span class="hljs-tag">&lt;<span class="hljs-name">charset</span>&gt;</span>UTF-8<span class="hljs-tag">&lt;/<span class="hljs-name">charset</span>&gt;</span> <span class="hljs-comment">&lt;!-- æ­¤å¤„è®¾ç½®å­—ç¬¦é›† --&gt;</span><br>  <span class="hljs-tag">&lt;/<span class="hljs-name">encoder</span>&gt;</span><br> <span class="hljs-tag">&lt;/<span class="hljs-name">appender</span>&gt;</span><br><br> <span class="hljs-tag">&lt;<span class="hljs-name">appender</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;FILE_ERROR&quot;</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;ch.qos.logback.core.rolling.RollingFileAppender&quot;</span>&gt;</span><br>  <span class="hljs-comment">&lt;!--å¦‚æœåªæ˜¯æƒ³è¦ Error çº§åˆ«çš„æ—¥å¿—ï¼Œé‚£ä¹ˆéœ€è¦è¿‡æ»¤ä¸€ä¸‹ï¼Œé»˜è®¤æ˜¯ info çº§åˆ«çš„ï¼ŒThresholdFilter--&gt;</span><br>  <span class="hljs-tag">&lt;<span class="hljs-name">filter</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;ch.qos.logback.classic.filter.ThresholdFilter&quot;</span>&gt;</span><br>   <span class="hljs-tag">&lt;<span class="hljs-name">level</span>&gt;</span>Error<span class="hljs-tag">&lt;/<span class="hljs-name">level</span>&gt;</span><br>  <span class="hljs-tag">&lt;/<span class="hljs-name">filter</span>&gt;</span><br>  <span class="hljs-comment">&lt;!--æ—¥å¿—åç§°ï¼Œå¦‚æœæ²¡æœ‰File å±æ€§ï¼Œé‚£ä¹ˆåªä¼šä½¿ç”¨FileNamePatternçš„æ–‡ä»¶è·¯å¾„è§„åˆ™å¦‚æœåŒæ—¶æœ‰&lt;File&gt;å’Œ&lt;FileNamePattern&gt;ï¼Œé‚£ä¹ˆå½“å¤©æ—¥å¿—æ˜¯&lt;File&gt;ï¼Œæ˜å¤©ä¼šè‡ªåŠ¨æŠŠä»Šå¤©çš„æ—¥å¿—æ”¹åä¸ºä»Šå¤©çš„æ—¥æœŸã€‚å³ï¼Œ&lt;File&gt; çš„æ—¥å¿—éƒ½æ˜¯å½“å¤©çš„ã€‚--&gt;</span><br>  <span class="hljs-comment">&lt;!--&lt;File&gt;logs/error.demo-logback.log&lt;/File&gt;--&gt;</span><br>  <span class="hljs-comment">&lt;!--æ»šåŠ¨ç­–ç•¥ï¼ŒæŒ‰ç…§æ—¶é—´æ»šåŠ¨ TimeBasedRollingPolicy--&gt;</span><br>  <span class="hljs-tag">&lt;<span class="hljs-name">rollingPolicy</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;ch.qos.logback.core.rolling.TimeBasedRollingPolicy&quot;</span>&gt;</span><br>   <span class="hljs-comment">&lt;!--æ–‡ä»¶è·¯å¾„,å®šä¹‰äº†æ—¥å¿—çš„åˆ‡åˆ†æ–¹å¼â€”â€”æŠŠæ¯ä¸€å¤©çš„æ—¥å¿—å½’æ¡£åˆ°ä¸€ä¸ªæ–‡ä»¶ä¸­,ä»¥é˜²æ­¢æ—¥å¿—å¡«æ»¡æ•´ä¸ªç£ç›˜ç©ºé—´--&gt;</span><br>   <span class="hljs-tag">&lt;<span class="hljs-name">FileNamePattern</span>&gt;</span>logs/demo-logback/error.created_on_%d&#123;yyyy-MM-dd&#125;.part_%i.log<span class="hljs-tag">&lt;/<span class="hljs-name">FileNamePattern</span>&gt;</span><br>   <span class="hljs-comment">&lt;!--åªä¿ç•™æœ€è¿‘90å¤©çš„æ—¥å¿—--&gt;</span><br>   <span class="hljs-tag">&lt;<span class="hljs-name">maxHistory</span>&gt;</span>90<span class="hljs-tag">&lt;/<span class="hljs-name">maxHistory</span>&gt;</span><br>   <span class="hljs-tag">&lt;<span class="hljs-name">timeBasedFileNamingAndTriggeringPolicy</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;ch.qos.logback.core.rolling.SizeAndTimeBasedFNATP&quot;</span>&gt;</span><br>    <span class="hljs-comment">&lt;!-- maxFileSize:è¿™æ˜¯æ´»åŠ¨æ–‡ä»¶çš„å¤§å°ï¼Œé»˜è®¤å€¼æ˜¯10MB,æœ¬ç¯‡è®¾ç½®ä¸º1KBï¼Œåªæ˜¯ä¸ºäº†æ¼”ç¤º --&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">maxFileSize</span>&gt;</span>2MB<span class="hljs-tag">&lt;/<span class="hljs-name">maxFileSize</span>&gt;</span><br>   <span class="hljs-tag">&lt;/<span class="hljs-name">timeBasedFileNamingAndTriggeringPolicy</span>&gt;</span><br>  <span class="hljs-tag">&lt;/<span class="hljs-name">rollingPolicy</span>&gt;</span><br>  <span class="hljs-tag">&lt;<span class="hljs-name">encoder</span>&gt;</span><br>   <span class="hljs-tag">&lt;<span class="hljs-name">pattern</span>&gt;</span>$&#123;FILE_ERROR_PATTERN&#125;<span class="hljs-tag">&lt;/<span class="hljs-name">pattern</span>&gt;</span><br>   <span class="hljs-tag">&lt;<span class="hljs-name">charset</span>&gt;</span>UTF-8<span class="hljs-tag">&lt;/<span class="hljs-name">charset</span>&gt;</span> <span class="hljs-comment">&lt;!-- æ­¤å¤„è®¾ç½®å­—ç¬¦é›† --&gt;</span><br>  <span class="hljs-tag">&lt;/<span class="hljs-name">encoder</span>&gt;</span><br> <span class="hljs-tag">&lt;/<span class="hljs-name">appender</span>&gt;</span><br><br> <span class="hljs-tag">&lt;<span class="hljs-name">root</span> <span class="hljs-attr">level</span>=<span class="hljs-string">&quot;info&quot;</span>&gt;</span><br>  <span class="hljs-tag">&lt;<span class="hljs-name">appender-ref</span> <span class="hljs-attr">ref</span>=<span class="hljs-string">&quot;CONSOLE&quot;</span>/&gt;</span><br>  <span class="hljs-tag">&lt;<span class="hljs-name">appender-ref</span> <span class="hljs-attr">ref</span>=<span class="hljs-string">&quot;FILE_INFO&quot;</span>/&gt;</span><br>  <span class="hljs-tag">&lt;<span class="hljs-name">appender-ref</span> <span class="hljs-attr">ref</span>=<span class="hljs-string">&quot;FILE_ERROR&quot;</span>/&gt;</span><br> <span class="hljs-tag">&lt;/<span class="hljs-name">root</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">configuration</span>&gt;</span><br></code></pre></td></tr></table></figure><h3 id="4ã€ä¸»å¯åŠ¨ç±»è¿›è¡Œæµ‹è¯•"><a href="#4ã€ä¸»å¯åŠ¨ç±»è¿›è¡Œæµ‹è¯•" class="headerlink" title="4ã€ä¸»å¯åŠ¨ç±»è¿›è¡Œæµ‹è¯•"></a>4ã€ä¸»å¯åŠ¨ç±»è¿›è¡Œæµ‹è¯•</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-meta">@SpringBootApplication</span><br><span class="hljs-meta">@Slf4j</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">SpringBootDemoLogbackApplication</span> &#123;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span> &#123;<br>        <span class="hljs-type">ConfigurableApplicationContext</span> <span class="hljs-variable">context</span> <span class="hljs-operator">=</span> SpringApplication.run(SpringBootDemoLogbackApplication.class, args);<br>        <span class="hljs-type">int</span> <span class="hljs-variable">length</span> <span class="hljs-operator">=</span> context.getBeanDefinitionNames().length;<br>        log.trace(<span class="hljs-string">&quot;Spring bootå¯åŠ¨åˆå§‹åŒ–äº† &#123;&#125; ä¸ª Bean&quot;</span>, length);<br>        log.debug(<span class="hljs-string">&quot;Spring bootå¯åŠ¨åˆå§‹åŒ–äº† &#123;&#125; ä¸ª Bean&quot;</span>, length);<br>        log.info(<span class="hljs-string">&quot;Spring bootå¯åŠ¨åˆå§‹åŒ–äº† &#123;&#125; ä¸ª Bean&quot;</span>, length);<br>        log.warn(<span class="hljs-string">&quot;Spring bootå¯åŠ¨åˆå§‹åŒ–äº† &#123;&#125; ä¸ª Bean&quot;</span>, length);<br>        log.error(<span class="hljs-string">&quot;Spring bootå¯åŠ¨åˆå§‹åŒ–äº† &#123;&#125; ä¸ª Bean&quot;</span>, length);<br>        <span class="hljs-keyword">try</span> &#123;<br>            <span class="hljs-type">int</span> <span class="hljs-variable">i</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>;<br>            <span class="hljs-comment">//int j = 1 / i;</span><br>        &#125; <span class="hljs-keyword">catch</span> (Exception e) &#123;<br>            log.error(<span class="hljs-string">&quot;ã€SpringBootDemoLogbackApplicationã€‘å¯åŠ¨å¼‚å¸¸ï¼š&quot;</span>, e);<br>        &#125;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><h3 id="5ã€ç»“æœ"><a href="#5ã€ç»“æœ" class="headerlink" title="5ã€ç»“æœ"></a>5ã€ç»“æœ</h3><p>æŠ¥é”™æ—¥å¿—å¦‚ä¸‹ï¼š</p><p><img src="/2022/10/14/springboot-pei-zhi-wen-jian-yi-ji-ri-zhi/image-20221017170557025.png" alt="Error"></p><blockquote><p>TODO</p></blockquote><h2 id="äº”ã€spring-boot-ä½¿ç”¨-AOP-åˆ‡é¢çš„æ–¹å¼è®°å½•-web-è¯·æ±‚æ—¥å¿—"><a href="#äº”ã€spring-boot-ä½¿ç”¨-AOP-åˆ‡é¢çš„æ–¹å¼è®°å½•-web-è¯·æ±‚æ—¥å¿—" class="headerlink" title="äº”ã€spring-boot ä½¿ç”¨ AOP åˆ‡é¢çš„æ–¹å¼è®°å½• web è¯·æ±‚æ—¥å¿—"></a>äº”ã€spring-boot ä½¿ç”¨ AOP åˆ‡é¢çš„æ–¹å¼è®°å½• web è¯·æ±‚æ—¥å¿—</h2><h2 id="å…­ã€spring-boot-ç»Ÿä¸€å¼‚å¸¸å¤„ç†"><a href="#å…­ã€spring-boot-ç»Ÿä¸€å¼‚å¸¸å¤„ç†" class="headerlink" title="å…­ã€spring-boot ç»Ÿä¸€å¼‚å¸¸å¤„ç†"></a>å…­ã€spring-boot ç»Ÿä¸€å¼‚å¸¸å¤„ç†</h2>]]></content>
    
    
    <categories>
      
      <category>åç«¯</category>
      
    </categories>
    
    
    <tags>
      
      <tag>java</tag>
      
      <tag>SpringBoot</tag>
      
      <tag>é…ç½®æ–‡ä»¶</tag>
      
      <tag>æ—¥å¿—</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>v2-å“ˆå¸Œè¡¨</title>
    <link href="/2022/10/13/v2-ha-xi-biao/"/>
    <url>/2022/10/13/v2-ha-xi-biao/</url>
    
    <content type="html"><![CDATA[<h1 id="ä¸€ã€ç†è®ºåŸºç¡€"><a href="#ä¸€ã€ç†è®ºåŸºç¡€" class="headerlink" title="ä¸€ã€ç†è®ºåŸºç¡€"></a>ä¸€ã€ç†è®ºåŸºç¡€</h1><p>å“ˆå¸Œè¡¨æ˜¯æ ¹æ®å…³é”®ç çš„å€¼è€Œç›´æ¥è¿›è¡Œè®¿é—®çš„æ•°æ®ç»“æ„ã€‚</p><p>å“ˆå¸Œè¡¨ä¸­å…³é”®ç å°±æ˜¯æ•°ç»„çš„ç´¢å¼•ä¸‹æ ‡ï¼Œç„¶åé€šè¿‡ä¸‹æ ‡ç›´æ¥è®¿é—®æ•°ç»„ä¸­çš„å…ƒç´ ã€‚</p><p>å“ˆå¸Œè¡¨èƒ½è§£å†³ä»€ä¹ˆé—®é¢˜å‘¢ï¼Ÿä¸€èˆ¬å“ˆå¸Œè¡¨æ˜¯ç”¨æ¥åˆ¤æ–­ä¸€ä¸ªå…ƒç´ æ˜¯å¦å‡ºç°åœ¨å…ƒç´ é‡Œã€‚</p><p>ä¾‹å¦‚è¦æŸ¥è¯¢ä¸€ä¸ªåå­—æ˜¯å¦åœ¨è¿™æ‰€å­¦æ ¡é‡Œï¼Œè¦æšä¸¾çš„è¯æ—¶é—´å¤æ‚åº¦æ˜¯O(n)ï¼Œä½†å¦‚æœä½¿ç”¨å“ˆå¸Œè¡¨çš„è¯ï¼Œ åªéœ€è¦O(1)å°±å¯ä»¥åšåˆ°ã€‚</p><h2 id="1ã€å“ˆå¸Œå‡½æ•°"><a href="#1ã€å“ˆå¸Œå‡½æ•°" class="headerlink" title="1ã€å“ˆå¸Œå‡½æ•°"></a>1ã€å“ˆå¸Œå‡½æ•°</h2><p>å“ˆå¸Œå‡½æ•°ï¼ŒæŠŠå­¦ç”Ÿçš„å§“åç›´æ¥æ˜ å°„ä¸ºå“ˆå¸Œè¡¨ä¸Šçš„ç´¢å¼•ï¼Œç„¶åå°±å¯ä»¥é€šè¿‡æŸ¥è¯¢ç´¢å¼•ä¸‹æ ‡å¿«é€ŸçŸ¥é“è¿™ä½åŒå­¦æ˜¯å¦åœ¨è¿™æ‰€å­¦æ ¡é‡Œäº†ã€‚</p><p>å“ˆå¸Œå‡½æ•°é€šè¿‡hashCodeæŠŠåå­—è½¬åŒ–ä¸ºæ•°å€¼ï¼Œä¸€èˆ¬hashcodeæ˜¯é€šè¿‡ç‰¹å®šç¼–ç æ–¹å¼ï¼Œå¯ä»¥å°†å…¶ä»–æ•°æ®æ ¼å¼è½¬åŒ–ä¸ºä¸åŒçš„æ•°å€¼ï¼Œè¿™æ ·å°±æŠŠå­¦ç”Ÿåå­—æ˜ å°„ä¸ºå“ˆå¸Œè¡¨ä¸Šçš„ç´¢å¼•æ•°å­—äº†ã€‚</p><p>ä½†æ˜¯è‹¥æ˜¯å“ˆå¸Œè¡¨ä¸å¤Ÿå¤§ï¼Œè€ŒhashCodeå¾—åˆ°çš„æ•°å€¼åˆå¤§äºå“ˆå¸Œè¡¨çš„é•¿åº¦å‘¢ï¼Ÿä¸€èˆ¬éƒ½æ˜¯ç”¨å–æ¨¡æ¥è§£å†³è¿™ä¸ªé—®é¢˜ã€‚</p><p>é‚£ä¹ˆé—®é¢˜åˆæ¥äº†ï¼Œè‹¥æ˜¯æœ‰å¾ˆå¤šåŒå­¦é€šè¿‡hashCodeå¾—åˆ°çš„æ•°å€¼éƒ½ç›¸ç­‰å‘¢ï¼Ÿè¿™ä¸ªç°è±¡å°±å«å“ˆå¸Œç¢°æ’</p><h2 id="2ã€å“ˆå¸Œç¢°æ’"><a href="#2ã€å“ˆå¸Œç¢°æ’" class="headerlink" title="2ã€å“ˆå¸Œç¢°æ’"></a>2ã€å“ˆå¸Œç¢°æ’</h2><p>å¦‚ä¸‹ï¼Œå°æå’Œå°ç‹éƒ½æ˜ å°„åˆ°ç´¢å¼•ä¸‹æ ‡1çš„ä½ç½®ï¼Œäº§ç”Ÿå“ˆå¸Œç¢°æ’ã€‚</p><p><img src="/2022/10/13/v2-ha-xi-biao/image-20221013103434324.png"></p><p>è§£å†³åŠæ³•æœ‰ä¸¤ä¸ª</p><h3 id="1ã€æ‹‰é“¾æ³•"><a href="#1ã€æ‹‰é“¾æ³•" class="headerlink" title="1ã€æ‹‰é“¾æ³•"></a>1ã€æ‹‰é“¾æ³•</h3><p>æ‹‰é“¾æ³•ç®€è€Œè¨€ä¹‹å°±æ˜¯äº§ç”Ÿç¢°æ’æ—¶ï¼Œè®©å‘ç”Ÿå†²çªçš„å…ƒç´ éƒ½å‚¨å­˜åœ¨é“¾è¡¨ä¸­ã€‚</p><p><img src="/2022/10/13/v2-ha-xi-biao/image-20221013103638804.png"></p><h3 id="2ã€çº¿æ€§æ¢æµ‹æ³•"><a href="#2ã€çº¿æ€§æ¢æµ‹æ³•" class="headerlink" title="2ã€çº¿æ€§æ¢æµ‹æ³•"></a>2ã€çº¿æ€§æ¢æµ‹æ³•</h3><p>çº¿æ€§æ¢æµ‹æ³•æ˜¯å½“äº§ç”Ÿå†²çªæ—¶ï¼Œå¾€ä¸‹é¡ºå»¶è‡³æ²¡æœ‰æ•°æ®çš„é‚£ä¸€ä½ï¼Œå¦‚ä¸‹å›¾ã€‚</p><p><img src="/2022/10/13/v2-ha-xi-biao/image-20221013103733434.png"></p><p>æ‰€ä»¥è¦æ±‚tableSizeä¸€å®šè¦å¤§äºdataSize ï¼Œè¦ä¸ç„¶å“ˆå¸Œè¡¨ä¸Šå°±æ²¡æœ‰ç©ºç½®çš„ä½ç½®æ¥å­˜æ”¾ å†²çªçš„æ•°æ®äº†ã€‚</p><h2 id="3ã€å¸¸è§å“ˆå¸Œç»“æ„"><a href="#3ã€å¸¸è§å“ˆå¸Œç»“æ„" class="headerlink" title="3ã€å¸¸è§å“ˆå¸Œç»“æ„"></a>3ã€å¸¸è§å“ˆå¸Œç»“æ„</h2><ul><li>æ•°ç»„</li><li>set</li><li>map</li></ul><h2 id="4ã€å¸¸ç”¨æ–¹æ³•"><a href="#4ã€å¸¸ç”¨æ–¹æ³•" class="headerlink" title="4ã€å¸¸ç”¨æ–¹æ³•"></a>4ã€å¸¸ç”¨æ–¹æ³•</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-comment">// æ˜¯å¦åŒ…å«å…³é”®å­—</span><br>map.containsKey(keys);<br><span class="hljs-comment">// æ·»åŠ å…³é”®å­—å’Œå€¼</span><br>map.put(keys, value);<br><span class="hljs-comment">// è·å–æ‰€æœ‰é”®çš„å€¼</span><br>map.values();<br><br><span class="hljs-comment">// å­—ç¬¦ä¸²è½¬å­—ç¬¦æ•°ç»„</span><br><span class="hljs-type">String</span> <span class="hljs-variable">str</span> <span class="hljs-operator">=</span> <span class="hljs-string">&quot;string&quot;</span>;<br><span class="hljs-type">char</span>[] ch = str.toCharArray();<br><span class="hljs-comment">// å­—ç¬¦æ•°ç»„è½¬å­—ç¬¦ä¸²</span><br><span class="hljs-type">String</span> <span class="hljs-variable">keys</span> <span class="hljs-operator">=</span> String.valueOf(ch);<br></code></pre></td></tr></table></figure><h1 id="äºŒã€ç»å…¸é¢˜"><a href="#äºŒã€ç»å…¸é¢˜" class="headerlink" title="äºŒã€ç»å…¸é¢˜"></a>äºŒã€ç»å…¸é¢˜</h1><h2 id="1ã€æ•°ç»„ä¸­åªå‡ºç°ä¸€æ¬¡çš„ä¸¤ä¸ªæ•°å­—"><a href="#1ã€æ•°ç»„ä¸­åªå‡ºç°ä¸€æ¬¡çš„ä¸¤ä¸ªæ•°å­—" class="headerlink" title="1ã€æ•°ç»„ä¸­åªå‡ºç°ä¸€æ¬¡çš„ä¸¤ä¸ªæ•°å­—"></a>1ã€æ•°ç»„ä¸­åªå‡ºç°ä¸€æ¬¡çš„ä¸¤ä¸ªæ•°å­—</h2><p>ç‰›å®¢åŸé¢˜é“¾æ¥ï¼š<a href="https://www.nowcoder.com/practice/389fc1c3d3be4479a154f63f495abff8?tpId=295&tqId=745&ru=/exam/oj&qru=/ta/format-top101/question-ranking&sourceUrl=/exam/oj"><strong>BM52</strong> <strong>æ•°ç»„ä¸­åªå‡ºç°ä¸€æ¬¡çš„ä¸¤ä¸ªæ•°å­—</strong></a></p><h3 id="1ã€æ–¹æ³•ä¸€ï¼šå“ˆå¸Œè¡¨"><a href="#1ã€æ–¹æ³•ä¸€ï¼šå“ˆå¸Œè¡¨" class="headerlink" title="1ã€æ–¹æ³•ä¸€ï¼šå“ˆå¸Œè¡¨"></a>1ã€æ–¹æ³•ä¸€ï¼šå“ˆå¸Œè¡¨</h3><p>çœ‹åˆ°é¢˜ç›®ï¼Œå¾ˆå®¹æ˜“æƒ³åˆ°ç”¨ä¸€ä¸ªå“ˆå¸Œè¡¨æ¥è®°å½•æ¯ä¸ªæ•°å‡ºç°çš„æ¬¡æ•°ï¼Œå¹¶å¾—åˆ°åªå‡ºç°ä¸€æ¬¡çš„æ•°å­—</p><p>å…·ä½“æ€è·¯å¦‚ä¸‹ï¼š</p><p>1ã€åˆ›å»ºä¸€ä¸ªå“ˆå¸Œè¡¨</p><p>2ã€å½“æ•°ç»„å…ƒç´ æ²¡æœ‰åœ¨å“ˆå¸Œè¡¨ä¸­æˆä¸ºkeyçš„æ—¶å€™ï¼Œputè¿›å“ˆå¸Œè¡¨ï¼Œå½“å·²å­˜åœ¨çš„æ—¶å€™ï¼Œåˆ™removeæ‰ã€‚</p><p>3ã€æœ€åå“ˆå¸Œè¡¨ä¸­å‰©ä¸‹çš„keyå°±æ˜¯åªå‡ºç°ä¸€æ¬¡çš„æ•°å­—</p><p>4ã€éå†keyç„¶åè¿”å›ç»“æœ</p><p>ä»£ç å¦‚ä¸‹ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-type">int</span>[] FindNumsAppearOnce (<span class="hljs-type">int</span>[] array) &#123;<br>        <span class="hljs-comment">// write code here</span><br>        <span class="hljs-comment">// ç”¨äºè¿”å›ç»“æœ</span><br>        <span class="hljs-type">int</span>[] res = <span class="hljs-keyword">new</span> <span class="hljs-title class_">int</span>[<span class="hljs-number">2</span>];<br>        <span class="hljs-comment">// åˆ›å»ºä¸€ä¸ªå“ˆå¸Œè¡¨</span><br>        HashMap&lt;Integer,Object&gt; set = <span class="hljs-keyword">new</span> <span class="hljs-title class_">HashMap</span>&lt;&gt;();<br>        <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> <span class="hljs-variable">i</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>; i &lt; array.length; i++)&#123;<br>            <span class="hljs-comment">// å¦‚æœå·²ç»è¢«å½“ä½œkeyäº†ï¼Œé‚£å°±ç›´æ¥removeæ‰</span><br>            <span class="hljs-keyword">if</span>(set.containsKey(array[i]))&#123;<br>                set.remove(array[i],<span class="hljs-literal">null</span>);<br>            &#125;<span class="hljs-keyword">else</span>&#123;<br>                <span class="hljs-comment">// å¦åˆ™å°±æ·»åŠ è¿›å»</span><br>                set.put(array[i],<span class="hljs-literal">null</span>);<br>            &#125;<br>        &#125;<br>        <span class="hljs-type">int</span> <span class="hljs-variable">i</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>;<br>        <span class="hljs-comment">// æœ€åæ‹¿å‡ºæ¥æ”¾è¿›è¿”å›ç»“æœçš„æ•°ç»„ä¸­è¿›è¡Œè¿”å›</span><br>        <span class="hljs-keyword">for</span>(Integer num:set.keySet())&#123;<br>            res[i++] = num;<br>        &#125;<br>        <span class="hljs-keyword">return</span> res;<br>    &#125;<br></code></pre></td></tr></table></figure><p>å½“ç„¶ï¼Œæ—¶é—´å¤æ‚åº¦å’Œç©ºé—´å¤æ‚åº¦éƒ½æ˜¯O(n)ï¼Œä½†æ˜¯è¿™é“é¢˜è¦æ±‚æ˜¯ç©ºé—´å¤æ‚åº¦ä¸ºO(1)ï¼ŒSo?</p><h3 id="2ã€æ–¹æ³•äºŒï¼šåŒæŒ‡é’ˆæ³•"><a href="#2ã€æ–¹æ³•äºŒï¼šåŒæŒ‡é’ˆæ³•" class="headerlink" title="2ã€æ–¹æ³•äºŒï¼šåŒæŒ‡é’ˆæ³•"></a>2ã€æ–¹æ³•äºŒï¼šåŒæŒ‡é’ˆæ³•</h3><p>åŒæŒ‡é’ˆæ³•çš„å‰ææ˜¯è¦æ•°ç»„æœ‰åºï¼Œå¯ä»¥ç”¨Arrays.sortæ¥å¯¹æ•°ç»„è¿›è¡Œæ’åºã€‚å®šä¹‰ä¸¤ä¸ªæŒ‡é’ˆï¼Œè‹¥æ˜¯åä¸€ä¸ªå…ƒç´ å’Œå½“å‰å…ƒç´ ä¸ç­‰ï¼Œè¯´æ˜ä»€ä¹ˆï¼Ÿ<code>è¯´æ˜å‰ä¸€ä¸ªå…ƒç´ åªå‡ºç°äº†ä¸€æ¬¡</code>ã€‚è¿™å¥è¯æœ‰æ­§ä¹‰ï¼Œå¯èƒ½æœ‰äººä¼šè¯´æˆ‘ä» 1, 1, 2ä¸­çš„ç¬¬äºŒä¸ªä½ç½®çš„1å’Œ2è¿›è¡Œæ¯”è¾ƒï¼Œå°±è¯´æ˜ä¸äº†1åªå‡ºç°äº†ä¸€æ¬¡ã€‚è¿™ä¸ªé—®é¢˜å¦‚ä½•è§£å†³ï¼Ÿå¾ˆå¥½åŠï¼Œåªéœ€è¦ä»0å¼€å§‹éå†å³å¯ï¼Œè‹¥æ˜¯å‡ºç°åä¸€ä¸ªå…ƒç´ å’Œå½“å‰å…ƒç´ ç›¸ç­‰ï¼Œå°±ç›´æ¥å°†æŒ‡é’ˆåç§»ä¸¤ä½ã€‚è¿™æ ·å°±è§£å†³é—®é¢˜äº†ã€‚</p><p>å…·ä½“æ€è·¯å¦‚ä¸‹ï¼š</p><ol><li>å¯¹åŸå§‹æ•°ç»„è¿›è¡Œæ’åº</li><li>éå†æ•°ç»„ï¼Œè‹¥æ˜¯ i + 1 ç­‰äºæ•°ç»„çš„é•¿åº¦ æˆ–è€… ä¸‹ä¸€ä¸ªå…ƒç´ ä¸ç­‰äºå½“å‰å…ƒç´ ï¼Œå°±å°†  i å­˜å…¥è¿”å›æ•°ç»„ä¸­ï¼Œå¹¶åç§»ä¸€ä½ï¼›å¦åˆ™åç§»ä¸¤ä½</li></ol><blockquote><p>æ³¨æ„ï¼Œè‹¥æ˜¯ i + 1 ç­‰äºæ•°ç»„çš„é•¿åº¦ï¼Œè¯´æ˜æ­¤æ—¶iå·²ç»æ˜¯æœ€åä¸€ä¸ªå…ƒç´ ï¼Œç›´æ¥æ”¾å…¥è¿”å›æ•°ç»„ä¸­å³å¯</p></blockquote><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-type">int</span>[] FindNumsAppearOnce (<span class="hljs-type">int</span>[] array) &#123;<br>        <span class="hljs-comment">// write code here</span><br>        <span class="hljs-comment">//   åŒæŒ‡é’ˆæ³•</span><br>        <span class="hljs-type">int</span>[] res = <span class="hljs-keyword">new</span> <span class="hljs-title class_">int</span>[<span class="hljs-number">2</span>];<br>        Arrays.sort(array);<br>        <span class="hljs-type">int</span> <span class="hljs-variable">two</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>;<br>        <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> <span class="hljs-variable">i</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>; i &lt; array.length; i++) &#123;<br>            <span class="hljs-keyword">if</span> (i + <span class="hljs-number">1</span> == array.length || array[i + <span class="hljs-number">1</span>] != array[i]) &#123;<br>                res[two] = array[i];<br>                two++;<br>            &#125;   <br>            <span class="hljs-keyword">else</span><br>                i++;<br>        &#125;<br>        <span class="hljs-keyword">return</span> res;<br>    &#125;<br></code></pre></td></tr></table></figure><h3 id="3ã€æ–¹æ³•ä¸‰ï¼šä½è¿ç®—"><a href="#3ã€æ–¹æ³•ä¸‰ï¼šä½è¿ç®—" class="headerlink" title="3ã€æ–¹æ³•ä¸‰ï¼šä½è¿ç®—"></a>3ã€<code>æ–¹æ³•ä¸‰ï¼šä½è¿ç®—</code></h3><p>å…ˆæ¥äº†è§£ä¸€ä¸‹ä»€ä¹ˆå«å¼‚æˆ–è¿ç®—</p><p>å¼‚æˆ–è¿ç®—æ˜¯åŸºäºäºŒè¿›åˆ¶çš„ä½è¿ç®—ï¼Œé‡‡ç”¨ç¬¦å·XORæˆ–è€…^æ¥è¡¨ç¤ºï¼Œè¿ç®—è§„åˆ™æ˜¯å°±ä¸äºŒè¿›åˆ¶ï¼Œå¦‚æœæ˜¯åŒå€¼å–0ã€å¼‚å€¼å–1ã€‚</p><p><code>å¼‚æˆ–è¿ç®—çš„æ€§è´¨</code>ï¼š</p><ol><li>äº¤æ¢å¾‹ å¯ä»¥ä»»æ„äº¤æ¢è¿ç®—å› å­ï¼Œç»“æœä¸å˜ã€‚</li><li>ç»“åˆå¾‹ ï¼ˆa^bï¼‰^c=a^(a^c)</li><li>å¯¹äºä»»ä½•æ•°xï¼Œéƒ½æœ‰x^x=0,x^0=x,åŒè‡ªå·±æ±‚å¼‚æˆ–è¿ç®—ä¸º0ï¼ŒåŒ0æ±‚å¼‚æˆ–è¿ç®—ç»“æœä¸ºè‡ªå·±</li><li>è‡ªåæ€§ï¼ŒA^B^B=A^0=Aã€‚è¿™ä¸ªæ€§è´¨å¯ä»¥ç”¨æ¥æ±‚å“ªä¸€ä¸ªæ•°ä¸ºä¸€ä¸ª</li></ol><p>è¿™é“é¢˜è¿ç”¨çš„å°±æ˜¯ç¬¬å››ä¸ªæ€§è´¨ï¼Œè‡ªåæ€§</p><blockquote><p>ä¸¾ä¸ªä¾‹å­ï¼š</p><p>4 âŠ• 4 = 0ï¼Œå°†4åŒ–ä¸ºäºŒè¿›åˆ¶ä¸º 0100</p><p>æ‰€ä»¥ 0100</p><p>å¼‚æˆ– 0100</p><p>å¾—åˆ° 0000</p><p>4 âŠ• 4 âŠ• 5 = 5</p><p>åˆ™ 0100</p><p> 0100</p><p> 0101</p><p>å¾—åˆ° 0101</p><p>æˆ‘ä»¬å¯ä»¥çœ‹åˆ°ä¸Šé¢çš„è¿ç®—è¿‡ç¨‹ï¼Œå› ä¸º4=4ï¼Œä¸¤è€…ç›¸ç­‰å¼‚æˆ–ç»“æœä¸º0ã€‚æ‰€ä»¥0å¼‚æˆ–ä»»æ„æ•°éƒ½ç­‰äºä»»æ„æ•°ã€‚</p></blockquote><p>æ‰€ä»¥ï¼Œå½“åªæœ‰ä¸€ä¸ªå‡ºç°äº†ä¸€æ¬¡çš„æ•°å­—çš„æ—¶å€™ï¼Œåˆ™åªéœ€è¦å°†å…¨éƒ¨æ•°è¿›è¡Œå¼‚æˆ–è¿ç®—ï¼Œè¿ç®—ç»“æœå°±å‰©ä¸‹äº†é‚£ä¸ªåªå‡ºç°ä¸€æ¬¡çš„æ•°å­—äº†ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-type">int</span>[] singleNumber(<span class="hljs-type">int</span>[] nums) &#123;<br>    <span class="hljs-type">int</span> <span class="hljs-variable">x</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>;<br>    <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> num : nums)  <span class="hljs-comment">// 1. éå† nums æ‰§è¡Œå¼‚æˆ–è¿ç®—</span><br>        x ^= num;<br>    <span class="hljs-keyword">return</span> x;            <span class="hljs-comment">// 2. è¿”å›å‡ºç°ä¸€æ¬¡çš„æ•°å­— x</span><br>&#125;<br></code></pre></td></tr></table></figure><p>é—®é¢˜æ¥äº†ï¼šä¸Šè¿°çš„æ€æƒ³æ˜¯å¤šä¸ªæ•°ä¸­æ‰¾åˆ°åªå‡ºç°ä¸€æ¬¡çš„æ•°å­—ï¼Œä½†æ˜¯æœ¬é¢˜æ˜¯æ‰¾ä¸¤ä¸ªï¼Œæ¯”å¦‚è¾“å…¥ 1,4,1,6ã€‚æœ€åå‰©ä¸‹4âŠ•6ã€‚æ€ä¹ˆåŠï¼Ÿ</p><p>é‚£å°±è¿›è¡Œåˆ†ç»„å˜›ï¼Œåˆ†æˆä¸¤ä¸ªç»„ã€‚</p><p>ä½†æ˜¯åˆ†ç»„çš„ä¾æ®æ˜¯ä»€ä¹ˆå‘¢ï¼Ÿå…ˆæ¥çœ‹çœ‹æŒ‰å¥‡æ•°å¶æ•°åˆ†ï¼ŒæŒ‰å¥‡æ•°å¶æ•°åˆ†ä¸éš¾å®ç°ï¼Œåªéœ€è¦å°†å…¶ &amp;1 å³å¯ï¼ŒåŸç†æ˜¯å¥‡æ•°çš„æœ€ä½ä½ä¸€å®šæ˜¯1ï¼Œå¶æ•°çš„æœ€ä½ä½ä¸€å®šæ˜¯0ã€‚ä½†æ˜¯ä¹Ÿä¸èƒ½ä¿è¯åªå‡ºç°ä¸€æ¬¡çš„æ•°å­—æ­£å¥½æ˜¯ä¸€å¥‡ä¸€å¶ï¼Œæˆ–è®¸äººå®¶æ˜¯ä¸¤ä¸ªå¥‡æ•°ä¸¤ä¸ªå¶æ•°å‘¢ï¼Ÿæ‰€ä»¥æŒ‰å¥‡æ•°å¶æ•°çš„åˆ†æ³•ä¸å¯è¡Œã€‚</p><p>ç¡®å®šåˆ†ç»„ä¾æ®ä¹‹å‰ï¼Œå…ˆçœ‹ä¸€ä¸ªå°ä¾‹å­ï¼Œæ¯”å¦‚è¦åŒºåˆ†0100å’Œ0110ï¼Œä¹Ÿå°±æ˜¯4å’Œ6ï¼Œæ€ä¹ˆåŒºåˆ†å‘¢ï¼Ÿå¯ä»¥ä»æœ€ä½ä½åˆšå¼€å§‹ä¸åŒçš„ä½ç½®åŒºåˆ†ï¼Œ0100âŠ•0110 = 0010ï¼Œé‚£ä¹ˆå¯ä»¥ç”¨0010æ¥åŒºåˆ†ã€‚å¼‚æˆ–è¿ç®—<code>æ­£å¥½</code>ç”¨çš„ä¸Šã€‚</p><p>é‚£ä¹ˆé—®é¢˜å°±å˜çš„å¾ˆç®€å•ï¼Œå…·ä½“æ€è·¯å¦‚ä¸‹ï¼š</p><ol><li>å…ˆå°†å…¨éƒ¨æ•°è¿›è¡Œå¼‚æˆ–è¿ç®—ï¼Œå¾—å‡ºæœ€ç»ˆç»“æœ</li><li>æ‰¾åˆ°å¯ä»¥å……å½“åˆ†ç»„çš„æ•°</li><li>åˆ†ç»„ï¼ŒåŒæ—¶æ±‚å‡ºå‡ºç°ä¸€æ¬¡çš„æ•°å­—</li><li>è¿›è¡Œéé™åºæ’åˆ—</li></ol><p>ä»£ç å¦‚ä¸‹ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-type">int</span>[] FindNumsAppearOnce (<span class="hljs-type">int</span>[] array) &#123;<br>        <span class="hljs-comment">// write code here</span><br>    <br>        <span class="hljs-comment">// å…ˆå°†å…¨éƒ¨æ•°è¿›è¡Œå¼‚æˆ–è¿ç®—ï¼Œå¾—å‡ºæœ€ç»ˆç»“æœ</span><br>        <span class="hljs-type">int</span> <span class="hljs-variable">temp</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>;<br>        <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> num : array) &#123;<br>            temp ^= num;<br>        &#125;<br>    <br>        <span class="hljs-comment">// æ‰¾åˆ°é‚£ä¸ªå¯ä»¥å……å½“åˆ†ç»„å»è¿›è¡Œä¸è¿ç®—çš„æ•°</span><br>        <span class="hljs-comment">// ä»æœ€ä½ä½å¼€å§‹æ‰¾èµ·</span><br>        <span class="hljs-type">int</span> <span class="hljs-variable">mask</span> <span class="hljs-operator">=</span> <span class="hljs-number">1</span>;<br>        <span class="hljs-keyword">while</span> ((tmp &amp; mask) == <span class="hljs-number">0</span>) &#123;<br>            mask &lt;&lt;= <span class="hljs-number">1</span>;<br>        &#125;<br>    <br>        <span class="hljs-comment">// è¿›è¡Œåˆ†ç»„ï¼Œåˆ†æˆä¸¤ç»„ï¼Œè½¬æ¢ä¸ºä¸¤ç»„ æ±‚å‡ºç°ä¸€æ¬¡çš„æ•°å­— å»æ±‚</span><br>        <span class="hljs-type">int</span> <span class="hljs-variable">a</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>;<br>        <span class="hljs-type">int</span> <span class="hljs-variable">b</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>;<br>        <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> num : array) &#123;<br>            <span class="hljs-keyword">if</span> ((num &amp; mask) == <span class="hljs-number">0</span>) &#123;<br>                a ^= num;<br>            &#125; <span class="hljs-keyword">else</span> &#123;<br>                b ^= num;<br>            &#125;<br>        &#125;<br>    <br>        <span class="hljs-comment">// å› ä¸ºé¢˜ç›®è¦æ±‚å°çš„æ•°æ”¾å‰é¢ï¼Œæ‰€ä»¥è¿™ä¸€åšä¸ªåˆ¤æ–­</span><br>        <span class="hljs-keyword">if</span> (a &gt; b) &#123;<br>            <span class="hljs-type">int</span> <span class="hljs-variable">c</span> <span class="hljs-operator">=</span> a;<br>            a = b;<br>            b = c;<br>        &#125;<br>        <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">int</span>[] &#123;a, b&#125;;<br>    &#125;<br></code></pre></td></tr></table></figure><blockquote><p>ç¬¬14è¡Œçš„ &lt;&lt; ç¬¦å·ï¼Œå·¦ç§»è¿ç®—ç¬¦ã€‚æ•ˆæœï¼šé€šè¿‡ä»å³ä¾§æ¨å…¥é›¶å¹¶è®©æœ€å·¦è¾¹çš„ä½è„±è½æ¥å‘å·¦ç§»åŠ¨ã€‚æ¯”å¦‚9 &lt;&lt; 1 ç­‰åŒäº 1001 &lt;&lt; 1 ï¼Œç»“æœå°±æ˜¯0010ï¼Œæ¢åšåè¿›åˆ¶ä¹Ÿå°±æ˜¯2</p></blockquote><p>ä¸Šè¿°çš„ç¬¬30åˆ°32è¡Œçš„ä»£ç ï¼Œä¹Ÿå¯ä»¥ç”¨å¼‚æˆ–æ¥å®ç°aå’Œbæ•°å€¼çš„äº¤æ¢ã€‚<code>è¿™ä¹Ÿæ˜¯å¼‚æˆ–æ€§è´¨çš„è¿ç”¨ã€‚</code></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs java">a = a ^ b    <span class="hljs-comment">// a = a ^ b</span><br>b = a ^ b    <span class="hljs-comment">// b = a ^ b ^ b ,  ==&gt; b = a</span><br>a = a ^ b    <span class="hljs-comment">// a = a ^ b ^ a ,  ==&gt; a = b</span><br></code></pre></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>ç®—æ³•</category>
      
    </categories>
    
    
    <tags>
      
      <tag>java</tag>
      
      <tag>å“ˆå¸Œè¡¨</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>08-è¡Œä¸ºå‹-çŠ¶æ€-è¿­ä»£å™¨</title>
    <link href="/2022/10/12/08-xing-wei-xing-zhuang-tai-die-dai-qi/"/>
    <url>/2022/10/12/08-xing-wei-xing-zhuang-tai-die-dai-qi/</url>
    
    <content type="html"><![CDATA[<h1 id="ä¸€ã€çŠ¶æ€æ¨¡å¼"><a href="#ä¸€ã€çŠ¶æ€æ¨¡å¼" class="headerlink" title="ä¸€ã€çŠ¶æ€æ¨¡å¼"></a>ä¸€ã€çŠ¶æ€æ¨¡å¼</h1><p>çŠ¶æ€æ¨¡å¼ï¼ˆState Patternï¼‰ï¼šå®ƒä¸»è¦ç”¨æ¥è§£å†³å¯¹è±¡åœ¨å¤šç§çŠ¶æ€è½¬æ¢æ—¶ï¼Œéœ€è¦å¯¹å¤– è¾“å‡ºä¸åŒçš„è¡Œä¸ºçš„é—®é¢˜ã€‚çŠ¶æ€å’Œè¡Œä¸ºæ˜¯ä¸€ä¸€å¯¹åº”çš„ï¼ŒçŠ¶æ€ä¹‹é—´å¯ä»¥ç›¸äº’è½¬æ¢ã€‚</p><p>å½“ä¸€ä¸ªå¯¹è±¡çš„å†…åœ¨çŠ¶æ€æ”¹å˜æ—¶ï¼Œå…è®¸æ”¹å˜å…¶è¡Œä¸ºï¼Œè¿™ä¸ªå¯¹è±¡çœ‹èµ·æ¥åƒæ˜¯æ”¹å˜äº† å…¶ç±»ã€‚</p><h2 id="1ã€Demoæ¡ˆä¾‹-æŠ½å¥–æ´»åŠ¨é—®é¢˜"><a href="#1ã€Demoæ¡ˆä¾‹-æŠ½å¥–æ´»åŠ¨é—®é¢˜" class="headerlink" title="1ã€Demoæ¡ˆä¾‹-æŠ½å¥–æ´»åŠ¨é—®é¢˜"></a>1ã€Demoæ¡ˆä¾‹-æŠ½å¥–æ´»åŠ¨é—®é¢˜</h2><blockquote><p>éœ€æ±‚</p></blockquote><ol><li>å‡å¦‚æ¯å‚åŠ ä¸€æ¬¡è¿™ä¸ªæ´»åŠ¨è¦ æ‰£é™¤ç”¨æˆ·50ç§¯åˆ†ï¼Œä¸­å¥–æ¦‚ç‡ æ˜¯10%  </li><li>å¥–å“æ•°é‡å›ºå®šï¼ŒæŠ½å®Œå°±ä¸èƒ½ æŠ½å¥– </li><li>æ´»åŠ¨æœ‰å››ä¸ªçŠ¶æ€: å¯ä»¥æŠ½å¥–ã€ ä¸èƒ½æŠ½å¥–ã€å‘æ”¾å¥–å“å’Œå¥–å“ é¢†å®Œ </li><li>æ´»åŠ¨çš„å››ä¸ªçŠ¶æ€è½¬æ¢å…³ç³»å›¾ </li></ol><p><img src="/2022/10/12/08-xing-wei-xing-zhuang-tai-die-dai-qi/image-20221012210047466.png"></p><p>çŠ¶æ€æ¨¡å¼è§£å†³è¯¥é—®é¢˜ç±»å›¾ï¼š</p><p><img src="/2022/10/12/08-xing-wei-xing-zhuang-tai-die-dai-qi/image-20221012211016481.png"></p><h3 id="1ã€State"><a href="#1ã€State" class="headerlink" title="1ã€State"></a>1ã€State</h3><p>çŠ¶æ€æŠ½è±¡ç±»</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">abstract</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">State</span> &#123;<br>   <br>   <span class="hljs-comment">// æ‰£é™¤ç§¯åˆ† - 50</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">abstract</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">deductMoney</span><span class="hljs-params">()</span>;<br><br>    <span class="hljs-comment">// æ˜¯å¦æŠ½ä¸­å¥–å“</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">abstract</span> <span class="hljs-type">boolean</span> <span class="hljs-title function_">raffle</span><span class="hljs-params">()</span>;<br><br>    <span class="hljs-comment">// å‘æ”¾å¥–å“</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">abstract</span>  <span class="hljs-keyword">void</span> <span class="hljs-title function_">dispensePrize</span><span class="hljs-params">()</span>;<br><br>&#125;<br></code></pre></td></tr></table></figure><h3 id="2ã€NoRaffleState"><a href="#2ã€NoRaffleState" class="headerlink" title="2ã€NoRaffleState"></a>2ã€NoRaffleState</h3><p>ä¸èƒ½æŠ½å¥–çŠ¶æ€</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">NoRaffleState</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_">State</span> &#123;<br><br>    <span class="hljs-comment">// åˆå§‹åŒ–æ—¶ä¼ å…¥æ´»åŠ¨å¼•ç”¨ï¼Œæ‰£é™¤ç§¯åˆ†åæ”¹å˜å…¶çŠ¶æ€</span><br>    RaffleActivity activity;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-title function_">NoRaffleState</span><span class="hljs-params">(RaffleActivity activity)</span> &#123;<br>        <span class="hljs-built_in">this</span>.activity = activity;<br>    &#125;<br><br>    <span class="hljs-comment">// å½“å‰çŠ¶æ€å¯ä»¥æ‰£ç§¯åˆ† , æ‰£é™¤åï¼Œå°†çŠ¶æ€è®¾ç½®æˆå¯ä»¥æŠ½å¥–çŠ¶æ€</span><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">deductMoney</span><span class="hljs-params">()</span> &#123;<br>        System.out.println(<span class="hljs-string">&quot;æ‰£é™¤50ç§¯åˆ†æˆåŠŸï¼Œæ‚¨å¯ä»¥æŠ½å¥–äº†&quot;</span>);<br>        activity.setState(activity.getCanRaffleState());<br>    &#125;<br><br>    <span class="hljs-comment">// å½“å‰çŠ¶æ€ä¸èƒ½æŠ½å¥–</span><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-type">boolean</span> <span class="hljs-title function_">raffle</span><span class="hljs-params">()</span> &#123;<br>        System.out.println(<span class="hljs-string">&quot;æ‰£äº†ç§¯åˆ†æ‰èƒ½æŠ½å¥–å–”ï¼&quot;</span>);<br>        <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;<br>    &#125;<br><br>    <span class="hljs-comment">// å½“å‰çŠ¶æ€ä¸èƒ½å‘å¥–å“</span><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">dispensePrize</span><span class="hljs-params">()</span> &#123;<br>        System.out.println(<span class="hljs-string">&quot;ä¸èƒ½å‘æ”¾å¥–å“&quot;</span>);<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><h3 id="3ã€DispenseState"><a href="#3ã€DispenseState" class="headerlink" title="3ã€DispenseState"></a>3ã€DispenseState</h3><p>å‘æ”¾å¥–å“çš„çŠ¶æ€</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">DispenseState</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_">State</span> &#123;<br><br>    <span class="hljs-comment">// åˆå§‹åŒ–æ—¶ä¼ å…¥æ´»åŠ¨å¼•ç”¨ï¼Œå‘æ”¾å¥–å“åæ”¹å˜å…¶çŠ¶æ€</span><br>    RaffleActivity activity;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-title function_">DispenseState</span><span class="hljs-params">(RaffleActivity activity)</span> &#123;<br>        <span class="hljs-built_in">this</span>.activity = activity;<br>    &#125;<br>    <br>    <span class="hljs-comment">//</span><br><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">deductMoney</span><span class="hljs-params">()</span> &#123;<br>        System.out.println(<span class="hljs-string">&quot;ä¸èƒ½æ‰£é™¤ç§¯åˆ†&quot;</span>);<br>    &#125;<br><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-type">boolean</span> <span class="hljs-title function_">raffle</span><span class="hljs-params">()</span> &#123;<br>        System.out.println(<span class="hljs-string">&quot;ä¸èƒ½æŠ½å¥–&quot;</span>);<br>        <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;<br>    &#125;<br><br>    <span class="hljs-comment">//å‘æ”¾å¥–å“</span><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">dispensePrize</span><span class="hljs-params">()</span> &#123;<br>        <span class="hljs-keyword">if</span>(activity.getCount() &gt; <span class="hljs-number">0</span>)&#123;<br>            System.out.println(<span class="hljs-string">&quot;æ­å–œä¸­å¥–äº†&quot;</span>);<br>            <span class="hljs-comment">// æ”¹å˜çŠ¶æ€ä¸ºä¸èƒ½æŠ½å¥–</span><br>            activity.setState(activity.getNoRafflleState());<br>        &#125;<span class="hljs-keyword">else</span>&#123;<br>            System.out.println(<span class="hljs-string">&quot;å¾ˆé—æ†¾ï¼Œå¥–å“å‘é€å®Œäº†&quot;</span>);<br>            <span class="hljs-comment">// æ”¹å˜çŠ¶æ€ä¸ºå¥–å“å‘é€å®Œæ¯•, åé¢æˆ‘ä»¬å°±ä¸å¯ä»¥æŠ½å¥–</span><br>            activity.setState(activity.getDispensOutState());<br>            <span class="hljs-comment">//System.out.println(&quot;æŠ½å¥–æ´»åŠ¨ç»“æŸ&quot;);</span><br>            <span class="hljs-comment">//System.exit(0);</span><br>        &#125;<br><br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><h3 id="4ã€DispenseOutState"><a href="#4ã€DispenseOutState" class="headerlink" title="4ã€DispenseOutState"></a>4ã€DispenseOutState</h3><p>å¥–å“å‘æ”¾å®Œæ¯•çŠ¶æ€</p><p>å½“æˆ‘ä»¬activity æ”¹å˜æˆ DispenseOutStateï¼Œ æŠ½å¥–æ´»åŠ¨ç»“æŸ</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">DispenseOutState</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_">State</span> &#123;<br><br>   <span class="hljs-comment">// åˆå§‹åŒ–æ—¶ä¼ å…¥æ´»åŠ¨å¼•ç”¨</span><br>    RaffleActivity activity;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-title function_">DispenseOutState</span><span class="hljs-params">(RaffleActivity activity)</span> &#123;<br>        <span class="hljs-built_in">this</span>.activity = activity;<br>    &#125;<br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">deductMoney</span><span class="hljs-params">()</span> &#123;<br>        System.out.println(<span class="hljs-string">&quot;å¥–å“å‘é€å®Œäº†ï¼Œè¯·ä¸‹æ¬¡å†å‚åŠ &quot;</span>);<br>    &#125;<br><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-type">boolean</span> <span class="hljs-title function_">raffle</span><span class="hljs-params">()</span> &#123;<br>        System.out.println(<span class="hljs-string">&quot;å¥–å“å‘é€å®Œäº†ï¼Œè¯·ä¸‹æ¬¡å†å‚åŠ &quot;</span>);<br>        <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;<br>    &#125;<br><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">dispensePrize</span><span class="hljs-params">()</span> &#123;<br>        System.out.println(<span class="hljs-string">&quot;å¥–å“å‘é€å®Œäº†ï¼Œè¯·ä¸‹æ¬¡å†å‚åŠ &quot;</span>);<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><h3 id="5ã€CanRaffleState"><a href="#5ã€CanRaffleState" class="headerlink" title="5ã€CanRaffleState"></a>5ã€CanRaffleState</h3><p>å¯ä»¥æŠ½å¥–çš„çŠ¶æ€</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">CanRaffleState</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_">State</span> &#123;<br><br>    RaffleActivity activity;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-title function_">CanRaffleState</span><span class="hljs-params">(RaffleActivity activity)</span> &#123;<br>        <span class="hljs-built_in">this</span>.activity = activity;<br>    &#125;<br><br>    <span class="hljs-comment">//å·²ç»æ‰£é™¤äº†ç§¯åˆ†ï¼Œä¸èƒ½å†æ‰£</span><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">deductMoney</span><span class="hljs-params">()</span> &#123;<br>        System.out.println(<span class="hljs-string">&quot;å·²ç»æ‰£å–è¿‡äº†ç§¯åˆ†&quot;</span>);<br>    &#125;<br><br>    <span class="hljs-comment">//å¯ä»¥æŠ½å¥–, æŠ½å®Œå¥–åï¼Œæ ¹æ®å®é™…æƒ…å†µï¼Œæ”¹æˆæ–°çš„çŠ¶æ€</span><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-type">boolean</span> <span class="hljs-title function_">raffle</span><span class="hljs-params">()</span> &#123;<br>        System.out.println(<span class="hljs-string">&quot;æ­£åœ¨æŠ½å¥–ï¼Œè¯·ç¨ç­‰ï¼&quot;</span>);<br>        <span class="hljs-type">Random</span> <span class="hljs-variable">r</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Random</span>();<br>        <span class="hljs-type">int</span> <span class="hljs-variable">num</span> <span class="hljs-operator">=</span> r.nextInt(<span class="hljs-number">10</span>);<br>        <span class="hljs-comment">// 10%ä¸­å¥–æœºä¼š</span><br>        <span class="hljs-keyword">if</span>(num == <span class="hljs-number">0</span>)&#123;<br>            <span class="hljs-comment">// æ”¹å˜æ´»åŠ¨çŠ¶æ€ä¸ºå‘æ”¾å¥–å“ context</span><br>            activity.setState(activity.getDispenseState());<br>            <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;<br>        &#125;<span class="hljs-keyword">else</span>&#123;<br>            System.out.println(<span class="hljs-string">&quot;å¾ˆé—æ†¾æ²¡æœ‰æŠ½ä¸­å¥–å“ï¼&quot;</span>);<br>            <span class="hljs-comment">// æ”¹å˜çŠ¶æ€ä¸ºä¸èƒ½æŠ½å¥–</span><br>            activity.setState(activity.getNoRafflleState());<br>            <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;<br>        &#125;<br>    &#125;<br><br>    <span class="hljs-comment">// ä¸èƒ½å‘æ”¾å¥–å“</span><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">dispensePrize</span><span class="hljs-params">()</span> &#123;<br>        System.out.println(<span class="hljs-string">&quot;æ²¡ä¸­å¥–ï¼Œä¸èƒ½å‘æ”¾å¥–å“&quot;</span>);<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><h3 id="6ã€RaffleActivity"><a href="#6ã€RaffleActivity" class="headerlink" title="6ã€RaffleActivity"></a>6ã€RaffleActivity</h3><p>æŠ½å¥–æ´»åŠ¨</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">RaffleActivity</span> &#123;<br><br>   <span class="hljs-comment">// state è¡¨ç¤ºæ´»åŠ¨å½“å‰çš„çŠ¶æ€ï¼Œæ˜¯å˜åŒ–</span><br>    <span class="hljs-type">State</span> <span class="hljs-variable">state</span> <span class="hljs-operator">=</span> <span class="hljs-literal">null</span>;<br>    <span class="hljs-comment">// å¥–å“æ•°é‡</span><br>    <span class="hljs-type">int</span> <span class="hljs-variable">count</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>;<br>    <br>    <span class="hljs-comment">// å››ä¸ªå±æ€§ï¼Œè¡¨ç¤ºå››ç§çŠ¶æ€</span><br>    <span class="hljs-type">State</span> <span class="hljs-variable">noRafflleState</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">NoRaffleState</span>(<span class="hljs-built_in">this</span>);<br>    <span class="hljs-type">State</span> <span class="hljs-variable">canRaffleState</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">CanRaffleState</span>(<span class="hljs-built_in">this</span>);<br>    <br>    <span class="hljs-type">State</span> <span class="hljs-variable">dispenseState</span> <span class="hljs-operator">=</span>   <span class="hljs-keyword">new</span> <span class="hljs-title class_">DispenseState</span>(<span class="hljs-built_in">this</span>);<br>    <span class="hljs-type">State</span> <span class="hljs-variable">dispensOutState</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">DispenseOutState</span>(<span class="hljs-built_in">this</span>);<br><br>    <span class="hljs-comment">//æ„é€ å™¨</span><br>    <span class="hljs-comment">//1. åˆå§‹åŒ–å½“å‰çš„çŠ¶æ€ä¸º noRafflleStateï¼ˆå³ä¸èƒ½æŠ½å¥–çš„çŠ¶æ€ï¼‰</span><br>    <span class="hljs-comment">//2. åˆå§‹åŒ–å¥–å“çš„æ•°é‡ </span><br>    <span class="hljs-keyword">public</span> <span class="hljs-title function_">RaffleActivity</span><span class="hljs-params">( <span class="hljs-type">int</span> count)</span> &#123;<br>        <span class="hljs-built_in">this</span>.state = getNoRafflleState();<br>        <span class="hljs-built_in">this</span>.count = count;<br>    &#125;<br><br>    <span class="hljs-comment">//æ‰£åˆ†, è°ƒç”¨å½“å‰çŠ¶æ€çš„ deductMoney</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">debuctMoney</span><span class="hljs-params">()</span>&#123;<br>        state.deductMoney();<br>    &#125;<br><br>    <span class="hljs-comment">//æŠ½å¥– </span><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">raffle</span><span class="hljs-params">()</span>&#123;<br>       <span class="hljs-comment">// å¦‚æœå½“å‰çš„çŠ¶æ€æ˜¯æŠ½å¥–æˆåŠŸ</span><br>        <span class="hljs-keyword">if</span>(state.raffle())&#123;<br>           <span class="hljs-comment">//é¢†å–å¥–å“</span><br>            state.dispensePrize();<br>        &#125;<br><br>    &#125;<br><br>    <span class="hljs-keyword">public</span> State <span class="hljs-title function_">getState</span><span class="hljs-params">()</span> &#123;<br>        <span class="hljs-keyword">return</span> state;<br>    &#125;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">setState</span><span class="hljs-params">(State state)</span> &#123;<br>        <span class="hljs-built_in">this</span>.state = state;<br>    &#125;<br><br>    <span class="hljs-comment">//è¿™é‡Œè¯·å¤§å®¶æ³¨æ„ï¼Œæ¯é¢†å–ä¸€æ¬¡å¥–å“ï¼Œcount--</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-type">int</span> <span class="hljs-title function_">getCount</span><span class="hljs-params">()</span> &#123;<br>       <span class="hljs-type">int</span> <span class="hljs-variable">curCount</span> <span class="hljs-operator">=</span> count; <br>       count--;<br>        <span class="hljs-keyword">return</span> curCount;<br>    &#125;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">setCount</span><span class="hljs-params">(<span class="hljs-type">int</span> count)</span> &#123;<br>        <span class="hljs-built_in">this</span>.count = count;<br>    &#125;<br><br>    <span class="hljs-keyword">public</span> State <span class="hljs-title function_">getNoRafflleState</span><span class="hljs-params">()</span> &#123;<br>        <span class="hljs-keyword">return</span> noRafflleState;<br>    &#125;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">setNoRafflleState</span><span class="hljs-params">(State noRafflleState)</span> &#123;<br>        <span class="hljs-built_in">this</span>.noRafflleState = noRafflleState;<br>    &#125;<br><br>    <span class="hljs-keyword">public</span> State <span class="hljs-title function_">getCanRaffleState</span><span class="hljs-params">()</span> &#123;<br>        <span class="hljs-keyword">return</span> canRaffleState;<br>    &#125;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">setCanRaffleState</span><span class="hljs-params">(State canRaffleState)</span> &#123;<br>        <span class="hljs-built_in">this</span>.canRaffleState = canRaffleState;<br>    &#125;<br><br>    <span class="hljs-keyword">public</span> State <span class="hljs-title function_">getDispenseState</span><span class="hljs-params">()</span> &#123;<br>        <span class="hljs-keyword">return</span> dispenseState;<br>    &#125;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">setDispenseState</span><span class="hljs-params">(State dispenseState)</span> &#123;<br>        <span class="hljs-built_in">this</span>.dispenseState = dispenseState;<br>    &#125;<br><br>    <span class="hljs-keyword">public</span> State <span class="hljs-title function_">getDispensOutState</span><span class="hljs-params">()</span> &#123;<br>        <span class="hljs-keyword">return</span> dispensOutState;<br>    &#125;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">setDispensOutState</span><span class="hljs-params">(State dispensOutState)</span> &#123;<br>        <span class="hljs-built_in">this</span>.dispensOutState = dispensOutState;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><h3 id="7ã€ClientTest"><a href="#7ã€ClientTest" class="headerlink" title="7ã€ClientTest"></a>7ã€ClientTest</h3><p>ä¸»å‡½æ•°æµ‹è¯•</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">ClientTest</span> &#123;<br><br>   <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span> &#123;<br>      <span class="hljs-comment">// TODO Auto-generated method stub</span><br>      <span class="hljs-comment">// åˆ›å»ºæ´»åŠ¨å¯¹è±¡ï¼Œå¥–å“æœ‰1ä¸ªå¥–å“</span><br>        <span class="hljs-type">RaffleActivity</span> <span class="hljs-variable">activity</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">RaffleActivity</span>(<span class="hljs-number">1</span>);<br><br>        <span class="hljs-comment">// æˆ‘ä»¬è¿ç»­æŠ½30æ¬¡å¥–</span><br>        <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> <span class="hljs-variable">i</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">30</span>; i++) &#123;<br>            System.out.println(<span class="hljs-string">&quot;--------ç¬¬&quot;</span> + (i + <span class="hljs-number">1</span>) + <span class="hljs-string">&quot;æ¬¡æŠ½å¥–----------&quot;</span>);<br>            <span class="hljs-comment">// å‚åŠ æŠ½å¥–ï¼Œç¬¬ä¸€æ­¥ç‚¹å‡»æ‰£é™¤ç§¯åˆ†</span><br>            activity.debuctMoney();<br><br>            <span class="hljs-comment">// ç¬¬äºŒæ­¥æŠ½å¥–</span><br>            activity.raffle();<br>        &#125;<br>   &#125;<br><br>&#125;<br></code></pre></td></tr></table></figure><h2 id="2ã€çŠ¶æ€æ¨¡å¼åŸç†"><a href="#2ã€çŠ¶æ€æ¨¡å¼åŸç†" class="headerlink" title="2ã€çŠ¶æ€æ¨¡å¼åŸç†"></a>2ã€çŠ¶æ€æ¨¡å¼åŸç†</h2><p>ç±»å›¾å¦‚ä¸‹ï¼š</p><p><img src="/2022/10/12/08-xing-wei-xing-zhuang-tai-die-dai-qi/image-20221012210214155.png"></p><blockquote><p>è¯´æ˜</p></blockquote><ol><li>Context ç±»ä¸ºç¯å¢ƒè§’è‰², ç”¨äºç»´æŠ¤Stateå®ä¾‹,è¿™ä¸ªå®ä¾‹å®šä¹‰å½“å‰çŠ¶æ€ </li><li>State æ˜¯æŠ½è±¡çŠ¶æ€è§’è‰²,å®šä¹‰ä¸€ä¸ªæ¥å£å°è£…ä¸Context çš„ä¸€ä¸ªç‰¹ç‚¹æ¥å£ç›¸å…³è¡Œä¸º </li><li>ConcreteState å…·ä½“çš„çŠ¶æ€è§’è‰²ï¼Œæ¯ä¸ªå­ç±»å®ç°ä¸€ä¸ªä¸Context çš„ä¸€ä¸ªçŠ¶æ€ç›¸å…³è¡Œä¸º</li></ol><h2 id="3ã€çŠ¶æ€æ¨¡å¼åº”ç”¨"><a href="#3ã€çŠ¶æ€æ¨¡å¼åº”ç”¨" class="headerlink" title="3ã€çŠ¶æ€æ¨¡å¼åº”ç”¨"></a>3ã€çŠ¶æ€æ¨¡å¼åº”ç”¨</h2><p>çŠ¶æ€æ¨¡å¼åœ¨å®é™…é¡¹ç›®-å€Ÿè´·å¹³å°ä¸­çš„åº”ç”¨</p><ol><li>å€Ÿè´·å¹³å°çš„è®¢å•ï¼Œæœ‰å®¡æ ¸-å‘å¸ƒ-æŠ¢å• ç­‰ç­‰ æ­¥éª¤ï¼Œéšç€æ“ä½œçš„ä¸åŒï¼Œä¼šæ”¹å˜è®¢å•çš„ çŠ¶æ€, é¡¹ç›®ä¸­çš„è¿™ä¸ªæ¨¡å—å®ç°å°±ä¼šä½¿ç”¨åˆ°çŠ¶æ€æ¨¡å¼ </li><li>é€šå¸¸é€šè¿‡if/elseåˆ¤æ–­è®¢å•çš„çŠ¶æ€ï¼Œä»è€Œå®ç°ä¸åŒçš„é€»è¾‘ï¼Œä¼ªä»£ç å¦‚ä¸‹</li></ol><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">if</span>(å®¡æ ¸)&#123;<br><span class="hljs-comment">//å®¡æ ¸é€»è¾‘</span><br>&#125;elseif(å‘å¸ƒ)&#123;<br><span class="hljs-comment">//å‘å¸ƒé€»è¾‘</span><br>&#125;elseif(æ¥å•)&#123;<br><span class="hljs-comment">//æ¥å•é€»è¾‘</span><br>&#125;<br></code></pre></td></tr></table></figure><p>é—®é¢˜åˆ†æï¼š</p><p>è¿™ç±»ä»£ç éš¾ä»¥åº”å¯¹å˜åŒ–ï¼Œåœ¨æ·»åŠ ä¸€ç§çŠ¶æ€æ—¶ï¼Œæˆ‘ä»¬éœ€è¦æ‰‹åŠ¨ æ·»åŠ if/elseï¼Œåœ¨æ·»åŠ ä¸€ç§åŠŸèƒ½æ—¶ï¼Œè¦å¯¹æ‰€æœ‰çš„çŠ¶æ€è¿›è¡Œåˆ¤æ–­ã€‚ å› æ­¤ä»£ç ä¼šå˜å¾—è¶Šæ¥è¶Šè‡ƒè‚¿ï¼Œå¹¶ä¸”ä¸€æ—¦æ²¡æœ‰å¤„ç†æŸä¸ªçŠ¶æ€ï¼Œ ä¾¿ä¼šå‘ç”Ÿæå…¶ä¸¥é‡çš„BUGï¼Œéš¾ä»¥ç»´æŠ¤ã€‚æ­¤æ—¶å°±éœ€è¦ä½¿ç”¨çŠ¶æ€æ¨¡å¼</p><h2 id="4ã€çŠ¶æ€æ¨¡å¼æ³¨æ„äº‹é¡¹"><a href="#4ã€çŠ¶æ€æ¨¡å¼æ³¨æ„äº‹é¡¹" class="headerlink" title="4ã€çŠ¶æ€æ¨¡å¼æ³¨æ„äº‹é¡¹"></a>4ã€çŠ¶æ€æ¨¡å¼æ³¨æ„äº‹é¡¹</h2><ol><li>ä»£ç æœ‰å¾ˆå¼ºçš„å¯è¯»æ€§ã€‚çŠ¶æ€æ¨¡å¼å°†æ¯ä¸ªçŠ¶æ€çš„è¡Œä¸ºå°è£…åˆ°å¯¹åº”çš„ä¸€ä¸ªç±»ä¸­ </li><li>æ–¹ä¾¿ç»´æŠ¤ã€‚å°†å®¹æ˜“äº§ç”Ÿé—®é¢˜çš„if-elseè¯­å¥åˆ é™¤äº†ï¼Œå¦‚æœæŠŠæ¯ä¸ªçŠ¶æ€çš„è¡Œä¸ºéƒ½æ”¾åˆ°ä¸€ ä¸ªç±»ä¸­ï¼Œæ¯æ¬¡è°ƒç”¨æ–¹æ³•æ—¶éƒ½è¦åˆ¤æ–­å½“å‰æ˜¯ä»€ä¹ˆçŠ¶æ€ï¼Œä¸ä½†ä¼šäº§å‡ºå¾ˆå¤šif-elseè¯­å¥ï¼Œ è€Œä¸”å®¹æ˜“å‡ºé”™ </li><li>ç¬¦åˆâ€œå¼€é—­åŸåˆ™â€ã€‚å®¹æ˜“å¢åˆ çŠ¶æ€ </li><li>ä¼šäº§ç”Ÿå¾ˆå¤šç±»ã€‚æ¯ä¸ªçŠ¶æ€éƒ½è¦ä¸€ä¸ªå¯¹åº”çš„ç±»ï¼Œå½“çŠ¶æ€è¿‡å¤šæ—¶ä¼šäº§ç”Ÿå¾ˆå¤šç±»ï¼ŒåŠ å¤§ç»´ æŠ¤éš¾åº¦ </li><li>åº”ç”¨åœºæ™¯ï¼šå½“ä¸€ä¸ªäº‹ä»¶æˆ–è€…å¯¹è±¡æœ‰å¾ˆå¤šç§çŠ¶æ€ï¼ŒçŠ¶æ€ä¹‹é—´ä¼šç›¸äº’è½¬æ¢ï¼Œå¯¹ä¸åŒçš„çŠ¶ æ€è¦æ±‚æœ‰ä¸åŒçš„è¡Œä¸ºçš„æ—¶å€™ï¼Œå¯ä»¥è€ƒè™‘ä½¿ç”¨çŠ¶æ€æ¨¡å¼</li></ol><h1 id="äºŒã€è¿­ä»£å™¨æ¨¡å¼"><a href="#äºŒã€è¿­ä»£å™¨æ¨¡å¼" class="headerlink" title="äºŒã€è¿­ä»£å™¨æ¨¡å¼"></a>äºŒã€è¿­ä»£å™¨æ¨¡å¼</h1><h2 id="1ã€è¿­ä»£å™¨æ¨¡å¼çš„åŸç†å’Œå®ç°"><a href="#1ã€è¿­ä»£å™¨æ¨¡å¼çš„åŸç†å’Œå®ç°" class="headerlink" title="1ã€è¿­ä»£å™¨æ¨¡å¼çš„åŸç†å’Œå®ç°"></a>1ã€è¿­ä»£å™¨æ¨¡å¼çš„åŸç†å’Œå®ç°</h2><p>è¿­ä»£å™¨æ¨¡å¼ï¼Œä¹Ÿå«æ¸¸æ ‡æ¨¡å¼ã€‚è¿­ä»£å™¨æ¨¡å¼ç”¨æ¥éå†é›†åˆå¯¹è±¡ã€‚è¿™é‡Œè¯´çš„â€œé›†åˆå¯¹è±¡â€ä¹Ÿå¯ä»¥å«â€œå®¹å™¨â€â€œèšåˆå¯¹è±¡â€ï¼Œå®é™…ä¸Šå°±æ˜¯åŒ…å«ä¸€ç»„å¯¹è±¡çš„å¯¹è±¡ï¼Œæ¯”å¦‚æ•°ç»„ã€é“¾è¡¨ã€æ ‘ã€å›¾ã€è·³è¡¨ã€‚è¿­ä»£å™¨æ¨¡å¼å°†é›†åˆå¯¹è±¡çš„éå†æ“ä½œä»é›†åˆç±»ä¸­æ‹†åˆ†å‡ºæ¥ï¼Œæ”¾åˆ°è¿­ä»£å™¨ç±»ä¸­ï¼Œè®©ä¸¤è€…çš„èŒè´£æ›´åŠ å•ä¸€ã€‚</p><p>è¿­ä»£å™¨æ˜¯ç”¨æ¥éå†å®¹å™¨çš„ï¼Œæ‰€ä»¥ï¼Œä¸€ä¸ªå®Œæ•´çš„è¿­ä»£å™¨æ¨¡å¼ä¸€èˆ¬ä¼šæ¶‰åŠ<strong>å®¹å™¨å’Œå®¹å™¨è¿­ä»£å™¨</strong>éƒ¨åˆ†ä¸¤éƒ¨åˆ†å†…å®¹ã€‚ä¸ºäº†è¾¾åˆ°åŸºäºæ¥å£è€Œéå®ç°ç¼–ç¨‹çš„ç›®çš„ï¼Œå®¹å™¨åˆåŒ…å«å®¹å™¨æ¥å£ã€å®¹å™¨å®ç°ç±»ï¼Œè¿­ä»£å™¨åˆåŒ…å«è¿­ä»£å™¨æ¥å£ã€è¿­ä»£å™¨å®ç°ç±»ã€‚</p><p>é€šè¿‡ä¸€ä¸ªä¾‹å­æ¥å…·ä½“è®²ï¼Œå¦‚ä½•å®ç°ä¸€ä¸ªè¿­ä»£å™¨ã€‚</p><p>å¤§éƒ¨åˆ†ç¼–ç¨‹è¯­è¨€éƒ½æä¾›äº†éå†å®¹å™¨çš„è¿­ä»£å™¨ç±»ï¼Œæˆ‘ä»¬åœ¨å¹³æ—¶å¼€å‘ä¸­ï¼Œç›´æ¥æ‹¿æ¥ç”¨å³å¯ï¼Œå‡ ä¹ä¸å¤§å¯èƒ½ä»é›¶ç¼–å†™ä¸€ä¸ªè¿­ä»£å™¨ã€‚ä¸è¿‡ï¼Œè¿™é‡Œä¸ºäº†è®²è§£è¿­ä»£å™¨çš„å®ç°åŸç†ï¼Œæˆ‘ä»¬å‡è®¾æŸä¸ªæ–°çš„ç¼–ç¨‹è¯­è¨€çš„åŸºç¡€ç±»åº“ä¸­ï¼Œè¿˜æ²¡æœ‰æä¾›çº¿æ€§å®¹å™¨å¯¹åº”çš„è¿­ä»£å™¨ï¼Œéœ€è¦æˆ‘ä»¬ä»é›¶å¼€å§‹å¼€å‘ã€‚</p><p>çº¿æ€§æ•°æ®ç»“æ„åŒ…æ‹¬æ•°ç»„å’Œé“¾è¡¨ï¼Œåœ¨å¤§éƒ¨åˆ†ç¼–ç¨‹è¯­è¨€ä¸­éƒ½æœ‰å¯¹åº”çš„ç±»æ¥å°è£…è¿™ä¸¤ç§æ•°æ®ç»“æ„ï¼Œåœ¨å¼€å‘ä¸­ç›´æ¥æ‹¿æ¥ç”¨å°±å¯ä»¥äº†ã€‚å‡è®¾åœ¨è¿™ç§æ–°çš„ç¼–ç¨‹è¯­è¨€ä¸­ï¼Œè¿™ä¸¤ä¸ªæ•°æ®ç»“æ„åˆ†åˆ«å¯¹åº” ArrayList å’Œ LinkedList ä¸¤ä¸ªç±»ã€‚é™¤æ­¤ä¹‹å¤–ï¼Œæˆ‘ä»¬ä»ä¸¤ä¸ªç±»ä¸­æŠ½è±¡å‡ºå…¬å…±çš„æ¥å£ï¼Œå®šä¹‰ä¸º List æ¥å£ï¼Œä»¥æ–¹ä¾¿å¼€å‘è€…åŸºäºæ¥å£è€Œéå®ç°ç¼–ç¨‹ï¼Œç¼–å†™çš„ä»£ç èƒ½åœ¨ä¸¤ç§æ•°æ®å­˜å‚¨ç»“æ„ä¹‹é—´çµæ´»åˆ‡æ¢ã€‚</p><p>ç°åœ¨é’ˆå¯¹ ArrayList å’Œ LinkedList ä¸¤ä¸ªçº¿æ€§å®¹å™¨ï¼Œè®¾è®¡å®ç°å¯¹åº”çš„è¿­ä»£å™¨ã€‚å®šä¹‰ä¸€ä¸ªè¿­ä»£å™¨æ¥å£ Iteratorï¼Œä»¥åŠé’ˆå¯¹ä¸¤ç§å®¹å™¨çš„å…·ä½“çš„è¿­ä»£å™¨å®ç°ç±» ArrayIterator å’Œ ListIteratorã€‚</p><p>å…ˆæ¥çœ‹ä¸‹ Iterator æ¥å£çš„å®šä¹‰ã€‚å…·ä½“çš„ä»£ç å¦‚ä¸‹æ‰€ç¤ºï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-comment">// æ¥å£å®šä¹‰æ–¹å¼ä¸€</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">interface</span> <span class="hljs-title class_">Iterator</span>&lt;E&gt; &#123;<br>  <span class="hljs-type">boolean</span> <span class="hljs-title function_">hasNext</span><span class="hljs-params">()</span>;<br>  <span class="hljs-keyword">void</span> <span class="hljs-title function_">next</span><span class="hljs-params">()</span>;<br>  E <span class="hljs-title function_">currentItem</span><span class="hljs-params">()</span>;<br>&#125;<br><br><span class="hljs-comment">// æ¥å£å®šä¹‰æ–¹å¼äºŒ</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">interface</span> <span class="hljs-title class_">Iterator</span>&lt;E&gt; &#123;<br>  <span class="hljs-type">boolean</span> <span class="hljs-title function_">hasNext</span><span class="hljs-params">()</span>;<br>  E <span class="hljs-title function_">next</span><span class="hljs-params">()</span>;<br>&#125;<br></code></pre></td></tr></table></figure><p>Iterator æ¥å£æœ‰ä¸¤ç§å®šä¹‰æ–¹å¼ã€‚åœ¨ç¬¬ä¸€ç§å®šä¹‰ä¸­ï¼Œnext() å‡½æ•°ç”¨æ¥å°†æ¸¸æ ‡åç§»ä¸€ä½å…ƒç´ ï¼ŒcurrentItem() å‡½æ•°ç”¨æ¥è¿”å›å½“å‰æ¸¸æ ‡æŒ‡å‘çš„å…ƒç´ ã€‚åœ¨ç¬¬äºŒç§å®šä¹‰ä¸­ï¼Œè¿”å›å½“å‰å…ƒç´ ä¸åç§»ä¸€ä½è¿™ä¸¤ä¸ªæ“ä½œï¼Œè¦æ”¾åˆ°åŒä¸€ä¸ªå‡½æ•° next() ä¸­å®Œæˆã€‚ç¬¬ä¸€ç§å®šä¹‰æ–¹å¼æ›´åŠ çµæ´»ä¸€äº›ï¼Œæ¯”å¦‚æˆ‘ä»¬å¯ä»¥å¤šæ¬¡è°ƒç”¨ currentItem() æŸ¥è¯¢å½“å‰å…ƒç´ ï¼Œè€Œä¸ç§»åŠ¨æ¸¸æ ‡ã€‚æ‰€ä»¥ï¼Œåœ¨æ¥ä¸‹æ¥çš„å®ç°ä¸­ï¼Œæˆ‘ä»¬é€‰æ‹©ç¬¬ä¸€ç§æ¥å£å®šä¹‰æ–¹å¼ã€‚</p><p>å†æ¥çœ‹ä¸‹ ArrayIterator çš„ä»£ç å®ç°ï¼Œå…·ä½“å¦‚ä¸‹æ‰€ç¤ºã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">ArrayIterator</span>&lt;E&gt; <span class="hljs-keyword">implements</span> <span class="hljs-title class_">Iterator</span>&lt;E&gt; &#123;<br>  <span class="hljs-keyword">private</span> <span class="hljs-type">int</span> cursor;<br>  <span class="hljs-keyword">private</span> ArrayList&lt;E&gt; arrayList;<br><br>  <span class="hljs-keyword">public</span> <span class="hljs-title function_">ArrayIterator</span><span class="hljs-params">(ArrayList&lt;E&gt; arrayList)</span> &#123;<br>    <span class="hljs-built_in">this</span>.cursor = <span class="hljs-number">0</span>;<br>    <span class="hljs-built_in">this</span>.arrayList = arrayList;<br>  &#125;<br><br>  <span class="hljs-meta">@Override</span><br>  <span class="hljs-keyword">public</span> <span class="hljs-type">boolean</span> <span class="hljs-title function_">hasNext</span><span class="hljs-params">()</span> &#123;<br>    <span class="hljs-keyword">return</span> cursor != arrayList.size(); <span class="hljs-comment">// æ³¨æ„è¿™é‡Œï¼Œcursoråœ¨æŒ‡å‘æœ€åä¸€ä¸ªå…ƒç´ çš„æ—¶å€™ï¼ŒhasNext()ä»æ—§è¿”å›trueã€‚</span><br>  &#125;<br><br>  <span class="hljs-meta">@Override</span><br>  <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">next</span><span class="hljs-params">()</span> &#123;<br>    cursor++;<br>  &#125;<br><br>  <span class="hljs-meta">@Override</span><br>  <span class="hljs-keyword">public</span> E <span class="hljs-title function_">currentItem</span><span class="hljs-params">()</span> &#123;<br>    <span class="hljs-keyword">if</span> (cursor &gt;= arrayList.size()) &#123;<br>      <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">NoSuchElementException</span>();<br>    &#125;<br><br>    <span class="hljs-keyword">return</span> arrayList.get(cursor);<br>  &#125;<br>&#125;<br><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Demo</span> &#123;<br><br>  <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span> &#123;<br>    ArrayList&lt;String&gt; names = <span class="hljs-keyword">new</span> <span class="hljs-title class_">ArrayList</span>&lt;&gt;();<br>    names.add(<span class="hljs-string">&quot;lql&quot;</span>);<br>    names.add(<span class="hljs-string">&quot;dl&quot;</span>);<br>    names.add(<span class="hljs-string">&quot;tql&quot;</span>);<br><br>    Iterator&lt;String&gt; iterator = <span class="hljs-keyword">new</span> <span class="hljs-title class_">ArrayIterator</span>(names);<br>    <span class="hljs-keyword">while</span> (iterator.hasNext()) &#123;<br>      System.out.println(iterator.currentItem());<br>      iterator.next();<br>    &#125;<br>  &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>åœ¨ä¸Šé¢çš„ä»£ç å®ç°ä¸­ï¼Œéœ€è¦å°†å¾…éå†çš„å®¹å™¨å¯¹è±¡ï¼Œé€šè¿‡æ„é€ å‡½æ•°ä¼ é€’ç»™è¿­ä»£å™¨ç±»ã€‚å®é™…ä¸Šï¼Œä¸ºäº†å°è£…è¿­ä»£å™¨çš„åˆ›å»ºç»†èŠ‚ï¼Œæˆ‘ä»¬å¯ä»¥åœ¨å®¹å™¨ä¸­å®šä¹‰ä¸€ä¸ª iterator() æ–¹æ³•ï¼Œæ¥åˆ›å»ºå¯¹åº”çš„è¿­ä»£å™¨ã€‚ä¸ºäº†èƒ½å®ç°åŸºäºæ¥å£è€Œéå®ç°ç¼–ç¨‹ï¼Œæˆ‘ä»¬è¿˜éœ€è¦å°†è¿™ä¸ªæ–¹æ³•å®šä¹‰åœ¨ List æ¥å£ä¸­ã€‚å…·ä½“çš„ä»£ç å®ç°å’Œä½¿ç”¨ç¤ºä¾‹å¦‚ä¸‹æ‰€ç¤ºï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">import</span> java.util.Iterator;<br><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">interface</span> <span class="hljs-title class_">List</span>&lt;E&gt; &#123;<br>  Iterator <span class="hljs-title function_">iterator</span><span class="hljs-params">()</span>;<br>  <span class="hljs-comment">// ...çœç•¥å…¶ä»–æ¥å£å‡½æ•°...</span><br>&#125;<br><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">ArrayList</span>&lt;E&gt; <span class="hljs-keyword">implements</span> <span class="hljs-title class_">List</span>&lt;E&gt; &#123;<br>  <span class="hljs-comment">// ...</span><br>  <span class="hljs-keyword">public</span> Iterator <span class="hljs-title function_">iterator</span><span class="hljs-params">()</span> &#123;<br>    <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">ArrayIterator</span>(<span class="hljs-built_in">this</span>);<br>  &#125;<br>  <span class="hljs-comment">// ...çœç•¥å…¶ä»–ä»£ç </span><br>&#125;<br><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Demo</span> &#123;<br><br>  <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span> &#123;<br>    List&lt;String&gt; names = <span class="hljs-keyword">new</span> <span class="hljs-title class_">ArrayList</span>&lt;&gt;();<br>    names.add(<span class="hljs-string">&quot;lql&quot;</span>);<br>    names.add(<span class="hljs-string">&quot;dl&quot;</span>);<br>    names.add(<span class="hljs-string">&quot;tql&quot;</span>);<br><br>    Iterator&lt;String&gt; iterator = names.iterator();<br>    <span class="hljs-keyword">while</span> (iterator.hasNext()) &#123;<br>      System.out.println(iterator.currentItem());<br>      iterator.next();<br>    &#125;<br>  &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>å¯¹äº LinkedIteratorï¼Œå®ƒçš„ä»£ç ç»“æ„è·Ÿ ArrayIterator å®Œå…¨ç›¸åŒã€‚ç»“åˆåˆšåˆšçš„ä¾‹å­ï¼Œæ¥æ€»ç»“ä¸€ä¸‹è¿­ä»£å™¨çš„è®¾è®¡æ€è·¯ã€‚æ€»ç»“ä¸‹æ¥å°±ä¸‰å¥è¯ï¼šè¿­ä»£å™¨ä¸­éœ€è¦å®šä¹‰ hasNext()ã€currentItem()ã€next() ä¸‰ä¸ªæœ€åŸºæœ¬çš„æ–¹æ³•ã€‚å¾…éå†çš„å®¹å™¨å¯¹è±¡é€šè¿‡ä¾èµ–æ³¨å…¥ä¼ é€’åˆ°è¿­ä»£å™¨ç±»ä¸­ã€‚å®¹å™¨é€šè¿‡ iterator() æ–¹æ³•æ¥åˆ›å»ºè¿­ä»£å™¨ã€‚</p><h2 id="2ã€è¿­ä»£å™¨æ¨¡å¼çš„ä¼˜åŠ¿"><a href="#2ã€è¿­ä»£å™¨æ¨¡å¼çš„ä¼˜åŠ¿" class="headerlink" title="2ã€è¿­ä»£å™¨æ¨¡å¼çš„ä¼˜åŠ¿"></a>2ã€è¿­ä»£å™¨æ¨¡å¼çš„ä¼˜åŠ¿</h2><p>ä¸€èˆ¬æ¥è®²ï¼Œéå†é›†åˆæ•°æ®æœ‰ä¸‰ç§æ–¹æ³•ï¼šfor å¾ªç¯ã€foreach å¾ªç¯ã€iterator è¿­ä»£å™¨ã€‚å¯¹äºè¿™ä¸‰ç§æ–¹å¼ï¼Œæˆ‘æ‹¿ Java è¯­è¨€æ¥ä¸¾ä¾‹è¯´æ˜ä¸€ä¸‹ã€‚å…·ä½“çš„ä»£ç å¦‚ä¸‹æ‰€ç¤ºï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span> &#123;<br>    List&lt;String&gt; names = <span class="hljs-keyword">new</span> <span class="hljs-title class_">ArrayList</span>&lt;&gt;();<br><br>    names.add(<span class="hljs-string">&quot;lql&quot;</span>);<br>    names.add(<span class="hljs-string">&quot;dl&quot;</span>);<br>    names.add(<span class="hljs-string">&quot;tql&quot;</span>);<br><br>    <span class="hljs-comment">// ç¬¬ä¸€ç§éå†æ–¹å¼ï¼šforå¾ªç¯</span><br>    <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> <span class="hljs-variable">i</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>; i &lt; names.size(); i++) &#123;<br>      System.out.print(names.get(i) + <span class="hljs-string">&quot;,&quot;</span>);<br>    &#125;<br><br>    <span class="hljs-comment">// ç¬¬äºŒç§éå†æ–¹å¼ï¼šforeachå¾ªç¯</span><br>    <span class="hljs-keyword">for</span> (String name : names) &#123;<br>      System.out.print(name + <span class="hljs-string">&quot;,&quot;</span>);<br>    &#125;<br><br>    <span class="hljs-comment">// ç¬¬ä¸‰ç§éå†æ–¹å¼ï¼šè¿­ä»£å™¨éå†</span><br>    Iterator&lt;String&gt; iterator = names.iterator();<br>    <span class="hljs-keyword">while</span> (iterator.hasNext()) &#123;<br>      System.out.print(iterator.next() + <span class="hljs-string">&quot;,&quot;</span>); <span class="hljs-comment">// Javaä¸­çš„è¿­ä»£å™¨æ¥å£æ˜¯ç¬¬äºŒç§å®šä¹‰æ–¹å¼ï¼Œnext()æ—¢ç§»åŠ¨æ¸¸æ ‡åˆè¿”å›æ•°æ®</span><br>    &#125;<br>  &#125;<br></code></pre></td></tr></table></figure><p>å®é™…ä¸Šï¼Œforeach å¾ªç¯åªæ˜¯ä¸€ä¸ªè¯­æ³•ç³–è€Œå·²ï¼Œåº•å±‚æ˜¯åŸºäºè¿­ä»£å™¨æ¥å®ç°çš„ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œä¸Šé¢ä»£ç ä¸­çš„ç¬¬äºŒç§éå†æ–¹å¼ï¼ˆforeach å¾ªç¯ä»£ç ï¼‰çš„åº•å±‚å®ç°ï¼Œå°±æ˜¯ç¬¬ä¸‰ç§éå†æ–¹å¼ï¼ˆè¿­ä»£å™¨éå†ä»£ç ï¼‰ã€‚è¿™ä¸¤ç§éå†æ–¹å¼å¯ä»¥çœ‹ä½œåŒä¸€ç§éå†æ–¹å¼ï¼Œä¹Ÿå°±æ˜¯è¿­ä»£å™¨éå†æ–¹å¼ã€‚</p><p>ä»ä¸Šé¢çš„ä»£ç æ¥çœ‹ï¼Œfor å¾ªç¯éå†æ–¹å¼æ¯”èµ·è¿­ä»£å™¨éå†æ–¹å¼ï¼Œä»£ç çœ‹èµ·æ¥æ›´åŠ ç®€æ´ã€‚é‚£ä¸ºä»€ä¹ˆè¿˜è¦ç”¨è¿­ä»£å™¨æ¥éå†å®¹å™¨å‘¢ï¼Ÿä¸ºä»€ä¹ˆè¿˜è¦ç»™å®¹å™¨è®¾è®¡å¯¹åº”çš„è¿­ä»£å™¨å‘¢ï¼ŸåŸå› æœ‰ä»¥ä¸‹ä¸‰ä¸ªã€‚</p><ol><li>é¦–å…ˆï¼Œå¯¹äºç±»ä¼¼æ•°ç»„å’Œé“¾è¡¨è¿™æ ·çš„æ•°æ®ç»“æ„ï¼Œéå†æ–¹å¼æ¯”è¾ƒç®€å•ï¼Œç›´æ¥ä½¿ç”¨ for å¾ªç¯æ¥éå†å°±è¶³å¤Ÿäº†ã€‚ä½†æ˜¯ï¼Œå¯¹äºå¤æ‚çš„æ•°æ®ç»“æ„ï¼ˆæ¯”å¦‚æ ‘ã€å›¾ï¼‰æ¥è¯´ï¼Œæœ‰å„ç§å¤æ‚çš„éå†æ–¹å¼ã€‚æ¯”å¦‚ï¼Œæ ‘æœ‰å‰ä¸­ååºã€æŒ‰å±‚éå†ï¼Œå›¾æœ‰æ·±åº¦ä¼˜å…ˆã€å¹¿åº¦ä¼˜å…ˆéå†ç­‰ç­‰ã€‚å¦‚æœç”±å®¢æˆ·ç«¯ä»£ç æ¥å®ç°è¿™äº›éå†ç®—æ³•ï¼ŒåŠ¿å¿…å¢åŠ å¼€å‘æˆæœ¬ï¼Œè€Œä¸”å®¹æ˜“å†™é”™ã€‚å¦‚æœå°†è¿™éƒ¨åˆ†éå†çš„é€»è¾‘å†™åˆ°å®¹å™¨ç±»ä¸­ï¼Œä¹Ÿä¼šå¯¼è‡´å®¹å™¨ç±»ä»£ç çš„å¤æ‚æ€§ã€‚å‰é¢ä¹Ÿå¤šæ¬¡æåˆ°ï¼Œåº”å¯¹å¤æ‚æ€§çš„æ–¹æ³•å°±æ˜¯æ‹†åˆ†ã€‚æˆ‘ä»¬å¯ä»¥å°†éå†æ“ä½œæ‹†åˆ†åˆ°è¿­ä»£å™¨ç±»ä¸­ã€‚æ¯”å¦‚ï¼Œé’ˆå¯¹å›¾çš„éå†ï¼Œæˆ‘ä»¬å°±å¯ä»¥å®šä¹‰ DFSIteratorã€BFSIterator ä¸¤ä¸ªè¿­ä»£å™¨ç±»ï¼Œè®©å®ƒä»¬åˆ†åˆ«æ¥å®ç°æ·±åº¦ä¼˜å…ˆéå†å’Œå¹¿åº¦ä¼˜å…ˆéå†ã€‚</li><li>å…¶æ¬¡ï¼Œå°†æ¸¸æ ‡æŒ‡å‘çš„å½“å‰ä½ç½®ç­‰ä¿¡æ¯ï¼Œå­˜å‚¨åœ¨è¿­ä»£å™¨ç±»ä¸­ï¼Œæ¯ä¸ªè¿­ä»£å™¨ç‹¬äº«æ¸¸æ ‡ä¿¡æ¯ã€‚è¿™æ ·ï¼Œæˆ‘ä»¬å°±å¯ä»¥åˆ›å»ºå¤šä¸ªä¸åŒçš„è¿­ä»£å™¨ï¼ŒåŒæ—¶å¯¹åŒä¸€ä¸ªå®¹å™¨è¿›è¡Œéå†è€Œäº’ä¸å½±å“ã€‚</li><li>æœ€åï¼Œå®¹å™¨å’Œè¿­ä»£å™¨éƒ½æä¾›äº†æŠ½è±¡çš„æ¥å£ï¼Œæ–¹ä¾¿æˆ‘ä»¬åœ¨å¼€å‘çš„æ—¶å€™ï¼ŒåŸºäºæ¥å£è€Œéå…·ä½“çš„å®ç°ç¼–ç¨‹ã€‚å½“éœ€è¦åˆ‡æ¢æ–°çš„éå†ç®—æ³•çš„æ—¶å€™ï¼Œæ¯”å¦‚ï¼Œä»å‰å¾€åéå†é“¾è¡¨åˆ‡æ¢æˆä»åå¾€å‰éå†é“¾è¡¨ï¼Œå®¢æˆ·ç«¯ä»£ç åªéœ€è¦å°†è¿­ä»£å™¨ç±»ä» LinkedIterator åˆ‡æ¢ä¸º ReversedLinkedIterator å³å¯ï¼Œå…¶ä»–ä»£ç éƒ½ä¸éœ€è¦ä¿®æ”¹ã€‚é™¤æ­¤ä¹‹å¤–ï¼Œæ·»åŠ æ–°çš„éå†ç®—æ³•ï¼Œæˆ‘ä»¬åªéœ€è¦æ‰©å±•æ–°çš„è¿­ä»£å™¨ç±»ï¼Œä¹Ÿæ›´ç¬¦åˆå¼€é—­åŸåˆ™ã€‚</li></ol><p>è¿­ä»£å™¨æ¨¡å¼ä¸»è¦ä½œç”¨æ˜¯è§£è€¦å®¹å™¨ä»£ç å’Œéå†ä»£ç ã€‚</p><h2 id="3ã€åœ¨éå†çš„åŒæ—¶å¢åˆ é›†åˆå…ƒç´ ä¼šå‘ç”Ÿä»€ä¹ˆï¼Ÿ"><a href="#3ã€åœ¨éå†çš„åŒæ—¶å¢åˆ é›†åˆå…ƒç´ ä¼šå‘ç”Ÿä»€ä¹ˆï¼Ÿ" class="headerlink" title="3ã€åœ¨éå†çš„åŒæ—¶å¢åˆ é›†åˆå…ƒç´ ä¼šå‘ç”Ÿä»€ä¹ˆï¼Ÿ"></a>3ã€åœ¨éå†çš„åŒæ—¶å¢åˆ é›†åˆå…ƒç´ ä¼šå‘ç”Ÿä»€ä¹ˆï¼Ÿ</h2><p>åœ¨é€šè¿‡è¿­ä»£å™¨æ¥éå†é›†åˆå…ƒç´ çš„åŒæ—¶ï¼Œå¢åŠ æˆ–è€…åˆ é™¤é›†åˆä¸­çš„å…ƒç´ ï¼Œæœ‰å¯èƒ½ä¼šå¯¼è‡´æŸä¸ªå…ƒç´ è¢«é‡å¤éå†æˆ–éå†ä¸åˆ°ã€‚ä¸è¿‡ï¼Œå¹¶ä¸æ˜¯æ‰€æœ‰æƒ…å†µä¸‹éƒ½ä¼šéå†å‡ºé”™ï¼Œæœ‰çš„æ—¶å€™ä¹Ÿå¯ä»¥æ­£å¸¸éå†ï¼Œæ‰€ä»¥ï¼Œè¿™ç§è¡Œä¸ºç§°ä¸º<strong>ç»“æœä¸å¯é¢„æœŸè¡Œä¸º</strong>æˆ–è€…<strong>æœªå†³è¡Œä¸º</strong>ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œè¿è¡Œç»“æœåˆ°åº•æ˜¯å¯¹è¿˜æ˜¯é”™ï¼Œè¦è§†æƒ…å†µè€Œå®šã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">interface</span> <span class="hljs-title class_">Iterator</span>&lt;E&gt; &#123;<br>  <span class="hljs-type">boolean</span> <span class="hljs-title function_">hasNext</span><span class="hljs-params">()</span>;<br>  <span class="hljs-keyword">void</span> <span class="hljs-title function_">next</span><span class="hljs-params">()</span>;<br>  E <span class="hljs-title function_">currentItem</span><span class="hljs-params">()</span>;<br>&#125;<br><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">ArrayIterator</span>&lt;E&gt; <span class="hljs-keyword">implements</span> <span class="hljs-title class_">Iterator</span>&lt;E&gt; &#123;<br>  <span class="hljs-keyword">private</span> <span class="hljs-type">int</span> cursor;<br>  <span class="hljs-keyword">private</span> ArrayList&lt;E&gt; arrayList;<br><br>  <span class="hljs-keyword">public</span> <span class="hljs-title function_">ArrayIterator</span><span class="hljs-params">(ArrayList&lt;E&gt; arrayList)</span> &#123;<br>    <span class="hljs-built_in">this</span>.cursor = <span class="hljs-number">0</span>;<br>    <span class="hljs-built_in">this</span>.arrayList = arrayList;<br>  &#125;<br><br>  <span class="hljs-meta">@Override</span><br>  <span class="hljs-keyword">public</span> <span class="hljs-type">boolean</span> <span class="hljs-title function_">hasNext</span><span class="hljs-params">()</span> &#123;<br>    <span class="hljs-keyword">return</span> cursor &lt; arrayList.size();<br>  &#125;<br><br>  <span class="hljs-meta">@Override</span><br>  <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">next</span><span class="hljs-params">()</span> &#123;<br>    cursor++;<br>  &#125;<br><br>  <span class="hljs-meta">@Override</span><br>  <span class="hljs-keyword">public</span> E <span class="hljs-title function_">currentItem</span><span class="hljs-params">()</span> &#123;<br>    <span class="hljs-keyword">if</span> (cursor &gt;= arrayList.size()) &#123;<br>      <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">NoSuchElementException</span>();<br>    &#125;<br><br>    <span class="hljs-keyword">return</span> arrayList.get(cursor);<br>  &#125;<br>&#125;<br><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">interface</span> <span class="hljs-title class_">List</span>&lt;E&gt; &#123;<br>  Iterator <span class="hljs-title function_">iterator</span><span class="hljs-params">()</span>;<br>&#125;<br><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">ArrayList</span>&lt;E&gt; <span class="hljs-keyword">implements</span> <span class="hljs-title class_">List</span>&lt;E&gt; &#123;<br>  <span class="hljs-comment">// ...</span><br>  <span class="hljs-keyword">public</span> Iterator <span class="hljs-title function_">iterator</span><span class="hljs-params">()</span> &#123;<br>    <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">ArrayIterator</span>(<span class="hljs-built_in">this</span>);<br>  &#125;<br>  <span class="hljs-comment">// ...</span><br>&#125;<br><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Demo</span> &#123;<br><br>  <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span> &#123;<br>    List&lt;String&gt; names = <span class="hljs-keyword">new</span> <span class="hljs-title class_">ArrayList</span>&lt;&gt;();<br>    names.add(<span class="hljs-string">&quot;a&quot;</span>);<br>    names.add(<span class="hljs-string">&quot;b&quot;</span>);<br>    names.add(<span class="hljs-string">&quot;c&quot;</span>);<br>    names.add(<span class="hljs-string">&quot;d&quot;</span>);<br><br>    Iterator&lt;String&gt; iterator = names.iterator();<br>    iterator.next();<br>    names.remove(<span class="hljs-string">&quot;a&quot;</span>);<br>  &#125;<br>&#125;<br></code></pre></td></tr></table></figure><ol><li>æˆ‘ä»¬çŸ¥é“ï¼ŒArrayList åº•å±‚å¯¹åº”çš„æ˜¯æ•°ç»„è¿™ç§æ•°æ®ç»“æ„ï¼Œåœ¨æ‰§è¡Œå®Œç¬¬ 55 è¡Œä»£ç çš„æ—¶å€™ï¼Œæ•°ç»„ä¸­å­˜å‚¨çš„æ˜¯ aã€bã€cã€d å››ä¸ªå…ƒç´ ï¼Œè¿­ä»£å™¨çš„æ¸¸æ ‡ cursor æŒ‡å‘å…ƒç´  aã€‚å½“æ‰§è¡Œå®Œç¬¬ 58è¡Œä»£ç çš„æ—¶å€™ï¼Œæ¸¸æ ‡æŒ‡å‘å…ƒç´  bï¼Œåˆ°è¿™é‡Œéƒ½æ²¡æœ‰é—®é¢˜ã€‚</li><li>ä¸ºäº†ä¿æŒæ•°ç»„å­˜å‚¨æ•°æ®çš„è¿ç»­æ€§ï¼Œæ•°ç»„çš„åˆ é™¤æ“ä½œä¼šæ¶‰åŠå…ƒç´ çš„æ¬ç§»ã€‚å½“æ‰§è¡Œåˆ°ç¬¬ 59è¡Œä»£ç çš„æ—¶å€™ï¼Œæˆ‘ä»¬ä»æ•°ç»„ä¸­å°†å…ƒç´  a åˆ é™¤æ‰ï¼Œbã€cã€d ä¸‰ä¸ªå…ƒç´ ä¼šä¾æ¬¡å¾€å‰æ¬ç§»ä¸€ä½ï¼Œè¿™å°±ä¼šå¯¼è‡´æ¸¸æ ‡æœ¬æ¥æŒ‡å‘å…ƒç´  bï¼Œç°åœ¨å˜æˆäº†æŒ‡å‘å…ƒç´  cã€‚åŸæœ¬åœ¨æ‰§è¡Œå®Œç¬¬ 58 è¡Œä»£ç ä¹‹åï¼Œæˆ‘ä»¬è¿˜å¯ä»¥éå†åˆ° bã€cã€d ä¸‰ä¸ªå…ƒç´ ï¼Œä½†åœ¨æ‰§è¡Œå®Œç¬¬ 59 è¡Œä»£ç ä¹‹åï¼Œæˆ‘ä»¬åªèƒ½éå†åˆ° cã€d ä¸¤ä¸ªå…ƒç´ ï¼Œb éå†ä¸åˆ°äº†ã€‚</li></ol><ol><li>ä¸è¿‡ï¼Œå¦‚æœç¬¬ 59 è¡Œä»£ç åˆ é™¤çš„ä¸æ˜¯æ¸¸æ ‡å‰é¢çš„å…ƒç´ ï¼ˆå…ƒç´  aï¼‰ä»¥åŠæ¸¸æ ‡æ‰€åœ¨ä½ç½®çš„å…ƒç´ ï¼ˆå…ƒç´  bï¼‰ï¼Œè€Œæ˜¯æ¸¸æ ‡åé¢çš„å…ƒç´ ï¼ˆå…ƒç´  c å’Œ dï¼‰ï¼Œè¿™æ ·å°±ä¸ä¼šå­˜åœ¨ä»»ä½•é—®é¢˜äº†ï¼Œä¸ä¼šå­˜åœ¨æŸä¸ªå…ƒç´ éå†ä¸åˆ°çš„æƒ…å†µäº†ã€‚</li><li>æ‰€ä»¥ï¼Œæˆ‘ä»¬å‰é¢è¯´ï¼Œåœ¨éå†çš„è¿‡ç¨‹ä¸­åˆ é™¤é›†åˆå…ƒç´ ï¼Œç»“æœæ˜¯ä¸å¯é¢„æœŸçš„ï¼Œæœ‰æ—¶å€™æ²¡é—®é¢˜ï¼ˆåˆ é™¤å…ƒç´  c æˆ– dï¼‰ï¼Œæœ‰æ—¶å€™å°±æœ‰é—®é¢˜ï¼ˆåˆ é™¤å…ƒç´  a æˆ– bï¼‰ï¼Œè¿™ä¸ªè¦è§†æƒ…å†µè€Œå®šï¼ˆåˆ°åº•åˆ é™¤çš„æ˜¯å“ªä¸ªä½ç½®çš„å…ƒç´ ï¼‰ï¼Œå°±æ˜¯è¿™ä¸ªæ„æ€ã€‚</li><li>åœ¨éå†çš„è¿‡ç¨‹ä¸­åˆ é™¤é›†åˆå…ƒç´ ï¼Œæœ‰å¯èƒ½ä¼šå¯¼è‡´æŸä¸ªå…ƒç´ éå†ä¸åˆ°ï¼Œé‚£åœ¨éå†çš„è¿‡ç¨‹ä¸­æ·»åŠ é›†åˆå…ƒç´ ï¼Œä¼šå‘ç”Ÿä»€ä¹ˆæƒ…å†µå‘¢ï¼Ÿè¿˜æ˜¯ç»“åˆåˆšåˆšé‚£ä¸ªä¾‹å­æ¥è®²è§£ï¼Œæˆ‘ä»¬å°†ä¸Šé¢çš„ä»£ç ç¨å¾®æ”¹é€ ä¸€ä¸‹ï¼ŒæŠŠåˆ é™¤å…ƒç´ æ”¹ä¸ºæ·»åŠ å…ƒç´ ã€‚å…·ä½“çš„ä»£ç å¦‚ä¸‹æ‰€ç¤ºï¼š</li></ol><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Demo</span> &#123;<br>  <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span> &#123;<br>    List&lt;String&gt; names = <span class="hljs-keyword">new</span> <span class="hljs-title class_">ArrayList</span>&lt;&gt;();<br>    names.add(<span class="hljs-string">&quot;a&quot;</span>);<br>    names.add(<span class="hljs-string">&quot;b&quot;</span>);<br>    names.add(<span class="hljs-string">&quot;c&quot;</span>);<br>    names.add(<span class="hljs-string">&quot;d&quot;</span>);<br><br>    Iterator&lt;String&gt; iterator = names.iterator();<br>    iterator.next();<br>    names.add(<span class="hljs-number">0</span>, <span class="hljs-string">&quot;x&quot;</span>);<br>  &#125;<br>&#125;<br></code></pre></td></tr></table></figure><ol><li>åœ¨æ‰§è¡Œå®Œç¬¬ 10 è¡Œä»£ç ä¹‹åï¼Œæ•°ç»„ä¸­åŒ…å« aã€bã€cã€d å››ä¸ªå…ƒç´ ï¼Œæ¸¸æ ‡æŒ‡å‘ b è¿™ä¸ªå…ƒç´ ï¼Œå·²ç»è·³è¿‡äº†å…ƒç´  aã€‚åœ¨æ‰§è¡Œå®Œç¬¬ 11 è¡Œä»£ç ä¹‹åï¼Œæˆ‘ä»¬å°† x æ’å…¥åˆ°ä¸‹æ ‡ä¸º 0 çš„ä½ç½®ï¼Œaã€bã€cã€d å››ä¸ªå…ƒç´ ä¾æ¬¡å¾€åç§»åŠ¨ä¸€ä½ã€‚è¿™ä¸ªæ—¶å€™ï¼Œæ¸¸æ ‡åˆé‡æ–°æŒ‡å‘äº†å…ƒç´  aã€‚å…ƒç´  a è¢«æ¸¸æ ‡é‡å¤æŒ‡å‘ä¸¤æ¬¡ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œå…ƒç´  a å­˜åœ¨è¢«é‡å¤éå†çš„æƒ…å†µã€‚</li><li>è·Ÿåˆ é™¤æƒ…å†µç±»ä¼¼ï¼Œå¦‚æœæˆ‘ä»¬åœ¨æ¸¸æ ‡çš„åé¢æ·»åŠ å…ƒç´ ï¼Œå°±ä¸ä¼šå­˜åœ¨ä»»ä½•é—®é¢˜ã€‚æ‰€ä»¥ï¼Œåœ¨éå†çš„åŒæ—¶æ·»åŠ é›†åˆå…ƒç´ ä¹Ÿæ˜¯ä¸€ç§ä¸å¯é¢„æœŸè¡Œä¸ºã€‚</li></ol><h2 id="4ã€å¦‚ä½•åº”å¯¹éå†æ—¶æ”¹å˜é›†åˆå¯¼è‡´çš„æœªå†³è¡Œä¸ºï¼Ÿ"><a href="#4ã€å¦‚ä½•åº”å¯¹éå†æ—¶æ”¹å˜é›†åˆå¯¼è‡´çš„æœªå†³è¡Œä¸ºï¼Ÿ" class="headerlink" title="4ã€å¦‚ä½•åº”å¯¹éå†æ—¶æ”¹å˜é›†åˆå¯¼è‡´çš„æœªå†³è¡Œä¸ºï¼Ÿ"></a>4ã€å¦‚ä½•åº”å¯¹éå†æ—¶æ”¹å˜é›†åˆå¯¼è‡´çš„æœªå†³è¡Œä¸ºï¼Ÿ</h2><ol><li>å½“é€šè¿‡è¿­ä»£å™¨æ¥éå†é›†åˆçš„æ—¶å€™ï¼Œå¢åŠ ã€åˆ é™¤é›†åˆå…ƒç´ ä¼šå¯¼è‡´ä¸å¯é¢„æœŸçš„éå†ç»“æœã€‚å®é™…ä¸Šï¼Œâ€œä¸å¯é¢„æœŸâ€æ¯”ç›´æ¥å‡ºé”™æ›´åŠ å¯æ€•ï¼Œæœ‰çš„æ—¶å€™è¿è¡Œæ­£ç¡®ï¼Œæœ‰çš„æ—¶å€™è¿è¡Œé”™è¯¯ï¼Œä¸€äº›éšè—å¾ˆæ·±ã€å¾ˆéš¾ debug çš„ bug å°±æ˜¯è¿™ä¹ˆäº§ç”Ÿçš„ã€‚é‚£å¦‚ä½•æ‰èƒ½é¿å…å‡ºç°è¿™ç§ä¸å¯é¢„æœŸçš„è¿è¡Œç»“æœå‘¢ï¼Ÿ</li><li>æœ‰ä¸¤ç§æ¯”è¾ƒå¹²è„†åˆ©ç´¢çš„è§£å†³æ–¹æ¡ˆï¼šä¸€ç§æ˜¯éå†çš„æ—¶å€™ä¸å…è®¸å¢åˆ å…ƒç´ ï¼Œå¦ä¸€ç§æ˜¯å¢åˆ å…ƒç´ ä¹‹åè®©éå†æŠ¥é”™ã€‚</li><li>å®é™…ä¸Šï¼Œç¬¬ä¸€ç§è§£å†³æ–¹æ¡ˆæ¯”è¾ƒéš¾å®ç°ï¼Œæˆ‘ä»¬è¦ç¡®å®šéå†å¼€å§‹å’Œç»“æŸçš„æ—¶é—´ç‚¹ã€‚éå†å¼€å§‹çš„æ—¶é—´èŠ‚ç‚¹æˆ‘ä»¬å¾ˆå®¹æ˜“è·å¾—ã€‚æˆ‘ä»¬å¯ä»¥æŠŠåˆ›å»ºè¿­ä»£å™¨çš„æ—¶é—´ç‚¹ä½œä¸ºéå†å¼€å§‹çš„æ—¶é—´ç‚¹ã€‚ä½†æ˜¯ï¼Œéå†ç»“æŸçš„æ—¶é—´ç‚¹è¯¥å¦‚ä½•æ¥ç¡®å®šå‘¢ï¼Ÿ</li><li>åœ¨å®é™…çš„è½¯ä»¶å¼€å‘ä¸­ï¼Œæ¯æ¬¡ä½¿ç”¨è¿­ä»£å™¨æ¥éå†å…ƒç´ ï¼Œå¹¶ä¸ä¸€å®šéè¦æŠŠæ‰€æœ‰å…ƒç´ éƒ½éå†ä¸€éã€‚</li><li>æˆ‘ä»¬å¯ä»¥åœ¨è¿­ä»£å™¨ç±»ä¸­å®šä¹‰ä¸€ä¸ªæ–°çš„æ¥å£ finishIteration()ï¼Œä¸»åŠ¨å‘ŠçŸ¥å®¹å™¨è¿­ä»£å™¨ä½¿ç”¨å®Œäº†ï¼Œä½ å¯ä»¥å¢åˆ å…ƒç´ äº†ï¼Œå¯è¡Œå—ï¼Ÿä½†æ˜¯ï¼Œè¿™å°±è¦æ±‚ç¨‹åºå‘˜åœ¨ä½¿ç”¨å®Œè¿­ä»£å™¨ä¹‹åè¦ä¸»åŠ¨è°ƒç”¨è¿™ä¸ªå‡½æ•°ï¼Œä¹Ÿå¢åŠ äº†å¼€å‘æˆæœ¬ï¼Œè¿˜å¾ˆå®¹æ˜“æ¼æ‰ã€‚</li></ol><ol><li>å®é™…ä¸Šï¼Œç¬¬äºŒç§è§£å†³æ–¹æ³•æ›´åŠ åˆç†ã€‚Java è¯­è¨€å°±æ˜¯é‡‡ç”¨çš„è¿™ç§è§£å†³æ–¹æ¡ˆï¼Œå¢åˆ å…ƒç´ ä¹‹åï¼Œè®©éå†æŠ¥é”™ã€‚</li><li>æ€ä¹ˆç¡®å®šåœ¨éå†æ—¶å€™ï¼Œé›†åˆæœ‰æ²¡æœ‰å¢åˆ å…ƒç´ å‘¢ï¼Ÿæˆ‘ä»¬åœ¨ ArrayList ä¸­å®šä¹‰ä¸€ä¸ªæˆå‘˜å˜é‡ modCountï¼Œè®°å½•é›†åˆè¢«ä¿®æ”¹çš„æ¬¡æ•°ï¼Œé›†åˆæ¯è°ƒç”¨ä¸€æ¬¡å¢åŠ æˆ–åˆ é™¤å…ƒç´ çš„å‡½æ•°ï¼Œå°±ä¼šç»™ modCount åŠ  1ã€‚å½“é€šè¿‡è°ƒç”¨é›†åˆä¸Šçš„ iterator() å‡½æ•°æ¥åˆ›å»ºè¿­ä»£å™¨çš„æ—¶å€™ï¼Œæˆ‘ä»¬æŠŠ modCount å€¼ä¼ é€’ç»™è¿­ä»£å™¨çš„ expectedModCount æˆå‘˜å˜é‡ï¼Œä¹‹åæ¯æ¬¡è°ƒç”¨è¿­ä»£å™¨ä¸Šçš„ hasNext()ã€next()ã€currentItem() å‡½æ•°ï¼Œæˆ‘ä»¬éƒ½ä¼šæ£€æŸ¥é›†åˆä¸Šçš„ modCount æ˜¯å¦ç­‰äº expectedModCountï¼Œä¹Ÿå°±æ˜¯çœ‹ï¼Œåœ¨åˆ›å»ºå®Œè¿­ä»£å™¨ä¹‹åï¼ŒmodCount æ˜¯å¦æ”¹å˜è¿‡ã€‚</li><li>å¦‚æœä¸¤ä¸ªå€¼ä¸ç›¸åŒï¼Œé‚£å°±è¯´æ˜é›†åˆå­˜å‚¨çš„å…ƒç´ å·²ç»æ”¹å˜äº†ï¼Œè¦ä¹ˆå¢åŠ äº†å…ƒç´ ï¼Œè¦ä¹ˆåˆ é™¤äº†å…ƒç´ ï¼Œä¹‹å‰åˆ›å»ºçš„è¿­ä»£å™¨å·²ç»ä¸èƒ½æ­£ç¡®è¿è¡Œäº†ï¼Œå†ç»§ç»­ä½¿ç”¨å°±ä¼šäº§ç”Ÿä¸å¯é¢„æœŸçš„ç»“æœï¼Œæ‰€ä»¥æˆ‘ä»¬é€‰æ‹© fail-fast è§£å†³æ–¹å¼ï¼ŒæŠ›å‡ºè¿è¡Œæ—¶å¼‚å¸¸ï¼Œç»“æŸæ‰ç¨‹åºï¼Œè®©ç¨‹åºå‘˜å°½å¿«ä¿®å¤è¿™ä¸ªå› ä¸ºä¸æ­£ç¡®ä½¿ç”¨è¿­ä»£å™¨è€Œäº§ç”Ÿçš„ bugã€‚</li></ol><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">ArrayIterator</span> <span class="hljs-keyword">implements</span> <span class="hljs-title class_">Iterator</span> &#123;<br>  <span class="hljs-keyword">private</span> <span class="hljs-type">int</span> cursor;<br>  <span class="hljs-keyword">private</span> ArrayList arrayList;<br>  <span class="hljs-keyword">private</span> <span class="hljs-type">int</span> expectedModCount;<br><br>  <span class="hljs-keyword">public</span> <span class="hljs-title function_">ArrayIterator</span><span class="hljs-params">(ArrayList arrayList)</span> &#123;<br>    <span class="hljs-built_in">this</span>.cursor = <span class="hljs-number">0</span>;<br>    <span class="hljs-built_in">this</span>.arrayList = arrayList;<br>    <span class="hljs-built_in">this</span>.expectedModCount = arrayList.modCount;<br>  &#125;<br><br>  <span class="hljs-meta">@Override</span><br>  <span class="hljs-keyword">public</span> <span class="hljs-type">boolean</span> <span class="hljs-title function_">hasNext</span><span class="hljs-params">()</span> &#123;<br>    checkForComodification();<br>    <span class="hljs-keyword">return</span> cursor &lt; arrayList.size();<br>  &#125;<br><br>  <span class="hljs-meta">@Override</span><br>  <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">next</span><span class="hljs-params">()</span> &#123;<br>    checkForComodification();<br>    cursor++;<br>  &#125;<br><br>  <span class="hljs-meta">@Override</span><br>  <span class="hljs-keyword">public</span> Object <span class="hljs-title function_">currentItem</span><span class="hljs-params">()</span> &#123;<br>    checkForComodification();<br>    <span class="hljs-keyword">return</span> arrayList.get(cursor);<br>  &#125;<br><br>  <span class="hljs-keyword">private</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">checkForComodification</span><span class="hljs-params">()</span> &#123;<br>    <span class="hljs-keyword">if</span> (arrayList.modCount != expectedModCount) <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">ConcurrentModificationException</span>();<br>  &#125;<br>&#125;<br><br><span class="hljs-comment">// ä»£ç ç¤ºä¾‹</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Demo</span> &#123;<br><br>  <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span> &#123;<br>    List&lt;String&gt; names = <span class="hljs-keyword">new</span> <span class="hljs-title class_">ArrayList</span>&lt;&gt;();<br>    names.add(<span class="hljs-string">&quot;a&quot;</span>);<br>    names.add(<span class="hljs-string">&quot;b&quot;</span>);<br>    names.add(<span class="hljs-string">&quot;c&quot;</span>);<br>    names.add(<span class="hljs-string">&quot;d&quot;</span>);<br><br>    Iterator&lt;String&gt; iterator = names.iterator();<br>    iterator.next();<br>    names.remove(<span class="hljs-string">&quot;a&quot;</span>);<br>    iterator.next(); <span class="hljs-comment">// æŠ›å‡ºConcurrentModificationExceptionå¼‚å¸¸</span><br>  &#125;<br>&#125;<br></code></pre></td></tr></table></figure><h2 id="5ã€å¦‚ä½•åœ¨éå†çš„åŒæ—¶å®‰å…¨çš„åˆ é™¤é›†åˆå…ƒç´ ï¼Ÿ"><a href="#5ã€å¦‚ä½•åœ¨éå†çš„åŒæ—¶å®‰å…¨çš„åˆ é™¤é›†åˆå…ƒç´ ï¼Ÿ" class="headerlink" title="5ã€å¦‚ä½•åœ¨éå†çš„åŒæ—¶å®‰å…¨çš„åˆ é™¤é›†åˆå…ƒç´ ï¼Ÿ"></a>5ã€å¦‚ä½•åœ¨éå†çš„åŒæ—¶å®‰å…¨çš„åˆ é™¤é›†åˆå…ƒç´ ï¼Ÿ</h2><ol><li>åƒ Java è¯­è¨€ï¼Œè¿­ä»£å™¨ç±»ä¸­é™¤äº†å‰é¢æåˆ°çš„å‡ ä¸ªæœ€åŸºæœ¬çš„æ–¹æ³•ä¹‹å¤–ï¼Œè¿˜å®šä¹‰äº†ä¸€ä¸ª remove() æ–¹æ³•ï¼Œèƒ½å¤Ÿåœ¨éå†é›†åˆçš„åŒæ—¶ï¼Œå®‰å…¨åœ°åˆ é™¤é›†åˆä¸­çš„å…ƒç´ ã€‚ä¸è¿‡ï¼Œéœ€è¦è¯´æ˜çš„æ˜¯ï¼Œå®ƒå¹¶æ²¡æœ‰æä¾›æ·»åŠ å…ƒç´ çš„æ–¹æ³•ã€‚æ¯•ç«Ÿè¿­ä»£å™¨çš„ä¸»è¦ä½œç”¨æ˜¯éå†ï¼Œæ·»åŠ å…ƒç´ æ”¾åˆ°è¿­ä»£å™¨é‡Œæœ¬èº«å°±ä¸åˆé€‚ã€‚</li><li>Java è¿­ä»£å™¨ä¸­æä¾›çš„ remove() æ–¹æ³•è¿˜æ˜¯æ¯”è¾ƒé¸¡è‚‹çš„ï¼Œä½œç”¨æœ‰é™ã€‚å®ƒåªèƒ½åˆ é™¤æ¸¸æ ‡æŒ‡å‘çš„å‰ä¸€ä¸ªå…ƒç´ ï¼Œè€Œä¸”ä¸€ä¸ª next() å‡½æ•°ä¹‹åï¼Œåªèƒ½è·Ÿç€æœ€å¤šä¸€ä¸ª remove() æ“ä½œï¼Œå¤šæ¬¡è°ƒç”¨ remove() æ“ä½œä¼šæŠ¥é”™ã€‚</li></ol><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Demo</span> &#123;<br>  <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span> &#123;<br>    List&lt;String&gt; names = <span class="hljs-keyword">new</span> <span class="hljs-title class_">ArrayList</span>&lt;&gt;();<br>    names.add(<span class="hljs-string">&quot;a&quot;</span>);<br>    names.add(<span class="hljs-string">&quot;b&quot;</span>);<br>    names.add(<span class="hljs-string">&quot;c&quot;</span>);<br>    names.add(<span class="hljs-string">&quot;d&quot;</span>);<br><br>    Iterator&lt;String&gt; iterator = names.iterator();<br>    iterator.next();<br>    iterator.remove();<br>    iterator.remove(); <span class="hljs-comment">// æŠ¥é”™ï¼ŒæŠ›å‡ºIllegalStateExceptionå¼‚å¸¸</span><br>  &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>ä¸ºä»€ä¹ˆé€šè¿‡è¿­ä»£å™¨å°±èƒ½å®‰å…¨çš„åˆ é™¤é›†åˆä¸­çš„å…ƒç´ å‘¢ï¼Ÿæ¥çœ‹ä¸‹ remove() å‡½æ•°æ˜¯å¦‚ä½•å®ç°çš„ï¼Œä»£ç å¦‚ä¸‹æ‰€ç¤ºã€‚åœ¨ Java å®ç°ä¸­ï¼Œè¿­ä»£å™¨ç±»æ˜¯å®¹å™¨ç±»çš„å†…éƒ¨ç±»ï¼Œå¹¶ä¸” next() å‡½æ•°ä¸ä»…å°†æ¸¸æ ‡åç§»ä¸€ä½ï¼Œè¿˜ä¼šè¿”å›å½“å‰çš„å…ƒç´ ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">ArrayList</span>&lt;E&gt; &#123;<br>  <span class="hljs-keyword">transient</span> Object[] elementData;<br>  <span class="hljs-keyword">private</span> <span class="hljs-type">int</span> size;<br><br>  <span class="hljs-keyword">public</span> Iterator&lt;E&gt; <span class="hljs-title function_">iterator</span><span class="hljs-params">()</span> &#123;<br>    <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Itr</span>();<br>  &#125;<br><br>  <span class="hljs-keyword">private</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Itr</span> <span class="hljs-keyword">implements</span> <span class="hljs-title class_">Iterator</span>&lt;E&gt; &#123;<br>    <span class="hljs-type">int</span> cursor; <span class="hljs-comment">// index of next element to return</span><br>    <span class="hljs-type">int</span> <span class="hljs-variable">lastRet</span> <span class="hljs-operator">=</span> -<span class="hljs-number">1</span>; <span class="hljs-comment">// index of last element returned; -1 if no such</span><br>    <span class="hljs-type">int</span> <span class="hljs-variable">expectedModCount</span> <span class="hljs-operator">=</span> modCount;<br><br>    Itr() &#123;&#125;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-type">boolean</span> <span class="hljs-title function_">hasNext</span><span class="hljs-params">()</span> &#123;<br>      <span class="hljs-keyword">return</span> cursor != size;<br>    &#125;<br><br>    <span class="hljs-meta">@SuppressWarnings(&quot;unchecked&quot;)</span><br>    <span class="hljs-keyword">public</span> E <span class="hljs-title function_">next</span><span class="hljs-params">()</span> &#123;<br>      checkForComodification();<br>      <span class="hljs-type">int</span> <span class="hljs-variable">i</span> <span class="hljs-operator">=</span> cursor;<br>      <span class="hljs-keyword">if</span> (i &gt;= size) <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">NoSuchElementException</span>();<br>      Object[] elementData = ArrayList.<span class="hljs-built_in">this</span>.elementData;<br>      <span class="hljs-keyword">if</span> (i &gt;= elementData.length) <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">ConcurrentModificationException</span>();<br>      cursor = i + <span class="hljs-number">1</span>;<br><br>      <span class="hljs-keyword">return</span> (E) elementData[lastRet = i];<br>    &#125;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">remove</span><span class="hljs-params">()</span> &#123;<br>      <span class="hljs-keyword">if</span> (lastRet &lt; <span class="hljs-number">0</span>) <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">IllegalStateException</span>();<br>      checkForComodification();<br><br>      <span class="hljs-keyword">try</span> &#123;<br>        ArrayList.<span class="hljs-built_in">this</span>.remove(lastRet);<br>        cursor = lastRet;<br>        lastRet = -<span class="hljs-number">1</span>;<br>        expectedModCount = modCount;<br>      &#125; <span class="hljs-keyword">catch</span> (IndexOutOfBoundsException ex) &#123;<br>        <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">ConcurrentModificationException</span>();<br>      &#125;<br>    &#125;<br>  &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>åœ¨ä¸Šé¢çš„ä»£ç å®ç°ä¸­ï¼Œè¿­ä»£å™¨ç±»æ–°å¢äº†ä¸€ä¸ª lastRet æˆå‘˜å˜é‡ï¼Œç”¨æ¥è®°å½•æ¸¸æ ‡æŒ‡å‘çš„å‰ä¸€ä¸ªå…ƒç´ ã€‚é€šè¿‡è¿­ä»£å™¨å»åˆ é™¤è¿™ä¸ªå…ƒç´ çš„æ—¶å€™ï¼Œæˆ‘ä»¬å¯ä»¥æ›´æ–°è¿­ä»£å™¨ä¸­çš„æ¸¸æ ‡å’Œ lastRet å€¼ï¼Œæ¥ä¿è¯ä¸ä¼šå› ä¸ºåˆ é™¤å…ƒç´ è€Œå¯¼è‡´æŸä¸ªå…ƒç´ éå†ä¸åˆ°ã€‚å¦‚æœé€šè¿‡å®¹å™¨æ¥åˆ é™¤å…ƒç´ ï¼Œå¹¶ä¸”å¸Œæœ›æ›´æ–°è¿­ä»£å™¨ä¸­çš„æ¸¸æ ‡å€¼æ¥ä¿è¯éå†ä¸å‡ºé”™ï¼Œæˆ‘ä»¬å°±è¦ç»´æŠ¤è¿™ä¸ªå®¹å™¨éƒ½åˆ›å»ºäº†å“ªäº›è¿­ä»£å™¨ï¼Œæ¯ä¸ªè¿­ä»£å™¨æ˜¯å¦è¿˜åœ¨ä½¿ç”¨ç­‰ä¿¡æ¯ï¼Œä»£ç å®ç°å°±å˜å¾—æ¯”è¾ƒå¤æ‚äº†ã€‚</p>]]></content>
    
    
    <categories>
      
      <category>è®¾è®¡æ¨¡å¼</category>
      
    </categories>
    
    
    <tags>
      
      <tag>è®¾è®¡æ¨¡å¼</tag>
      
      <tag>çŠ¶æ€</tag>
      
      <tag>è¿­ä»£å™¨</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>07-è¡Œä¸ºå‹-ç­–ç•¥-èŒè´£é“¾</title>
    <link href="/2022/10/11/07-xing-wei-xing-ce-lue-zhi-ze-lian/"/>
    <url>/2022/10/11/07-xing-wei-xing-ce-lue-zhi-ze-lian/</url>
    
    <content type="html"><![CDATA[<h1 id="ä¸€ã€ç­–ç•¥æ¨¡å¼ã€å¸¸ç”¨ã€‘"><a href="#ä¸€ã€ç­–ç•¥æ¨¡å¼ã€å¸¸ç”¨ã€‘" class="headerlink" title="ä¸€ã€ç­–ç•¥æ¨¡å¼ã€å¸¸ç”¨ã€‘"></a>ä¸€ã€ç­–ç•¥æ¨¡å¼ã€å¸¸ç”¨ã€‘</h1><h2 id="1ã€Demoæ¡ˆä¾‹-é¸­å­é—®é¢˜"><a href="#1ã€Demoæ¡ˆä¾‹-é¸­å­é—®é¢˜" class="headerlink" title="1ã€Demoæ¡ˆä¾‹-é¸­å­é—®é¢˜"></a>1ã€Demoæ¡ˆä¾‹-é¸­å­é—®é¢˜</h2><p>ç¼–å†™é¸­å­é¡¹ç›®ï¼Œå…·ä½“è¦æ±‚å¦‚ä¸‹: </p><ol><li>æœ‰å„ç§é¸­å­(æ¯”å¦‚ é‡é¸­ã€åŒ—äº¬é¸­ã€æ°´é¸­ç­‰ï¼Œ é¸­å­æœ‰å„ç§è¡Œä¸ºï¼Œæ¯”å¦‚ å«ã€é£è¡Œç­‰) </li><li>æ˜¾ç¤ºé¸­å­çš„ä¿¡æ¯</li></ol><h3 id="1ã€ä¼ ç»Ÿæ–¹å¼è§£å†³é¸­å­é—®é¢˜ä»£ç å®ç°"><a href="#1ã€ä¼ ç»Ÿæ–¹å¼è§£å†³é¸­å­é—®é¢˜ä»£ç å®ç°" class="headerlink" title="1ã€ä¼ ç»Ÿæ–¹å¼è§£å†³é¸­å­é—®é¢˜ä»£ç å®ç°"></a>1ã€ä¼ ç»Ÿæ–¹å¼è§£å†³é¸­å­é—®é¢˜ä»£ç å®ç°</h3><h4 id="1ã€Duck"><a href="#1ã€Duck" class="headerlink" title="1ã€Duck"></a>1ã€Duck</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">abstract</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Duck</span> &#123;<br><br>   <span class="hljs-keyword">public</span> <span class="hljs-title function_">Duck</span><span class="hljs-params">()</span> &#123;<br>   <br>   &#125;<br><br>   <span class="hljs-keyword">public</span> <span class="hljs-keyword">abstract</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">display</span><span class="hljs-params">()</span>;<span class="hljs-comment">//æ˜¾ç¤ºé¸­å­ä¿¡æ¯</span><br>   <br>   <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">quack</span><span class="hljs-params">()</span> &#123;<br>      System.out.println(<span class="hljs-string">&quot;é¸­å­å˜å˜å«~~&quot;</span>);<br>   &#125;<br>   <br>   <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">swim</span><span class="hljs-params">()</span> &#123;<br>      System.out.println(<span class="hljs-string">&quot;é¸­å­ä¼šæ¸¸æ³³~~&quot;</span>);<br>   &#125;<br>   <br>   <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">fly</span><span class="hljs-params">()</span> &#123;<br>      System.out.println(<span class="hljs-string">&quot;é¸­å­ä¼šé£ç¿”~~~&quot;</span>);<br>   &#125;<br>   <br>&#125;<br></code></pre></td></tr></table></figure><h4 id="2ã€PekingDuck"><a href="#2ã€PekingDuck" class="headerlink" title="2ã€PekingDuck"></a>2ã€PekingDuck</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">PekingDuck</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_">Duck</span> &#123;<br><br>   <span class="hljs-meta">@Override</span><br>   <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">display</span><span class="hljs-params">()</span> &#123;<br>      <span class="hljs-comment">// TODO Auto-generated method stub</span><br>      System.out.println(<span class="hljs-string">&quot;~~åŒ—äº¬é¸­~~~&quot;</span>);<br>   &#125;<br>   <br>   <span class="hljs-comment">//å› ä¸ºåŒ—äº¬é¸­ä¸èƒ½é£ç¿”ï¼Œå› æ­¤éœ€è¦é‡å†™fly</span><br>   <span class="hljs-meta">@Override</span><br>   <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">fly</span><span class="hljs-params">()</span> &#123;<br>      <span class="hljs-comment">// TODO Auto-generated method stub</span><br>      System.out.println(<span class="hljs-string">&quot;åŒ—äº¬é¸­ä¸èƒ½é£ç¿”&quot;</span>);<br>   &#125;<br><br>&#125;<br></code></pre></td></tr></table></figure><h4 id="3ã€ToyDuck"><a href="#3ã€ToyDuck" class="headerlink" title="3ã€ToyDuck"></a>3ã€ToyDuck</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">ToyDuck</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_">Duck</span>&#123;<br><br>   <span class="hljs-meta">@Override</span><br>   <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">display</span><span class="hljs-params">()</span> &#123;<br>      <span class="hljs-comment">// TODO Auto-generated method stub</span><br>      System.out.println(<span class="hljs-string">&quot;ç©å…·é¸­&quot;</span>);<br>   &#125;<br><br>   <span class="hljs-comment">//éœ€è¦é‡å†™çˆ¶ç±»çš„æ‰€æœ‰æ–¹æ³•</span><br>   <br>   <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">quack</span><span class="hljs-params">()</span> &#123;<br>      System.out.println(<span class="hljs-string">&quot;ç©å…·é¸­ä¸èƒ½å«~~&quot;</span>);<br>   &#125;<br>   <br>   <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">swim</span><span class="hljs-params">()</span> &#123;<br>      System.out.println(<span class="hljs-string">&quot;ç©å…·é¸­ä¸ä¼šæ¸¸æ³³~~&quot;</span>);<br>   &#125;<br>   <br>   <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">fly</span><span class="hljs-params">()</span> &#123;<br>      System.out.println(<span class="hljs-string">&quot;ç©å…·é¸­ä¸ä¼šé£ç¿”~~~&quot;</span>);<br>   &#125;<br>&#125;<br></code></pre></td></tr></table></figure><h4 id="4ã€WildDuck"><a href="#4ã€WildDuck" class="headerlink" title="4ã€WildDuck"></a>4ã€WildDuck</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">WildDuck</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_">Duck</span> &#123;<br><br>   <span class="hljs-meta">@Override</span><br>   <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">display</span><span class="hljs-params">()</span> &#123;<br>      <span class="hljs-comment">// TODO Auto-generated method stub</span><br>      System.out.println(<span class="hljs-string">&quot; è¿™æ˜¯é‡é¸­ &quot;</span>);<br>   &#125;<br><br>&#125;<br></code></pre></td></tr></table></figure><h4 id="5ã€é—®é¢˜"><a href="#5ã€é—®é¢˜" class="headerlink" title="5ã€é—®é¢˜"></a>5ã€é—®é¢˜</h4><p>é‚£ä¹ˆé—®é¢˜æ¥äº†</p><ol><li>å…¶å®ƒé¸­å­ï¼Œéƒ½ç»§æ‰¿äº†Duckç±»ï¼Œæ‰€ä»¥flyè®©æ‰€æœ‰å­ç±»éƒ½ä¼šé£äº†ï¼Œè¿™æ˜¯ä¸æ­£ç¡®çš„ </li><li>ä¸Šé¢è¯´çš„1 çš„é—®é¢˜ï¼Œå…¶å®æ˜¯ç»§æ‰¿å¸¦æ¥çš„é—®é¢˜ï¼šå¯¹ç±»çš„å±€éƒ¨æ”¹åŠ¨ï¼Œå°¤å…¶è¶…ç±»çš„å±€éƒ¨æ”¹ åŠ¨ï¼Œä¼šå½±å“å…¶ä»–éƒ¨åˆ†ã€‚ä¼šæœ‰æº¢å‡ºæ•ˆåº”</li><li>ä¸ºäº†æ”¹è¿›1é—®é¢˜ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡è¦†ç›–fly æ–¹æ³•æ¥è§£å†³ =&gt; è¦†ç›–è§£å†³</li><li>é—®é¢˜åˆæ¥äº†ï¼Œå¦‚æœæˆ‘ä»¬æœ‰ä¸€ä¸ªç©å…·é¸­å­ToyDuck, è¿™æ ·å°±éœ€è¦ToyDuckå»è¦†ç›–Duck çš„æ‰€æœ‰å®ç°çš„æ–¹æ³•</li></ol><p>è§£å†³æ€è·¯ ==ç­–ç•¥æ¨¡å¼== </p><h3 id="2ã€ç­–ç•¥æ¨¡å¼è§£å†³é¸­å­é—®é¢˜ä»£ç å®ç°"><a href="#2ã€ç­–ç•¥æ¨¡å¼è§£å†³é¸­å­é—®é¢˜ä»£ç å®ç°" class="headerlink" title="2ã€ç­–ç•¥æ¨¡å¼è§£å†³é¸­å­é—®é¢˜ä»£ç å®ç°"></a>2ã€ç­–ç•¥æ¨¡å¼è§£å†³é¸­å­é—®é¢˜ä»£ç å®ç°</h3><p>æ€è·¯åˆ†æï¼š</p><p>åˆ†åˆ«å°è£…è¡Œä¸ºæ¥å£ï¼Œå®ç°ç®—æ³•æ—ï¼Œè¶…ç±»é‡Œæ”¾è¡Œä¸ºæ¥å£å¯¹è±¡ï¼Œåœ¨å­ç±»é‡Œå…·ä½“ è®¾å®šè¡Œä¸ºå¯¹è±¡ã€‚åŸåˆ™å°±æ˜¯ï¼šåˆ†ç¦»å˜åŒ–éƒ¨åˆ†ï¼Œå°è£…æ¥å£ï¼ŒåŸºäºæ¥å£ç¼–ç¨‹å„ç§åŠŸèƒ½ã€‚æ­¤æ¨¡ å¼è®©è¡Œä¸ºçš„å˜åŒ–ç‹¬ç«‹äºç®—æ³•çš„ä½¿ç”¨è€…</p><h4 id="1ã€FlyBehavior"><a href="#1ã€FlyBehavior" class="headerlink" title="1ã€FlyBehavior"></a>1ã€FlyBehavior</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">interface</span> <span class="hljs-title class_">FlyBehavior</span> &#123;<br>   <br>   <span class="hljs-keyword">void</span> <span class="hljs-title function_">fly</span><span class="hljs-params">()</span>; <span class="hljs-comment">// å­ç±»å…·ä½“å®ç°</span><br>&#125;<br></code></pre></td></tr></table></figure><h4 id="2ã€GoodFlyBehavior"><a href="#2ã€GoodFlyBehavior" class="headerlink" title="2ã€GoodFlyBehavior"></a>2ã€GoodFlyBehavior</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">GoodFlyBehavior</span> <span class="hljs-keyword">implements</span> <span class="hljs-title class_">FlyBehavior</span> &#123;<br><br>   <span class="hljs-meta">@Override</span><br>   <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">fly</span><span class="hljs-params">()</span> &#123;<br>      <span class="hljs-comment">// TODO Auto-generated method stub</span><br>      System.out.println(<span class="hljs-string">&quot; é£ç¿”æŠ€æœ¯é«˜è¶… ~~~&quot;</span>);<br>   &#125;<br><br>&#125;<br></code></pre></td></tr></table></figure><h4 id="3ã€BadFlyBehavior"><a href="#3ã€BadFlyBehavior" class="headerlink" title="3ã€BadFlyBehavior"></a>3ã€BadFlyBehavior</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">BadFlyBehavior</span> <span class="hljs-keyword">implements</span> <span class="hljs-title class_">FlyBehavior</span> &#123;<br><br>   <span class="hljs-meta">@Override</span><br>   <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">fly</span><span class="hljs-params">()</span> &#123;<br>      <span class="hljs-comment">// TODO Auto-generated method stub</span><br>      System.out.println(<span class="hljs-string">&quot; é£ç¿”æŠ€æœ¯ä¸€èˆ¬ &quot;</span>);<br>   &#125;<br><br>&#125;<br></code></pre></td></tr></table></figure><h4 id="4ã€NoFlyBehavior"><a href="#4ã€NoFlyBehavior" class="headerlink" title="4ã€NoFlyBehavior"></a>4ã€NoFlyBehavior</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">NoFlyBehavior</span> <span class="hljs-keyword">implements</span> <span class="hljs-title class_">FlyBehavior</span>&#123;<br><br>   <span class="hljs-meta">@Override</span><br>   <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">fly</span><span class="hljs-params">()</span> &#123;<br>      <span class="hljs-comment">// TODO Auto-generated method stub</span><br>      System.out.println(<span class="hljs-string">&quot; ä¸ä¼šé£ç¿”  &quot;</span>);<br>   &#125;<br><br>&#125;<br></code></pre></td></tr></table></figure><h4 id="5ã€QuackBehavior"><a href="#5ã€QuackBehavior" class="headerlink" title="5ã€QuackBehavior"></a>5ã€QuackBehavior</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">interface</span> <span class="hljs-title class_">QuackBehavior</span> &#123;<br>   <span class="hljs-keyword">void</span> <span class="hljs-title function_">quack</span><span class="hljs-params">()</span>;<span class="hljs-comment">//å­ç±»å®ç°</span><br>&#125;<br></code></pre></td></tr></table></figure><h4 id="6ã€Duck"><a href="#6ã€Duck" class="headerlink" title="6ã€Duck"></a>6ã€Duck</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">abstract</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Duck</span> &#123;<br><br>   <span class="hljs-comment">//å±æ€§, ç­–ç•¥æ¥å£</span><br>   FlyBehavior flyBehavior;<br>   <span class="hljs-comment">//å…¶å®ƒå±æ€§&lt;-&gt;ç­–ç•¥æ¥å£</span><br>   QuackBehavior quackBehavior;<br>   <br>   <span class="hljs-keyword">public</span> <span class="hljs-title function_">Duck</span><span class="hljs-params">()</span> &#123;<br>   <br>   &#125;<br><br>   <span class="hljs-keyword">public</span> <span class="hljs-keyword">abstract</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">display</span><span class="hljs-params">()</span>;<span class="hljs-comment">//æ˜¾ç¤ºé¸­å­ä¿¡æ¯</span><br>   <br>   <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">quack</span><span class="hljs-params">()</span> &#123;<br>      System.out.println(<span class="hljs-string">&quot;é¸­å­å˜å˜å«~~&quot;</span>);<br>   &#125;<br>   <br>   <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">swim</span><span class="hljs-params">()</span> &#123;<br>      System.out.println(<span class="hljs-string">&quot;é¸­å­ä¼šæ¸¸æ³³~~&quot;</span>);<br>   &#125;<br>   <br>   <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">fly</span><span class="hljs-params">()</span> &#123;<br>      <span class="hljs-comment">//æ”¹è¿›</span><br>      <span class="hljs-keyword">if</span>(flyBehavior != <span class="hljs-literal">null</span>) &#123;<br>         flyBehavior.fly();<br>      &#125;<br>   &#125;<br><br>   <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">setFlyBehavior</span><span class="hljs-params">(FlyBehavior flyBehavior)</span> &#123;<br>      <span class="hljs-built_in">this</span>.flyBehavior = flyBehavior;<br>   &#125;<br>   <br>   <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">setQuackBehavior</span><span class="hljs-params">(QuackBehavior quackBehavior)</span> &#123;<br>      <span class="hljs-built_in">this</span>.quackBehavior = quackBehavior;<br>   &#125;<br>   <br>&#125;<br></code></pre></td></tr></table></figure><h4 id="7ã€PekingDuck"><a href="#7ã€PekingDuck" class="headerlink" title="7ã€PekingDuck"></a>7ã€PekingDuck</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">PekingDuck</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_">Duck</span> &#123;<br><br>   <span class="hljs-comment">//å‡å¦‚åŒ—äº¬é¸­å¯ä»¥é£ç¿”ï¼Œä½†æ˜¯é£ç¿”æŠ€æœ¯ä¸€èˆ¬</span><br>   <span class="hljs-keyword">public</span> <span class="hljs-title function_">PekingDuck</span><span class="hljs-params">()</span> &#123;<br>      <span class="hljs-comment">// TODO Auto-generated constructor stub</span><br>      flyBehavior = <span class="hljs-keyword">new</span> <span class="hljs-title class_">BadFlyBehavior</span>();<br>      <br>   &#125;<br>   <br>   <span class="hljs-meta">@Override</span><br>   <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">display</span><span class="hljs-params">()</span> &#123;<br>      <span class="hljs-comment">// TODO Auto-generated method stub</span><br>      System.out.println(<span class="hljs-string">&quot;~~åŒ—äº¬é¸­~~~&quot;</span>);<br>   &#125;<br>   <br>&#125;<br></code></pre></td></tr></table></figure><h4 id="8ã€ToyDuck"><a href="#8ã€ToyDuck" class="headerlink" title="8ã€ToyDuck"></a>8ã€ToyDuck</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">ToyDuck</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_">Duck</span>&#123;<br><br>   <span class="hljs-keyword">public</span> <span class="hljs-title function_">ToyDuck</span><span class="hljs-params">()</span> &#123;<br>      <span class="hljs-comment">// TODO Auto-generated constructor stub</span><br>      flyBehavior = <span class="hljs-keyword">new</span> <span class="hljs-title class_">NoFlyBehavior</span>();<br>   &#125;<br>   <br>   <span class="hljs-meta">@Override</span><br>   <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">display</span><span class="hljs-params">()</span> &#123;<br>      <span class="hljs-comment">// TODO Auto-generated method stub</span><br>      System.out.println(<span class="hljs-string">&quot;ç©å…·é¸­&quot;</span>);<br>   &#125;<br><br>   <span class="hljs-comment">//éœ€è¦é‡å†™çˆ¶ç±»çš„æ‰€æœ‰æ–¹æ³•</span><br>   <br>   <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">quack</span><span class="hljs-params">()</span> &#123;<br>      System.out.println(<span class="hljs-string">&quot;ç©å…·é¸­ä¸èƒ½å«~~&quot;</span>);<br>   &#125;<br>   <br>   <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">swim</span><span class="hljs-params">()</span> &#123;<br>      System.out.println(<span class="hljs-string">&quot;ç©å…·é¸­ä¸ä¼šæ¸¸æ³³~~&quot;</span>);<br>   &#125;<br>   <br>&#125;<br></code></pre></td></tr></table></figure><h4 id="9ã€WildDuck"><a href="#9ã€WildDuck" class="headerlink" title="9ã€WildDuck"></a>9ã€WildDuck</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">WildDuck</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_">Duck</span> &#123;<br>   <br>   <span class="hljs-comment">//æ„é€ å™¨ï¼Œä¼ å…¥FlyBehavor çš„å¯¹è±¡</span><br>   <span class="hljs-keyword">public</span>  <span class="hljs-title function_">WildDuck</span><span class="hljs-params">()</span> &#123;<br>      <span class="hljs-comment">// TODO Auto-generated constructor stub</span><br>      flyBehavior = <span class="hljs-keyword">new</span> <span class="hljs-title class_">GoodFlyBehavior</span>();<br>   &#125;<br>   <br>   <span class="hljs-meta">@Override</span><br>   <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">display</span><span class="hljs-params">()</span> &#123;<br>      <span class="hljs-comment">// TODO Auto-generated method stub</span><br>      System.out.println(<span class="hljs-string">&quot; è¿™æ˜¯é‡é¸­ &quot;</span>);<br>   &#125;<br><br>&#125;<br></code></pre></td></tr></table></figure><h4 id="10ã€Client"><a href="#10ã€Client" class="headerlink" title="10ã€Client"></a>10ã€Client</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Client</span> &#123;<br><br>   <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span> &#123;<br>      <span class="hljs-comment">// TODO Auto-generated method stub</span><br>      <span class="hljs-type">WildDuck</span> <span class="hljs-variable">wildDuck</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">WildDuck</span>();<br>      wildDuck.fly();<span class="hljs-comment">//</span><br>      <br>      <span class="hljs-type">ToyDuck</span> <span class="hljs-variable">toyDuck</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">ToyDuck</span>();<br>      toyDuck.fly();<br>      <br>      <span class="hljs-type">PekingDuck</span> <span class="hljs-variable">pekingDuck</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">PekingDuck</span>();<br>      pekingDuck.fly();<br>      <br>      <span class="hljs-comment">//åŠ¨æ€æ”¹å˜æŸä¸ªå¯¹è±¡çš„è¡Œä¸º, åŒ—äº¬é¸­ ä¸èƒ½é£</span><br>      pekingDuck.setFlyBehavior(<span class="hljs-keyword">new</span> <span class="hljs-title class_">NoFlyBehavior</span>());<br>      System.out.println(<span class="hljs-string">&quot;åŒ—äº¬é¸­çš„å®é™…é£ç¿”èƒ½åŠ›&quot;</span>);<br>      pekingDuck.fly();<br>   &#125;<br><br>&#125;<br></code></pre></td></tr></table></figure><p>ç»“æœå¦‚ä¸‹ï¼š</p><p><img src="/2022/10/11/07-xing-wei-xing-ce-lue-zhi-ze-lian/image-20221012163252938.png"></p><h2 id="2ã€ç­–ç•¥æ¨¡å¼å·¥ä½œåŸç†"><a href="#2ã€ç­–ç•¥æ¨¡å¼å·¥ä½œåŸç†" class="headerlink" title="2ã€ç­–ç•¥æ¨¡å¼å·¥ä½œåŸç†"></a>2ã€ç­–ç•¥æ¨¡å¼å·¥ä½œåŸç†</h2><ol><li>ç­–ç•¥æ¨¡å¼ï¼ˆStrategy Patternï¼‰ä¸­ï¼Œå®šä¹‰ç®—æ³•æ—ï¼Œåˆ†åˆ«å°è£…èµ·æ¥ï¼Œè®©ä»–ä»¬ä¹‹é—´å¯ä»¥ äº’ç›¸æ›¿æ¢ï¼Œæ­¤æ¨¡å¼è®©ç®—æ³•çš„å˜åŒ–ç‹¬ç«‹äºä½¿ç”¨ç®—æ³•çš„å®¢æˆ· </li><li>è¿™ç®—æ³•ä½“ç°äº†å‡ ä¸ªè®¾è®¡åŸåˆ™ï¼Œç¬¬ä¸€ã€æŠŠå˜åŒ–çš„ä»£ç ä»ä¸å˜çš„ä»£ç ä¸­åˆ†ç¦»å‡ºæ¥ï¼› ç¬¬äºŒã€é’ˆå¯¹æ¥å£ç¼–ç¨‹è€Œä¸æ˜¯å…·ä½“ç±»ï¼ˆå®šä¹‰äº†ç­–ç•¥æ¥å£ï¼‰ï¼›ç¬¬ä¸‰ã€å¤šç”¨ç»„åˆ/èšåˆï¼Œ å°‘ç”¨ç»§æ‰¿ï¼ˆå®¢æˆ·é€šè¿‡ç»„åˆæ–¹å¼ä½¿ç”¨ç­–ç•¥ï¼‰</li></ol><p>ç±»å›¾å¦‚ä¸‹ï¼š</p><p><img src="/2022/10/11/07-xing-wei-xing-ce-lue-zhi-ze-lian/image-20221012162105114.png"></p><p>ä»ä¸Šå›¾å¯ä»¥çœ‹åˆ°ï¼Œå®¢æˆ·context æœ‰æˆå‘˜å˜é‡strategyæˆ–è€…å…¶ä»–çš„ç­–ç•¥æ¥å£ ,è‡³äºéœ€è¦ä½¿ç”¨åˆ°å“ªä¸ªç­–ç•¥ï¼Œæˆ‘ä»¬å¯ä»¥åœ¨æ„é€ å™¨ä¸­æŒ‡å®šã€‚</p><h2 id="3ã€ç­–ç•¥æ¨¡å¼åœ¨JDK-Arrays-åº”ç”¨"><a href="#3ã€ç­–ç•¥æ¨¡å¼åœ¨JDK-Arrays-åº”ç”¨" class="headerlink" title="3ã€ç­–ç•¥æ¨¡å¼åœ¨JDK-Arrays åº”ç”¨"></a>3ã€ç­–ç•¥æ¨¡å¼åœ¨JDK-Arrays åº”ç”¨</h2><p>ä¸¾ä¸ªä¾‹å­</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Strategy</span> &#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span> &#123;<br>        Integer[] data = &#123; <span class="hljs-number">9</span>, <span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">8</span>, <span class="hljs-number">4</span>, <span class="hljs-number">3</span> &#125;;<br><br>        <span class="hljs-comment">// è¯´æ˜</span><br>        <span class="hljs-comment">// 1. å®ç°äº† Comparator æ¥å£ï¼ˆç­–ç•¥æ¥å£ï¼‰ , åŒ¿åç±»å¯¹è±¡ new Comparator&lt;Integer&gt;()&#123;..&#125;</span><br>        <span class="hljs-comment">// 2. å¯¹è±¡ new Comparator&lt;Integer&gt;()&#123;..&#125; å°±æ˜¯å®ç°äº†ç­–ç•¥æ¥å£çš„å¯¹è±¡</span><br>        <span class="hljs-comment">// 3. public int compare(Integer o1, Integer o2)&#123;&#125; æŒ‡å®šå…·ä½“çš„å¤„ç†æ–¹å¼</span><br>        Comparator&lt;Integer&gt; comparator = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Comparator</span>&lt;Integer&gt;() &#123;<br>            <span class="hljs-keyword">public</span> <span class="hljs-type">int</span> <span class="hljs-title function_">compare</span><span class="hljs-params">(Integer o1, Integer o2)</span> &#123;<br>                <span class="hljs-keyword">if</span> (o1 &gt; o2) &#123;<br>                    <span class="hljs-keyword">return</span> -<span class="hljs-number">1</span>;<br>                &#125; <span class="hljs-keyword">else</span> &#123;<br>                    <span class="hljs-keyword">return</span> <span class="hljs-number">1</span>;<br>                &#125;<br>            &#125;;<br>        &#125;;<br><br>        <span class="hljs-comment">// è¯´æ˜</span><br>      <span class="hljs-comment">/*</span><br><span class="hljs-comment">       * public static &lt;T&gt; void sort(T[] a, Comparator&lt;? super T&gt; c) &#123;</span><br><span class="hljs-comment">              if (c == null) &#123;</span><br><span class="hljs-comment">                  sort(a); //é»˜è®¤æ–¹æ³•</span><br><span class="hljs-comment">              &#125; else &#123;</span><br><span class="hljs-comment">                  if (LegacyMergeSort.userRequested)</span><br><span class="hljs-comment">                      legacyMergeSort(a, c); //ä½¿ç”¨ç­–ç•¥å¯¹è±¡c</span><br><span class="hljs-comment">                  else</span><br><span class="hljs-comment">                     // ä½¿ç”¨ç­–ç•¥å¯¹è±¡c</span><br><span class="hljs-comment">                      TimSort.sort(a, 0, a.length, c, null, 0, 0);</span><br><span class="hljs-comment">              &#125;</span><br><span class="hljs-comment">          &#125;</span><br><span class="hljs-comment">       */</span><br>        <span class="hljs-comment">// æ–¹å¼1</span><br>        Arrays.sort(data, comparator);<br><br>        System.out.println(Arrays.toString(data)); <span class="hljs-comment">// ????????</span><br><br><br>        <span class="hljs-comment">//æ–¹å¼2- lambda è¡¨è¾¾å¼</span><br>        Integer[] data2 = &#123; <span class="hljs-number">19</span>, <span class="hljs-number">11</span>, <span class="hljs-number">12</span>, <span class="hljs-number">18</span>, <span class="hljs-number">14</span>, <span class="hljs-number">13</span> &#125;;<br><br>        Arrays.sort(data2, (var1, var2) -&gt; &#123;<br>            <span class="hljs-keyword">if</span>(var1.compareTo(var2) &gt; <span class="hljs-number">0</span>) &#123;<br>                <span class="hljs-keyword">return</span> -<span class="hljs-number">1</span>;<br>            &#125; <span class="hljs-keyword">else</span> &#123;<br>                <span class="hljs-keyword">return</span> <span class="hljs-number">1</span>;<br>            &#125;<br>        &#125;);<br><br>        System.out.println(<span class="hljs-string">&quot;data2=&quot;</span> + Arrays.toString(data2));<br><br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><ol><li>ä¸Šè¿°ç”¨ä¸¤ç§æ–¹å¼å®ç°ç­–ç•¥æ¨¡å¼ï¼Œæ–¹å¼1æ˜¯ä»¥Comparatorä¸ºæ¥å£ï¼Œå®ç°compareæ–¹æ³•æ¥å®Œæˆå…·ä½“å®ç°</li><li>æ–¹å¼2æ˜¯ç›´æ¥åœ¨lambdaå¤„æŒ‡å®šç­–ç•¥</li></ol><h2 id="4ã€æ³¨æ„äº‹é¡¹"><a href="#4ã€æ³¨æ„äº‹é¡¹" class="headerlink" title="4ã€æ³¨æ„äº‹é¡¹"></a>4ã€æ³¨æ„äº‹é¡¹</h2><ol><li>ç­–ç•¥æ¨¡å¼çš„å…³é”®æ˜¯ï¼šåˆ†æé¡¹ç›®ä¸­å˜åŒ–éƒ¨åˆ†ä¸ä¸å˜éƒ¨åˆ† </li><li>ç­–ç•¥æ¨¡å¼çš„æ ¸å¿ƒæ€æƒ³æ˜¯ï¼šå¤šç”¨ç»„åˆ/èšåˆ å°‘ç”¨ç»§æ‰¿ï¼›ç”¨è¡Œä¸ºç±»ç»„åˆï¼Œè€Œä¸æ˜¯è¡Œä¸ºçš„ ç»§æ‰¿ã€‚æ›´æœ‰å¼¹æ€§ </li><li>ä½“ç°äº†â€œå¯¹ä¿®æ”¹å…³é—­ï¼Œå¯¹æ‰©å±•å¼€æ”¾â€åŸåˆ™ï¼Œå®¢æˆ·ç«¯å¢åŠ è¡Œä¸ºä¸ç”¨ä¿®æ”¹åŸæœ‰ä»£ç ï¼Œåª è¦æ·»åŠ ä¸€ç§ç­–ç•¥ï¼ˆæˆ–è€…è¡Œä¸ºï¼‰å³å¯ï¼Œé¿å…äº†ä½¿ç”¨å¤šé‡è½¬ç§»è¯­å¥ï¼ˆif..else if..elseï¼‰ </li><li>æä¾›äº†å¯ä»¥æ›¿æ¢ç»§æ‰¿å…³ç³»çš„åŠæ³•ï¼š ç­–ç•¥æ¨¡å¼å°†ç®—æ³•å°è£…åœ¨ç‹¬ç«‹çš„Strategyç±»ä¸­ä½¿å¾— ä½ å¯ä»¥ç‹¬ç«‹äºå…¶Contextæ”¹å˜å®ƒï¼Œä½¿å®ƒæ˜“äºåˆ‡æ¢ã€æ˜“äºç†è§£ã€æ˜“äºæ‰©å±• </li><li>éœ€è¦æ³¨æ„çš„æ˜¯ï¼šæ¯æ·»åŠ ä¸€ä¸ªç­–ç•¥å°±è¦å¢åŠ ä¸€ä¸ªç±»ï¼Œå½“ç­–ç•¥è¿‡å¤šæ˜¯ä¼šå¯¼è‡´ç±»æ•°ç›®åºå¤§</li></ol><h1 id="äºŒã€èŒè´£é“¾æ¨¡å¼"><a href="#äºŒã€èŒè´£é“¾æ¨¡å¼" class="headerlink" title="äºŒã€èŒè´£é“¾æ¨¡å¼"></a>äºŒã€èŒè´£é“¾æ¨¡å¼</h1><p>æ¨¡æ¿æ¨¡å¼ã€ç­–ç•¥æ¨¡å¼ï¼ŒèŒè´£é“¾æ¨¡å¼ã€‚è¿™ä¸‰ç§æ¨¡å¼å…·æœ‰ç›¸åŒçš„ä½œç”¨ï¼šå¤ç”¨å’Œæ‰©å±•ï¼Œåœ¨å®é™…çš„é¡¹ç›®å¼€å‘ä¸­æ¯”è¾ƒå¸¸ç”¨ï¼Œç‰¹åˆ«æ˜¯æ¡†æ¶å¼€å‘ä¸­ï¼Œæˆ‘ä»¬å¯ä»¥åˆ©ç”¨å®ƒä»¬æ¥æä¾›æ¡†æ¶çš„æ‰©å±•ç‚¹ï¼Œèƒ½å¤Ÿè®©æ¡†æ¶çš„ä½¿ç”¨è€…åœ¨ä¸ä¿®æ”¹æ¡†æ¶æºç çš„æƒ…å†µä¸‹ï¼ŒåŸºäºæ‰©å±•ç‚¹å®šåˆ¶åŒ–æ¡†æ¶çš„åŠŸèƒ½ã€‚</p><h2 id="1ã€Demoæ¡ˆä¾‹-å­¦æ ¡é‡‡è´­"><a href="#1ã€Demoæ¡ˆä¾‹-å­¦æ ¡é‡‡è´­" class="headerlink" title="1ã€Demoæ¡ˆä¾‹-å­¦æ ¡é‡‡è´­"></a>1ã€Demoæ¡ˆä¾‹-å­¦æ ¡é‡‡è´­</h2><blockquote><p>éœ€æ±‚</p></blockquote><p>é‡‡è´­å‘˜é‡‡è´­æ•™å­¦å™¨æ</p><ol><li>å¦‚æœé‡‘é¢å°äºç­‰äº 5000, ç”±æ•™å­¦ä¸»ä»»å®¡æ‰¹ ï¼ˆ0&lt;=x&lt;=5000ï¼‰</li><li>å¦‚æœé‡‘é¢å°äºç­‰äº 10000, ç”±é™¢é•¿å®¡æ‰¹ (5000&lt;x&lt;=10000)</li><li>å¦‚æœé‡‘é¢å°äºç­‰äº 30000, ç”±å‰¯æ ¡é•¿å®¡æ‰¹ (10000&lt;x&lt;=30000)</li><li>å¦‚æœé‡‘é¢è¶…è¿‡ 30000 ä»¥ä¸Šï¼Œæœ‰æ ¡é•¿å®¡æ‰¹ ( 30000&lt;x)</li></ol><h3 id="1ã€ä¼ ç»Ÿæ–¹å¼è§£å†³æ–¹æ¡ˆ"><a href="#1ã€ä¼ ç»Ÿæ–¹å¼è§£å†³æ–¹æ¡ˆ" class="headerlink" title="1ã€ä¼ ç»Ÿæ–¹å¼è§£å†³æ–¹æ¡ˆ"></a>1ã€ä¼ ç»Ÿæ–¹å¼è§£å†³æ–¹æ¡ˆ</h3><ol><li>ä¼ ç»Ÿæ–¹å¼æ˜¯ï¼šæ¥æ”¶åˆ°ä¸€ä¸ªé‡‡è´­è¯·æ±‚åï¼Œæ ¹æ®é‡‡è´­é‡‘é¢æ¥è°ƒç”¨å¯¹åº”çš„ Approver (å®¡æ‰¹äºº)å®Œæˆå®¡æ‰¹ã€‚</li><li>ä¼ ç»Ÿæ–¹å¼çš„é—®é¢˜åˆ†æ : å®¢æˆ·ç«¯è¿™é‡Œä¼šä½¿ç”¨åˆ° åˆ†æ”¯åˆ¤æ–­(æ¯”å¦‚ switch) æ¥å¯¹ä¸åŒçš„é‡‡è´­è¯·æ±‚å¤„ç†ï¼Œ è¿™æ ·å°±å­˜åœ¨å¦‚ä¸‹é—®é¢˜ (1) å¦‚æœå„ä¸ªçº§åˆ«çš„äººå‘˜å®¡æ‰¹é‡‘é¢å‘ç”Ÿå˜åŒ–ï¼Œåœ¨å®¢æˆ·ç«¯çš„ä¹Ÿéœ€è¦å˜åŒ– (2) å®¢æˆ·ç«¯å¿…é¡»æ˜ç¡®çš„çŸ¥é“æœ‰å¤šå°‘ä¸ªå®¡æ‰¹çº§åˆ«å’Œè®¿é—®</li><li>è¿™æ ·å¯¹ä¸€ä¸ªé‡‡è´­è¯·æ±‚è¿›è¡Œå¤„ç† å’Œ Approver (å®¡æ‰¹äºº) å°±å­˜åœ¨å¼ºè€¦åˆå…³ç³»ï¼Œä¸åˆ©äºä»£ç çš„æ‰©å±•å’Œç»´æŠ¤</li></ol><h3 id="2ã€èŒè´£é“¾æ¨¡å¼æ–¹æ¡ˆä»£ç "><a href="#2ã€èŒè´£é“¾æ¨¡å¼æ–¹æ¡ˆä»£ç " class="headerlink" title="2ã€èŒè´£é“¾æ¨¡å¼æ–¹æ¡ˆä»£ç "></a>2ã€èŒè´£é“¾æ¨¡å¼æ–¹æ¡ˆä»£ç </h3><h4 id="1ã€Approverã€æŠ½è±¡ç±»ã€‘"><a href="#1ã€Approverã€æŠ½è±¡ç±»ã€‘" class="headerlink" title="1ã€Approverã€æŠ½è±¡ç±»ã€‘"></a>1ã€Approverã€æŠ½è±¡ç±»ã€‘</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">abstract</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Approver</span> &#123;<br><br>  Approver approver; <span class="hljs-comment">// ä¸‹ä¸€ä¸ªå¤„ç†è€…</span><br>  String name; <span class="hljs-comment">// åå­—</span><br><br>  <span class="hljs-keyword">public</span> <span class="hljs-title function_">Approver</span><span class="hljs-params">(String name)</span> &#123;<br>    <span class="hljs-comment">// TODO Auto-generated constructor stub</span><br>    <span class="hljs-built_in">this</span>.name = name;<br>  &#125;<br><br>  <span class="hljs-comment">// ä¸‹ä¸€ä¸ªå¤„ç†è€…</span><br>  <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">setApprover</span><span class="hljs-params">(Approver approver)</span> &#123;<br>    <span class="hljs-built_in">this</span>.approver = approver;<br>  &#125;<br><br>  <span class="hljs-comment">// å¤„ç†å®¡æ‰¹è¯·æ±‚çš„æ–¹æ³•ï¼Œå¾—åˆ°ä¸€ä¸ªè¯·æ±‚, å¤„ç†æ˜¯å­ç±»å®Œæˆï¼Œå› æ­¤è¯¥æ–¹æ³•åšæˆæŠ½è±¡</span><br>  <span class="hljs-keyword">public</span> <span class="hljs-keyword">abstract</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">processRequest</span><span class="hljs-params">(PurchaseRequest purchaseRequest)</span>;<br>&#125;<br></code></pre></td></tr></table></figure><h4 id="2ã€PurchaseRequest"><a href="#2ã€PurchaseRequest" class="headerlink" title="2ã€PurchaseRequest"></a>2ã€PurchaseRequest</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-comment">// è¯·æ±‚ç±»</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">PurchaseRequest</span> &#123;<br><br>  <span class="hljs-keyword">private</span> <span class="hljs-type">int</span> <span class="hljs-variable">type</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>; <span class="hljs-comment">// è¯·æ±‚ç±»å‹</span><br>  <span class="hljs-keyword">private</span> <span class="hljs-type">float</span> <span class="hljs-variable">price</span> <span class="hljs-operator">=</span> <span class="hljs-number">0.0f</span>; <span class="hljs-comment">// è¯·æ±‚é‡‘é¢</span><br>  <span class="hljs-keyword">private</span> <span class="hljs-type">int</span> <span class="hljs-variable">id</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>;<br>  <span class="hljs-comment">// æ„é€ å™¨</span><br>  <span class="hljs-keyword">public</span> <span class="hljs-title function_">PurchaseRequest</span><span class="hljs-params">(<span class="hljs-type">int</span> type, <span class="hljs-type">float</span> price, <span class="hljs-type">int</span> id)</span> &#123;<br>    <span class="hljs-built_in">this</span>.type = type;<br>    <span class="hljs-built_in">this</span>.price = price;<br>    <span class="hljs-built_in">this</span>.id = id;<br>  &#125;<br><br>  <span class="hljs-keyword">public</span> <span class="hljs-type">int</span> <span class="hljs-title function_">getType</span><span class="hljs-params">()</span> &#123;<br>    <span class="hljs-keyword">return</span> type;<br>  &#125;<br><br>  <span class="hljs-keyword">public</span> <span class="hljs-type">float</span> <span class="hljs-title function_">getPrice</span><span class="hljs-params">()</span> &#123;<br>    <span class="hljs-keyword">return</span> price;<br>  &#125;<br><br>  <span class="hljs-keyword">public</span> <span class="hljs-type">int</span> <span class="hljs-title function_">getId</span><span class="hljs-params">()</span> &#123;<br>    <span class="hljs-keyword">return</span> id;<br>  &#125;<br>&#125;<br></code></pre></td></tr></table></figure><h4 id="3ã€DepartmentApprover"><a href="#3ã€DepartmentApprover" class="headerlink" title="3ã€DepartmentApprover"></a>3ã€DepartmentApprover</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-comment">// æ•™å­¦ä¸»ä»»</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">DepartmentApprover</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_">Approver</span> &#123;<br><br>  <span class="hljs-keyword">public</span> <span class="hljs-title function_">DepartmentApprover</span><span class="hljs-params">(String name)</span> &#123;<br>    <span class="hljs-comment">// TODO Auto-generated constructor stub</span><br>    <span class="hljs-built_in">super</span>(name);<br>  &#125;<br><br>  <span class="hljs-meta">@Override</span><br>  <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">processRequest</span><span class="hljs-params">(PurchaseRequest purchaseRequest)</span> &#123;<br>    <span class="hljs-comment">// TODO Auto-generated method stub</span><br>    <span class="hljs-keyword">if</span> (purchaseRequest.getPrice() &lt;= <span class="hljs-number">5000</span>) &#123;<br>      System.out.println(<span class="hljs-string">&quot; è¯·æ±‚ç¼–å· id= &quot;</span> + purchaseRequest.getId() + <span class="hljs-string">&quot; è¢« &quot;</span> + <span class="hljs-built_in">this</span>.name + <span class="hljs-string">&quot; å¤„ç†&quot;</span>);<br>    &#125; <span class="hljs-keyword">else</span> &#123;<br>      approver.processRequest(purchaseRequest);<br>    &#125;<br>  &#125;<br>&#125;<br></code></pre></td></tr></table></figure><h4 id="4ã€CollegeApprover"><a href="#4ã€CollegeApprover" class="headerlink" title="4ã€CollegeApprover"></a>4ã€CollegeApprover</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-comment">// é™¢é•¿</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">CollegeApprover</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_">Approver</span> &#123;<br><br>  <span class="hljs-keyword">public</span> <span class="hljs-title function_">CollegeApprover</span><span class="hljs-params">(String name)</span> &#123;<br>    <span class="hljs-comment">// TODO Auto-generated constructor stub</span><br>    <span class="hljs-built_in">super</span>(name);<br>  &#125;<br><br>  <span class="hljs-meta">@Override</span><br>  <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">processRequest</span><span class="hljs-params">(PurchaseRequest purchaseRequest)</span> &#123;<br>    <span class="hljs-comment">// TODO Auto-generated method stub</span><br>    <span class="hljs-keyword">if</span> (purchaseRequest.getPrice() &gt; <span class="hljs-number">5000</span> &amp;&amp; purchaseRequest.getPrice() &lt;= <span class="hljs-number">10000</span>) &#123;<br>      System.out.println(<span class="hljs-string">&quot; è¯·æ±‚ç¼–å· id= &quot;</span> + purchaseRequest.getId() + <span class="hljs-string">&quot; è¢« &quot;</span> + <span class="hljs-built_in">this</span>.name + <span class="hljs-string">&quot; å¤„ç†&quot;</span>);<br>    &#125; <span class="hljs-keyword">else</span> &#123;<br>      approver.processRequest(purchaseRequest);<br>    &#125;<br>  &#125;<br>&#125;<br></code></pre></td></tr></table></figure><h4 id="5ã€ViceSchoolMasterApprover"><a href="#5ã€ViceSchoolMasterApprover" class="headerlink" title="5ã€ViceSchoolMasterApprover"></a>5ã€ViceSchoolMasterApprover</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-comment">// å‰¯æ ¡é•¿</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">ViceSchoolMasterApprover</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_">Approver</span> &#123;<br><br>  <span class="hljs-keyword">public</span> <span class="hljs-title function_">ViceSchoolMasterApprover</span><span class="hljs-params">(String name)</span> &#123;<br>    <span class="hljs-comment">// TODO Auto-generated constructor stub</span><br>    <span class="hljs-built_in">super</span>(name);<br>  &#125;<br><br>  <span class="hljs-meta">@Override</span><br>  <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">processRequest</span><span class="hljs-params">(PurchaseRequest purchaseRequest)</span> &#123;<br>    <span class="hljs-comment">// TODO Auto-generated method stub</span><br>    <span class="hljs-keyword">if</span> (purchaseRequest.getPrice() &gt; <span class="hljs-number">10000</span> &amp;&amp; purchaseRequest.getPrice() &lt;= <span class="hljs-number">30000</span>) &#123;<br>      System.out.println(<span class="hljs-string">&quot; è¯·æ±‚ç¼–å· id= &quot;</span> + purchaseRequest.getId() + <span class="hljs-string">&quot; è¢« &quot;</span> + <span class="hljs-built_in">this</span>.name + <span class="hljs-string">&quot; å¤„ç†&quot;</span>);<br>    &#125; <span class="hljs-keyword">else</span> &#123;<br>      approver.processRequest(purchaseRequest);<br>    &#125;<br>  &#125;<br>&#125;<br></code></pre></td></tr></table></figure><h4 id="6ã€SchoolMasterApprover"><a href="#6ã€SchoolMasterApprover" class="headerlink" title="6ã€SchoolMasterApprover"></a>6ã€SchoolMasterApprover</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-comment">// æ ¡é•¿</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">SchoolMasterApprover</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_">Approver</span> &#123;<br><br>  <span class="hljs-keyword">public</span> <span class="hljs-title function_">SchoolMasterApprover</span><span class="hljs-params">(String name)</span> &#123;<br>    <span class="hljs-comment">// TODO Auto-generated constructor stub</span><br>    <span class="hljs-built_in">super</span>(name);<br>  &#125;<br><br>  <span class="hljs-meta">@Override</span><br>  <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">processRequest</span><span class="hljs-params">(PurchaseRequest purchaseRequest)</span> &#123;<br>    <span class="hljs-comment">// TODO Auto-generated method stub</span><br>    <span class="hljs-keyword">if</span> (purchaseRequest.getPrice() &gt; <span class="hljs-number">30000</span>) &#123;<br>      System.out.println(<span class="hljs-string">&quot; è¯·æ±‚ç¼–å· id= &quot;</span> + purchaseRequest.getId() + <span class="hljs-string">&quot; è¢« &quot;</span> + <span class="hljs-built_in">this</span>.name + <span class="hljs-string">&quot; å¤„ç†&quot;</span>);<br>    &#125; <span class="hljs-keyword">else</span> &#123;<br>      approver.processRequest(purchaseRequest);<br>    &#125;<br>  &#125;<br>&#125;<br></code></pre></td></tr></table></figure><h4 id="7ã€Client"><a href="#7ã€Client" class="headerlink" title="7ã€Client"></a>7ã€Client</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Client</span> &#123;<br><br>  <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span> &#123;<br>    <span class="hljs-comment">// TODO Auto-generated method stub</span><br>    <span class="hljs-comment">// åˆ›å»ºä¸€ä¸ªè¯·æ±‚</span><br>    <span class="hljs-type">PurchaseRequest</span> <span class="hljs-variable">purchaseRequest</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">PurchaseRequest</span>(<span class="hljs-number">1</span>, <span class="hljs-number">4000</span>, <span class="hljs-number">1</span>);<br><br>    <span class="hljs-comment">// åˆ›å»ºç›¸å…³çš„å®¡æ‰¹äºº</span><br>    <span class="hljs-type">DepartmentApprover</span> <span class="hljs-variable">departmentApprover</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">DepartmentApprover</span>(<span class="hljs-string">&quot;å¼ ä¸»ä»»&quot;</span>);<br>    <span class="hljs-type">CollegeApprover</span> <span class="hljs-variable">collegeApprover</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">CollegeApprover</span>(<span class="hljs-string">&quot;æé™¢é•¿&quot;</span>);<br>    <span class="hljs-type">ViceSchoolMasterApprover</span> <span class="hljs-variable">viceSchoolMasterApprover</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">ViceSchoolMasterApprover</span>(<span class="hljs-string">&quot;ç‹å‰¯æ ¡&quot;</span>);<br>    <span class="hljs-type">SchoolMasterApprover</span> <span class="hljs-variable">schoolMasterApprover</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">SchoolMasterApprover</span>(<span class="hljs-string">&quot;Bæ ¡é•¿&quot;</span>);<br><br>    <span class="hljs-comment">// éœ€è¦å°†å„ä¸ªå®¡æ‰¹çº§åˆ«çš„ä¸‹ä¸€ä¸ªè®¾ç½®å¥½ (å¤„ç†äººæ„æˆç¯å½¢: )</span><br>    departmentApprover.setApprover(collegeApprover);<br>    collegeApprover.setApprover(viceSchoolMasterApprover);<br>    viceSchoolMasterApprover.setApprover(schoolMasterApprover);<br>    schoolMasterApprover.setApprover(departmentApprover);<br><br>    departmentApprover.processRequest(purchaseRequest);<br>    viceSchoolMasterApprover.processRequest(purchaseRequest);<br>  &#125;<br>&#125;<br></code></pre></td></tr></table></figure><h2 id="2ã€èŒè´£é“¾æ¨¡å¼å·¥ä½œåŸç†"><a href="#2ã€èŒè´£é“¾æ¨¡å¼å·¥ä½œåŸç†" class="headerlink" title="2ã€èŒè´£é“¾æ¨¡å¼å·¥ä½œåŸç†"></a>2ã€èŒè´£é“¾æ¨¡å¼å·¥ä½œåŸç†</h2><ol><li>èŒè´£é“¾æ¨¡å¼ï¼ˆChain of Responsibility Patternï¼‰,  åˆå« è´£ä»»é“¾æ¨¡å¼ï¼Œä¸ºè¯·æ±‚åˆ›å»ºäº†ä¸€ä¸ªæ¥æ”¶è€… å¯¹è±¡çš„é“¾(ç®€å•ç¤ºæ„å›¾)ã€‚è¿™ç§æ¨¡å¼å¯¹è¯·æ±‚çš„ å‘é€è€…å’Œæ¥æ”¶è€…è¿›è¡Œè§£è€¦ã€‚ </li><li>èŒè´£é“¾æ¨¡å¼é€šå¸¸æ¯ä¸ªæ¥æ”¶è€…éƒ½åŒ…å«å¯¹å¦ä¸€ä¸ªæ¥ æ”¶è€…çš„å¼•ç”¨ã€‚å¦‚æœä¸€ä¸ªå¯¹è±¡ä¸èƒ½å¤„ç†è¯¥è¯·æ±‚ï¼Œ é‚£ä¹ˆå®ƒä¼šæŠŠç›¸åŒçš„è¯·æ±‚ä¼ ç»™ä¸‹ä¸€ä¸ªæ¥æ”¶è€…ï¼Œä¾ æ­¤ç±»æ¨ã€‚ </li></ol><p>èŒè´£é“¾æ¨¡å¼ï¼ˆChain Of Responsibilityï¼‰ï¼Œ ä½¿å¤šä¸ªå¯¹è±¡éƒ½æœ‰æœºä¼šå¤„ç†è¯·æ±‚ï¼Œä»è€Œé¿ å…è¯·æ±‚çš„å‘é€è€…å’Œæ¥æ”¶è€…ä¹‹é—´çš„è€¦åˆå…³ ç³»ã€‚å°†è¿™ä¸ªå¯¹è±¡è¿æˆä¸€æ¡é“¾ï¼Œå¹¶æ²¿ç€è¿™ æ¡é“¾ä¼ é€’è¯¥è¯·æ±‚ï¼Œç›´åˆ°æœ‰ä¸€ä¸ªå¯¹è±¡å¤„ç† å®ƒä¸ºæ­¢ã€‚</p><p>é€šä¿—æ¥è®²ï¼Œå°±æ˜¯åœ¨èŒè´£é“¾æ¨¡å¼ä¸­ï¼Œå¤šä¸ªå¤„ç†å™¨ï¼ˆä¹Ÿå°±æ˜¯åˆšåˆšå®šä¹‰ä¸­è¯´çš„â€œæ¥æ”¶å¯¹è±¡â€ï¼‰ä¾æ¬¡å¤„ç†åŒä¸€ä¸ªè¯·æ±‚ã€‚ä¸€ä¸ªè¯·æ±‚å…ˆç»è¿‡ A å¤„ç†å™¨å¤„ç†ï¼Œç„¶åå†æŠŠè¯·æ±‚ä¼ é€’ç»™ B å¤„ç†å™¨ï¼ŒB å¤„ç†å™¨å¤„ç†å®Œåå†ä¼ é€’ç»™ C å¤„ç†å™¨ï¼Œä»¥æ­¤ç±»æ¨ï¼Œå½¢æˆä¸€ä¸ªé“¾æ¡ã€‚é“¾æ¡ä¸Šçš„æ¯ä¸ªå¤„ç†å™¨å„è‡ªæ‰¿æ‹…å„è‡ªçš„å¤„ç†èŒè´£ï¼Œæ‰€ä»¥å«ä½œèŒè´£é“¾æ¨¡å¼ã€‚</p><blockquote><p>èŒè´£é“¾æ¨¡å¼æœ€å¸¸ç”¨æ¥å¼€å‘æ¡†æ¶çš„è¿‡æ»¤å™¨å’Œæ‹¦æˆªå™¨</p></blockquote><h2 id="3ã€Servlet-Filter"><a href="#3ã€Servlet-Filter" class="headerlink" title="3ã€Servlet Filter"></a>3ã€Servlet Filter</h2><p>Servlet Filter æ˜¯ Java Servlet è§„èŒƒä¸­å®šä¹‰çš„ç»„ä»¶ï¼Œç¿»è¯‘æˆä¸­æ–‡å°±æ˜¯è¿‡æ»¤å™¨ï¼Œå®ƒå¯ä»¥å®ç°å¯¹ HTTP è¯·æ±‚çš„è¿‡æ»¤åŠŸèƒ½ï¼Œæ¯”å¦‚é‰´æƒã€é™æµã€è®°å½•æ—¥å¿—ã€éªŒè¯å‚æ•°ç­‰ç­‰ã€‚å› ä¸ºå®ƒæ˜¯ Servlet è§„èŒƒçš„ä¸€éƒ¨åˆ†ï¼Œæ‰€ä»¥ï¼Œåªè¦æ˜¯æ”¯æŒ Servlet çš„ Web å®¹å™¨ï¼ˆæ¯”å¦‚ï¼ŒTomcatã€Jetty ç­‰ï¼‰ï¼Œéƒ½æ”¯æŒè¿‡æ»¤å™¨åŠŸèƒ½ã€‚</p><p><img src="/2022/10/11/07-xing-wei-xing-ce-lue-zhi-ze-lian/image-20221012180753720.png"></p><p>åœ¨å®é™…é¡¹ç›®ä¸­ Servlet Filterçš„ä½¿ç”¨ ã€‚ä¸€ä¸ªç®€å•çš„ç¤ºä¾‹ä»£ç ï¼Œå¦‚ä¸‹æ‰€ç¤ºã€‚æ·»åŠ ä¸€ä¸ªè¿‡æ»¤å™¨ï¼Œåªéœ€è¦å®šä¹‰ä¸€ä¸ªå®ç° javax.servlet.Filter æ¥å£çš„è¿‡æ»¤å™¨ç±»ï¼Œå¹¶ä¸”å°†å®ƒé…ç½®åœ¨ web.xml é…ç½®æ–‡ä»¶ä¸­ã€‚Web å®¹å™¨å¯åŠ¨çš„æ—¶å€™ï¼Œä¼šè¯»å– web.xml ä¸­çš„é…ç½®ï¼Œåˆ›å»ºè¿‡æ»¤å™¨å¯¹è±¡ã€‚å½“æœ‰è¯·æ±‚åˆ°æ¥çš„æ—¶å€™ï¼Œä¼šå…ˆç»è¿‡è¿‡æ»¤å™¨ï¼Œç„¶åæ‰ç”± Servlet æ¥å¤„ç†ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">LogFilter</span> <span class="hljs-keyword">implements</span> <span class="hljs-title class_">Filter</span> &#123;<br><br>  <span class="hljs-meta">@Override</span><br>  <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">init</span><span class="hljs-params">(FilterConfig filterConfig)</span> <span class="hljs-keyword">throws</span> ServletException &#123;<br>    <span class="hljs-comment">// åœ¨åˆ›å»ºFilteræ—¶è‡ªåŠ¨è°ƒç”¨ï¼Œ</span><br>    <span class="hljs-comment">// å…¶ä¸­filterConfigåŒ…å«è¿™ä¸ªFilterçš„é…ç½®å‚æ•°ï¼Œæ¯”å¦‚nameä¹‹ç±»çš„ï¼ˆä»é…ç½®æ–‡ä»¶ä¸­è¯»å–çš„ï¼‰</span><br><br>  &#125;<br><br>  <span class="hljs-meta">@Override</span><br>  <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">doFilter</span><span class="hljs-params">(ServletRequest request, ServletResponse response, FilterChain chain)</span><br>      <span class="hljs-keyword">throws</span> IOException, ServletException &#123;<br>    System.out.println(<span class="hljs-string">&quot;æ‹¦æˆªå®¢æˆ·ç«¯å‘é€æ¥çš„è¯·æ±‚.&quot;</span>);<br>    chain.doFilter(request, response);<br>    System.out.println(<span class="hljs-string">&quot;æ‹¦æˆªå‘é€ç»™å®¢æˆ·ç«¯çš„å“åº”.&quot;</span>);<br>  &#125;<br><br>  <span class="hljs-meta">@Override</span><br>  <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">destroy</span><span class="hljs-params">()</span> &#123;<br>    <span class="hljs-comment">// åœ¨é”€æ¯Filteræ—¶è‡ªåŠ¨è°ƒç”¨</span><br>  &#125;<br>&#125;<br></code></pre></td></tr></table></figure><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs xml">// åœ¨web.xmlé…ç½®æ–‡ä»¶ä¸­å¦‚ä¸‹é…ç½®ï¼š<br><span class="hljs-tag">&lt;<span class="hljs-name">filter</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">filter-name</span>&gt;</span>logFilter<span class="hljs-tag">&lt;/<span class="hljs-name">filter-name</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">filter-class</span>&gt;</span>com.zb.cd.LogFilter<span class="hljs-tag">&lt;/<span class="hljs-name">filter-class</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">filter</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">filter-mapping</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">filter-name</span>&gt;</span>logFilter<span class="hljs-tag">&lt;/<span class="hljs-name">filter-name</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">url-pattern</span>&gt;</span>/*<span class="hljs-tag">&lt;/<span class="hljs-name">url-pattern</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">filter-mapping</span>&gt;</span><br></code></pre></td></tr></table></figure><ol><li>ä»åˆšåˆšçš„ç¤ºä¾‹ä»£ç ä¸­å¯ä»¥å‘ç°ï¼Œæ·»åŠ è¿‡æ»¤å™¨éå¸¸æ–¹ä¾¿ï¼Œä¸éœ€è¦ä¿®æ”¹ä»»ä½•ä»£ç ï¼Œå®šä¹‰ä¸€ä¸ªå®ç° javax.servlet.Filter çš„ç±»ï¼Œå†æ”¹æ”¹é…ç½®å°±æå®šäº†ï¼Œå®Œå…¨ç¬¦åˆå¼€é—­åŸåˆ™ã€‚é‚£ Servlet Filter æ˜¯å¦‚ä½•åšåˆ°å¦‚æ­¤å¥½çš„æ‰©å±•æ€§çš„å‘¢ï¼Ÿå®ƒåˆ©ç”¨çš„å°±æ˜¯èŒè´£é“¾æ¨¡å¼ã€‚</li><li>èŒè´£é“¾æ¨¡å¼çš„å®ç°åŒ…å«å¤„ç†å™¨æ¥å£ï¼ˆIHandlerï¼‰æˆ–æŠ½è±¡ç±»ï¼ˆHandlerï¼‰ï¼Œä»¥åŠå¤„ç†å™¨é“¾ï¼ˆHandlerChainï¼‰ã€‚å¯¹åº”åˆ° Servlet Filterï¼Œjavax.servlet.Filter å°±æ˜¯å¤„ç†å™¨æ¥å£ï¼ŒFilterChain å°±æ˜¯å¤„ç†å™¨é“¾ã€‚æ¥ä¸‹æ¥é‡ç‚¹æ¥çœ‹ FilterChain æ˜¯å¦‚ä½•å®ç°çš„ã€‚</li><li>ä¸è¿‡ï¼ŒServlet åªæ˜¯ä¸€ä¸ªè§„èŒƒï¼Œå¹¶ä¸åŒ…å«å…·ä½“çš„å®ç°ï¼Œæ‰€ä»¥ï¼ŒServlet ä¸­çš„ FilterChain åªæ˜¯ä¸€ä¸ªæ¥å£å®šä¹‰ã€‚å…·ä½“çš„å®ç°ç±»ç”±éµä» Servlet è§„èŒƒçš„ Web å®¹å™¨æ¥æä¾›ï¼Œæ¯”å¦‚ï¼ŒApplicationFilterChain ç±»å°±æ˜¯ Tomcat æä¾›çš„ FilterChain çš„å®ç°ç±»ï¼Œæºç å¦‚ä¸‹æ‰€ç¤ºã€‚</li></ol><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">final</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">ApplicationFilterChain</span> <span class="hljs-keyword">implements</span> <span class="hljs-title class_">FilterChain</span> &#123;<br>  <span class="hljs-keyword">private</span> <span class="hljs-type">int</span> <span class="hljs-variable">pos</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>; <span class="hljs-comment">// å½“å‰æ‰§è¡Œåˆ°äº†å“ªä¸ªfilter</span><br>  <span class="hljs-keyword">private</span> <span class="hljs-type">int</span> n; <span class="hljs-comment">// filterçš„ä¸ªæ•°</span><br>  <span class="hljs-keyword">private</span> ApplicationFilterConfig[] filters;<br>  <span class="hljs-keyword">private</span> Servlet servlet;<br><br>  <span class="hljs-meta">@Override</span><br>  <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">doFilter</span><span class="hljs-params">(ServletRequest request, ServletResponse response)</span> &#123;<br>    <span class="hljs-keyword">if</span> (pos &lt; n) &#123;<br>      <span class="hljs-type">ApplicationFilterConfig</span> <span class="hljs-variable">filterConfig</span> <span class="hljs-operator">=</span> filters[pos++];<br>      <span class="hljs-type">Filter</span> <span class="hljs-variable">filter</span> <span class="hljs-operator">=</span> filterConfig.getFilter();<br>      filter.doFilter(request, response, <span class="hljs-built_in">this</span>);<br>    &#125; <span class="hljs-keyword">else</span> &#123;<br>      <span class="hljs-comment">// filteréƒ½å¤„ç†å®Œæ¯•åï¼Œæ‰§è¡Œservlet</span><br>      servlet.service(request, response);<br>    &#125;<br>  &#125;<br><br>  <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">addFilter</span><span class="hljs-params">(ApplicationFilterConfig filterConfig)</span> &#123;<br>    <span class="hljs-keyword">for</span> (ApplicationFilterConfig filter : filters) <span class="hljs-keyword">if</span> (filter == filterConfig) <span class="hljs-keyword">return</span>;<br>    <span class="hljs-keyword">if</span> (n == filters.length) &#123; <span class="hljs-comment">// æ‰©å®¹</span><br>      ApplicationFilterConfig[] newFilters = <span class="hljs-keyword">new</span> <span class="hljs-title class_">ApplicationFilterConfig</span>[n + INCREMENT];<br>      System.arraycopy(filters, <span class="hljs-number">0</span>, newFilters, <span class="hljs-number">0</span>, n);<br>      filters = newFilters;<br>    &#125;<br>    filters[n++] = filterConfig;<br>  &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>ApplicationFilterChain ä¸­çš„ doFilter() å‡½æ•°çš„ä»£ç å®ç°æ¯”è¾ƒæœ‰æŠ€å·§ï¼Œå®é™…ä¸Šæ˜¯ä¸€ä¸ªé€’å½’è°ƒç”¨ã€‚å¯ä»¥ç”¨æ¯ä¸ª Filterï¼ˆæ¯”å¦‚ LogFilterï¼‰çš„ doFilter() çš„ä»£ç å®ç°ï¼Œç›´æ¥æ›¿æ¢ ApplicationFilterChain çš„ç¬¬ 12 è¡Œä»£ç ï¼Œå¯ä»¥çœ‹å‡ºæ˜¯é€’å½’è°ƒç”¨ã€‚å¦‚ä¸‹æ‰€ç¤ºã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-meta">@Override</span><br><span class="hljs-keyword">public</span>  <span class="hljs-keyword">void</span>  <span class="hljs-title function_">doFilter</span><span class="hljs-params">(ServletRequest request, ServletResponse response)</span>  &#123;<br>    <span class="hljs-keyword">if</span> (pos &lt; n) &#123;<br>        <span class="hljs-type">ApplicationFilterConfig</span> <span class="hljs-variable">filterConfig</span> <span class="hljs-operator">=</span> filters[pos++];<br>        <span class="hljs-type">Filter</span> <span class="hljs-variable">filter</span> <span class="hljs-operator">=</span> filterConfig.getFilter();<br>        <span class="hljs-comment">//filter.doFilter(request, response, this);</span><br>        <span class="hljs-comment">//æŠŠfilter.doFilterçš„ä»£ç å®ç°å±•å¼€æ›¿æ¢åˆ°è¿™é‡Œ</span><br>        System.out.println(<span class="hljs-string">&quot;æ‹¦æˆªå®¢æˆ·ç«¯å‘é€æ¥çš„è¯·æ±‚.&quot;</span>);<br>        chain.doFilter(request, response); <span class="hljs-comment">// chainå°±æ˜¯this</span><br>        System.out.println(<span class="hljs-string">&quot;æ‹¦æˆªå‘é€ç»™å®¢æˆ·ç«¯çš„å“åº”.&quot;</span>)<br>    &#125; <span class="hljs-keyword">else</span> &#123;<br>        <span class="hljs-comment">// filteréƒ½å¤„ç†å®Œæ¯•åï¼Œæ‰§è¡Œservlet</span><br>        servlet.service(request, response);<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>è¿™æ ·å®ç°ä¸»è¦æ˜¯ä¸ºäº†åœ¨ä¸€ä¸ª doFilter() æ–¹æ³•ä¸­ï¼Œæ”¯æŒåŒå‘æ‹¦æˆªï¼Œæ—¢èƒ½æ‹¦æˆªå®¢æˆ·ç«¯å‘é€æ¥çš„è¯·æ±‚ï¼Œä¹Ÿèƒ½æ‹¦æˆªå‘é€ç»™å®¢æˆ·ç«¯çš„å“åº”ã€‚</p>]]></content>
    
    
    <categories>
      
      <category>è®¾è®¡æ¨¡å¼</category>
      
    </categories>
    
    
    <tags>
      
      <tag>è®¾è®¡æ¨¡å¼</tag>
      
      <tag>ç­–ç•¥</tag>
      
      <tag>èŒè´£é“¾</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>C-ã€Šå®‰æ²³æ¡¥ã€‹</title>
    <link href="/2022/10/09/c-an-he-qiao/"/>
    <url>/2022/10/09/c-an-he-qiao/</url>
    
    <content type="html"><![CDATA[<center>ã€Šå®‰æ²³æ¡¥ã€‹</center><p>åŸè°ƒG | é€‰è°ƒG </p><p><img src="/2022/10/09/c-an-he-qiao/image-20221009170248015.png"></p><p><img src="/2022/10/09/c-an-he-qiao/image-20221009170322004.png"></p><p><img src="/2022/10/09/c-an-he-qiao/image-20221009170357665.png"></p><p><img src="/2022/10/09/c-an-he-qiao/image-20221009170417935.png"></p><p><img src="/2022/10/09/c-an-he-qiao/image-20221009170440876.png"></p><blockquote><p>æ›²è°±æ¥æºå¤§æ ‘éŸ³ä¹å±‹</p></blockquote>]]></content>
    
    
    <categories>
      
      <category>å‰ä»–</category>
      
    </categories>
    
    
    <tags>
      
      <tag>å‰ä»–</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>C-ã€Šæˆéƒ½ã€‹</title>
    <link href="/2022/10/09/c-cheng-du/"/>
    <url>/2022/10/09/c-cheng-du/</url>
    
    <content type="html"><![CDATA[<center>ã€Šæˆéƒ½ã€‹<center><p>åŸè°ƒD | é€‰è°ƒC | capo = 3</p><p><img src="/2022/10/09/c-cheng-du/image-20221009165319957.png" alt></p><p><img src="/2022/10/09/c-cheng-du/image-20221009165406564.png" alt></p><blockquote><p>æ›²è°±æ¥æºäºè¶£è°ˆéŸ³ä¹</p></blockquote></center></center>]]></content>
    
    
    <categories>
      
      <category>å‰ä»–</category>
      
    </categories>
    
    
    <tags>
      
      <tag>å‰ä»–</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>v2-æ•°ç»„</title>
    <link href="/2022/10/08/v2-shu-zu/"/>
    <url>/2022/10/08/v2-shu-zu/</url>
    
    <content type="html"><![CDATA[<h1 id="ä¸€ã€ç†è®ºåŸºç¡€"><a href="#ä¸€ã€ç†è®ºåŸºç¡€" class="headerlink" title="ä¸€ã€ç†è®ºåŸºç¡€"></a>ä¸€ã€ç†è®ºåŸºç¡€</h1><p>å®šä¹‰ï¼š<strong>æ•°ç»„æ˜¯å­˜æ”¾åœ¨è¿ç»­å†…å­˜ç©ºé—´ä¸Šçš„ç›¸åŒç±»å‹æ•°æ®çš„é›†åˆã€‚</strong></p><p>éœ€è¦æ³¨æ„ä¸¤ç‚¹ï¼š</p><ul><li>æ•°ç»„ä¸‹æ ‡ä»0å¼€å§‹</li><li>æ•°ç»„å†…å­˜ç©ºé—´çš„åœ°å€æ˜¯è¿ç»­çš„</li></ul><p>é’ˆå¯¹äºŒç»´æ•°ç»„åœ¨å†…å­˜ç©ºé—´çš„åœ°å€æ˜¯å¦è¿ç»­ï¼Œä¸åŒçš„ç¼–ç¨‹è¯­è¨€çš„å†…å­˜ç®¡ç†ä¸åŒã€‚åœ¨C++ä¸­äºŒç»´æ•°ç»„æ˜¯è¿ç»­åˆ†å¸ƒçš„ã€‚ä½†åœ¨javaä¸­äºŒç»´æ•°ç»„ä¸æ˜¯è¿ç»­åˆ†å¸ƒçš„ã€‚</p><p>javaä¸­çš„äºŒç»´æ•°ç»„å¯èƒ½æ˜¯å¦‚ä¸‹æ’åˆ—æ–¹å¼ï¼š</p><p><img src="/2022/10/08/v2-shu-zu/image-20221008165054951.png"></p><p>åŸºæœ¬æ–¹æ³•ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-type">int</span>[] nums = <span class="hljs-keyword">new</span> <span class="hljs-title class_">int</span>[n];<br><span class="hljs-type">int</span> <span class="hljs-variable">len</span> <span class="hljs-operator">=</span> nums.length;    <span class="hljs-comment">// é•¿åº¦</span><br>nums[i];  <span class="hljs-comment">// å–å€¼</span><br></code></pre></td></tr></table></figure><h1 id="äºŒã€ç»å…¸é¢˜ç›®ï¼ˆåŠ›æ‰£"><a href="#äºŒã€ç»å…¸é¢˜ç›®ï¼ˆåŠ›æ‰£" class="headerlink" title="äºŒã€ç»å…¸é¢˜ç›®ï¼ˆåŠ›æ‰£"></a>äºŒã€ç»å…¸é¢˜ç›®ï¼ˆåŠ›æ‰£</h1><h2 id="1ã€704-äºŒåˆ†æŸ¥æ‰¾"><a href="#1ã€704-äºŒåˆ†æŸ¥æ‰¾" class="headerlink" title="1ã€704.äºŒåˆ†æŸ¥æ‰¾"></a>1ã€704.äºŒåˆ†æŸ¥æ‰¾</h2><p>äºŒåˆ†æŸ¥æ‰¾çš„å‰ææ¡ä»¶æ˜¯æ•°ç»„æœ‰åºï¼ŒåŒæ—¶è¿˜è¦ä¿è¯æ•°ç»„æ— é‡å¤å…ƒç´ ï¼Œå› ä¸ºè‹¥æ˜¯æœ‰é‡å¤å…ƒç´ ï¼ŒäºŒåˆ†æŸ¥æ‰¾è¿”å›æ¥çš„ç´¢å¼•å¯èƒ½ä¸æ˜¯å”¯ä¸€çš„ã€‚äºŒåˆ†æŸ¥æ‰¾éœ€è¦æ³¨æ„çš„åœ°æ–¹æ˜¯è¾¹ç•Œé—®é¢˜ï¼Œä¸€æ—¦ç¡®å®šå¥½è¾¹ç•Œï¼Œéƒ½è¦æŒ‰è¿™ä¸ªè§„åˆ™æ¥ï¼Œä¸€ä¼šæ˜¯å·¦é—­å³é—­ä¸€ä¼šæ˜¯å·¦é—­å³å¼€ï¼Œå½“ç„¶ç»•ï¼</p><p>æ‰€ä»¥è‹¥æ˜¯çœ‹åˆ°æ•°ç»„æœ‰åºä¸”æ— é‡å¤ï¼Œå¯ä»¥è”æƒ³äºŒåˆ†æŸ¥æ‰¾</p><p>äºŒåˆ†æŸ¥æ‰¾ä¸¤ç§å†™æ³•ï¼š</p><ul><li>å·¦é—­å³é—­å³[left, right]</li><li>å·¦é—­å³å¼€å³[left, right)</li></ul><h3 id="1ã€å·¦é—­å³é—­"><a href="#1ã€å·¦é—­å³é—­" class="headerlink" title="1ã€å·¦é—­å³é—­"></a>1ã€å·¦é—­å³é—­</h3><p>å®šä¹‰ target æ˜¯åœ¨ä¸€ä¸ªåœ¨å·¦é—­å³é—­çš„åŒºé—´é‡Œï¼Œ<strong>ä¹Ÿå°±æ˜¯[left, right]</strong> ã€‚</p><ul><li>while (left &lt;= right) è¦ä½¿ç”¨ &lt;= ï¼Œå› ä¸ºleft == rightæ˜¯æœ‰æ„ä¹‰çš„ï¼Œæ‰€ä»¥ä½¿ç”¨ &lt;=</li><li>if (nums[middle] &gt; target) right è¦èµ‹å€¼ä¸º middle - 1ï¼ŒåŒæ ·if (nums[middle] &lt; target) leftè¦èµ‹å€¼ä¸º middle + 1ã€‚å› ä¸ºæ˜¯å·¦é—­å³é—­ï¼Œæ‰€ä»¥middleä¸€å®šå·²ç»åˆ¤æ–­è¿‡äº†ï¼Œç›´æ¥è·³è¿‡å³å¯</li></ul><h3 id="2ã€å·¦é—­å³å¼€"><a href="#2ã€å·¦é—­å³å¼€" class="headerlink" title="2ã€å·¦é—­å³å¼€"></a>2ã€å·¦é—­å³å¼€</h3><p>å®šä¹‰ target æ˜¯åœ¨ä¸€ä¸ªåœ¨å·¦é—­å³é—­çš„åŒºé—´é‡Œï¼Œ<strong>ä¹Ÿå°±æ˜¯[left, rightï¼‰</strong> ã€‚</p><ul><li>while (left &lt;= right) è¦ä½¿ç”¨ &lt; ï¼Œå› ä¸ºleft == rightæ˜¯æ²¡æœ‰æœ‰æ„ä¹‰çš„ï¼Œæ‰€ä»¥ä¸èƒ½ä½¿ç”¨&lt;=ï¼Œè¦ä½¿ç”¨&lt;</li><li>if (nums[middle] &gt; target) right è¦èµ‹å€¼ä¸º middleï¼Œ if (nums[middle] &lt; target) leftè¦èµ‹å€¼ä¸º middle + 1ã€‚</li></ul><p>äºŒè€…é€‰ä¸€ä¸ªå³å¯ï¼Œæˆ‘ä¸ªäººå€¾å‘äºå·¦é—­å³é—­</p><h3 id="3ã€ç›¸å…³é¢˜ç›®æ¨è"><a href="#3ã€ç›¸å…³é¢˜ç›®æ¨è" class="headerlink" title="3ã€ç›¸å…³é¢˜ç›®æ¨è"></a>3ã€ç›¸å…³é¢˜ç›®æ¨è</h3><ul><li><a href="https://programmercarl.com/0035.%E6%90%9C%E7%B4%A2%E6%8F%92%E5%85%A5%E4%BD%8D%E7%BD%AE.html">35.æœç´¢æ’å…¥ä½ç½®(opens new window)</a></li><li><a href="https://programmercarl.com/0034.%E5%9C%A8%E6%8E%92%E5%BA%8F%E6%95%B0%E7%BB%84%E4%B8%AD%E6%9F%A5%E6%89%BE%E5%85%83%E7%B4%A0%E7%9A%84%E7%AC%AC%E4%B8%80%E4%B8%AA%E5%92%8C%E6%9C%80%E5%90%8E%E4%B8%80%E4%B8%AA%E4%BD%8D%E7%BD%AE.html">34.åœ¨æ’åºæ•°ç»„ä¸­æŸ¥æ‰¾å…ƒç´ çš„ç¬¬ä¸€ä¸ªå’Œæœ€åä¸€ä¸ªä½ç½®(opens new window)</a></li><li>69.x çš„å¹³æ–¹æ ¹</li><li>367.æœ‰æ•ˆçš„å®Œå…¨å¹³æ–¹æ•°</li></ul><h2 id="2ã€27-ç§»é™¤å…ƒç´ "><a href="#2ã€27-ç§»é™¤å…ƒç´ " class="headerlink" title="2ã€27.ç§»é™¤å…ƒç´ "></a>2ã€27.ç§»é™¤å…ƒç´ </h2><p>é¢˜ç›®è¦æ±‚ä¸èƒ½ä½¿ç”¨é¢å¤–çš„æ•°ç»„ç©ºé—´ï¼Œæ„å‘³ç€åªèƒ½åŸåœ°æ“ä½œ</p><p>ä¸¤ç§æ–¹æ³•</p><h3 id="1ã€æš´åŠ›æ³•"><a href="#1ã€æš´åŠ›æ³•" class="headerlink" title="1ã€æš´åŠ›æ³•"></a>1ã€æš´åŠ›æ³•</h3><p>forå¾ªç¯ä¸¤æ¬¡ï¼Œç¢°åˆ°ç›®æ ‡å€¼ï¼Œå°±å°†åé¢çš„å„ä¸ªå…ƒç´ å¾€å‰ç§»åŠ¨ä¸€ä½</p><p>å½“ç„¶æ—¶é—´å¤æ‚åº¦æ¯”è¾ƒé«˜ï¼ŒO(n*2)</p><h3 id="2ã€åŒæŒ‡é’ˆæ³•"><a href="#2ã€åŒæŒ‡é’ˆæ³•" class="headerlink" title="2ã€åŒæŒ‡é’ˆæ³•"></a>2ã€åŒæŒ‡é’ˆæ³•</h3><p>ç»´æŒä¸¤ä¸ªæŒ‡é’ˆï¼Œä¸€ä¸ªå¿«ä¸€ä¸ªæ…¢ï¼Œforå¾ªç¯ä¸€æ¬¡ï¼Œè‹¥ä¸ä¸ºç›®æ ‡å€¼ï¼Œå°†fastæ‰€åœ¨ä½ç½®çš„å…ƒç´ èµ‹å€¼ç»™slowæ‰€åœ¨ä½ç½®çš„å…ƒç´ ï¼ŒåŒæ—¶å¾€åè¿›ä¸€ä½</p><p>ä»£ç å¦‚ä¸‹ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">for</span> (fast = <span class="hljs-number">0</span>; fast &lt; nums.length; fast++) &#123;<br>   <span class="hljs-keyword">if</span>(nums[fast] != val) &#123;<br>       nums[slow++] = nums[fast];<br>   &#125;<br>&#125;<br></code></pre></td></tr></table></figure><h3 id="3ã€ç›¸å…³é¢˜ç›®æ¨è-1"><a href="#3ã€ç›¸å…³é¢˜ç›®æ¨è-1" class="headerlink" title="3ã€ç›¸å…³é¢˜ç›®æ¨è"></a>3ã€ç›¸å…³é¢˜ç›®æ¨è</h3><ul><li>26.åˆ é™¤æ’åºæ•°ç»„ä¸­çš„é‡å¤é¡¹</li><li>283.ç§»åŠ¨é›¶</li><li>844.æ¯”è¾ƒå«é€€æ ¼çš„å­—ç¬¦ä¸²</li><li>977.æœ‰åºæ•°ç»„çš„å¹³æ–¹</li></ul><h2 id="3ã€209-é•¿åº¦æœ€å°çš„å­æ•°ç»„"><a href="#3ã€209-é•¿åº¦æœ€å°çš„å­æ•°ç»„" class="headerlink" title="3ã€209.é•¿åº¦æœ€å°çš„å­æ•°ç»„"></a>3ã€209.é•¿åº¦æœ€å°çš„å­æ•°ç»„</h2><p>ä¸‰ç§æ–¹æ³•</p><h3 id="1ã€æš´åŠ›æ³•-1"><a href="#1ã€æš´åŠ›æ³•-1" class="headerlink" title="1ã€æš´åŠ›æ³•"></a>1ã€æš´åŠ›æ³•</h3><p>ä¸¤å±‚forå¾ªç¯ï¼Œæ¯éå†ä¸€ä¸ªï¼Œå°±å‘åç›¸åŠ æ‰¾åˆ°å¤§äºtargetçš„ç´¢å¼•å¹¶è®°å½•ï¼ŒåŒæ—¶ä¿ç•™ä¸€ä¸ªresæ¥è®°å½•æœ€å°å€¼</p><p>å½“ç„¶æ—¶é—´å¤æ‚åº¦æ˜¯æ¯”è¾ƒé«˜çš„ï¼ŒO(n*2)</p><h3 id="2ã€æ»‘åŠ¨çª—å£"><a href="#2ã€æ»‘åŠ¨çª—å£" class="headerlink" title="2ã€æ»‘åŠ¨çª—å£"></a>2ã€æ»‘åŠ¨çª—å£</h3><p>å®šä¹‰ä¸¤ä¸ªæŒ‡é’ˆstartå’Œendï¼Œå¹¶è®°å½•sumï¼Œè‹¥æ˜¯sum &lt; targetï¼Œå°±å°†endå¾€å++ï¼›è‹¥æ˜¯sum &gt;= targetï¼Œå°±å°†start++ï¼Œå¹¶å¯¹sumå’Œsizeåšç›¸åº”æ“ä½œ</p><p>ä»£ç å¦‚ä¸‹ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">while</span> (end &lt; nums.length) &#123;<br>     sum += nums[end];<br>     <span class="hljs-keyword">while</span> (sum &gt;= target) &#123;<br>     min = Math.min(min, end - start + <span class="hljs-number">1</span>);<br>        sum -= nums[start];<br>        start++;<br>     &#125;<br>     end++;<br>&#125;<br></code></pre></td></tr></table></figure><h3 id="3ã€ç›¸å…³é¢˜ç›®æ¨è-2"><a href="#3ã€ç›¸å…³é¢˜ç›®æ¨è-2" class="headerlink" title="3ã€ç›¸å…³é¢˜ç›®æ¨è"></a>3ã€ç›¸å…³é¢˜ç›®æ¨è</h3><ul><li><a href="https://leetcode.cn/problems/fruit-into-baskets/">904.æ°´æœæˆç¯®(opens new window)</a></li><li>==<a href="https://leetcode.cn/problems/minimum-window-substring/">76.æœ€å°è¦†ç›–å­ä¸²</a>==ã€ç»å…¸ã€‘</li></ul><h3 id="4ã€æ»‘åŠ¨çª—å£æ€»ç»“"><a href="#4ã€æ»‘åŠ¨çª—å£æ€»ç»“" class="headerlink" title="4ã€æ»‘åŠ¨çª—å£æ€»ç»“"></a>4ã€æ»‘åŠ¨çª—å£æ€»ç»“</h3><p>æ»‘åŠ¨çª—å£æœ‰æœ€å°æ»‘åŠ¨çª—å£æ¨¡æ¿å’Œæœ€å¤§æ»‘åŠ¨çª—å£æ¨¡æ¿ï¼Œå…·ä½“è¦æ±‚çœ‹é¢˜ç›®è¦æ±‚</p><p>æœ€å°æ»‘åŠ¨çª—å£æ¨¡æ¿ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">while</span> (j &lt; len)&#123;<br>    åˆ¤æ–­[i, j]æ˜¯å¦æ»¡è¶³æ¡ä»¶<br>    <span class="hljs-keyword">while</span> (æ»¡è¶³æ¡ä»¶)&#123;<br>        ä¸æ–­æ›´æ–°ç»“æœ(æ³¨æ„åœ¨<span class="hljs-keyword">while</span>å†…æ›´æ–°ï¼)<br>        i += <span class="hljs-number">1</span> ï¼ˆæœ€å¤§ç¨‹åº¦çš„å‹ç¼©iï¼Œä½¿å¾—æ»‘çª—å°½å¯èƒ½çš„å°ï¼‰<br>    &#125;<br>    j += <span class="hljs-number">1</span><br>&#125;<br></code></pre></td></tr></table></figure><p>å¦‚ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">while</span> (end &lt; nums.length) &#123;<br>     sum += nums[end];<br>     <span class="hljs-keyword">while</span> (sum &gt;= target) &#123;<br>     min = Math.min(min, end - start + <span class="hljs-number">1</span>);<br>        sum -= nums[start];<br>        start++;<br>     &#125;<br>     end++;<br>&#125;<br></code></pre></td></tr></table></figure><p>ä»£è¡¨é¢˜ç›®ä¸º209</p><p>æœ€å¤§æ»‘åŠ¨çª—å£æ¨¡æ¿ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">while</span> (j &lt; len)&#123;<br>    åˆ¤æ–­[i, j]æ˜¯å¦æ»¡è¶³æ¡ä»¶<br>    <span class="hljs-keyword">while</span> (ä¸æ»¡è¶³æ¡ä»¶)&#123;<br>        i += <span class="hljs-number">1</span> ï¼ˆæœ€å¤§ç¨‹åº¦çš„å‹ç¼©iï¼Œä½¿å¾—æ»‘çª—å°½å¯èƒ½çš„å°ï¼‰<br>    &#125;<br>    ä¸æ–­æ›´æ–°ç»“æœ(æ³¨æ„åœ¨<span class="hljs-keyword">while</span>å†…æ›´æ–°ï¼)<br>    j += <span class="hljs-number">1</span><br>&#125;<br></code></pre></td></tr></table></figure><p>å¦‚ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">while</span> (right &lt; fruits.length) &#123;<br>    map.put(fruits[right], map.getOrDefault(fruits[right], <span class="hljs-number">0</span>) + <span class="hljs-number">1</span>);<br>    <span class="hljs-keyword">while</span> (map.size() &gt; <span class="hljs-number">2</span>) &#123;<br>    <span class="hljs-comment">// countä¸ºæ°´æœæœ€å¤§æ•°ç›®ï¼Œå½“mapå¤§å°è¶…è¿‡2æ—¶ï¼Œæ»‘çª—éœ€å‰ç§»left;</span><br>       map.put(fruits[left], map.get(fruits[left]) - <span class="hljs-number">1</span>);<br>       <span class="hljs-keyword">if</span> (map.get(fruits[left]) == <span class="hljs-number">0</span>) &#123;<br>            map.remove(fruits[left]);<br>       &#125;<br>       left++;<br>    &#125;<br>    count = Math.max(count, right - left + <span class="hljs-number">1</span>);<br>    right++;<br>&#125;<br></code></pre></td></tr></table></figure><p>ä»£è¡¨é¢˜ç›®ä¸º904</p><h2 id="4ã€59-èºæ—‹çŸ©é˜µII"><a href="#4ã€59-èºæ—‹çŸ©é˜µII" class="headerlink" title="4ã€59.èºæ—‹çŸ©é˜µII"></a>4ã€59.èºæ—‹çŸ©é˜µII</h2><p>æ­£ç¡®è§£å†³äºŒåˆ†æ³•æ˜¯åšæŒå¾ªç¯ä¸å˜é‡åŸåˆ™ï¼Œè¿™é“é¢˜ä¹Ÿæ˜¯ä¸€æ ·ï¼Œè¦ä¹ˆä¸€ç›´å·¦é—­å³å¼€ï¼Œè¦ä¹ˆä¸€ç›´å·¦é—­å³é—­ã€‚</p><p>æ¨¡æ‹Ÿé¡ºæ—¶é’ˆç”»çŸ©é˜µçš„è¿‡ç¨‹:</p><ul><li>å¡«å……ä¸Šè¡Œä»å·¦åˆ°å³</li><li>å¡«å……å³åˆ—ä»ä¸Šåˆ°ä¸‹</li><li>å¡«å……ä¸‹è¡Œä»å³åˆ°å·¦</li><li>å¡«å……å·¦åˆ—ä»ä¸‹åˆ°ä¸Š</li></ul><p>ç”±æ­¤å¯è§ï¼Œéœ€è¦å®šä¹‰çš„å˜é‡æœ‰ï¼š</p><ol><li>è¿”å›çš„æ•°ç»„</li><li>å¾ªç¯æ¬¡æ•°ï¼Œæ¯ä¸€ç¯ä¸ºä¸€æ¬¡ï¼Œå®šä¹‰è¿™ä¸ªçš„ç›®çš„æ˜¯æ§åˆ¶è¾¹ç•Œï¼Œå› ä¸ºæœ‰çš„æ—¶å€™éœ€è¦èµ‹å€¼n-1æ¬¡ï¼Œæœ‰çš„æ—¶å€™éœ€è¦èµ‹å€¼n-2æ¬¡ï¼Œè¿™ä¸ªæ—¶å€™å°±è¦ç”¨åˆ°å¾ªç¯æ¬¡æ•°</li><li>å®šä¹‰èµ·å§‹å˜é‡startï¼Œæ¯å¾ªç¯ä¸€åœˆå°±ä»¤start++</li><li>å®šä¹‰å…¨å±€å˜é‡i, j</li></ol><h3 id="ç›¸å…³é¢˜ç›®æ¨è"><a href="#ç›¸å…³é¢˜ç›®æ¨è" class="headerlink" title="ç›¸å…³é¢˜ç›®æ¨è"></a>ç›¸å…³é¢˜ç›®æ¨è</h3><ul><li>54.èºæ—‹çŸ©é˜µ</li><li>å‰‘æŒ‡Offer 29.é¡ºæ—¶é’ˆæ‰“å°çŸ©é˜µ</li></ul>]]></content>
    
    
    <categories>
      
      <category>ç®—æ³•</category>
      
    </categories>
    
    
    <tags>
      
      <tag>java</tag>
      
      <tag>æ•°ç»„</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>è¯»ä¹¦ç¬”è®°</title>
    <link href="/2022/09/27/du-shu-bi-ji/"/>
    <url>/2022/09/27/du-shu-bi-ji/</url>
    
    <content type="html"><![CDATA[<div class="hbe hbe-container" id="hexo-blog-encrypt" data-wpm="Oh, this is an invalid password. Check and try again, please." data-whm="OOPS, these decrypted content may changed, but you can still have a look.">  <script id="hbeData" type="hbeData" data-hmacdigest="cf0279ad49910541a41438567238882f062868c64d59367d913b7c1bd3b3089e">8f1cbd128789af83855b0654c56affebf269f8ebeab30c7a77e0ad4ee53534abf8127398457cf86c0a224b90ebb981babd3b9be897d78041891daa3f617b8cab38db2f0c759631a4f9efd0d4ab8245ba4a7bbc95f81300c612cd4b417dd90c18c2f1d33e07c6f22142c1f6c0339b43fac635fd6003dc5c96eac2d9c9154950d88ec5127277c234aba901eae0d89636e089f1ea5aad9bb29276f48a4cbd272f9348bc04b52e4c0934df487d08c5d4bbdbc18609161b31bc9b5d227f82f63e6cad564fecd7f44940232104f77c4f87776b435c4d888461eff3c179bb40b2eceb43c359cfa9d316b5f35959cf71140812f656dd0e34e0abdefbae6c8e935303136616c7bcd3f3ae4557753a25aecf793c7851a10d84c1ad923e035a9166126ce6165a746b2af10cc1084861baff6548cfeab4679837e4572ea4be1cbabf72bf4423a3e0e2f5f19d29f9f10282ea04fc5694262a051b1ccfcbd7c0ed58a1b6c0db1d0559bd7cd6c4f219bf2efc3c09d0bc46fe60da3d1199441223587e1e62639384b09630b4d285cf38e5a8c73084ecf0a26246e998e8c90219bfa1fd52525aa73fcde9de5a09c565a3c57e1aa69a13fbd0809424f4e7d367a7373d34976d33b59022effc1b3ca633a6f323756622e56d7bcaa5e0cf088c4ff41b9967ce307568439244dc2845f74dd570960e0c183b117f00ff2c7494c6d922e41e1d15168eee6bc62a6b4fbf200b272144858da49b4752fd88524c6a1a6c89504280af5a2608594867f353c620568e5d0e2e902f989049f34c8b308738e3cbd3d6b339b7c095ae55db010b474c5d16d22cf782254c722bc3b199e07d0a758b79ab381b1311d01b1c769da858b98da8301e0f23b47e04fc2d5090b18e9554f683b7310a547ec15c94951d2570e0d12d6f177a808bde9925a23e47e450d44f7f0f781c2689aa7a480d06b2357e8ea2b95a01c07adda1860efaaeb0aace985527a0a9fa712af992b9dcd912c78169bf9e7018f129a1b2cecf2fecb165f486160922f35688c82eed9cdb34bc10eb2fcd7a756493a0f844d6fd08f9d4014758426820e23847f383b966cde71a04f0f6b87f14a5b8a0fca77557a306e7481979709f5c5c225f0f084bbef65f70be04c0fde7dfbfb1dfc6f14cf44aaf2b5b95c4122686c8065a6977ed355f8f4e648a05cb0ea6dc0643bdc2fc1d2de57dfd4089d7f32a8dd76766df60ee4cfd88e24721f11292f5b1f502f1a72f0497ef36f3c1ac4cb3ee17083248d8c8ca998608701ac0dd8139425e1a9b6f99cf9c3eeac2a06aed83b38a20f73b84b0090a2b8a36c99272737f93885174ab1e87cefdb9a3f2fdffa933e4c795e2adf3903c845ecda24f99e75be87e7b8bf4dbf5ac1226e097ded11ddf7a8f63de1c5e822228fc9b84ed261c449983b82e175c2c5b096d54929dc1c189c73eacd8af898780bd5cca8258fc2cc5abc5b9b369af006f9504e54c82ff73a5298e247417397c5d1c4664a066f1fce2f9801dd32139557941437d8acb596bf3dfd58345e92e9813efdfab7600a35f7013502f6d2cb14539ebe1b0f151ad3920b0917d463a10aceb17a3ff3b8b922f00a09c05d72a5a7a0880e82eaf523458a6d474a2c6e98d0c0c6340f1c9a2c7486af0b97237050ceb7e40c73d0346d79b96ddb3374b14528c391905fd3b7c22b6b58c9f17e7f28404686744d8e9753cf06aca1ca3fcee9142110970d9d602147d4c50501572bbb66203231abffa86dd7d8909e60c3b003addd350272effe4d90625dc7a8d091e8e4ab7c44461419a80cd87dbed723b88a5c4d0d45fef83449c00c943e997f780c3917cd142083e4d7f58f96b78fd4a61b0d666904e9b9e9ed6f9ed65fb799df4820eabc22406f397d783884f0cd8dce42f4ced411fe1f77619708683fbb8672c2d234aa0d81942324cbd0f234622d6776050a137a57025533f1ed330048344113378de2d209a607d61496caf353f958d267f5db13126d8b812ad3139b8a3cafa05ab29488aa907e9f6e8349d9c57cb045aff4d0aaaf20dcd916ff7ffae8cd6a13249c0594c0240e8b170138c56e7536a9ca0becfef3bf9b70fcaa703d9b10359f3d43375a9d419c113fe8cdaebbde1a9930ef2fc0f24b4527ecaa49a1110cd6091463132fbd2abbc880408369060d5c8c69d39a56f98aa26bfef8fd40247b44041b3e57b33afde1865b83360076e6b00b21b5f0722e1b63b5f6a0addc0e2a53bd4ac6161f0fb705dad36ffde6a9ae1e0faabd85586a5b8ee765e473245ad86c1b4edcf809fc70ec8f77a7204c4090fc9048f34d67c8160b1c95c17d2da5af81581cc237b8a760d8e4d048149f3e942fc67ee7cc854a37636bf1b6e04523f3833a492d2849f705e946de1cecf99ad61ad87df6ee1951b63311f031bdc223d2355091ed4ee9ae9d49e0c95fd307a798d749a4fa6c7205411f649e9e6a90282208cfd4e6fcca058a73cee157ab2c60a020ead4bf2550f2e310d2035a303771a7aea9b44af1880659f53c21ed3cd4def1024817f273e980268c34df8ce0c671ce28f25197f907c9076561ae8c7fb3280e2ae4253456cc5cfbf323f72bf400eea4c5d3e0c1a27caea441977e1d347713987c87770b563749621f376713c26500fc16b0aadd86ac88abdf359bc873ea7f8f03a129d71d9963d1d7de394a4671fbf5adb179a2f211a2bca9e66c138e008ff6e80c793ba8e5fcc8624e932865d3f8decf3aadc682ec981171f9938cb177bcb8a3746438d78003b054298fbad9e79e8be90159351cccd96c2aa103e568440863da5b732619bd417bac1ab5ccf81ffca59856b1e144059b40b0ae30b4122202b9cd0763909af9672073cb99034a86ff84a5839f773b41c59ad4565f8eeb645ca911efaf0d0beacd4dab3b7e396b0c5171a4332d002f7e910590fef6c8fe879e7fd83b641ae32aa27adc73d02d4ae3a16ef4bcb376c6171cc76004458e940d02828a37663cf4e34309f52aba8ee30cc624b6d38fd487727a9cd642a9c16314fe91dd48c5d4566c9baf6a3d8ff1db8ae4acc89b2a3aba5bb82bb8526c3687b49ce564769ac0e3d509283f067f036593a4d3370add7239e3fd5e5b3c601b92df1e46a5f9339377b955ed9e58b52aedcf248fbfc2f6c88a5945a721cc2d70d67252e7d70571b66539f811b93c6b8e74e447dad4e63a3fa76c9de17685b5f58539ef6f315632ecff98740d3344f5654f8ae841a294f34b2b80c766d670749d8e31b89814b78801113b14efa0f9f24c669dcb2c93692c00f77ce56b94759adcf4ca3b852ad9033875439288c99a723c0f9b032a554cefbfbbfa63405cdad9b10917dc28dfde6dcb61f344e857caebf1c166145755d0d7429bd3419a801dadc4b4884b7fbed226a76001a2548cdbe63e73c0986e4a74c28ff6e6964e71368c965dc2ef9dd91af4e4f2a4f3f7fcba28eac94c3ac7d851f7bb1255ee28835697e0a6632626ea3f4d27100054d3bb197534fcc0f2dbe868d79f2d7c7a77d5d92e56938ba17fd8d09cfde0f66177a261b61e7d6cac0fbf160f0092f24c1f22702476fa895f2490442717a6d747ee38cb742634a9e527dc128a5bda7e91d2ee0d3fe69c0d4ab0141bf57ccf551cb91b9cce369040a765717b650d3a6f43eceb072e82561f9b8962aa2b71d21fe61882e63371bd56cfa5f52620f673c8c34552e2636b5c4811a81d2d4c246c036b8a988a2dd73f97df70b5bc2e2ff06cac391d69196a40710e30f9f010d5cc6503d6f0b2d81eea1f9f43c0573b601badeb71b421235ff2c4380fd969cf0f2315275fe50185c2f482d149c7170c8bea3f21a12f161a9ce93608c6a76154e9b73ccc10c03e24ed43cdb5f632351be8cbee7cf5e14b2cdeb28ceeb2da842ed0531e42a97bb6997e0430a3fc4a1a74f3b343e4b2e8534e5e277294b95429d21d9df258858af26e6ce94378a7c0e368a52d6d2f3674698da6cac9b3635b3dafbf40895845142c102ce09cbb726722ea63526c143c37e47456d2825b3e6bd1364656104f42ef5509a103bec2f4acb093371c81caf74b23f386914fc7f59b8ccc3da8fe332f0aad11411b8354309a437b1213f2fe52e53d435f209875d80dd36d46f0e7d64cd5b9cb30bc731da8306a951ab82c489aaca1a36c857bb4ca2ae20fbfd942d374184c0cea3d89d9c49635c2b8b36adcd9c680f099434fbf3df68bcb2af7b1bec6754c503b8bc9ce006353f8b686bad96048dabde4fa9edfb3f7b7feb5458e9ce71861a507ca7a90365c55a2bd5becda4bc37d905c3dbd9061ef0a244e1de7eae13f5714b3096b94105754ae5226cee6a9538ee4e0e4fb512df5289f8da7265a1e46f140595fde6155c904ca3928103a51a943d74a796b952ccc03319f2b8aafa65eb9cd2d9a13f8e57f21e47f9b4226bfc0938491b69630bbd43a01c846d46cc8735335c25895c3baf4a1d6ea760870a39277cb9710ef04e5279c1d149f592a0858844f8900ca34b838188c460381db0374f162f075eb370537ca3391d33e4dcbdac0e7d645e94cc9050438290c40966634117393d85031f95e338edbc3e27273b1e0a65e253d0db09b355b838b389d927b240fa3b7861443b3fe416b78c8848d6d84f63e915ba793704d7ec9e1f872594c74ebaae65aa5d6f0496</script>  <div class="hbe hbe-content">    <div class="hbe hbe-input hbe-input-default">      <input class="hbe hbe-input-field hbe-input-field-default" type="password" id="hbePass">      <label class="hbe hbe-input-label hbe-input-label-default" for="hbePass">        <span class="hbe hbe-input-label-content hbe-input-label-content-default">Hey, password is required here.</span>      </label>    </div>  </div></div><script data-pjax src="/lib/hbe.js"></script><link href="/css/hbe.style.css" rel="stylesheet" type="text/css">]]></content>
    
    
    <categories>
      
      <category>è¯»ä¹¦ç¬”è®°</category>
      
    </categories>
    
    
    <tags>
      
      <tag>è¯»ä¹¦ç¬”è®°</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>06-è¡Œä¸ºå‹-è§‚å¯Ÿè€…-æ¨¡æ¿</title>
    <link href="/2022/09/27/06-xing-wei-xing-guan-cha-zhe-mo-ban/"/>
    <url>/2022/09/27/06-xing-wei-xing-guan-cha-zhe-mo-ban/</url>
    
    <content type="html"><![CDATA[<h1 id="ä¸€ã€è§‚å¯Ÿè€…æ¨¡å¼ã€å¸¸ç”¨ã€‘"><a href="#ä¸€ã€è§‚å¯Ÿè€…æ¨¡å¼ã€å¸¸ç”¨ã€‘" class="headerlink" title="ä¸€ã€è§‚å¯Ÿè€…æ¨¡å¼ã€å¸¸ç”¨ã€‘"></a>ä¸€ã€è§‚å¯Ÿè€…æ¨¡å¼ã€å¸¸ç”¨ã€‘</h1><ol><li>23ç§è®¾è®¡æ¨¡å¼åˆ†ä¸ºåˆ›å»ºå‹ã€ç»“æ„å‹ã€è¡Œä¸ºå‹ã€‚åˆ›å»ºå‹è®¾è®¡æ¨¡å¼ä¸»è¦è§£å†³â€œå¯¹è±¡çš„åˆ›å»ºâ€é—®é¢˜ï¼Œç»“æ„å‹è®¾è®¡æ¨¡å¼ä¸»è¦è§£å†³â€œç±»æˆ–å¯¹è±¡çš„ç»„åˆæˆ–ç»„è£…â€é—®é¢˜ï¼Œé‚£è¡Œä¸ºå‹è®¾è®¡æ¨¡å¼ä¸»è¦è§£å†³çš„å°±æ˜¯â€œç±»æˆ–å¯¹è±¡ä¹‹é—´çš„äº¤äº’â€é—®é¢˜ã€‚</li><li>è¡Œä¸ºå‹è®¾è®¡æ¨¡å¼æ¯”è¾ƒå¤šï¼Œæœ‰ 11 ä¸ªï¼Œå‡ ä¹å äº† 23 ç§ç»å…¸è®¾è®¡æ¨¡å¼çš„ä¸€åŠã€‚å®ƒä»¬åˆ†åˆ«æ˜¯ï¼šè§‚å¯Ÿè€…æ¨¡å¼ã€æ¨¡æ¿æ¨¡å¼ã€ç­–ç•¥æ¨¡å¼ã€èŒè´£é“¾æ¨¡å¼ã€çŠ¶æ€æ¨¡å¼ã€è¿­ä»£å™¨æ¨¡å¼ã€è®¿é—®è€…æ¨¡å¼ã€å¤‡å¿˜å½•æ¨¡å¼ã€å‘½ä»¤æ¨¡å¼ã€è§£é‡Šå™¨æ¨¡å¼ã€ä¸­ä»‹æ¨¡å¼ã€‚</li><li>æ ¹æ®åº”ç”¨åœºæ™¯çš„ä¸åŒï¼Œè§‚å¯Ÿè€…æ¨¡å¼ä¼šå¯¹åº”ä¸åŒçš„ä»£ç å®ç°æ–¹å¼ï¼šæœ‰åŒæ­¥é˜»å¡çš„å®ç°æ–¹å¼ï¼Œä¹Ÿæœ‰å¼‚æ­¥éé˜»å¡çš„å®ç°æ–¹å¼ï¼›æœ‰è¿›ç¨‹å†…çš„å®ç°æ–¹å¼ï¼Œä¹Ÿæœ‰è·¨è¿›ç¨‹çš„å®ç°æ–¹å¼ã€‚</li></ol><h2 id="1ã€Demoæ¡ˆä¾‹-å¤©æ°”é¢„æŠ¥"><a href="#1ã€Demoæ¡ˆä¾‹-å¤©æ°”é¢„æŠ¥" class="headerlink" title="1ã€Demoæ¡ˆä¾‹-å¤©æ°”é¢„æŠ¥"></a>1ã€Demoæ¡ˆä¾‹-å¤©æ°”é¢„æŠ¥</h2><ol><li>æ°”è±¡ç«™å¯ä»¥å°†æ¯å¤©æµ‹é‡åˆ°çš„æ¸©åº¦ï¼Œæ¹¿åº¦ï¼Œæ°”å‹ç­‰ç­‰ä»¥å…¬å‘Šçš„å½¢å¼å‘å¸ƒå‡ºå»(æ¯”å¦‚å‘å¸ƒåˆ°è‡ªå·±çš„ç½‘ç«™æˆ–ç¬¬ä¸‰æ–¹)ã€‚</li><li>éœ€è¦<strong>è®¾è®¡å¼€æ”¾å‹</strong> <strong>API</strong>ï¼Œä¾¿äº<strong>å…¶ä»–ç¬¬ä¸‰æ–¹ä¹Ÿèƒ½æ¥å…¥æ°”è±¡ç«™è·å–æ•°æ®</strong>ã€‚</li><li>æä¾›æ¸©åº¦ã€æ°”å‹å’Œæ¹¿åº¦çš„æ¥å£</li><li>æµ‹é‡æ•°æ®æ›´æ–°æ—¶ï¼Œè¦èƒ½å®æ—¶çš„é€šçŸ¥ç»™ç¬¬ä¸‰æ–¹</li></ol><h3 id="1ã€æ–¹æ¡ˆä¸€"><a href="#1ã€æ–¹æ¡ˆä¸€" class="headerlink" title="1ã€æ–¹æ¡ˆä¸€"></a>1ã€æ–¹æ¡ˆä¸€</h3><p><img src="/2022/09/27/06-xing-wei-xing-guan-cha-zhe-mo-ban/image-20220930151033041.png" alt="ä¼ ç»Ÿè®¾è®¡æ–¹æ¡ˆ"></p><h4 id="1ã€WeatherData"><a href="#1ã€WeatherData" class="headerlink" title="1ã€WeatherData"></a>1ã€WeatherData</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-comment">/**</span><br><span class="hljs-comment"> * ç±»æ˜¯æ ¸å¿ƒ</span><br><span class="hljs-comment"> * 1. åŒ…å«æœ€æ–°çš„å¤©æ°”æƒ…å†µä¿¡æ¯ </span><br><span class="hljs-comment"> * 2. å«æœ‰ CurrentConditions å¯¹è±¡</span><br><span class="hljs-comment"> * 3. å½“æ•°æ®æœ‰æ›´æ–°æ—¶ï¼Œå°±ä¸»åŠ¨çš„è°ƒç”¨   CurrentConditionså¯¹è±¡updateæ–¹æ³•(å« display), è¿™æ ·ä»–ä»¬ï¼ˆæ¥å…¥æ–¹ï¼‰å°±çœ‹åˆ°æœ€æ–°çš„ä¿¡æ¯</span><br><span class="hljs-comment"> *</span><br><span class="hljs-comment"> */</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">WeatherData</span> &#123;<br>   <span class="hljs-keyword">private</span> <span class="hljs-type">float</span> temperatrue;<br>   <span class="hljs-keyword">private</span> <span class="hljs-type">float</span> pressure;<br>   <span class="hljs-keyword">private</span> <span class="hljs-type">float</span> humidity;<br>   <span class="hljs-keyword">private</span> CurrentConditions currentConditions;<br>   <span class="hljs-comment">//åŠ å…¥æ–°çš„ç¬¬ä¸‰æ–¹</span><br><br>   <span class="hljs-keyword">public</span> <span class="hljs-title function_">WeatherData</span><span class="hljs-params">(CurrentConditions currentConditions)</span> &#123;<br>      <span class="hljs-built_in">this</span>.currentConditions = currentConditions;<br>   &#125;<br><br>   <span class="hljs-keyword">public</span> <span class="hljs-type">float</span> <span class="hljs-title function_">getTemperature</span><span class="hljs-params">()</span> &#123;<br>      <span class="hljs-keyword">return</span> temperatrue;<br>   &#125;<br><br>   <span class="hljs-keyword">public</span> <span class="hljs-type">float</span> <span class="hljs-title function_">getPressure</span><span class="hljs-params">()</span> &#123;<br>      <span class="hljs-keyword">return</span> pressure;<br>   &#125;<br><br>   <span class="hljs-keyword">public</span> <span class="hljs-type">float</span> <span class="hljs-title function_">getHumidity</span><span class="hljs-params">()</span> &#123;<br>      <span class="hljs-keyword">return</span> humidity;<br>   &#125;<br><br>   <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">dataChange</span><span class="hljs-params">()</span> &#123;<br>      <span class="hljs-comment">//è°ƒç”¨ æ¥å…¥æ–¹çš„ update</span><br>      currentConditions.update(getTemperature(), getPressure(), getHumidity());<br>   &#125;<br><br>   <span class="hljs-comment">//å½“æ•°æ®æœ‰æ›´æ–°æ—¶ï¼Œå°±è°ƒç”¨ setData</span><br>   <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">setData</span><span class="hljs-params">(<span class="hljs-type">float</span> temperature, <span class="hljs-type">float</span> pressure, <span class="hljs-type">float</span> humidity)</span> &#123;<br>      <span class="hljs-built_in">this</span>.temperatrue = temperature;<br>      <span class="hljs-built_in">this</span>.pressure = pressure;<br>      <span class="hljs-built_in">this</span>.humidity = humidity;<br>      <span class="hljs-comment">//è°ƒç”¨dataChangeï¼Œ å°†æœ€æ–°çš„ä¿¡æ¯ æ¨é€ç»™ æ¥å…¥æ–¹ currentConditions</span><br>      dataChange();<br>   &#125;<br>&#125;<br></code></pre></td></tr></table></figure><h4 id="2ã€CurrentConditions"><a href="#2ã€CurrentConditions" class="headerlink" title="2ã€CurrentConditions"></a>2ã€CurrentConditions</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-comment">/**</span><br><span class="hljs-comment"> * æ˜¾ç¤ºå½“å‰å¤©æ°”æƒ…å†µï¼ˆå¯ä»¥ç†è§£æˆæ˜¯æ°”è±¡ç«™è‡ªå·±çš„ç½‘ç«™ï¼‰</span><br><span class="hljs-comment"> *</span><br><span class="hljs-comment"> */</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">CurrentConditions</span> &#123;<br>   <span class="hljs-comment">// æ¸©åº¦ï¼Œæ°”å‹ï¼Œæ¹¿åº¦</span><br>   <span class="hljs-keyword">private</span> <span class="hljs-type">float</span> temperature;<br>   <span class="hljs-keyword">private</span> <span class="hljs-type">float</span> pressure;<br>   <span class="hljs-keyword">private</span> <span class="hljs-type">float</span> humidity;<br><br>   <span class="hljs-comment">//æ›´æ–° å¤©æ°”æƒ…å†µï¼Œæ˜¯ç”± WeatherData æ¥è°ƒç”¨ï¼Œæˆ‘ä½¿ç”¨æ¨é€æ¨¡å¼</span><br>   <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">update</span><span class="hljs-params">(<span class="hljs-type">float</span> temperature, <span class="hljs-type">float</span> pressure, <span class="hljs-type">float</span> humidity)</span> &#123;<br>      <span class="hljs-built_in">this</span>.temperature = temperature;<br>      <span class="hljs-built_in">this</span>.pressure = pressure;<br>      <span class="hljs-built_in">this</span>.humidity = humidity;<br>      display();<br>   &#125;<br><br>   <span class="hljs-comment">//æ˜¾ç¤º</span><br>   <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">display</span><span class="hljs-params">()</span> &#123;<br>      System.out.println(<span class="hljs-string">&quot;***Today mTemperature: &quot;</span> + temperature + <span class="hljs-string">&quot;***&quot;</span>);<br>      System.out.println(<span class="hljs-string">&quot;***Today mPressure: &quot;</span> + pressure + <span class="hljs-string">&quot;***&quot;</span>);<br>      System.out.println(<span class="hljs-string">&quot;***Today mHumidity: &quot;</span> + humidity + <span class="hljs-string">&quot;***&quot;</span>);<br>   &#125;<br>&#125;<br></code></pre></td></tr></table></figure><h4 id="3ã€Client"><a href="#3ã€Client" class="headerlink" title="3ã€Client"></a>3ã€Client</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Client</span> &#123;<br>  <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span> &#123;<br>    <span class="hljs-comment">// åˆ›å»ºæ¥å…¥æ–¹ currentConditions</span><br>    <span class="hljs-type">CurrentConditions</span> <span class="hljs-variable">currentConditions</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">CurrentConditions</span>();<br>    <span class="hljs-comment">// åˆ›å»º WeatherData å¹¶å°† æ¥å…¥æ–¹ currentConditions ä¼ é€’åˆ° WeatherDataä¸­</span><br>    <span class="hljs-type">WeatherData</span> <span class="hljs-variable">weatherData</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">WeatherData</span>(currentConditions);<br><br>    <span class="hljs-comment">// æ›´æ–°å¤©æ°”æƒ…å†µ</span><br>    weatherData.setData(<span class="hljs-number">30</span>, <span class="hljs-number">150</span>, <span class="hljs-number">40</span>);<br><br>    <span class="hljs-comment">// å¤©æ°”æƒ…å†µå˜åŒ–</span><br>    System.out.println(<span class="hljs-string">&quot;============å¤©æ°”æƒ…å†µå˜åŒ–=============&quot;</span>);<br>    weatherData.setData(<span class="hljs-number">40</span>, <span class="hljs-number">160</span>, <span class="hljs-number">20</span>);<br>  &#125;<br>&#125;<br></code></pre></td></tr></table></figure><h4 id="4ã€é—®é¢˜åˆ†æ"><a href="#4ã€é—®é¢˜åˆ†æ" class="headerlink" title="4ã€é—®é¢˜åˆ†æ"></a>4ã€é—®é¢˜åˆ†æ</h4><ol><li>å…¶ä»–ç¬¬ä¸‰æ–¹æ¥å…¥æ°”è±¡ç«™è·å–æ•°æ®çš„é—®é¢˜ï¼Œæ— æ³•åœ¨è¿è¡Œæ—¶åŠ¨æ€çš„æ·»åŠ ç¬¬ä¸‰æ–¹ (æ–°æµªç½‘ç«™)</li><li>è¿å ocp åŸåˆ™ï¼Œå½“åŠ å…¥ç¬¬ä¸‰æ–¹æ—¶ï¼Œéœ€è¦ä¿®æ”¹WeatherDataä»£ç ï¼Œä¸åˆ©äºç»´æŠ¤ã€‚</li></ol><h3 id="2ã€è§‚å¯Ÿè€…æ¨¡å¼æ–¹æ¡ˆ"><a href="#2ã€è§‚å¯Ÿè€…æ¨¡å¼æ–¹æ¡ˆ" class="headerlink" title="2ã€è§‚å¯Ÿè€…æ¨¡å¼æ–¹æ¡ˆ"></a>2ã€è§‚å¯Ÿè€…æ¨¡å¼æ–¹æ¡ˆ</h3><h4 id="1ã€Subjectã€æ¥å£ã€‘"><a href="#1ã€Subjectã€æ¥å£ã€‘" class="headerlink" title="1ã€Subjectã€æ¥å£ã€‘"></a>1ã€Subjectã€æ¥å£ã€‘</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-comment">//æ¥å£, è®©WeatherData æ¥å®ç° </span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">interface</span> <span class="hljs-title class_">Subject</span> &#123;<br>   <br>   <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">registerObserver</span><span class="hljs-params">(Observer o)</span>;<br>   <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">removeObserver</span><span class="hljs-params">(Observer o)</span>;<br>   <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">notifyObservers</span><span class="hljs-params">()</span>;<br>&#125;<br></code></pre></td></tr></table></figure><h4 id="2ã€Observerã€æ¥å£ã€‘"><a href="#2ã€Observerã€æ¥å£ã€‘" class="headerlink" title="2ã€Observerã€æ¥å£ã€‘"></a>2ã€Observerã€æ¥å£ã€‘</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-comment">//è§‚å¯Ÿè€…æ¥å£ï¼Œæœ‰è§‚å¯Ÿè€…æ¥å®ç°</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">interface</span> <span class="hljs-title class_">Observer</span> &#123;<br><br>   <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">update</span><span class="hljs-params">(<span class="hljs-type">float</span> temperature, <span class="hljs-type">float</span> pressure, <span class="hljs-type">float</span> humidity)</span>;<br>&#125;<br></code></pre></td></tr></table></figure><h4 id="3ã€WeatherData"><a href="#3ã€WeatherData" class="headerlink" title="3ã€WeatherData"></a>3ã€WeatherData</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">WeatherData</span> <span class="hljs-keyword">implements</span> <span class="hljs-title class_">Subject</span> &#123;<br>   <span class="hljs-keyword">private</span> <span class="hljs-type">float</span> temperatrue;<br>   <span class="hljs-keyword">private</span> <span class="hljs-type">float</span> pressure;<br>   <span class="hljs-keyword">private</span> <span class="hljs-type">float</span> humidity;<br>   <span class="hljs-comment">//è§‚å¯Ÿè€…é›†åˆ</span><br>   <span class="hljs-keyword">private</span> ArrayList&lt;Observer&gt; observers;<br>   <br>   <span class="hljs-comment">//åŠ å…¥æ–°çš„ç¬¬ä¸‰æ–¹</span><br><br>   <span class="hljs-keyword">public</span> <span class="hljs-title function_">WeatherData</span><span class="hljs-params">()</span> &#123;<br>      observers = <span class="hljs-keyword">new</span> <span class="hljs-title class_">ArrayList</span>&lt;Observer&gt;();<br>   &#125;<br><br>   <span class="hljs-keyword">public</span> <span class="hljs-type">float</span> <span class="hljs-title function_">getTemperature</span><span class="hljs-params">()</span> &#123;<br>      <span class="hljs-keyword">return</span> temperatrue;<br>   &#125;<br><br>   <span class="hljs-keyword">public</span> <span class="hljs-type">float</span> <span class="hljs-title function_">getPressure</span><span class="hljs-params">()</span> &#123;<br>      <span class="hljs-keyword">return</span> pressure;<br>   &#125;<br><br>   <span class="hljs-keyword">public</span> <span class="hljs-type">float</span> <span class="hljs-title function_">getHumidity</span><span class="hljs-params">()</span> &#123;<br>      <span class="hljs-keyword">return</span> humidity;<br>   &#125;<br><br>   <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">dataChange</span><span class="hljs-params">()</span> &#123;<br>      <span class="hljs-comment">//è°ƒç”¨ æ¥å…¥æ–¹çš„ update</span><br>      <br>      notifyObservers();<br>   &#125;<br><br>   <span class="hljs-comment">//å½“æ•°æ®æœ‰æ›´æ–°æ—¶ï¼Œå°±è°ƒç”¨ setData</span><br>   <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">setData</span><span class="hljs-params">(<span class="hljs-type">float</span> temperature, <span class="hljs-type">float</span> pressure, <span class="hljs-type">float</span> humidity)</span> &#123;<br>      <span class="hljs-built_in">this</span>.temperatrue = temperature;<br>      <span class="hljs-built_in">this</span>.pressure = pressure;<br>      <span class="hljs-built_in">this</span>.humidity = humidity;<br>      <span class="hljs-comment">//è°ƒç”¨dataChangeï¼Œ å°†æœ€æ–°çš„ä¿¡æ¯ æ¨é€ç»™ æ¥å…¥æ–¹ currentConditions</span><br>      dataChange();<br>   &#125;<br><br>   <span class="hljs-comment">//æ³¨å†Œä¸€ä¸ªè§‚å¯Ÿè€…</span><br>   <span class="hljs-meta">@Override</span><br>   <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">registerObserver</span><span class="hljs-params">(Observer o)</span> &#123;<br>      <span class="hljs-comment">// TODO Auto-generated method stub</span><br>      observers.add(o);<br>   &#125;<br><br>   <span class="hljs-comment">//ç§»é™¤ä¸€ä¸ªè§‚å¯Ÿè€…</span><br>   <span class="hljs-meta">@Override</span><br>   <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">removeObserver</span><span class="hljs-params">(Observer o)</span> &#123;<br>      <span class="hljs-comment">// TODO Auto-generated method stub</span><br>      <span class="hljs-keyword">if</span>(observers.contains(o)) &#123;<br>         observers.remove(o);<br>      &#125;<br>   &#125;<br><br>   <span class="hljs-comment">//éå†æ‰€æœ‰çš„è§‚å¯Ÿè€…ï¼Œå¹¶é€šçŸ¥</span><br>   <span class="hljs-meta">@Override</span><br>   <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">notifyObservers</span><span class="hljs-params">()</span> &#123;<br>      <span class="hljs-comment">// TODO Auto-generated method stub</span><br>      <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> <span class="hljs-variable">i</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>; i &lt; observers.size(); i++) &#123;<br>         observers.get(i).update(<span class="hljs-built_in">this</span>.temperatrue, <span class="hljs-built_in">this</span>.pressure, <span class="hljs-built_in">this</span>.humidity);<br>      &#125;<br>   &#125;<br>&#125;<br></code></pre></td></tr></table></figure><h4 id="4ã€CurrentConditions"><a href="#4ã€CurrentConditions" class="headerlink" title="4ã€CurrentConditions"></a>4ã€CurrentConditions</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">CurrentConditions</span> <span class="hljs-keyword">implements</span> <span class="hljs-title class_">Observer</span> &#123;<br><br>   <span class="hljs-comment">// æ¸©åº¦ï¼Œæ°”å‹ï¼Œæ¹¿åº¦</span><br>   <span class="hljs-keyword">private</span> <span class="hljs-type">float</span> temperature;<br>   <span class="hljs-keyword">private</span> <span class="hljs-type">float</span> pressure;<br>   <span class="hljs-keyword">private</span> <span class="hljs-type">float</span> humidity;<br><br>   <span class="hljs-comment">// æ›´æ–° å¤©æ°”æƒ…å†µï¼Œæ˜¯ç”± WeatherData æ¥è°ƒç”¨ï¼Œæˆ‘ä½¿ç”¨æ¨é€æ¨¡å¼</span><br>   <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">update</span><span class="hljs-params">(<span class="hljs-type">float</span> temperature, <span class="hljs-type">float</span> pressure, <span class="hljs-type">float</span> humidity)</span> &#123;<br>      <span class="hljs-built_in">this</span>.temperature = temperature;<br>      <span class="hljs-built_in">this</span>.pressure = pressure;<br>      <span class="hljs-built_in">this</span>.humidity = humidity;<br>      display();<br>   &#125;<br><br>   <span class="hljs-comment">// æ˜¾ç¤º</span><br>   <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">display</span><span class="hljs-params">()</span> &#123;<br>      System.out.println(<span class="hljs-string">&quot;***Today mTemperature: &quot;</span> + temperature + <span class="hljs-string">&quot;***&quot;</span>);<br>      System.out.println(<span class="hljs-string">&quot;***Today mPressure: &quot;</span> + pressure + <span class="hljs-string">&quot;***&quot;</span>);<br>      System.out.println(<span class="hljs-string">&quot;***Today mHumidity: &quot;</span> + humidity + <span class="hljs-string">&quot;***&quot;</span>);<br>   &#125;<br>&#125;<br></code></pre></td></tr></table></figure><h4 id="5ã€BaiduSite"><a href="#5ã€BaiduSite" class="headerlink" title="5ã€BaiduSite"></a>5ã€BaiduSite</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">BaiduSite</span> <span class="hljs-keyword">implements</span> <span class="hljs-title class_">Observer</span> &#123;<br><br>  <span class="hljs-comment">// æ¸©åº¦ï¼Œæ°”å‹ï¼Œæ¹¿åº¦</span><br>  <span class="hljs-keyword">private</span> <span class="hljs-type">float</span> temperature;<br>  <span class="hljs-keyword">private</span> <span class="hljs-type">float</span> pressure;<br>  <span class="hljs-keyword">private</span> <span class="hljs-type">float</span> humidity;<br><br>  <span class="hljs-comment">// æ›´æ–° å¤©æ°”æƒ…å†µï¼Œæ˜¯ç”± WeatherData æ¥è°ƒç”¨ï¼Œæˆ‘ä½¿ç”¨æ¨é€æ¨¡å¼</span><br>  <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">update</span><span class="hljs-params">(<span class="hljs-type">float</span> temperature, <span class="hljs-type">float</span> pressure, <span class="hljs-type">float</span> humidity)</span> &#123;<br>    <span class="hljs-built_in">this</span>.temperature = temperature;<br>    <span class="hljs-built_in">this</span>.pressure = pressure;<br>    <span class="hljs-built_in">this</span>.humidity = humidity;<br>    display();<br>  &#125;<br><br>  <span class="hljs-comment">// æ˜¾ç¤º</span><br>  <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">display</span><span class="hljs-params">()</span> &#123;<br>    System.out.println(<span class="hljs-string">&quot;===ç™¾åº¦ç½‘ç«™====&quot;</span>);<br>    System.out.println(<span class="hljs-string">&quot;***ç™¾åº¦ç½‘ç«™ æ°”æ¸© : &quot;</span> + temperature + <span class="hljs-string">&quot;***&quot;</span>);<br>    System.out.println(<span class="hljs-string">&quot;***ç™¾åº¦ç½‘ç«™ æ°”å‹: &quot;</span> + pressure + <span class="hljs-string">&quot;***&quot;</span>);<br>    System.out.println(<span class="hljs-string">&quot;***ç™¾åº¦ç½‘ç«™ æ¹¿åº¦: &quot;</span> + humidity + <span class="hljs-string">&quot;***&quot;</span>);<br>  &#125;<br>&#125;<br></code></pre></td></tr></table></figure><h4 id="6ã€Client"><a href="#6ã€Client" class="headerlink" title="6ã€Client"></a>6ã€Client</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Client</span> &#123;<br><br>  <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span> &#123;<br>    <span class="hljs-comment">// TODO Auto-generated method stub</span><br>    <span class="hljs-comment">// åˆ›å»ºä¸€ä¸ªWeatherData</span><br>    <span class="hljs-type">WeatherData</span> <span class="hljs-variable">weatherData</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">WeatherData</span>();<br><br>    <span class="hljs-comment">// åˆ›å»ºè§‚å¯Ÿè€…</span><br>    <span class="hljs-type">CurrentConditions</span> <span class="hljs-variable">currentConditions</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">CurrentConditions</span>();<br>    <span class="hljs-type">BaiduSite</span> <span class="hljs-variable">baiduSite</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">BaiduSite</span>();<br><br>    <span class="hljs-comment">// æ³¨å†Œåˆ°weatherData</span><br>    weatherData.registerObserver(currentConditions);<br>    weatherData.registerObserver(baiduSite);<br><br>    <span class="hljs-comment">// æµ‹è¯•</span><br>    System.out.println(<span class="hljs-string">&quot;é€šçŸ¥å„ä¸ªæ³¨å†Œçš„è§‚å¯Ÿè€…, çœ‹çœ‹ä¿¡æ¯&quot;</span>);<br>    weatherData.setData(<span class="hljs-number">10f</span>, <span class="hljs-number">100f</span>, <span class="hljs-number">30.3f</span>);<br><br>    weatherData.removeObserver(currentConditions);<br>    <span class="hljs-comment">// æµ‹è¯•</span><br>    System.out.println();<br>    System.out.println(<span class="hljs-string">&quot;é€šçŸ¥å„ä¸ªæ³¨å†Œçš„è§‚å¯Ÿè€…, çœ‹çœ‹ä¿¡æ¯&quot;</span>);<br>    weatherData.setData(<span class="hljs-number">10f</span>, <span class="hljs-number">100f</span>, <span class="hljs-number">30.3f</span>);<br>  &#125;<br>&#125;<br></code></pre></td></tr></table></figure><h2 id="2ã€åŸç†åŠåº”ç”¨åœºæ™¯å‰–æ"><a href="#2ã€åŸç†åŠåº”ç”¨åœºæ™¯å‰–æ" class="headerlink" title="2ã€åŸç†åŠåº”ç”¨åœºæ™¯å‰–æ"></a>2ã€åŸç†åŠåº”ç”¨åœºæ™¯å‰–æ</h2><p><strong>è§‚å¯Ÿè€…æ¨¡å¼</strong>ä¹Ÿè¢«ç§°ä¸º<strong>å‘å¸ƒè®¢é˜…æ¨¡å¼</strong>ã€‚</p><p>åœ¨å¯¹è±¡ä¹‹é—´å®šä¹‰ä¸€ä¸ªä¸€å¯¹å¤šçš„ä¾èµ–ï¼Œå½“ä¸€ä¸ªå¯¹è±¡çŠ¶æ€æ”¹å˜çš„æ—¶å€™ï¼Œæ‰€æœ‰ä¾èµ–çš„å¯¹è±¡éƒ½ä¼šè‡ªåŠ¨æ”¶åˆ°é€šçŸ¥ã€‚</p><ol><li>ä¸€èˆ¬æƒ…å†µä¸‹ï¼Œè¢«ä¾èµ–çš„å¯¹è±¡å«ä½œ<strong>è¢«è§‚å¯Ÿè€…</strong>ï¼ˆObservableï¼‰ï¼Œä¾èµ–çš„å¯¹è±¡å«ä½œ<strong>è§‚å¯Ÿè€…</strong>ï¼ˆObserverï¼‰ã€‚ä¸è¿‡ï¼Œåœ¨å®é™…çš„é¡¹ç›®å¼€å‘ä¸­ï¼Œè¿™ä¸¤ç§å¯¹è±¡çš„ç§°å‘¼æ˜¯æ¯”è¾ƒçµæ´»çš„ï¼Œæœ‰å„ç§ä¸åŒçš„å«æ³•ï¼Œæ¯”å¦‚ï¼šSubject-Observerã€Publisher-Subscriberã€Producer-Consumerã€EventEmitter-EventListenerã€Dispatcher-Listenerã€‚ä¸ç®¡æ€ä¹ˆç§°å‘¼ï¼Œåªè¦åº”ç”¨åœºæ™¯ç¬¦åˆåˆšåˆšç»™å‡ºçš„å®šä¹‰ï¼Œéƒ½å¯ä»¥çœ‹ä½œè§‚å¯Ÿè€…æ¨¡å¼ã€‚</li><li>å®é™…ä¸Šï¼Œè§‚å¯Ÿè€…æ¨¡å¼æ˜¯ä¸€ä¸ªæ¯”è¾ƒæŠ½è±¡çš„æ¨¡å¼ï¼Œæ ¹æ®ä¸åŒçš„åº”ç”¨åœºæ™¯å’Œéœ€æ±‚ï¼Œæœ‰å®Œå…¨ä¸åŒçš„å®ç°æ–¹å¼ã€‚ç°åœ¨å…ˆæ¥çœ‹å…¶ä¸­æœ€ç»å…¸çš„ä¸€ç§å®ç°æ–¹å¼ã€‚è¿™ä¹Ÿæ˜¯åœ¨è®²åˆ°è¿™ç§æ¨¡å¼çš„æ—¶å€™ï¼Œå¾ˆå¤šä¹¦ç±æˆ–èµ„æ–™ç»™å‡ºçš„æœ€å¸¸è§çš„å®ç°æ–¹å¼ã€‚å…·ä½“çš„ä»£ç å¦‚ä¸‹æ‰€ç¤ºï¼š</li></ol><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">import</span> java.util.ArrayList;<br><span class="hljs-keyword">import</span> java.util.List;<br><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">interface</span> <span class="hljs-title class_">Subject</span> &#123;<br>  <span class="hljs-keyword">void</span> <span class="hljs-title function_">registerObserver</span><span class="hljs-params">(Observer observer)</span>;<br><br>  <span class="hljs-keyword">void</span> <span class="hljs-title function_">removeObserver</span><span class="hljs-params">(Observer observer)</span>;<br><br>  <span class="hljs-keyword">void</span> <span class="hljs-title function_">notifyObservers</span><span class="hljs-params">(Message message)</span>;<br>&#125;<br><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">interface</span> <span class="hljs-title class_">Observer</span> &#123;<br>  <span class="hljs-keyword">void</span> <span class="hljs-title function_">update</span><span class="hljs-params">(Message message)</span>;<br>&#125;<br><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">ConcreteSubject</span> <span class="hljs-keyword">implements</span> <span class="hljs-title class_">Subject</span> &#123;<br>  <span class="hljs-keyword">private</span> List&lt;Observer&gt; observers = <span class="hljs-keyword">new</span> <span class="hljs-title class_">ArrayList</span>&lt;Observer&gt;();<br><br>  <span class="hljs-meta">@Override</span><br>  <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">registerObserver</span><span class="hljs-params">(Observer observer)</span> &#123;<br>    observers.add(observer);<br>  &#125;<br><br>  <span class="hljs-meta">@Override</span><br>  <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">removeObserver</span><span class="hljs-params">(Observer observer)</span> &#123;<br>    observers.remove(observer);<br>  &#125;<br><br>  <span class="hljs-meta">@Override</span><br>  <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">notifyObservers</span><span class="hljs-params">(Message message)</span> &#123;<br>    <span class="hljs-keyword">for</span> (Observer observer : observers) &#123;<br>      observer.update(message);<br>    &#125;<br>  &#125;<br>&#125;<br><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">ConcreteObserverOne</span> <span class="hljs-keyword">implements</span> <span class="hljs-title class_">Observer</span> &#123;<br><br>  <span class="hljs-meta">@Override</span><br>  <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">update</span><span class="hljs-params">(Message message)</span> &#123;<br>    <span class="hljs-comment">// <span class="hljs-doctag">TODO:</span> è·å–æ¶ˆæ¯é€šçŸ¥ï¼Œæ‰§è¡Œè‡ªå·±çš„é€»è¾‘...</span><br>    System.out.println(<span class="hljs-string">&quot;ConcreteObserverOne is notified.&quot;</span>);<br>  &#125;<br>&#125;<br><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">ConcreteObserverTwo</span> <span class="hljs-keyword">implements</span> <span class="hljs-title class_">Observer</span> &#123;<br><br>  <span class="hljs-meta">@Override</span><br>  <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">update</span><span class="hljs-params">(Message message)</span> &#123;<br>    <span class="hljs-comment">// <span class="hljs-doctag">TODO:</span> è·å–æ¶ˆæ¯é€šçŸ¥ï¼Œæ‰§è¡Œè‡ªå·±çš„é€»è¾‘...</span><br>    System.out.println(<span class="hljs-string">&quot;ConcreteObserverTwo is notified.&quot;</span>);<br>  &#125;<br>&#125;<br><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Demo</span> &#123;<br><br>  <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span> &#123;<br>    <span class="hljs-type">ConcreteSubject</span> <span class="hljs-variable">subject</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">ConcreteSubject</span>();<br>    subject.registerObserver(<span class="hljs-keyword">new</span> <span class="hljs-title class_">ConcreteObserverOne</span>());<br>    subject.registerObserver(<span class="hljs-keyword">new</span> <span class="hljs-title class_">ConcreteObserverTwo</span>());<br>    subject.notifyObservers(<span class="hljs-keyword">new</span> <span class="hljs-title class_">Message</span>());<br>  &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>åŸç†å’Œä»£ç éƒ½æ¯”è¾ƒå®¹æ˜“ç†è§£ï¼Œä½†æ˜¯è¿™ç§è®¾è®¡æ¨¡å¼èƒ½è§£å†³ä»€ä¹ˆé—®é¢˜ï¼Ÿ</p><p>å‡è®¾æˆ‘ä»¬åœ¨å¼€å‘ä¸€ä¸ª P2P æŠ•èµ„ç†è´¢ç³»ç»Ÿï¼Œç”¨æˆ·æ³¨å†ŒæˆåŠŸä¹‹åï¼Œæˆ‘ä»¬ä¼šç»™ç”¨æˆ·å‘æ”¾æŠ•èµ„ä½“éªŒé‡‘ã€‚ä»£ç å®ç°å¤§è‡´æ˜¯ä¸‹é¢è¿™ä¸ªæ ·å­çš„ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">UserController</span> &#123;<br><br>  <span class="hljs-keyword">private</span> UserService userService; <span class="hljs-comment">// ä¾èµ–æ³¨å…¥</span><br>  <span class="hljs-keyword">private</span> PromotionService promotionService; <span class="hljs-comment">// ä¾èµ–æ³¨å…¥</span><br><br>  <span class="hljs-keyword">public</span> Long <span class="hljs-title function_">register</span><span class="hljs-params">(String telephone, String password)</span> &#123;<br>    <span class="hljs-comment">// çœç•¥è¾“å…¥å‚æ•°çš„æ ¡éªŒä»£ç </span><br>    <span class="hljs-comment">// çœç•¥userService.register()å¼‚å¸¸çš„try-catchä»£ç </span><br>    <span class="hljs-type">long</span> <span class="hljs-variable">userId</span> <span class="hljs-operator">=</span> userService.register(telephone, password);<br>    promotionService.issueNewUserExperienceCash(userId);<br>    <span class="hljs-keyword">return</span> userId;<br>  &#125;<br>&#125;<br></code></pre></td></tr></table></figure><ol><li>è™½ç„¶æ³¨å†Œæ¥å£åšäº†ä¸¤ä»¶äº‹æƒ…ï¼Œæ³¨å†Œå’Œå‘æ”¾ä½“éªŒé‡‘ï¼Œè¿åå•ä¸€èŒè´£åŸåˆ™ï¼Œä½†æ˜¯ï¼Œå¦‚æœæ²¡æœ‰æ‰©å±•å’Œä¿®æ”¹çš„éœ€æ±‚ï¼Œç°åœ¨çš„ä»£ç å®ç°æ˜¯å¯ä»¥æ¥å—çš„ã€‚å¦‚æœéå¾—ç”¨è§‚å¯Ÿè€…æ¨¡å¼ï¼Œå°±éœ€è¦å¼•å…¥æ›´å¤šçš„ç±»å’Œæ›´åŠ å¤æ‚çš„ä»£ç ç»“æ„ï¼Œåå€’æ˜¯ä¸€ç§è¿‡åº¦è®¾è®¡ã€‚</li><li>ç›¸åï¼Œå¦‚æœéœ€æ±‚é¢‘ç¹å˜åŠ¨ï¼Œæ¯”å¦‚ï¼Œç”¨æˆ·æ³¨å†ŒæˆåŠŸä¹‹åï¼Œä¸å†å‘æ”¾ä½“éªŒé‡‘ï¼Œè€Œæ˜¯æ”¹ä¸ºå‘æ”¾ä¼˜æƒ åˆ¸ï¼Œå¹¶ä¸”è¿˜è¦ç»™ç”¨æˆ·å‘é€ä¸€å°â€œæ¬¢è¿æ³¨å†ŒæˆåŠŸâ€çš„ç«™å†…ä¿¡ã€‚è¿™ç§æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬å°±éœ€è¦é¢‘ç¹åœ°ä¿®æ”¹ register() å‡½æ•°ä¸­çš„ä»£ç ï¼Œè¿åå¼€é—­åŸåˆ™ã€‚è€Œä¸”ï¼Œå¦‚æœæ³¨å†ŒæˆåŠŸä¹‹åéœ€è¦æ‰§è¡Œçš„åç»­æ“ä½œè¶Šæ¥è¶Šå¤šï¼Œé‚£ register() å‡½æ•°çš„é€»è¾‘ä¼šå˜å¾—è¶Šæ¥è¶Šå¤æ‚ï¼Œä¹Ÿå°±å½±å“åˆ°ä»£ç çš„å¯è¯»æ€§å’Œå¯ç»´æŠ¤æ€§ã€‚</li><li>è¿™ä¸ªæ—¶å€™ï¼Œè§‚å¯Ÿè€…æ¨¡å¼å°±èƒ½æ´¾ä¸Šç”¨åœºäº†ã€‚åˆ©ç”¨è§‚å¯Ÿè€…æ¨¡å¼ï¼Œå¯¹ä¸Šé¢çš„ä»£ç è¿›è¡Œäº†é‡æ„ã€‚é‡æ„ä¹‹åçš„ä»£ç å¦‚ä¸‹æ‰€ç¤ºï¼š</li></ol><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">import</span> java.util.ArrayList;<br><span class="hljs-keyword">import</span> java.util.List;<br><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">interface</span> <span class="hljs-title class_">RegObserver</span> &#123;<br>  <span class="hljs-keyword">void</span> <span class="hljs-title function_">handleRegSuccess</span><span class="hljs-params">(<span class="hljs-type">long</span> userId)</span>;<br>&#125;<br><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">RegPromotionObserver</span> <span class="hljs-keyword">implements</span> <span class="hljs-title class_">RegObserver</span> &#123;<br>  <span class="hljs-keyword">private</span> PromotionService promotionService; <span class="hljs-comment">// ä¾èµ–æ³¨å…¥</span><br><br>  <span class="hljs-meta">@Override</span><br>  <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">handleRegSuccess</span><span class="hljs-params">(<span class="hljs-type">long</span> userId)</span> &#123;<br>    promotionService.issueNewUserExperienceCash(userId);<br>  &#125;<br>&#125;<br><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">RegNotificationObserver</span> <span class="hljs-keyword">implements</span> <span class="hljs-title class_">RegObserver</span> &#123;<br>  <span class="hljs-keyword">private</span> NotificationService notificationService;<br><br>  <span class="hljs-meta">@Override</span><br>  <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">handleRegSuccess</span><span class="hljs-params">(<span class="hljs-type">long</span> userId)</span> &#123;<br>    notificationService.sendInboxMessage(userId, <span class="hljs-string">&quot;Welcome...&quot;</span>);<br>  &#125;<br>&#125;<br><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">UserController</span> &#123;<br>  <span class="hljs-keyword">private</span> UserService userService; <span class="hljs-comment">// ä¾èµ–æ³¨å…¥</span><br>  <span class="hljs-keyword">private</span> List&lt;RegObserver&gt; regObservers = <span class="hljs-keyword">new</span> <span class="hljs-title class_">ArrayList</span>&lt;&gt;();<br><br>  <span class="hljs-comment">// ä¸€æ¬¡æ€§è®¾ç½®å¥½ï¼Œä¹‹åä¹Ÿä¸å¯èƒ½åŠ¨æ€çš„ä¿®æ”¹</span><br>  <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">setRegObservers</span><span class="hljs-params">(List&lt;RegObserver&gt; observers)</span> &#123;<br>    regObservers.addAll(observers);<br>  &#125;<br><br>  <span class="hljs-keyword">public</span> Long <span class="hljs-title function_">register</span><span class="hljs-params">(String telephone, String password)</span> &#123;<br>    <span class="hljs-comment">// çœç•¥è¾“å…¥å‚æ•°çš„æ ¡éªŒä»£ç </span><br>    <span class="hljs-comment">// çœç•¥userService.register()å¼‚å¸¸çš„try-catchä»£ç </span><br>    <span class="hljs-type">long</span> <span class="hljs-variable">userId</span> <span class="hljs-operator">=</span> userService.register(telephone, password);<br><br>    <span class="hljs-keyword">for</span> (RegObserver observer : regObservers) &#123;<br>      observer.handleRegSuccess(userId);<br>    &#125;<br><br>    <span class="hljs-keyword">return</span> userId;<br>  &#125;<br>&#125;<br></code></pre></td></tr></table></figure><ol><li>å½“æˆ‘ä»¬éœ€è¦æ·»åŠ æ–°çš„è§‚å¯Ÿè€…çš„æ—¶å€™ï¼Œæ¯”å¦‚ï¼Œç”¨æˆ·æ³¨å†ŒæˆåŠŸä¹‹åï¼Œæ¨é€ç”¨æˆ·æ³¨å†Œä¿¡æ¯ç»™å¤§æ•°æ®å¾ä¿¡ç³»ç»Ÿï¼ŒåŸºäºè§‚å¯Ÿè€…æ¨¡å¼çš„ä»£ç å®ç°ï¼ŒUserController ç±»çš„ register() å‡½æ•°å®Œå…¨ä¸éœ€è¦ä¿®æ”¹ï¼Œåªéœ€è¦å†æ·»åŠ ä¸€ä¸ªå®ç°äº† RegObserver æ¥å£çš„ç±»ï¼Œå¹¶ä¸”é€šè¿‡ setRegObservers() å‡½æ•°å°†å®ƒæ³¨å†Œåˆ° UserController ç±»ä¸­å³å¯ã€‚</li><li>å‰é¢æˆ‘ä»¬å·²ç»å­¦ä¹ äº†å¾ˆå¤šè®¾è®¡æ¨¡å¼ï¼Œä¸çŸ¥é“ä½ æœ‰æ²¡æœ‰å‘ç°ï¼Œå®é™…ä¸Šï¼Œ<strong>è®¾è®¡æ¨¡å¼è¦å¹²çš„äº‹æƒ…å°±æ˜¯è§£è€¦ã€‚åˆ›å»ºå‹æ¨¡å¼æ˜¯å°†åˆ›å»ºå’Œä½¿ç”¨ä»£ç è§£è€¦ï¼Œç»“æ„å‹æ¨¡å¼æ˜¯å°†ä¸åŒåŠŸèƒ½ä»£ç è§£è€¦ï¼Œè¡Œä¸ºå‹æ¨¡å¼æ˜¯å°†ä¸åŒçš„è¡Œä¸ºä»£ç è§£è€¦ï¼Œå…·ä½“åˆ°è§‚å¯Ÿè€…æ¨¡å¼ï¼Œå®ƒæ˜¯å°†è§‚å¯Ÿè€…å’Œè¢«è§‚å¯Ÿè€…ä»£ç è§£è€¦ã€‚</strong>å€ŸåŠ©è®¾è®¡æ¨¡å¼ï¼Œæˆ‘ä»¬åˆ©ç”¨æ›´å¥½çš„ä»£ç ç»“æ„ï¼Œå°†ä¸€å¤§å¨ä»£ç æ‹†åˆ†æˆèŒè´£æ›´å•ä¸€çš„å°ç±»ï¼Œè®©å…¶æ»¡è¶³å¼€é—­åŸåˆ™ã€é«˜å†…èšæ¾è€¦åˆç­‰ç‰¹æ€§ï¼Œä»¥æ­¤æ¥æ§åˆ¶å’Œåº”å¯¹ä»£ç çš„å¤æ‚æ€§ï¼Œæé«˜ä»£ç çš„å¯æ‰©å±•æ€§ã€‚</li></ol><h2 id="3ã€åŸºäºä¸åŒåº”ç”¨åœºæ™¯çš„ä¸åŒå®ç°æ–¹å¼"><a href="#3ã€åŸºäºä¸åŒåº”ç”¨åœºæ™¯çš„ä¸åŒå®ç°æ–¹å¼" class="headerlink" title="3ã€åŸºäºä¸åŒåº”ç”¨åœºæ™¯çš„ä¸åŒå®ç°æ–¹å¼"></a>3ã€åŸºäºä¸åŒåº”ç”¨åœºæ™¯çš„ä¸åŒå®ç°æ–¹å¼</h2><ol><li>è§‚å¯Ÿè€…æ¨¡å¼çš„åº”ç”¨åœºæ™¯éå¸¸å¹¿æ³›ï¼Œå°åˆ°ä»£ç å±‚é¢çš„è§£è€¦ï¼Œå¤§åˆ°æ¶æ„å±‚é¢çš„ç³»ç»Ÿè§£è€¦ï¼Œå†æˆ–è€…ä¸€äº›äº§å“çš„è®¾è®¡æ€è·¯ï¼Œéƒ½æœ‰è¿™ç§æ¨¡å¼çš„å½±å­ï¼Œæ¯”å¦‚ï¼Œé‚®ä»¶è®¢é˜…ã€RSS Feedsï¼Œæœ¬è´¨ä¸Šéƒ½æ˜¯è§‚å¯Ÿè€…æ¨¡å¼ã€‚</li><li>è§‚å¯Ÿè€…æ¨¡å¼æœ‰åŒæ­¥é˜»å¡çš„å®ç°æ–¹å¼ï¼Œä¹Ÿæœ‰å¼‚æ­¥éé˜»å¡çš„å®ç°æ–¹å¼ï¼›æœ‰è¿›ç¨‹å†…çš„å®ç°æ–¹å¼ï¼Œä¹Ÿæœ‰è·¨è¿›ç¨‹çš„å®ç°æ–¹å¼ã€‚</li><li>ä¹‹å‰è®²åˆ°çš„å®ç°æ–¹å¼ï¼Œä»åˆšåˆšçš„åˆ†ç±»æ–¹å¼ä¸Šæ¥çœ‹ï¼Œå®ƒæ˜¯ä¸€ç§åŒæ­¥é˜»å¡çš„å®ç°æ–¹å¼ã€‚è§‚å¯Ÿè€…å’Œè¢«è§‚å¯Ÿè€…ä»£ç åœ¨åŒä¸€ä¸ªçº¿ç¨‹å†…æ‰§è¡Œï¼Œè¢«è§‚å¯Ÿè€…ä¸€ç›´é˜»å¡ï¼Œç›´åˆ°æ‰€æœ‰çš„è§‚å¯Ÿè€…ä»£ç éƒ½æ‰§è¡Œå®Œæˆä¹‹åï¼Œæ‰æ‰§è¡Œåç»­çš„ä»£ç ã€‚å¯¹ç…§ä¸Šé¢è®²åˆ°çš„ç”¨æˆ·æ³¨å†Œçš„ä¾‹å­ï¼Œregister() å‡½æ•°ä¾æ¬¡è°ƒç”¨æ‰§è¡Œæ¯ä¸ªè§‚å¯Ÿè€…çš„ handleRegSuccess() å‡½æ•°ï¼Œç­‰åˆ°éƒ½æ‰§è¡Œå®Œæˆä¹‹åï¼Œæ‰ä¼šè¿”å›ç»“æœç»™å®¢æˆ·ç«¯ã€‚</li><li>å¦‚æœæ³¨å†Œæ¥å£æ˜¯ä¸€ä¸ªè°ƒç”¨æ¯”è¾ƒé¢‘ç¹çš„æ¥å£ï¼Œå¯¹æ€§èƒ½éå¸¸æ•æ„Ÿï¼Œå¸Œæœ›æ¥å£çš„å“åº”æ—¶é—´å°½å¯èƒ½çŸ­ï¼Œé‚£æˆ‘ä»¬å¯ä»¥å°†åŒæ­¥é˜»å¡çš„å®ç°æ–¹å¼æ”¹ä¸ºå¼‚æ­¥éé˜»å¡çš„å®ç°æ–¹å¼ï¼Œä»¥æ­¤æ¥å‡å°‘å“åº”æ—¶é—´ã€‚å…·ä½“æ¥è®²ï¼Œå½“ userService.register() å‡½æ•°æ‰§è¡Œå®Œæˆä¹‹åï¼Œæˆ‘ä»¬å¯åŠ¨ä¸€ä¸ªæ–°çš„çº¿ç¨‹æ¥æ‰§è¡Œè§‚å¯Ÿè€…çš„ handleRegSuccess() å‡½æ•°ï¼Œè¿™æ · userController.register() å‡½æ•°å°±ä¸éœ€è¦ç­‰åˆ°æ‰€æœ‰çš„ handleRegSuccess() å‡½æ•°éƒ½æ‰§è¡Œå®Œæˆä¹‹åæ‰è¿”å›ç»“æœç»™å®¢æˆ·ç«¯ã€‚userController.register() å‡½æ•°ä»æ‰§è¡Œ 3 ä¸ª SQL è¯­å¥æ‰è¿”å›ï¼Œå‡å°‘åˆ°åªéœ€è¦æ‰§è¡Œ 1 ä¸ª SQL è¯­å¥å°±è¿”å›ï¼Œå“åº”æ—¶é—´ç²—ç•¥æ¥è®²å‡å°‘ä¸ºåŸæ¥çš„ 1/3ã€‚</li><li>é‚£å¦‚ä½•å®ç°ä¸€ä¸ªå¼‚æ­¥éé˜»å¡çš„è§‚å¯Ÿè€…æ¨¡å¼å‘¢ï¼Ÿç®€å•ä¸€ç‚¹çš„åšæ³•æ˜¯ï¼Œåœ¨æ¯ä¸ª handleRegSuccess() å‡½æ•°ä¸­ï¼Œåˆ›å»ºä¸€ä¸ªæ–°çš„çº¿ç¨‹æ‰§è¡Œä»£ç ã€‚ä¸è¿‡ï¼Œæˆ‘ä»¬è¿˜æœ‰æ›´åŠ ä¼˜é›…çš„å®ç°æ–¹å¼ï¼Œé‚£å°±æ˜¯åŸºäº EventBus æ¥å®ç°ã€‚å®ƒå¯ä»¥å¤ç”¨åœ¨ä»»ä½•éœ€è¦å¼‚æ­¥éé˜»å¡è§‚å¯Ÿè€…æ¨¡å¼çš„åº”ç”¨åœºæ™¯ä¸­ã€‚</li><li>åˆšåˆšè®²åˆ°çš„ä¸¤ä¸ªåœºæ™¯ï¼Œä¸ç®¡æ˜¯åŒæ­¥é˜»å¡å®ç°æ–¹å¼è¿˜æ˜¯å¼‚æ­¥éé˜»å¡å®ç°æ–¹å¼ï¼Œéƒ½æ˜¯è¿›ç¨‹å†…çš„å®ç°æ–¹å¼ã€‚å¦‚æœç”¨æˆ·æ³¨å†ŒæˆåŠŸä¹‹åï¼Œæˆ‘ä»¬éœ€è¦å‘é€ç”¨æˆ·ä¿¡æ¯ç»™å¤§æ•°æ®å¾ä¿¡ç³»ç»Ÿï¼Œè€Œå¤§æ•°æ®å¾ä¿¡ç³»ç»Ÿæ˜¯ä¸€ä¸ªç‹¬ç«‹çš„ç³»ç»Ÿï¼Œè·Ÿå®ƒä¹‹é—´çš„äº¤äº’æ˜¯è·¨ä¸åŒè¿›ç¨‹çš„ï¼Œé‚£å¦‚ä½•å®ç°ä¸€ä¸ªè·¨è¿›ç¨‹çš„è§‚å¯Ÿè€…æ¨¡å¼å‘¢ï¼Ÿ</li><li>å¦‚æœå¤§æ•°æ®å¾ä¿¡ç³»ç»Ÿæä¾›äº†å‘é€ç”¨æˆ·æ³¨å†Œä¿¡æ¯çš„ RPC æ¥å£ï¼Œæˆ‘ä»¬ä»ç„¶å¯ä»¥æ²¿ç”¨ä¹‹å‰çš„å®ç°æ€è·¯ï¼Œåœ¨ handleRegSuccess() å‡½æ•°ä¸­è°ƒç”¨ RPC æ¥å£æ¥å‘é€æ•°æ®ã€‚ä½†æ˜¯ï¼Œæˆ‘ä»¬è¿˜æœ‰æ›´åŠ ä¼˜é›…ã€æ›´åŠ å¸¸ç”¨çš„ä¸€ç§å®ç°æ–¹å¼ï¼Œé‚£å°±æ˜¯åŸºäºæ¶ˆæ¯é˜Ÿåˆ—ï¼ˆMessage Queueï¼Œæ¯”å¦‚ ActiveMQï¼‰æ¥å®ç°ã€‚</li><li>å½“ç„¶ï¼Œè¿™ç§å®ç°æ–¹å¼ä¹Ÿæœ‰å¼Šç«¯ï¼Œé‚£å°±æ˜¯éœ€è¦å¼•å…¥ä¸€ä¸ªæ–°çš„ç³»ç»Ÿï¼ˆæ¶ˆæ¯é˜Ÿåˆ—ï¼‰ï¼Œå¢åŠ äº†ç»´æŠ¤æˆæœ¬ã€‚ä¸è¿‡ï¼Œå®ƒçš„å¥½å¤„ä¹Ÿéå¸¸æ˜æ˜¾ã€‚åœ¨åŸæ¥çš„å®ç°æ–¹å¼ä¸­ï¼Œè§‚å¯Ÿè€…éœ€è¦æ³¨å†Œåˆ°è¢«è§‚å¯Ÿè€…ä¸­ï¼Œè¢«è§‚å¯Ÿè€…éœ€è¦ä¾æ¬¡éå†è§‚å¯Ÿè€…æ¥å‘é€æ¶ˆæ¯ã€‚è€ŒåŸºäºæ¶ˆæ¯é˜Ÿåˆ—çš„å®ç°æ–¹å¼ï¼Œè¢«è§‚å¯Ÿè€…å’Œè§‚å¯Ÿè€…è§£è€¦æ›´åŠ å½»åº•ï¼Œä¸¤éƒ¨åˆ†çš„è€¦åˆæ›´å°ã€‚è¢«è§‚å¯Ÿè€…å®Œå…¨ä¸æ„ŸçŸ¥è§‚å¯Ÿè€…ï¼ŒåŒç†ï¼Œè§‚å¯Ÿè€…ä¹Ÿå®Œå…¨ä¸æ„ŸçŸ¥è¢«è§‚å¯Ÿè€…ã€‚è¢«è§‚å¯Ÿè€…åªç®¡å‘é€æ¶ˆæ¯åˆ°æ¶ˆæ¯é˜Ÿåˆ—ï¼Œè§‚å¯Ÿè€…åªç®¡ä»æ¶ˆæ¯é˜Ÿåˆ—ä¸­è¯»å–æ¶ˆæ¯æ¥æ‰§è¡Œç›¸åº”çš„é€»è¾‘ã€‚</li></ol><p>å…³äºEventBuså¯ä»¥çœ‹è¿™ç¯‡åšå®¢   </p><p><a href="https://imlql.cn/post/dd09051e.html">https://imlql.cn/post/dd09051e.html</a></p><h1 id="äºŒã€æ¨¡æ¿æ¨¡å¼ã€å¸¸ç”¨ã€‘"><a href="#äºŒã€æ¨¡æ¿æ¨¡å¼ã€å¸¸ç”¨ã€‘" class="headerlink" title="äºŒã€æ¨¡æ¿æ¨¡å¼ã€å¸¸ç”¨ã€‘"></a>äºŒã€æ¨¡æ¿æ¨¡å¼ã€å¸¸ç”¨ã€‘</h1><p>æ¨¡æ¿æ¨¡å¼ä¸¤å¤§ä½œç”¨ï¼šå¤ç”¨å’Œæ‰©å±•</p><h2 id="1ã€Demoæ¡ˆä¾‹-è±†æµ†åˆ¶ä½œ"><a href="#1ã€Demoæ¡ˆä¾‹-è±†æµ†åˆ¶ä½œ" class="headerlink" title="1ã€Demoæ¡ˆä¾‹-è±†æµ†åˆ¶ä½œ"></a>1ã€Demoæ¡ˆä¾‹-è±†æµ†åˆ¶ä½œ</h2><p>ç¼–å†™åˆ¶ä½œè±†æµ†çš„ç¨‹åºï¼Œè¯´æ˜å¦‚ä¸‹: </p><ol><li>åˆ¶ä½œè±†æµ†çš„æµç¨‹ é€‰æâ€”&gt;æ·»åŠ é…æ–™â€”&gt;æµ¸æ³¡â€”&gt;æ”¾åˆ°è±†æµ†æœºæ‰“ç¢ </li><li>é€šè¿‡æ·»åŠ ä¸åŒçš„é…æ–™ï¼Œå¯ä»¥åˆ¶ä½œå‡ºä¸åŒå£å‘³çš„è±†æµ† </li><li>é€‰æã€æµ¸æ³¡å’Œæ”¾åˆ°è±†æµ†æœºæ‰“ç¢è¿™å‡ ä¸ªæ­¥éª¤å¯¹äºåˆ¶ä½œæ¯ç§å£å‘³çš„è±†æµ†éƒ½æ˜¯ä¸€æ ·çš„ </li><li>è¯·ä½¿ç”¨ æ¨¡æ¿æ–¹æ³•æ¨¡å¼ å®Œæˆ </li></ol><h3 id="1ã€SoyaMilkã€æŠ½è±¡ç±»ã€‘"><a href="#1ã€SoyaMilkã€æŠ½è±¡ç±»ã€‘" class="headerlink" title="1ã€SoyaMilkã€æŠ½è±¡ç±»ã€‘"></a>1ã€SoyaMilkã€æŠ½è±¡ç±»ã€‘</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-comment">//æŠ½è±¡ç±»ï¼Œè¡¨ç¤ºè±†æµ†</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">abstract</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">SoyaMilk</span> &#123;<br><br>   <span class="hljs-comment">//æ¨¡æ¿æ–¹æ³•, make , æ¨¡æ¿æ–¹æ³•å¯ä»¥åšæˆfinal , ä¸è®©å­ç±»å»è¦†ç›–.</span><br>   <span class="hljs-keyword">final</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">make</span><span class="hljs-params">()</span> &#123;<br>      <br>      select(); <br>      <span class="hljs-keyword">if</span>(customerWantCondiments()) &#123;<br>         addCondiments();<br>      &#125;<br>      soak();<br>      beat();<br>      <br>   &#125;<br>   <br>   <span class="hljs-comment">//é€‰ææ–™</span><br>   <span class="hljs-keyword">void</span> <span class="hljs-title function_">select</span><span class="hljs-params">()</span> &#123;<br>      System.out.println(<span class="hljs-string">&quot;ç¬¬ä¸€æ­¥ï¼šé€‰æ‹©å¥½çš„æ–°é²œé»„è±†  &quot;</span>);<br>   &#125;<br>   <br>   <span class="hljs-comment">//æ·»åŠ ä¸åŒçš„é…æ–™ï¼Œ æŠ½è±¡æ–¹æ³•, å­ç±»å…·ä½“å®ç°</span><br>   <span class="hljs-keyword">abstract</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">addCondiments</span><span class="hljs-params">()</span>;<br>   <br>   <span class="hljs-comment">//æµ¸æ³¡</span><br>   <span class="hljs-keyword">void</span> <span class="hljs-title function_">soak</span><span class="hljs-params">()</span> &#123;<br>      System.out.println(<span class="hljs-string">&quot;ç¬¬ä¸‰æ­¥ï¼Œ é»„è±†å’Œé…æ–™å¼€å§‹æµ¸æ³¡ï¼Œ éœ€è¦3å°æ—¶ &quot;</span>);<br>   &#125;<br>    <br>   <span class="hljs-keyword">void</span> <span class="hljs-title function_">beat</span><span class="hljs-params">()</span> &#123;<br>      System.out.println(<span class="hljs-string">&quot;ç¬¬å››æ­¥ï¼šé»„è±†å’Œé…æ–™æ”¾åˆ°è±†æµ†æœºå»æ‰“ç¢  &quot;</span>);<br>   &#125;<br>   <br>   <span class="hljs-comment">//é’©å­æ–¹æ³•ï¼Œå†³å®šæ˜¯å¦éœ€è¦æ·»åŠ é…æ–™</span><br>   <span class="hljs-type">boolean</span> <span class="hljs-title function_">customerWantCondiments</span><span class="hljs-params">()</span> &#123;<br>      <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;<br>   &#125;<br>&#125;<br></code></pre></td></tr></table></figure><h3 id="2ã€RedBeanSoyaMilk"><a href="#2ã€RedBeanSoyaMilk" class="headerlink" title="2ã€RedBeanSoyaMilk"></a>2ã€RedBeanSoyaMilk</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">RedBeanSoyaMilk</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_">SoyaMilk</span> &#123;<br><br>  <span class="hljs-meta">@Override</span><br>  <span class="hljs-keyword">void</span> <span class="hljs-title function_">addCondiments</span><span class="hljs-params">()</span> &#123;<br>    <span class="hljs-comment">// TODO Auto-generated method stub</span><br>    System.out.println(<span class="hljs-string">&quot; åŠ å…¥ä¸Šå¥½çš„çº¢è±† &quot;</span>);<br>  &#125;<br>&#125;<br></code></pre></td></tr></table></figure><h3 id="3ã€PureSoyaMilk"><a href="#3ã€PureSoyaMilk" class="headerlink" title="3ã€PureSoyaMilk"></a>3ã€PureSoyaMilk</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-comment">// çº¯è±†æµ†</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">PureSoyaMilk</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_">SoyaMilk</span> &#123;<br><br>  <span class="hljs-meta">@Override</span><br>  <span class="hljs-keyword">void</span> <span class="hljs-title function_">addCondiments</span><span class="hljs-params">()</span> &#123;<br>    <span class="hljs-comment">// TODO Auto-generated method stub</span><br>    <span class="hljs-comment">// ç©ºå®ç°</span><br>  &#125;<br><br>  <span class="hljs-meta">@Override</span><br>  <span class="hljs-type">boolean</span> <span class="hljs-title function_">customerWantCondiments</span><span class="hljs-params">()</span> &#123;<br>    <span class="hljs-comment">// TODO Auto-generated method stub</span><br>    <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;<br>  &#125;<br>&#125;<br></code></pre></td></tr></table></figure><h3 id="4ã€PeanutSoyaMilk"><a href="#4ã€PeanutSoyaMilk" class="headerlink" title="4ã€PeanutSoyaMilk"></a>4ã€PeanutSoyaMilk</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">PeanutSoyaMilk</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_">SoyaMilk</span> &#123;<br><br>  <span class="hljs-meta">@Override</span><br>  <span class="hljs-keyword">void</span> <span class="hljs-title function_">addCondiments</span><span class="hljs-params">()</span> &#123;<br>    <span class="hljs-comment">// TODO Auto-generated method stub</span><br>    System.out.println(<span class="hljs-string">&quot; åŠ å…¥ä¸Šå¥½çš„èŠ±ç”Ÿ &quot;</span>);<br>  &#125;<br>&#125;<br></code></pre></td></tr></table></figure><h3 id="5ã€Client"><a href="#5ã€Client" class="headerlink" title="5ã€Client"></a>5ã€Client</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Client</span> &#123;<br><br>  <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span> &#123;<br>    System.out.println(<span class="hljs-string">&quot;----åˆ¶ä½œçº¢è±†è±†æµ†----&quot;</span>);<br>    <span class="hljs-type">SoyaMilk</span> <span class="hljs-variable">redBeanSoyaMilk</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">RedBeanSoyaMilk</span>();<br>    redBeanSoyaMilk.make();<br><br>    System.out.println(<span class="hljs-string">&quot;----åˆ¶ä½œèŠ±ç”Ÿè±†æµ†----&quot;</span>);<br>    <span class="hljs-type">SoyaMilk</span> <span class="hljs-variable">peanutSoyaMilk</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">PeanutSoyaMilk</span>();<br>    peanutSoyaMilk.make();<br><br>    System.out.println(<span class="hljs-string">&quot;----åˆ¶ä½œçº¯è±†æµ†----&quot;</span>);<br>    <span class="hljs-type">SoyaMilk</span> <span class="hljs-variable">pureSoyaMilk</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">PureSoyaMilk</span>();<br>    pureSoyaMilk.make();<br>  &#125;<br>&#125;<br></code></pre></td></tr></table></figure><h2 id="2ã€åŸç†åŠåº”ç”¨"><a href="#2ã€åŸç†åŠåº”ç”¨" class="headerlink" title="2ã€åŸç†åŠåº”ç”¨"></a>2ã€åŸç†åŠåº”ç”¨</h2><p>æ¨¡æ¿æ–¹æ³•æ¨¡å¼ï¼ˆTemplate Method Patternï¼‰ï¼Œåˆå«æ¨¡æ¿æ¨¡å¼(Template Pattern)ï¼Œz åœ¨ä¸€ä¸ªæŠ½è±¡ç±»å…¬å¼€å®šä¹‰äº†æ‰§è¡Œå®ƒçš„æ–¹æ³•çš„æ¨¡æ¿ã€‚å®ƒçš„å­ç±»å¯ä»¥æŒ‰éœ€è¦é‡å†™æ–¹æ³• å®ç°ï¼Œä½†è°ƒç”¨å°†ä»¥æŠ½è±¡ç±»ä¸­å®šä¹‰çš„æ–¹å¼è¿›è¡Œã€‚</p><p>ç®€å•è¯´ï¼Œæ¨¡æ¿æ–¹æ³•æ¨¡å¼ å®šä¹‰ä¸€ä¸ªæ“ä½œä¸­çš„ç®—æ³•çš„éª¨æ¶ï¼Œè€Œå°†ä¸€äº›æ­¥éª¤å»¶è¿Ÿåˆ°å­ ç±»ä¸­ï¼Œä½¿å¾—å­ç±»å¯ä»¥ä¸æ”¹å˜ä¸€ä¸ªç®—æ³•çš„ç»“æ„ï¼Œå°±å¯ä»¥é‡å®šä¹‰è¯¥ç®—æ³•çš„æŸäº›ç‰¹å®š æ­¥éª¤</p><p>åŸç†å¾ˆç®€å•ï¼Œä»£ç å®ç°å°±æ›´åŠ ç®€å•ï¼Œæˆ‘å†™äº†ä¸€ä¸ªç¤ºä¾‹ä»£ç ï¼Œå¦‚ä¸‹æ‰€ç¤ºã€‚templateMethod() å‡½æ•°å®šä¹‰ä¸º finalï¼Œæ˜¯ä¸ºäº†é¿å…å­ç±»é‡å†™å®ƒã€‚method1() å’Œ method2() å®šä¹‰ä¸º abstractï¼Œæ˜¯ä¸ºäº†å¼ºè¿«å­ç±»å»å®ç°ã€‚ä¸è¿‡ï¼Œè¿™äº›éƒ½ä¸æ˜¯å¿…é¡»çš„ï¼Œåœ¨å®é™…çš„é¡¹ç›®å¼€å‘ä¸­ï¼Œæ¨¡æ¿æ¨¡å¼çš„ä»£ç å®ç°æ¯”è¾ƒçµæ´»ï¼Œå¾…ä¼šå„¿è®²åˆ°åº”ç”¨åœºæ™¯çš„æ—¶å€™ï¼Œæˆ‘ä»¬ä¼šæœ‰å…·ä½“çš„ä½“ç°ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">abstract</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">AbstractClass</span> &#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">final</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">templateMethod</span><span class="hljs-params">()</span> &#123;<br>        <span class="hljs-comment">//...</span><br>        method1();<br>        <span class="hljs-comment">//...</span><br>        method2();<br>        <span class="hljs-comment">//...</span><br>    &#125;<br><br>    <span class="hljs-keyword">protected</span> <span class="hljs-keyword">abstract</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">method1</span><span class="hljs-params">()</span>;<br>    <span class="hljs-keyword">protected</span> <span class="hljs-keyword">abstract</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">method2</span><span class="hljs-params">()</span>;<br>&#125;<br><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">ConcreteClass1</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_">AbstractClass</span> &#123;<br><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-keyword">protected</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">method1</span><span class="hljs-params">()</span> &#123;<br>        <span class="hljs-comment">//...</span><br>    &#125;<br><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-keyword">protected</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">method2</span><span class="hljs-params">()</span> &#123;<br>        <span class="hljs-comment">//...</span><br>    &#125;<br>&#125;<br><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">ConcreteClass2</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_">AbstractClass</span> &#123;<br><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-keyword">protected</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">method1</span><span class="hljs-params">()</span> &#123;<br>        <span class="hljs-comment">//...</span><br>    &#125;<br><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-keyword">protected</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">method2</span><span class="hljs-params">()</span> &#123;<br>        <span class="hljs-comment">//...</span><br>    &#125;<br>&#125;<br><br><span class="hljs-type">AbstractClass</span> <span class="hljs-variable">demo</span> <span class="hljs-operator">=</span> ConcreteClass1();<br>demo.templateMethod();<br></code></pre></td></tr></table></figure><h2 id="3ã€æ¨¡æ¿ä½œç”¨ä¸€ï¼šå¤ç”¨"><a href="#3ã€æ¨¡æ¿ä½œç”¨ä¸€ï¼šå¤ç”¨" class="headerlink" title="3ã€æ¨¡æ¿ä½œç”¨ä¸€ï¼šå¤ç”¨"></a>3ã€æ¨¡æ¿ä½œç”¨ä¸€ï¼šå¤ç”¨</h2><p>æ¨¡æ¿æ¨¡å¼æŠŠä¸€ä¸ªç®—æ³•ä¸­ä¸å˜çš„æµç¨‹æŠ½è±¡åˆ°çˆ¶ç±»çš„æ¨¡æ¿æ–¹æ³• templateMethod() ä¸­ï¼Œå°†å¯å˜çš„éƒ¨åˆ† method1()ã€method2() ç•™ç»™å­ç±» ContreteClass1 å’Œ ContreteClass2 æ¥å®ç°ã€‚æ‰€æœ‰çš„å­ç±»éƒ½å¯ä»¥å¤ç”¨çˆ¶ç±»ä¸­æ¨¡æ¿æ–¹æ³•å®šä¹‰çš„æµç¨‹ä»£ç ã€‚</p><h3 id="1ã€Java-InputStream"><a href="#1ã€Java-InputStream" class="headerlink" title="1ã€Java InputStream"></a>1ã€Java InputStream</h3><ol><li>Java IO ç±»åº“ä¸­ï¼Œæœ‰å¾ˆå¤šç±»çš„è®¾è®¡ç”¨åˆ°äº†æ¨¡æ¿æ¨¡å¼ï¼Œæ¯”å¦‚ InputStreamã€OutputStreamã€Readerã€Writerã€‚æ‹¿ InputStream æ¥ä¸¾ä¾‹è¯´æ˜ä¸€ä¸‹ã€‚</li><li> InputStream éƒ¨åˆ†ç›¸å…³ä»£ç å¦‚ä¸‹ã€‚åœ¨ä»£ç ä¸­ï¼Œread() å‡½æ•°æ˜¯ä¸€ä¸ªæ¨¡æ¿æ–¹æ³•ï¼Œå®šä¹‰äº†è¯»å–æ•°æ®çš„æ•´ä¸ªæµç¨‹ï¼Œå¹¶ä¸”æš´éœ²äº†ä¸€ä¸ªå¯ä»¥ç”±å­ç±»æ¥å®šåˆ¶çš„æŠ½è±¡æ–¹æ³•ã€‚ä¸è¿‡è¿™ä¸ªæ–¹æ³•ä¹Ÿè¢«å‘½åä¸ºäº† read()ï¼Œåªæ˜¯å‚æ•°è·Ÿæ¨¡æ¿æ–¹æ³•ä¸åŒã€‚</li></ol><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">import</span> java.io.IOException;<br><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">abstract</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">InputStream</span> <span class="hljs-keyword">implements</span> <span class="hljs-title class_">Closeable</span> &#123;<br>    <span class="hljs-comment">//...çœç•¥å…¶ä»–ä»£ç ...</span><br><br>    <span class="hljs-keyword">public</span> <span class="hljs-type">int</span> <span class="hljs-title function_">read</span><span class="hljs-params">(<span class="hljs-type">byte</span> b[], <span class="hljs-type">int</span> off, <span class="hljs-type">int</span> len)</span> <span class="hljs-keyword">throws</span> IOException &#123;<br>        <span class="hljs-keyword">if</span> (b == <span class="hljs-literal">null</span>) &#123;<br>            <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">NullPointerException</span>();<br>        &#125; <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (off &lt; <span class="hljs-number">0</span> || len &lt; <span class="hljs-number">0</span> || len &gt; b.length - off) &#123;<br>            <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">IndexOutOfBoundsException</span>();<br>        &#125; <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (len == <span class="hljs-number">0</span>) &#123;<br>            <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>        &#125;<br>        <span class="hljs-type">int</span> <span class="hljs-variable">c</span> <span class="hljs-operator">=</span> read();<br>        <span class="hljs-keyword">if</span> (c == -<span class="hljs-number">1</span>) &#123;<br>            <span class="hljs-keyword">return</span> -<span class="hljs-number">1</span>;<br>        &#125;<br>        b[off] = (<span class="hljs-type">byte</span>) c;<br>        <span class="hljs-type">int</span> <span class="hljs-variable">i</span> <span class="hljs-operator">=</span> <span class="hljs-number">1</span>;<br>        <span class="hljs-keyword">try</span> &#123;<br>            <span class="hljs-keyword">for</span> (; i &lt; len; i++) &#123;<br>                c = read();<br>                <span class="hljs-keyword">if</span> (c == -<span class="hljs-number">1</span>) &#123;<br>                    <span class="hljs-keyword">break</span>;<br>                &#125;<br>                b[off + i] = (<span class="hljs-type">byte</span>) c;<br>            &#125;<br>        &#125; <span class="hljs-keyword">catch</span> (IOException ee) &#123;<br>        &#125;<br>        <span class="hljs-keyword">return</span> i;<br><br>    &#125;<br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">abstract</span> <span class="hljs-type">int</span> <span class="hljs-title function_">read</span><span class="hljs-params">()</span> <span class="hljs-keyword">throws</span> IOException;<br>&#125;<br><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">ByteArrayInputStream</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_">InputStream</span> &#123;<br>    <span class="hljs-comment">//...çœç•¥å…¶ä»–ä»£ç ...</span><br><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">synchronized</span> <span class="hljs-type">int</span> <span class="hljs-title function_">read</span><span class="hljs-params">()</span> &#123;<br>        <span class="hljs-keyword">return</span> (pos &lt; count) ? (buf[pos++] &amp; <span class="hljs-number">0xff</span>) : -<span class="hljs-number">1</span>;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><h3 id="2ã€Java-AbstractList"><a href="#2ã€Java-AbstractList" class="headerlink" title="2ã€Java AbstractList"></a>2ã€Java AbstractList</h3><p>åœ¨ Java AbstractList ç±»ä¸­ï¼ŒaddAll() å‡½æ•°å¯ä»¥çœ‹ä½œæ¨¡æ¿æ–¹æ³•ï¼Œadd() æ˜¯å­ç±»éœ€è¦é‡å†™çš„æ–¹æ³•ï¼Œå°½ç®¡æ²¡æœ‰å£°æ˜ä¸º abstract çš„ï¼Œä½†å‡½æ•°å®ç°ç›´æ¥æŠ›å‡ºäº† UnsupportedOperationException å¼‚å¸¸ã€‚å‰ææ˜¯ï¼Œå¦‚æœå­ç±»ä¸é‡å†™æ˜¯ä¸èƒ½ä½¿ç”¨çš„ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-type">boolean</span> <span class="hljs-title function_">addAll</span><span class="hljs-params">(<span class="hljs-type">int</span> index,Collection&lt;?extends E&gt; c)</span>&#123;<br>        rangeCheckForAdd(index);<br>        <span class="hljs-type">boolean</span> modified=<span class="hljs-literal">false</span>;<br><br>        <span class="hljs-keyword">for</span>(E e:c)&#123;<br>            add(index++,e);<br>            modified=<span class="hljs-literal">true</span>;<br>        &#125;<br>        <span class="hljs-keyword">return</span> modified;<br>&#125;<br><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">add</span><span class="hljs-params">(<span class="hljs-type">int</span> index,E element)</span>&#123;<br>        <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">UnsupportedOperationException</span>();<br>&#125;<br></code></pre></td></tr></table></figure><h2 id="4ã€æ¨¡æ¿ä½œç”¨äºŒï¼šæ‰©å±•"><a href="#4ã€æ¨¡æ¿ä½œç”¨äºŒï¼šæ‰©å±•" class="headerlink" title="4ã€æ¨¡æ¿ä½œç”¨äºŒï¼šæ‰©å±•"></a>4ã€æ¨¡æ¿ä½œç”¨äºŒï¼šæ‰©å±•</h2><p>è¿™é‡Œæ‰€è¯´çš„æ‰©å±•ï¼Œå¹¶ä¸æ˜¯æŒ‡ä»£ç çš„æ‰©å±•æ€§ï¼Œè€Œæ˜¯æŒ‡æ¡†æ¶çš„æ‰©å±•æ€§ï¼Œæœ‰ç‚¹ç±»ä¼¼æˆ‘ä»¬ä¹‹å‰è®²åˆ°çš„æ§åˆ¶åè½¬ã€‚åŸºäºè¿™ä¸ªä½œç”¨ï¼Œæ¨¡æ¿æ¨¡å¼å¸¸ç”¨åœ¨æ¡†æ¶çš„å¼€å‘ä¸­ï¼Œè®©æ¡†æ¶ç”¨æˆ·å¯ä»¥åœ¨ä¸ä¿®æ”¹æ¡†æ¶æºç çš„æƒ…å†µä¸‹ï¼Œå®šåˆ¶åŒ–æ¡†æ¶çš„åŠŸèƒ½ã€‚æˆ‘ä»¬é€šè¿‡ Junit TestCaseã€Java Servlet ä¸¤ä¸ªä¾‹å­æ¥è§£é‡Šä¸€ä¸‹ã€‚</p><h3 id="1ã€Java-Servlet"><a href="#1ã€Java-Servlet" class="headerlink" title="1ã€Java Servlet"></a>1ã€Java Servlet</h3><p>å¯¹äº Java Web é¡¹ç›®å¼€å‘æ¥è¯´ï¼Œå¸¸ç”¨çš„å¼€å‘æ¡†æ¶æ˜¯ SpringMVCã€‚åˆ©ç”¨å®ƒï¼Œæˆ‘ä»¬åªéœ€è¦å…³æ³¨ä¸šåŠ¡ä»£ç çš„ç¼–å†™ï¼Œåº•å±‚çš„åŸç†å‡ ä¹ä¸ä¼šæ¶‰åŠã€‚ä½†æ˜¯ï¼Œå¦‚æœæˆ‘ä»¬æŠ›å¼€è¿™äº›é«˜çº§æ¡†æ¶æ¥å¼€å‘ Web é¡¹ç›®ï¼Œå¿…ç„¶ä¼šç”¨åˆ° Servletã€‚å®é™…ä¸Šï¼Œä½¿ç”¨æ¯”è¾ƒåº•å±‚çš„ Servlet æ¥å¼€å‘ Web é¡¹ç›®ä¹Ÿä¸éš¾ã€‚æˆ‘ä»¬åªéœ€è¦å®šä¹‰ä¸€ä¸ªç»§æ‰¿ HttpServlet çš„ç±»ï¼Œå¹¶ä¸”é‡å†™å…¶ä¸­çš„ doGet() æˆ– doPost() æ–¹æ³•ï¼Œæ¥åˆ†åˆ«å¤„ç† get å’Œ post è¯·æ±‚ã€‚å…·ä½“çš„ä»£ç ç¤ºä¾‹å¦‚ä¸‹æ‰€ç¤ºï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">HelloServlet</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_">HttpServlet</span> &#123;<br><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-keyword">protected</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">doGet</span><span class="hljs-params">(HttpServletRequest req, HttpServletResponse resp)</span> <span class="hljs-keyword">throws</span> ServletException, IOException &#123;<br>        <span class="hljs-built_in">this</span>.doPost(req, resp);<br>    &#125;<br><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-keyword">protected</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">doPost</span><span class="hljs-params">(HttpServletRequest req, HttpServletResponse resp)</span> <span class="hljs-keyword">throws</span> ServletException, IOException &#123;<br>        resp.getWriter().write(<span class="hljs-string">&quot;Hello World.&quot;</span>);<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>é™¤æ­¤ä¹‹å¤–ï¼Œæˆ‘ä»¬è¿˜éœ€è¦åœ¨é…ç½®æ–‡ä»¶ web.xml ä¸­åšå¦‚ä¸‹é…ç½®ã€‚Tomcatã€Jetty ç­‰ Servlet å®¹å™¨åœ¨å¯åŠ¨çš„æ—¶å€™ï¼Œä¼šè‡ªåŠ¨åŠ è½½è¿™ä¸ªé…ç½®æ–‡ä»¶ä¸­çš„ URL å’Œ Servlet ä¹‹é—´çš„æ˜ å°„å…³ç³»ã€‚</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">servlet</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">servlet-name</span>&gt;</span>HelloServlet<span class="hljs-tag">&lt;/<span class="hljs-name">servlet-name</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">servlet-class</span>&gt;</span>com.zb.cd.HelloServlet<span class="hljs-tag">&lt;/<span class="hljs-name">servlet-class</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">servlet</span>&gt;</span><br><br><span class="hljs-tag">&lt;<span class="hljs-name">servlet-mapping</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">servlet-name</span>&gt;</span>HelloServlet<span class="hljs-tag">&lt;/<span class="hljs-name">servlet-name</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">url-pattern</span>&gt;</span>/hello<span class="hljs-tag">&lt;/<span class="hljs-name">url-pattern</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">servlet-mapping</span>&gt;</span><br></code></pre></td></tr></table></figure><p>å½“æˆ‘ä»¬åœ¨æµè§ˆå™¨ä¸­è¾“å…¥ç½‘å€ï¼ˆæ¯”å¦‚ï¼Œ<a href="http://127.0.0.1:8080/hello">http://127.0.0.1:8080/hello</a> ï¼‰çš„æ—¶å€™ï¼ŒServlet å®¹å™¨ä¼šæ¥æ”¶åˆ°ç›¸åº”çš„è¯·æ±‚ï¼Œå¹¶ä¸”æ ¹æ® URL å’Œ Servlet ä¹‹é—´çš„æ˜ å°„å…³ç³»ï¼Œæ‰¾åˆ°ç›¸åº”çš„ Servletï¼ˆHelloServletï¼‰ï¼Œç„¶åæ‰§è¡Œå®ƒçš„ service() æ–¹æ³•ã€‚service() æ–¹æ³•å®šä¹‰åœ¨çˆ¶ç±» HttpServlet ä¸­ï¼Œå®ƒä¼šè°ƒç”¨ doGet() æˆ– doPost() æ–¹æ³•ï¼Œç„¶åè¾“å‡ºæ•°æ®ï¼ˆâ€œHello worldâ€ï¼‰åˆ°ç½‘é¡µã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">service</span><span class="hljs-params">(ServletRequest req, ServletResponse res)</span><br>      <span class="hljs-keyword">throws</span> ServletException, IOException &#123;<br>    HttpServletRequest request;<br>    HttpServletResponse response;<br>    <span class="hljs-keyword">if</span> (!(req <span class="hljs-keyword">instanceof</span> HttpServletRequest &amp;&amp; res <span class="hljs-keyword">instanceof</span> HttpServletResponse)) &#123;<br>      <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">ServletException</span>(<span class="hljs-string">&quot;non-HTTP request or response&quot;</span>);<br>    &#125;<br>    request = (HttpServletRequest) req;<br>    response = (HttpServletResponse) res;<br>    service(request, response);<br>  &#125;<br><br>  <span class="hljs-keyword">protected</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">service</span><span class="hljs-params">(HttpServletRequest req, HttpServletResponse resp)</span><br>      <span class="hljs-keyword">throws</span> ServletException, IOException &#123;<br>    <span class="hljs-type">String</span> <span class="hljs-variable">method</span> <span class="hljs-operator">=</span> req.getMethod();<br>    <span class="hljs-keyword">if</span> (method.equals(METHOD_GET)) &#123;<br>      <span class="hljs-type">long</span> <span class="hljs-variable">lastModified</span> <span class="hljs-operator">=</span> getLastModified(req);<br>      <span class="hljs-keyword">if</span> (lastModified == -<span class="hljs-number">1</span>) &#123;<br>        <span class="hljs-comment">// servlet doesn&#x27;t support if-modified-since, no reason</span><br>        <span class="hljs-comment">// to go through further expensive logic</span><br>        doGet(req, resp);<br>      &#125; <span class="hljs-keyword">else</span> &#123;<br>        <span class="hljs-type">long</span> <span class="hljs-variable">ifModifiedSince</span> <span class="hljs-operator">=</span> req.getDateHeader(HEADER_IFMODSINCE);<br>        <span class="hljs-keyword">if</span> (ifModifiedSince &lt; lastModified) &#123;<br>          <span class="hljs-comment">// If the servlet mod time is later, call doGet()</span><br>          <span class="hljs-comment">// Round down to the nearest second for a proper compare</span><br>          <span class="hljs-comment">// A ifModifiedSince of -1 will always be less</span><br>          maybeSetLastModified(resp, lastModified);<br>          doGet(req, resp);<br>        &#125; <span class="hljs-keyword">else</span> &#123;<br>          resp.setStatus(HttpServletResponse.SC_NOT_MODIFIED);<br>        &#125;<br>      &#125;<br>    &#125; <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (method.equals(METHOD_HEAD)) &#123;<br>      <span class="hljs-type">long</span> <span class="hljs-variable">lastModified</span> <span class="hljs-operator">=</span> getLastModified(req);<br>      maybeSetLastModified(resp, lastModified);<br>      doHead(req, resp);<br>    &#125; <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (method.equals(METHOD_POST)) &#123;<br>      doPost(req, resp);<br>    &#125; <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (method.equals(METHOD_PUT)) &#123;<br>      doPut(req, resp);<br>    &#125; <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (method.equals(METHOD_DELETE)) &#123;<br>      doDelete(req, resp);<br>    &#125; <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (method.equals(METHOD_OPTIONS)) &#123;<br>      doOptions(req, resp);<br>    &#125; <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (method.equals(METHOD_TRACE)) &#123;<br>      doTrace(req, resp);<br>    &#125; <span class="hljs-keyword">else</span> &#123;<br>      <span class="hljs-type">String</span> <span class="hljs-variable">errMsg</span> <span class="hljs-operator">=</span> lStrings.getString(<span class="hljs-string">&quot;http.method_not_implemented&quot;</span>);<br>      Object[] errArgs = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Object</span>[<span class="hljs-number">1</span>];<br>      errArgs[<span class="hljs-number">0</span>] = method;<br>      errMsg = MessageFormat.format(errMsg, errArgs);<br>      resp.sendError(HttpServletResponse.SC_NOT_IMPLEMENTED, errMsg);<br>    &#125;<br>  &#125;<br></code></pre></td></tr></table></figure><p>ä»ä¸Šé¢çš„ä»£ç ä¸­æˆ‘ä»¬å¯ä»¥çœ‹å‡ºï¼ŒHttpServlet çš„ service() æ–¹æ³•å°±æ˜¯ä¸€ä¸ªæ¨¡æ¿æ–¹æ³•ï¼Œå®ƒå®ç°äº†æ•´ä¸ª HTTP è¯·æ±‚çš„æ‰§è¡Œæµç¨‹ï¼ŒdoGet()ã€doPost() æ˜¯æ¨¡æ¿ä¸­å¯ä»¥ç”±å­ç±»æ¥å®šåˆ¶çš„éƒ¨åˆ†ã€‚å®é™…ä¸Šï¼Œè¿™å°±ç›¸å½“äº Servlet æ¡†æ¶æä¾›äº†ä¸€ä¸ªæ‰©å±•ç‚¹ï¼ˆdoGet()ã€doPost() æ–¹æ³•ï¼‰ï¼Œè®©æ¡†æ¶ç”¨æˆ·åœ¨ä¸ç”¨ä¿®æ”¹ Servlet æ¡†æ¶æºç çš„æƒ…å†µä¸‹ï¼Œå°†ä¸šåŠ¡ä»£ç é€šè¿‡æ‰©å±•ç‚¹é•¶åµŒåˆ°æ¡†æ¶ä¸­æ‰§è¡Œã€‚</p><h3 id="2ã€JUnit-TestCase"><a href="#2ã€JUnit-TestCase" class="headerlink" title="2ã€JUnit TestCase"></a>2ã€JUnit TestCase</h3><ol><li>è·Ÿ Java Servlet ç±»ä¼¼ï¼ŒJUnit æ¡†æ¶ä¹Ÿé€šè¿‡æ¨¡æ¿æ¨¡å¼æä¾›äº†ä¸€äº›åŠŸèƒ½æ‰©å±•ç‚¹ï¼ˆsetUp()ã€tearDown() ç­‰ï¼‰ï¼Œè®©æ¡†æ¶ç”¨æˆ·å¯ä»¥åœ¨è¿™äº›æ‰©å±•ç‚¹ä¸Šæ‰©å±•åŠŸèƒ½ã€‚</li><li>åœ¨ä½¿ç”¨ JUnit æµ‹è¯•æ¡†æ¶æ¥ç¼–å†™å•å…ƒæµ‹è¯•çš„æ—¶å€™ï¼Œæˆ‘ä»¬ç¼–å†™çš„æµ‹è¯•ç±»éƒ½è¦ç»§æ‰¿æ¡†æ¶æä¾›çš„ TestCase ç±»ã€‚åœ¨ TestCase ç±»ä¸­ï¼ŒrunBare() å‡½æ•°æ˜¯æ¨¡æ¿æ–¹æ³•ï¼Œå®ƒå®šä¹‰äº†æ‰§è¡Œæµ‹è¯•ç”¨ä¾‹çš„æ•´ä½“æµç¨‹ï¼šå…ˆæ‰§è¡Œ setUp() åšäº›å‡†å¤‡å·¥ä½œï¼Œç„¶åæ‰§è¡Œ runTest() è¿è¡ŒçœŸæ­£çš„æµ‹è¯•ä»£ç ï¼Œæœ€åæ‰§è¡Œ tearDown() åšæ‰«å°¾å·¥ä½œã€‚</li><li>TestCase ç±»çš„å…·ä½“ä»£ç å¦‚ä¸‹æ‰€ç¤ºã€‚å°½ç®¡ setUp()ã€tearDown() å¹¶ä¸æ˜¯æŠ½è±¡å‡½æ•°ï¼Œè¿˜æä¾›äº†é»˜è®¤çš„å®ç°ï¼Œä¸å¼ºåˆ¶å­ç±»å»é‡æ–°å®ç°ï¼Œä½†è¿™éƒ¨åˆ†ä¹Ÿæ˜¯å¯ä»¥åœ¨å­ç±»ä¸­å®šåˆ¶çš„ï¼Œæ‰€ä»¥ä¹Ÿç¬¦åˆæ¨¡æ¿æ¨¡å¼çš„å®šä¹‰ã€‚</li></ol><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">abstract</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">TestCase</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_">Assert</span> <span class="hljs-keyword">implements</span> <span class="hljs-title class_">Test</span> &#123;<br>  <br>  <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">runBare</span><span class="hljs-params">()</span> <span class="hljs-keyword">throws</span> Throwable &#123;<br>    <span class="hljs-type">Throwable</span> <span class="hljs-variable">exception</span> <span class="hljs-operator">=</span> <span class="hljs-literal">null</span>;<br>    setUp();<br>    <span class="hljs-keyword">try</span> &#123;<br>      runTest();<br>    &#125; <span class="hljs-keyword">catch</span> (Throwable running) &#123;<br>      exception = running;<br>    &#125; <span class="hljs-keyword">finally</span> &#123;<br>      <span class="hljs-keyword">try</span> &#123;<br>        tearDown();<br>      &#125; <span class="hljs-keyword">catch</span> (Throwable tearingDown) &#123;<br>        <span class="hljs-keyword">if</span> (exception == <span class="hljs-literal">null</span>) exception = tearingDown;<br>      &#125;<br>    &#125;<br>    <span class="hljs-keyword">if</span> (exception != <span class="hljs-literal">null</span>) <span class="hljs-keyword">throw</span> exception;<br>  &#125;<br><br>  <span class="hljs-comment">/**</span><br><span class="hljs-comment">   * * Sets up the fixture, for example, open a network connection.</span><br><span class="hljs-comment">   *</span><br><span class="hljs-comment">   * &lt;p&gt;* This method is called before a test is executed.</span><br><span class="hljs-comment">   */</span><br>  <span class="hljs-keyword">protected</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">setUp</span><span class="hljs-params">()</span> <span class="hljs-keyword">throws</span> Exception &#123;&#125;<br><br>  <span class="hljs-comment">/**</span><br><span class="hljs-comment">   * * Tears down the fixture, for example, close a network connection.</span><br><span class="hljs-comment">   *</span><br><span class="hljs-comment">   * &lt;p&gt;* This method is called after a test is executed.</span><br><span class="hljs-comment">   */</span><br>  <span class="hljs-keyword">protected</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">tearDown</span><span class="hljs-params">()</span> <span class="hljs-keyword">throws</span> Exception &#123;&#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>ã€å›è°ƒã€‘</p>]]></content>
    
    
    <categories>
      
      <category>è®¾è®¡æ¨¡å¼</category>
      
    </categories>
    
    
    <tags>
      
      <tag>è®¾è®¡æ¨¡å¼</tag>
      
      <tag>è§‚å¯Ÿè€…</tag>
      
      <tag>æ¨¡æ¿</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>05-ç»“æ„å‹-é—¨é¢-ç»„åˆ-äº«å…ƒ</title>
    <link href="/2022/09/27/05-jie-gou-xing-men-mian-zu-he-xiang-yuan/"/>
    <url>/2022/09/27/05-jie-gou-xing-men-mian-zu-he-xiang-yuan/</url>
    
    <content type="html"><![CDATA[<h1 id="ä¸€ã€é—¨é¢æ¨¡å¼ï¼ˆå¤–è§‚æ¨¡å¼ï¼‰ã€ä¸å¸¸ç”¨ã€‘"><a href="#ä¸€ã€é—¨é¢æ¨¡å¼ï¼ˆå¤–è§‚æ¨¡å¼ï¼‰ã€ä¸å¸¸ç”¨ã€‘" class="headerlink" title="ä¸€ã€é—¨é¢æ¨¡å¼ï¼ˆå¤–è§‚æ¨¡å¼ï¼‰ã€ä¸å¸¸ç”¨ã€‘"></a>ä¸€ã€é—¨é¢æ¨¡å¼ï¼ˆå¤–è§‚æ¨¡å¼ï¼‰ã€ä¸å¸¸ç”¨ã€‘</h1><ol><li>é—¨é¢æ¨¡å¼åŸç†å’Œå®ç°éƒ½ç‰¹åˆ«ç®€å•ï¼Œåº”ç”¨åœºæ™¯ä¹Ÿæ¯”è¾ƒæ˜ç¡®ï¼Œä¸»è¦åœ¨æ¥å£è®¾è®¡æ–¹é¢ä½¿ç”¨ã€‚</li><li>ä¸ºäº†ä¿è¯æ¥å£çš„å¯å¤ç”¨æ€§ï¼ˆæˆ–è€…å«é€šç”¨æ€§ï¼‰ï¼Œæˆ‘ä»¬éœ€è¦å°†æ¥å£å°½é‡è®¾è®¡å¾—ç»†ç²’åº¦ä¸€ç‚¹ï¼ŒèŒè´£å•ä¸€ä¸€ç‚¹ã€‚ä½†æ˜¯ï¼Œå¦‚æœæ¥å£çš„ç²’åº¦è¿‡å°ï¼Œåœ¨æ¥å£çš„ä½¿ç”¨è€…å¼€å‘ä¸€ä¸ªä¸šåŠ¡åŠŸèƒ½æ—¶ï¼Œå°±ä¼šå¯¼è‡´éœ€è¦è°ƒç”¨ n å¤šç»†ç²’åº¦çš„æ¥å£æ‰èƒ½å®Œæˆã€‚è°ƒç”¨è€…è‚¯å®šä¼šæŠ±æ€¨æ¥å£ä¸å¥½ç”¨ã€‚</li><li>ç›¸åï¼Œå¦‚æœæ¥å£ç²’åº¦è®¾è®¡å¾—å¤ªå¤§ï¼Œä¸€ä¸ªæ¥å£è¿”å› n å¤šæ•°æ®ï¼Œè¦åš n å¤šäº‹æƒ…ï¼Œå°±ä¼šå¯¼è‡´æ¥å£ä¸å¤Ÿé€šç”¨ã€å¯å¤ç”¨æ€§ä¸å¥½ã€‚æ¥å£ä¸å¯å¤ç”¨ï¼Œé‚£é’ˆå¯¹ä¸åŒçš„è°ƒç”¨è€…çš„ä¸šåŠ¡éœ€æ±‚ï¼Œæˆ‘ä»¬å°±éœ€è¦å¼€å‘ä¸åŒçš„æ¥å£æ¥æ»¡è¶³ï¼Œè¿™å°±ä¼šå¯¼è‡´ç³»ç»Ÿçš„æ¥å£æ— é™è†¨èƒ€ã€‚</li><li>é‚£å¦‚ä½•æ¥è§£å†³æ¥å£çš„å¯å¤ç”¨æ€§ï¼ˆé€šç”¨æ€§ï¼‰å’Œæ˜“ç”¨æ€§ä¹‹é—´çš„çŸ›ç›¾å‘¢ï¼Ÿ</li></ol><h2 id="1ã€é—¨é¢æ¨¡å¼çš„åŸç†ä¸å®ç°"><a href="#1ã€é—¨é¢æ¨¡å¼çš„åŸç†ä¸å®ç°" class="headerlink" title="1ã€é—¨é¢æ¨¡å¼çš„åŸç†ä¸å®ç°"></a>1ã€é—¨é¢æ¨¡å¼çš„åŸç†ä¸å®ç°</h2><p>é—¨é¢æ¨¡å¼ï¼Œä¹Ÿå«å¤–è§‚æ¨¡å¼ï¼Œè‹±æ–‡å…¨ç§°æ˜¯ Facade Design Patternã€‚åœ¨ GoF çš„ã€Šè®¾è®¡æ¨¡å¼ã€‹ä¸€ä¹¦ä¸­ï¼Œé—¨é¢æ¨¡å¼æ˜¯è¿™æ ·å®šä¹‰çš„ï¼š</p><blockquote><p>Provide a unified interface to a set of interfaces in a subsystem. Facade Pattern defines a higher-level interface that makes the subsystem easier to use</p></blockquote><ol><li>ç¿»è¯‘æˆä¸­æ–‡å°±æ˜¯ï¼šé—¨é¢æ¨¡å¼ä¸ºå­ç³»ç»Ÿæä¾›ä¸€ç»„ç»Ÿä¸€çš„æ¥å£ï¼Œå®šä¹‰ä¸€ç»„é«˜å±‚æ¥å£è®©å­ç³»ç»Ÿæ›´æ˜“ç”¨ã€‚</li><li>å‡è®¾æœ‰ä¸€ä¸ªç³»ç»Ÿ Aï¼Œæä¾›äº† aã€bã€cã€d å››ä¸ªæ¥å£ã€‚ç³»ç»Ÿ B å®ŒæˆæŸä¸ªä¸šåŠ¡åŠŸèƒ½ï¼Œéœ€è¦è°ƒç”¨ A ç³»ç»Ÿçš„ aã€bã€d æ¥å£ã€‚åˆ©ç”¨é—¨é¢æ¨¡å¼ï¼Œæˆ‘ä»¬æä¾›ä¸€ä¸ªåŒ…è£¹ aã€bã€d æ¥å£è°ƒç”¨çš„é—¨é¢æ¥å£ xï¼Œç»™ç³»ç»Ÿ B ç›´æ¥ä½¿ç”¨ã€‚</li><li>ä½†æ˜¯ä¸ºä»€ä¹ˆä¸è®©ç³»ç»Ÿ B ç›´æ¥è°ƒç”¨ aã€bã€d ï¼Œè¿˜è¦æä¾›ä¸€ä¸ªåŒ…è£¹ aã€bã€d çš„æ¥å£ x å‘¢ï¼Ÿ</li><li>å‡è®¾æˆ‘ä»¬åˆšåˆšæåˆ°çš„ç³»ç»Ÿ A æ˜¯ä¸€ä¸ªåç«¯æœåŠ¡å™¨ï¼Œç³»ç»Ÿ B æ˜¯ App å®¢æˆ·ç«¯ã€‚App å®¢æˆ·ç«¯é€šè¿‡åç«¯æœåŠ¡å™¨æä¾›çš„æ¥å£æ¥è·å–æ•°æ®ã€‚æˆ‘ä»¬çŸ¥é“ï¼ŒApp å’ŒæœåŠ¡å™¨ä¹‹é—´æ˜¯é€šè¿‡ç§»åŠ¨ç½‘ç»œé€šä¿¡çš„ï¼Œç½‘ç»œé€šä¿¡è€—æ—¶æ¯”è¾ƒå¤šï¼Œä¸ºäº†æé«˜ App çš„å“åº”é€Ÿåº¦ï¼Œæˆ‘ä»¬è¦å°½é‡å‡å°‘ App ä¸æœåŠ¡å™¨ä¹‹é—´çš„ç½‘ç»œé€šä¿¡æ¬¡æ•°ã€‚</li><li>å‡è®¾ï¼Œå®ŒæˆæŸä¸ªä¸šåŠ¡åŠŸèƒ½ï¼ˆæ¯”å¦‚æ˜¾ç¤ºæŸä¸ªé¡µé¢ä¿¡æ¯ï¼‰éœ€è¦â€œä¾æ¬¡â€è°ƒç”¨ aã€bã€d ä¸‰ä¸ªæ¥å£ï¼Œå› è‡ªèº«ä¸šåŠ¡çš„ç‰¹ç‚¹ï¼Œä¸æ”¯æŒå¹¶å‘è°ƒç”¨è¿™ä¸‰ä¸ªæ¥å£ã€‚</li><li>å¦‚æœæˆ‘ä»¬ç°åœ¨å‘ç° App å®¢æˆ·ç«¯çš„å“åº”é€Ÿåº¦æ¯”è¾ƒæ…¢ï¼Œæ’æŸ¥ä¹‹åå‘ç°ï¼Œæ˜¯å› ä¸ºè¿‡å¤šçš„æ¥å£è°ƒç”¨è¿‡å¤šçš„ç½‘ç»œé€šä¿¡ã€‚é’ˆå¯¹è¿™ç§æƒ…å†µï¼Œæˆ‘ä»¬å°±å¯ä»¥åˆ©ç”¨é—¨é¢æ¨¡å¼ï¼Œè®©åç«¯æœåŠ¡å™¨æä¾›ä¸€ä¸ªåŒ…è£¹ aã€bã€d ä¸‰ä¸ªæ¥å£è°ƒç”¨çš„æ¥å£ xã€‚App å®¢æˆ·ç«¯è°ƒç”¨ä¸€æ¬¡æ¥å£ xï¼Œæ¥è·å–åˆ°æ‰€æœ‰æƒ³è¦çš„æ•°æ®ï¼Œå°†ç½‘ç»œé€šä¿¡çš„æ¬¡æ•°ä» 3 æ¬¡å‡å°‘åˆ° 1 æ¬¡ï¼Œä¹Ÿå°±æé«˜äº† App çš„å“åº”é€Ÿåº¦ã€‚</li><li>è¿™é‡Œä¸¾çš„ä¾‹å­åªæ˜¯åº”ç”¨é—¨é¢æ¨¡å¼çš„å…¶ä¸­ä¸€ä¸ªæ„å›¾ï¼Œä¹Ÿå°±æ˜¯è§£å†³æ€§èƒ½é—®é¢˜ã€‚å®é™…ä¸Šï¼Œä¸åŒçš„åº”ç”¨åœºæ™¯ä¸‹ï¼Œä½¿ç”¨é—¨é¢æ¨¡å¼çš„æ„å›¾ä¹Ÿä¸åŒã€‚</li></ol><h2 id="2ã€Demoæ¡ˆä¾‹-å½±é™¢ç®¡ç†"><a href="#2ã€Demoæ¡ˆä¾‹-å½±é™¢ç®¡ç†" class="headerlink" title="2ã€Demoæ¡ˆä¾‹-å½±é™¢ç®¡ç†"></a>2ã€Demoæ¡ˆä¾‹-å½±é™¢ç®¡ç†</h2><ul><li>ç»„å»ºä¸€ä¸ªå®¶åº­å½±é™¢ï¼š</li><li>DVD æ’­æ”¾å™¨ã€æŠ•å½±ä»ªã€è‡ªåŠ¨å±å¹•ã€ç¯ç»•ç«‹ä½“å£°ã€çˆ†ç±³èŠ±æœº,è¦æ±‚å®Œæˆä½¿ç”¨å®¶åº­å½±é™¢çš„åŠŸèƒ½ï¼Œå…¶è¿‡ç¨‹ä¸ºï¼š</li><li>ç›´æ¥ç”¨é¥æ§å™¨ï¼šç»Ÿç­¹å„è®¾å¤‡å¼€å…³<ul><li>å¼€çˆ†ç±³èŠ±æœº</li><li>æ”¾ä¸‹å±å¹•</li><li>å¼€æŠ•å½±ä»ª</li><li>å¼€éŸ³å“</li><li>å¼€ DVDï¼Œé€‰ dvd</li><li>å»æ‹¿çˆ†ç±³èŠ±</li><li>è°ƒæš—ç¯å…‰</li><li>æ’­æ”¾</li><li>è§‚å½±ç»“æŸåï¼Œå…³é—­å„ç§è®¾å¤‡</li></ul></li></ul><h3 id="1ã€ä¼ ç»Ÿæ–¹æ¡ˆ"><a href="#1ã€ä¼ ç»Ÿæ–¹æ¡ˆ" class="headerlink" title="1ã€ä¼ ç»Ÿæ–¹æ¡ˆ"></a>1ã€ä¼ ç»Ÿæ–¹æ¡ˆ</h3><p><img src="/2022/09/27/05-jie-gou-xing-men-mian-zu-he-xiang-yuan/image-20220927173050295.png"></p><ol><li>åœ¨ ClientTest çš„ main æ–¹æ³•ä¸­ï¼Œåˆ›å»ºå„ä¸ªå­ç³»ç»Ÿçš„å¯¹è±¡ï¼Œå¹¶ç›´æ¥å»è°ƒç”¨å­ç³»ç»Ÿ(å¯¹è±¡)ç›¸å…³æ–¹æ³•ï¼Œä¼šé€ æˆè°ƒç”¨è¿‡ç¨‹ æ··ä¹±ï¼Œæ²¡æœ‰æ¸…æ™°çš„è¿‡ç¨‹ ä¸åˆ©äºåœ¨ ClientTest ä¸­ï¼Œå»ç»´æŠ¤å¯¹å­ç³»ç»Ÿçš„æ“ä½œ</li><li>è§£å†³æ€è·¯ï¼š<strong>å®šä¹‰ä¸€ä¸ªé«˜å±‚æ¥å£</strong>ï¼Œç»™<strong>å­ç³»ç»Ÿä¸­çš„ä¸€ç»„æ¥å£æä¾›ä¸€ä¸ªä¸€è‡´çš„ç•Œé¢</strong>(æ¯”å¦‚åœ¨é«˜å±‚æ¥å£æä¾›å››ä¸ªæ–¹æ³• ready, play, pause, end )ï¼Œç”¨æ¥è®¿é—®å­ç³»ç»Ÿä¸­çš„ä¸€ç¾¤æ¥å£</li><li>ä¹Ÿå°±æ˜¯è¯´ å°±æ˜¯é€šè¿‡å®šä¹‰ä¸€ä¸ªä¸€è‡´çš„æ¥å£(ç•Œé¢ç±»)ï¼Œç”¨ä»¥å±è”½å†…éƒ¨å­ç³»ç»Ÿçš„ç»†èŠ‚ï¼Œä½¿å¾—è°ƒç”¨ç«¯åªéœ€è·Ÿè¿™ä¸ªæ¥å£å‘ ç”Ÿè°ƒç”¨ï¼Œè€Œæ— éœ€å…³å¿ƒè¿™ä¸ªå­ç³»ç»Ÿçš„å†…éƒ¨ç»†èŠ‚ =&gt; <strong>å¤–è§‚æ¨¡å¼</strong></li><li>å¤–è§‚ç±»(Facade): ä¸ºè°ƒç”¨ç«¯æä¾›ç»Ÿä¸€çš„è°ƒç”¨æ¥å£, å¤–è§‚ç±»çŸ¥é“å“ªäº›å­ç³»ç»Ÿè´Ÿè´£å¤„ç†è¯·æ±‚,ä»è€Œå°†è°ƒç”¨ç«¯çš„è¯·æ±‚ä»£ ç†ç»™é€‚å½“å­ç³»ç»Ÿå¯¹è±¡</li><li>è°ƒç”¨è€…(Client): å¤–è§‚æ¥å£çš„è°ƒç”¨è€…</li><li>å­ç³»ç»Ÿçš„é›†åˆï¼šæŒ‡æ¨¡å—æˆ–è€…å­ç³»ç»Ÿï¼Œå¤„ç† Facade å¯¹è±¡æŒ‡æ´¾çš„ä»»åŠ¡ï¼Œä»–æ˜¯åŠŸèƒ½çš„å®é™…æä¾›è€…</li></ol><h3 id="2ã€é—¨é¢æ¨¡å¼ä»£ç "><a href="#2ã€é—¨é¢æ¨¡å¼ä»£ç " class="headerlink" title="2ã€é—¨é¢æ¨¡å¼ä»£ç "></a>2ã€é—¨é¢æ¨¡å¼ä»£ç </h3><h4 id="1ã€TheaterLight"><a href="#1ã€TheaterLight" class="headerlink" title="1ã€TheaterLight"></a>1ã€TheaterLight</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">TheaterLight</span> &#123;<br><br>  <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-type">TheaterLight</span> <span class="hljs-variable">instance</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">TheaterLight</span>();<br><br>  <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> TheaterLight <span class="hljs-title function_">getInstance</span><span class="hljs-params">()</span> &#123;<br>    <span class="hljs-keyword">return</span> instance;<br>  &#125;<br><br>  <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">on</span><span class="hljs-params">()</span> &#123;<br>    System.out.println(<span class="hljs-string">&quot; TheaterLight on &quot;</span>);<br>  &#125;<br><br>  <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">off</span><span class="hljs-params">()</span> &#123;<br>    System.out.println(<span class="hljs-string">&quot; TheaterLight off &quot;</span>);<br>  &#125;<br><br>  <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">dim</span><span class="hljs-params">()</span> &#123;<br>    System.out.println(<span class="hljs-string">&quot; TheaterLight dim.. &quot;</span>);<br>  &#125;<br><br>  <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">bright</span><span class="hljs-params">()</span> &#123;<br>    System.out.println(<span class="hljs-string">&quot; TheaterLight bright.. &quot;</span>);<br>  &#125;<br>&#125;<br></code></pre></td></tr></table></figure><h4 id="2ã€Stereo"><a href="#2ã€Stereo" class="headerlink" title="2ã€Stereo"></a>2ã€Stereo</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Stereo</span> &#123;<br><br>   <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-type">Stereo</span> <span class="hljs-variable">instance</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Stereo</span>();<br>   <br>   <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> Stereo <span class="hljs-title function_">getInstance</span><span class="hljs-params">()</span> &#123;<br>      <span class="hljs-keyword">return</span> instance;<br>   &#125;<br>   <br>   <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">on</span><span class="hljs-params">()</span> &#123;<br>      System.out.println(<span class="hljs-string">&quot; Stereo on &quot;</span>);<br>   &#125;<br>   <br>   <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">off</span><span class="hljs-params">()</span> &#123;<br>      System.out.println(<span class="hljs-string">&quot; Screen off &quot;</span>);<br>   &#125;<br>   <br>   <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">up</span><span class="hljs-params">()</span> &#123;<br>      System.out.println(<span class="hljs-string">&quot; Screen up.. &quot;</span>);<br>   &#125;<br>   <br>   <span class="hljs-comment">//...</span><br>&#125;<br></code></pre></td></tr></table></figure><h4 id="3ã€Screen"><a href="#3ã€Screen" class="headerlink" title="3ã€Screen"></a>3ã€Screen</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Screen</span> &#123;<br><br>   <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-type">Screen</span> <span class="hljs-variable">instance</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Screen</span>();<br>   <br>   <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> Screen <span class="hljs-title function_">getInstance</span><span class="hljs-params">()</span> &#123;<br>      <span class="hljs-keyword">return</span> instance;<br>   &#125;<br><br>   <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">up</span><span class="hljs-params">()</span> &#123;<br>      System.out.println(<span class="hljs-string">&quot; Screen up &quot;</span>);<br>   &#125;<br>   <br>   <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">down</span><span class="hljs-params">()</span> &#123;<br>      System.out.println(<span class="hljs-string">&quot; Screen down &quot;</span>);<br>   &#125;<br>   <br>&#125;<br></code></pre></td></tr></table></figure><h4 id="4ã€Projector"><a href="#4ã€Projector" class="headerlink" title="4ã€Projector"></a>4ã€Projector</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Projector</span> &#123;<br><br>   <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-type">Projector</span> <span class="hljs-variable">instance</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Projector</span>();<br>   <br>   <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> Projector <span class="hljs-title function_">getInstance</span><span class="hljs-params">()</span> &#123;<br>      <span class="hljs-keyword">return</span> instance;<br>   &#125;<br>   <br>   <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">on</span><span class="hljs-params">()</span> &#123;<br>      System.out.println(<span class="hljs-string">&quot; Projector on &quot;</span>);<br>   &#125;<br>   <br>   <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">off</span><span class="hljs-params">()</span> &#123;<br>      System.out.println(<span class="hljs-string">&quot; Projector ff &quot;</span>);<br>   &#125;<br>   <br>   <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">focus</span><span class="hljs-params">()</span> &#123;<br>      System.out.println(<span class="hljs-string">&quot; Projector is Projector  &quot;</span>);<br>   &#125;<br>   <br>   <span class="hljs-comment">//...</span><br>&#125;<br></code></pre></td></tr></table></figure><h4 id="5ã€Popcorn"><a href="#5ã€Popcorn" class="headerlink" title="5ã€Popcorn"></a>5ã€Popcorn</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Popcorn</span> &#123;<br>   <br>   <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-type">Popcorn</span> <span class="hljs-variable">instance</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Popcorn</span>();<br>   <br>   <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> Popcorn <span class="hljs-title function_">getInstance</span><span class="hljs-params">()</span> &#123;<br>      <span class="hljs-keyword">return</span> instance;<br>   &#125;<br>   <br>   <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">on</span><span class="hljs-params">()</span> &#123;<br>      System.out.println(<span class="hljs-string">&quot; popcorn on &quot;</span>);<br>   &#125;<br>   <br>   <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">off</span><span class="hljs-params">()</span> &#123;<br>      System.out.println(<span class="hljs-string">&quot; popcorn ff &quot;</span>);<br>   &#125;<br>   <br>   <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">pop</span><span class="hljs-params">()</span> &#123;<br>      System.out.println(<span class="hljs-string">&quot; popcorn is poping  &quot;</span>);<br>   &#125;<br>&#125;<br></code></pre></td></tr></table></figure><h4 id="6ã€DVDPlayer"><a href="#6ã€DVDPlayer" class="headerlink" title="6ã€DVDPlayer"></a>6ã€DVDPlayer</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">DVDPlayer</span> &#123;<br>   <br>   <span class="hljs-comment">//ä½¿ç”¨å•ä¾‹æ¨¡å¼, ä½¿ç”¨é¥¿æ±‰å¼</span><br>   <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-type">DVDPlayer</span> <span class="hljs-variable">instance</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">DVDPlayer</span>();<br>   <br>   <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> DVDPlayer <span class="hljs-title function_">getInstanc</span><span class="hljs-params">()</span> &#123;<br>      <span class="hljs-keyword">return</span> instance;<br>   &#125;<br>   <br>   <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">on</span><span class="hljs-params">()</span> &#123;<br>      System.out.println(<span class="hljs-string">&quot; dvd on &quot;</span>);<br>   &#125;<br>   <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">off</span><span class="hljs-params">()</span> &#123;<br>      System.out.println(<span class="hljs-string">&quot; dvd off &quot;</span>);<br>   &#125;<br>   <br>   <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">play</span><span class="hljs-params">()</span> &#123;<br>      System.out.println(<span class="hljs-string">&quot; dvd is playing &quot;</span>);<br>   &#125;<br>   <br>   <span class="hljs-comment">//....</span><br>   <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">pause</span><span class="hljs-params">()</span> &#123;<br>      System.out.println(<span class="hljs-string">&quot; dvd pause ..&quot;</span>);<br>   &#125;<br>&#125;<br></code></pre></td></tr></table></figure><h4 id="7ã€HomeTheaterFacade"><a href="#7ã€HomeTheaterFacade" class="headerlink" title="7ã€HomeTheaterFacade"></a>7ã€HomeTheaterFacade</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">HomeTheaterFacade</span> &#123;<br><br>  <span class="hljs-comment">// å®šä¹‰å„ä¸ªå­ç³»ç»Ÿå¯¹è±¡</span><br>  <span class="hljs-keyword">private</span> TheaterLight theaterLight;<br>  <span class="hljs-keyword">private</span> Popcorn popcorn;<br>  <span class="hljs-keyword">private</span> Stereo stereo;<br>  <span class="hljs-keyword">private</span> Projector projector;<br>  <span class="hljs-keyword">private</span> Screen screen;<br>  <span class="hljs-keyword">private</span> DVDPlayer dVDPlayer;<br><br>  <span class="hljs-comment">// æ„é€ å™¨</span><br>  <span class="hljs-keyword">public</span> <span class="hljs-title function_">HomeTheaterFacade</span><span class="hljs-params">()</span> &#123;<br>    <span class="hljs-built_in">super</span>();<br>    <span class="hljs-built_in">this</span>.theaterLight = TheaterLight.getInstance();<br>    <span class="hljs-built_in">this</span>.popcorn = Popcorn.getInstance();<br>    <span class="hljs-built_in">this</span>.stereo = Stereo.getInstance();<br>    <span class="hljs-built_in">this</span>.projector = Projector.getInstance();<br>    <span class="hljs-built_in">this</span>.screen = Screen.getInstance();<br>    <span class="hljs-built_in">this</span>.dVDPlayer = DVDPlayer.getInstanc();<br>  &#125;<br><br>  <span class="hljs-comment">// æ“ä½œåˆ†æˆ 4 æ­¥</span><br><br>  <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">ready</span><span class="hljs-params">()</span> &#123;<br>    popcorn.on();<br>    popcorn.pop();<br>    screen.down();<br>    projector.on();<br>    stereo.on();<br>    dVDPlayer.on();<br>    theaterLight.dim();<br>  &#125;<br><br>  <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">play</span><span class="hljs-params">()</span> &#123;<br>    dVDPlayer.play();<br>  &#125;<br><br>  <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">pause</span><span class="hljs-params">()</span> &#123;<br>    dVDPlayer.pause();<br>  &#125;<br><br>  <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">end</span><span class="hljs-params">()</span> &#123;<br>    popcorn.off();<br>    theaterLight.bright();<br>    screen.up();<br>    projector.off();<br>    stereo.off();<br>    dVDPlayer.off();<br>  &#125;<br>&#125;<br></code></pre></td></tr></table></figure><h3 id="3ã€é—¨é¢æ¨¡å¼çš„åº”ç”¨åœºæ™¯ä¸¾ä¾‹"><a href="#3ã€é—¨é¢æ¨¡å¼çš„åº”ç”¨åœºæ™¯ä¸¾ä¾‹" class="headerlink" title="3ã€é—¨é¢æ¨¡å¼çš„åº”ç”¨åœºæ™¯ä¸¾ä¾‹"></a>3ã€é—¨é¢æ¨¡å¼çš„åº”ç”¨åœºæ™¯ä¸¾ä¾‹</h3><ol><li>åœ¨ GoF ç»™å‡ºçš„å®šä¹‰ä¸­æåˆ°ï¼Œâ€œé—¨é¢æ¨¡å¼è®©å­ç³»ç»Ÿæ›´åŠ æ˜“ç”¨â€ï¼Œå®é™…ä¸Šï¼Œå®ƒé™¤äº†è§£å†³æ˜“ç”¨æ€§é—®é¢˜ä¹‹å¤–ï¼Œè¿˜èƒ½è§£å†³å…¶ä»–å¾ˆå¤šæ–¹é¢çš„é—®é¢˜ã€‚</li><li>é™¤æ­¤ä¹‹å¤–ï¼Œé—¨é¢æ¨¡å¼å®šä¹‰ä¸­çš„â€œå­ç³»ç»Ÿï¼ˆsubsystemï¼‰â€ä¹Ÿå¯ä»¥æœ‰å¤šç§ç†è§£æ–¹å¼ã€‚å®ƒæ—¢å¯ä»¥æ˜¯ä¸€ä¸ªå®Œæ•´çš„ç³»ç»Ÿï¼Œä¹Ÿå¯ä»¥æ˜¯æ›´ç»†ç²’åº¦çš„ç±»æˆ–è€…æ¨¡å—ã€‚</li></ol><h4 id="1ã€è§£å†³æ˜“ç”¨æ€§é—®é¢˜"><a href="#1ã€è§£å†³æ˜“ç”¨æ€§é—®é¢˜" class="headerlink" title="1ã€è§£å†³æ˜“ç”¨æ€§é—®é¢˜"></a>1ã€è§£å†³æ˜“ç”¨æ€§é—®é¢˜</h4><ol><li>é—¨é¢æ¨¡å¼å¯ä»¥ç”¨æ¥å°è£…ç³»ç»Ÿçš„åº•å±‚å®ç°ï¼Œéšè—ç³»ç»Ÿçš„å¤æ‚æ€§ï¼Œæä¾›ä¸€ç»„æ›´åŠ ç®€å•æ˜“ç”¨ã€æ›´é«˜å±‚çš„æ¥å£ã€‚æ¯”å¦‚ï¼ŒLinux ç³»ç»Ÿè°ƒç”¨å‡½æ•°å°±å¯ä»¥çœ‹ä½œä¸€ç§â€œé—¨é¢â€ã€‚å®ƒæ˜¯ Linux æ“ä½œç³»ç»Ÿæš´éœ²ç»™å¼€å‘è€…çš„ä¸€ç»„â€œç‰¹æ®Šâ€çš„ç¼–ç¨‹æ¥å£ï¼Œå®ƒå°è£…äº†åº•å±‚æ›´åŸºç¡€çš„ Linux å†…æ ¸è°ƒç”¨ã€‚å†æ¯”å¦‚ï¼ŒLinux çš„ Shell å‘½ä»¤ï¼Œå®é™…ä¸Šä¹Ÿå¯ä»¥çœ‹ä½œä¸€ç§é—¨é¢æ¨¡å¼çš„åº”ç”¨ã€‚å®ƒç»§ç»­å°è£…ç³»ç»Ÿè°ƒç”¨ï¼Œæä¾›æ›´åŠ å‹å¥½ã€ç®€å•çš„å‘½ä»¤ï¼Œè®©æˆ‘ä»¬å¯ä»¥ç›´æ¥é€šè¿‡æ‰§è¡Œå‘½ä»¤æ¥è·Ÿæ“ä½œç³»ç»Ÿäº¤äº’ã€‚</li><li>è®¾è®¡åŸåˆ™ã€æ€æƒ³ã€æ¨¡å¼å¾ˆå¤šéƒ½æ˜¯ç›¸é€šçš„ï¼Œæ˜¯åŒä¸€ä¸ªé“ç†ä¸åŒè§’åº¦çš„è¡¨è¿°ã€‚å®é™…ä¸Šï¼Œä»éšè—å®ç°å¤æ‚æ€§ï¼Œæä¾›æ›´æ˜“ç”¨æ¥å£è¿™ä¸ªæ„å›¾æ¥çœ‹ï¼Œé—¨é¢æ¨¡å¼æœ‰ç‚¹ç±»ä¼¼ä¹‹å‰è®²åˆ°çš„è¿ªç±³ç‰¹æ³•åˆ™ï¼ˆæœ€å°‘çŸ¥è¯†åŸåˆ™ï¼‰å’Œæ¥å£éš”ç¦»åŸåˆ™ï¼šä¸¤ä¸ªæœ‰äº¤äº’çš„ç³»ç»Ÿï¼Œåªæš´éœ²æœ‰é™çš„å¿…è¦çš„æ¥å£ã€‚é™¤æ­¤ä¹‹å¤–ï¼Œé—¨é¢æ¨¡å¼è¿˜æœ‰ç‚¹ç±»ä¼¼ä¹‹å‰æåˆ°å°è£…ã€æŠ½è±¡çš„è®¾è®¡æ€æƒ³ï¼Œæä¾›æ›´æŠ½è±¡çš„æ¥å£ï¼Œå°è£…åº•å±‚å®ç°ç»†èŠ‚ã€‚</li></ol><h4 id="2ã€è§£å†³æ€§èƒ½é—®é¢˜"><a href="#2ã€è§£å†³æ€§èƒ½é—®é¢˜" class="headerlink" title="2ã€è§£å†³æ€§èƒ½é—®é¢˜"></a>2ã€è§£å†³æ€§èƒ½é—®é¢˜</h4><ol><li>å…³äºåˆ©ç”¨é—¨é¢æ¨¡å¼è§£å†³æ€§èƒ½é—®é¢˜è¿™ä¸€ç‚¹ï¼Œåˆšåˆšå·²ç»è®²è¿‡äº†ã€‚æˆ‘ä»¬é€šè¿‡å°†å¤šä¸ªæ¥å£è°ƒç”¨æ›¿æ¢ä¸ºä¸€ä¸ªé—¨é¢æ¥å£è°ƒç”¨ï¼Œå‡å°‘ç½‘ç»œé€šä¿¡æˆæœ¬ï¼Œæé«˜ App å®¢æˆ·ç«¯çš„å“åº”é€Ÿåº¦ã€‚æˆ‘ä»¬æ¥è®¨è®ºä¸€ä¸‹è¿™æ ·ä¸€ä¸ªé—®é¢˜ï¼šä»ä»£ç å®ç°çš„è§’åº¦æ¥çœ‹ï¼Œè¯¥å¦‚ä½•ç»„ç»‡é—¨é¢æ¥å£å’Œéé—¨é¢æ¥å£ï¼Ÿ</li><li>å¦‚æœé—¨é¢æ¥å£ä¸å¤šï¼Œæˆ‘ä»¬å®Œå…¨å¯ä»¥å°†å®ƒè·Ÿéé—¨é¢æ¥å£æ”¾åˆ°ä¸€å—ï¼Œä¹Ÿä¸éœ€è¦ç‰¹æ®Šæ ‡è®°ï¼Œå½“ä½œæ™®é€šæ¥å£æ¥ç”¨å³å¯ã€‚å¦‚æœé—¨é¢æ¥å£å¾ˆå¤šï¼Œæˆ‘ä»¬å¯ä»¥åœ¨å·²æœ‰çš„æ¥å£ä¹‹ä¸Šï¼Œå†é‡æ–°æŠ½è±¡å‡ºä¸€å±‚ï¼Œä¸“é—¨æ”¾ç½®é—¨é¢æ¥å£ï¼Œä»ç±»ã€åŒ…çš„å‘½åä¸Šè·ŸåŸæ¥çš„æ¥å£å±‚åšåŒºåˆ†ã€‚å¦‚æœé—¨é¢æ¥å£ç‰¹åˆ«å¤šï¼Œå¹¶ä¸”å¾ˆå¤šéƒ½æ˜¯è·¨å¤šä¸ªå­ç³»ç»Ÿçš„ï¼Œæˆ‘ä»¬å¯ä»¥å°†é—¨é¢æ¥å£æ”¾åˆ°ä¸€ä¸ªæ–°çš„å­ç³»ç»Ÿä¸­ã€‚</li></ol><h4 id="3ã€è§£å†³åˆ†å¸ƒå¼äº‹åŠ¡é—®é¢˜"><a href="#3ã€è§£å†³åˆ†å¸ƒå¼äº‹åŠ¡é—®é¢˜" class="headerlink" title="3ã€è§£å†³åˆ†å¸ƒå¼äº‹åŠ¡é—®é¢˜"></a>3ã€è§£å†³åˆ†å¸ƒå¼äº‹åŠ¡é—®é¢˜</h4><ol><li>å…³äºåˆ©ç”¨é—¨é¢æ¨¡å¼æ¥è§£å†³åˆ†å¸ƒå¼äº‹åŠ¡é—®é¢˜ï¼Œæˆ‘ä»¬é€šè¿‡ä¸€ä¸ªä¾‹å­æ¥è§£é‡Šä¸€ä¸‹ã€‚</li><li>åœ¨ä¸€ä¸ªé‡‘èç³»ç»Ÿä¸­ï¼Œæœ‰ä¸¤ä¸ªä¸šåŠ¡é¢†åŸŸæ¨¡å‹ï¼Œç”¨æˆ·å’Œé’±åŒ…ã€‚è¿™ä¸¤ä¸ªä¸šåŠ¡é¢†åŸŸæ¨¡å‹éƒ½å¯¹å¤–æš´éœ²äº†ä¸€ç³»åˆ—æ¥å£ï¼Œæ¯”å¦‚ç”¨æˆ·çš„å¢åˆ æ”¹æŸ¥æ¥å£ã€é’±åŒ…çš„å¢åˆ æ”¹æŸ¥æ¥å£ã€‚å‡è®¾æœ‰è¿™æ ·ä¸€ä¸ªä¸šåŠ¡åœºæ™¯ï¼šåœ¨ç”¨æˆ·æ³¨å†Œçš„æ—¶å€™ï¼Œæˆ‘ä»¬ä¸ä»…ä¼šåˆ›å»ºç”¨æˆ·ï¼ˆåœ¨æ•°æ®åº“ User è¡¨ä¸­ï¼‰ï¼Œè¿˜ä¼šç»™ç”¨æˆ·åˆ›å»ºä¸€ä¸ªé’±åŒ…ï¼ˆåœ¨æ•°æ®åº“çš„ Wallet è¡¨ä¸­ï¼‰ã€‚</li><li>å¯¹äºè¿™æ ·ä¸€ä¸ªç®€å•çš„ä¸šåŠ¡éœ€æ±‚ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡ä¾æ¬¡è°ƒç”¨ç”¨æˆ·çš„åˆ›å»ºæ¥å£å’Œé’±åŒ…çš„åˆ›å»ºæ¥å£æ¥å®Œæˆã€‚ä½†æ˜¯ï¼Œç”¨æˆ·æ³¨å†Œéœ€è¦<code>æ”¯æŒäº‹åŠ¡</code>ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œåˆ›å»ºç”¨æˆ·å’Œé’±åŒ…çš„ä¸¤ä¸ªæ“ä½œï¼Œè¦ä¹ˆéƒ½æˆåŠŸï¼Œè¦ä¹ˆéƒ½å¤±è´¥ï¼Œä¸èƒ½ä¸€ä¸ªæˆåŠŸã€ä¸€ä¸ªå¤±è´¥ã€‚</li><li>è¦æ”¯æŒä¸¤ä¸ªæ¥å£è°ƒç”¨åœ¨ä¸€ä¸ªäº‹åŠ¡ä¸­æ‰§è¡Œï¼Œæ˜¯æ¯”è¾ƒéš¾å®ç°çš„ï¼Œè¿™æ¶‰åŠåˆ†å¸ƒå¼äº‹åŠ¡é—®é¢˜ã€‚è™½ç„¶æˆ‘ä»¬å¯ä»¥é€šè¿‡å¼•å…¥åˆ†å¸ƒå¼äº‹åŠ¡æ¡†æ¶æˆ–è€…äº‹åè¡¥å¿çš„æœºåˆ¶æ¥è§£å†³ï¼Œä½†ä»£ç å®ç°éƒ½æ¯”è¾ƒå¤æ‚ã€‚è€Œæœ€ç®€å•çš„è§£å†³æ–¹æ¡ˆæ˜¯ï¼Œåˆ©ç”¨æ•°æ®åº“äº‹åŠ¡æˆ–è€… Spring æ¡†æ¶æä¾›çš„äº‹åŠ¡ï¼ˆå¦‚æœæ˜¯ Java è¯­è¨€çš„è¯ï¼‰ï¼Œåœ¨ä¸€ä¸ªäº‹åŠ¡ä¸­ï¼Œæ‰§è¡Œåˆ›å»ºç”¨æˆ·å’Œåˆ›å»ºé’±åŒ…è¿™ä¸¤ä¸ª SQL æ“ä½œã€‚è¿™å°±è¦æ±‚ä¸¤ä¸ª SQL æ“ä½œè¦åœ¨ä¸€ä¸ªæ¥å£ä¸­å®Œæˆï¼Œæ‰€ä»¥ï¼Œæˆ‘ä»¬å¯ä»¥å€Ÿé‰´é—¨é¢æ¨¡å¼çš„æ€æƒ³ï¼Œå†è®¾è®¡ä¸€ä¸ªåŒ…è£¹è¿™ä¸¤ä¸ªæ“ä½œçš„æ–°æ¥å£ï¼Œè®©æ–°æ¥å£åœ¨ä¸€ä¸ªäº‹åŠ¡ä¸­æ‰§è¡Œä¸¤ä¸ª SQL æ“ä½œã€‚</li></ol><h1 id="äºŒã€ç»„åˆæ¨¡å¼ã€ä¸å¸¸ç”¨ã€‘"><a href="#äºŒã€ç»„åˆæ¨¡å¼ã€ä¸å¸¸ç”¨ã€‘" class="headerlink" title="äºŒã€ç»„åˆæ¨¡å¼ã€ä¸å¸¸ç”¨ã€‘"></a>äºŒã€ç»„åˆæ¨¡å¼ã€ä¸å¸¸ç”¨ã€‘</h1><ol><li>ç»„åˆæ¨¡å¼è·Ÿä¹‹å‰æåˆ°çš„é¢å‘å¯¹è±¡è®¾è®¡ä¸­çš„â€œç»„åˆå…³ç³»ï¼ˆé€šè¿‡ç»„åˆæ¥ç»„è£…ä¸¤ä¸ªç±»ï¼‰â€ï¼Œå®Œå…¨æ˜¯ä¸¤ç äº‹ã€‚è¿™é‡Œçš„â€œç»„åˆæ¨¡å¼â€ï¼Œä¸»è¦æ˜¯ç”¨æ¥å¤„ç†æ ‘å½¢ç»“æ„æ•°æ®ã€‚è¿™é‡Œçš„â€œæ•°æ®â€ï¼Œå¯ä»¥ç®€å•ç†è§£ä¸ºä¸€ç»„å¯¹è±¡é›†åˆã€‚</li><li>æ­£å› ä¸ºå…¶åº”ç”¨åœºæ™¯çš„ç‰¹æ®Šæ€§ï¼Œæ•°æ®å¿…é¡»èƒ½è¡¨ç¤ºæˆæ ‘å½¢ç»“æ„ï¼Œè¿™ä¹Ÿå¯¼è‡´äº†è¿™ç§æ¨¡å¼åœ¨å®é™…çš„é¡¹ç›®å¼€å‘ä¸­å¹¶ä¸é‚£ä¹ˆå¸¸ç”¨ã€‚ä½†æ˜¯ï¼Œä¸€æ—¦æ•°æ®æ»¡è¶³æ ‘å½¢ç»“æ„ï¼Œåº”ç”¨è¿™ç§æ¨¡å¼å°±èƒ½å‘æŒ¥å¾ˆå¤§çš„ä½œç”¨ï¼Œèƒ½è®©ä»£ç å˜å¾—éå¸¸ç®€æ´ã€‚</li></ol><h2 id="1ã€ç»„åˆæ¨¡å¼çš„åŸç†ä¸å®ç°"><a href="#1ã€ç»„åˆæ¨¡å¼çš„åŸç†ä¸å®ç°" class="headerlink" title="1ã€ç»„åˆæ¨¡å¼çš„åŸç†ä¸å®ç°"></a>1ã€ç»„åˆæ¨¡å¼çš„åŸç†ä¸å®ç°</h2><ol><li>åœ¨ GoF çš„ã€Šè®¾è®¡æ¨¡å¼ã€‹ä¸€ä¹¦ä¸­ï¼Œç»„åˆæ¨¡å¼æ˜¯è¿™æ ·å®šä¹‰çš„ï¼š</li></ol><blockquote><p>Compose objects into tree structure to represent part-whole hierarchies.Composite lets client treat individual objects and compositions of objects uniformly.</p></blockquote><ol><li><p>ç¿»è¯‘æˆä¸­æ–‡å°±æ˜¯ï¼šå°†ä¸€ç»„å¯¹è±¡ç»„ç»‡ï¼ˆComposeï¼‰æˆæ ‘å½¢ç»“æ„ï¼Œä»¥è¡¨ç¤ºä¸€ç§â€œéƒ¨åˆ† - æ•´ä½“â€çš„å±‚æ¬¡ç»“æ„ã€‚ç»„åˆè®©å®¢æˆ·ç«¯ï¼ˆåœ¨å¾ˆå¤šè®¾è®¡æ¨¡å¼ä¹¦ç±ä¸­ï¼Œâ€œå®¢æˆ·ç«¯â€ä»£æŒ‡ä»£ç çš„ä½¿ç”¨è€…ã€‚ï¼‰å¯ä»¥ç»Ÿä¸€å•ä¸ªå¯¹è±¡å’Œç»„åˆå¯¹è±¡çš„å¤„ç†é€»è¾‘ã€‚</p></li><li><p>å‡è®¾æœ‰è¿™æ ·ä¸€ä¸ªéœ€æ±‚ï¼šè®¾è®¡ä¸€ä¸ªç±»æ¥è¡¨ç¤ºæ–‡ä»¶ç³»ç»Ÿä¸­çš„ç›®å½•ï¼Œèƒ½æ–¹ä¾¿åœ°å®ç°ä¸‹é¢è¿™äº›åŠŸèƒ½ï¼š</p><ul><li><p>åŠ¨æ€åœ°æ·»åŠ ã€åˆ é™¤æŸä¸ªç›®å½•ä¸‹çš„å­ç›®å½•æˆ–æ–‡ä»¶ï¼›</p></li><li><p>ç»Ÿè®¡æŒ‡å®šç›®å½•ä¸‹çš„æ–‡ä»¶ä¸ªæ•°ï¼›</p></li><li><p>ç»Ÿè®¡æŒ‡å®šç›®å½•ä¸‹çš„æ–‡ä»¶æ€»å¤§å°ã€‚</p></li></ul></li><li><p>åœ¨ä¸‹é¢çš„ä»£ç å®ç°ä¸­ï¼ŒæŠŠæ–‡ä»¶å’Œç›®å½•ç»Ÿä¸€ç”¨ FileSystemNode ç±»æ¥è¡¨ç¤ºï¼Œå¹¶ä¸”é€šè¿‡ isFile å±æ€§æ¥åŒºåˆ†ã€‚</p></li></ol><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">FileSystemNode</span> &#123;<br>  <span class="hljs-keyword">private</span> String path;<br>  <span class="hljs-keyword">private</span> <span class="hljs-type">boolean</span> isFile;<br>  <span class="hljs-keyword">private</span> List&lt;FileSystemNode&gt; subNodes = <span class="hljs-keyword">new</span> <span class="hljs-title class_">ArrayList</span>&lt;&gt;();<br><br>  <span class="hljs-keyword">public</span> <span class="hljs-title function_">FileSystemNode</span><span class="hljs-params">(String path, <span class="hljs-type">boolean</span> isFile)</span> &#123;<br>    <span class="hljs-built_in">this</span>.path = path;<br>    <span class="hljs-built_in">this</span>.isFile = isFile;<br>  &#125;<br><br>  <span class="hljs-keyword">public</span> <span class="hljs-type">int</span> <span class="hljs-title function_">countNumOfFiles</span><span class="hljs-params">()</span> &#123;<br>    <span class="hljs-comment">// <span class="hljs-doctag">TODO:</span>...</span><br>  &#125;<br><br>  <span class="hljs-keyword">public</span> <span class="hljs-type">long</span> <span class="hljs-title function_">countSizeOfFiles</span><span class="hljs-params">()</span> &#123;<br>    <span class="hljs-comment">// <span class="hljs-doctag">TODO:</span>...</span><br>  &#125;<br><br>  <span class="hljs-keyword">public</span> String <span class="hljs-title function_">getPath</span><span class="hljs-params">()</span> &#123;<br>    <span class="hljs-keyword">return</span> path;<br>  &#125;<br><br>  <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">addSubNode</span><span class="hljs-params">(FileSystemNode fileOrDir)</span> &#123;<br>    subNodes.add(fileOrDir);<br>  &#125;<br><br>  <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">removeSubNode</span><span class="hljs-params">(FileSystemNode fileOrDir)</span> &#123;<br>    <span class="hljs-type">int</span> <span class="hljs-variable">size</span> <span class="hljs-operator">=</span> subNodes.size();<br>    <span class="hljs-type">int</span> <span class="hljs-variable">i</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>;<br>    <span class="hljs-keyword">for</span> (; i &lt; size; ++i) &#123;<br>      <span class="hljs-keyword">if</span> (subNodes.get(i).getPath().equalsIgnoreCase(fileOrDir.getPath())) &#123;<br>        <span class="hljs-keyword">break</span>;<br>      &#125;<br>    &#125;<br><br>    <span class="hljs-keyword">if</span> (i &lt; size) &#123;<br>      subNodes.remove(i);<br>    &#125;<br>  &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>æƒ³è¦è¡¥å…¨å…¶ä¸­çš„ countNumOfFiles() å’Œ countSizeOfFiles() è¿™ä¸¤ä¸ªå‡½æ•°ï¼Œå¹¶ä¸æ˜¯ä»¶éš¾äº‹ï¼Œå®é™…ä¸Šè¿™å°±æ˜¯æ ‘ä¸Šçš„é€’å½’éå†ç®—æ³•ã€‚å¯¹äºæ–‡ä»¶ï¼Œæˆ‘ä»¬ç›´æ¥è¿”å›æ–‡ä»¶çš„ä¸ªæ•°ï¼ˆè¿”å› 1ï¼‰æˆ–å¤§å°ã€‚å¯¹äºç›®å½•ï¼Œæˆ‘ä»¬éå†ç›®å½•ä¸­æ¯ä¸ªå­ç›®å½•æˆ–è€…æ–‡ä»¶ï¼Œé€’å½’è®¡ç®—å®ƒä»¬çš„ä¸ªæ•°æˆ–å¤§å°ï¼Œç„¶åæ±‚å’Œï¼Œå°±æ˜¯è¿™ä¸ªç›®å½•ä¸‹çš„æ–‡ä»¶ä¸ªæ•°å’Œæ–‡ä»¶å¤§å°ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-type">int</span> <span class="hljs-title function_">countNumOfFiles</span><span class="hljs-params">()</span> &#123;<br>    <span class="hljs-keyword">if</span> (isFile) &#123;<br>        <span class="hljs-keyword">return</span> <span class="hljs-number">1</span>;<br>    &#125;<br>    <span class="hljs-type">int</span> <span class="hljs-variable">numOfFiles</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>;<br>    <span class="hljs-keyword">for</span> (FileSystemNode fileOrDir : subNodes) &#123;<br>        numOfFiles += fileOrDir.countNumOfFiles();<br>    &#125;<br>    <span class="hljs-keyword">return</span> numOfFiles;<br>&#125;<br><br><span class="hljs-keyword">public</span> <span class="hljs-type">long</span> <span class="hljs-title function_">countSizeOfFiles</span><span class="hljs-params">()</span> &#123;<br>    <span class="hljs-keyword">if</span> (isFile) &#123;<br>        <span class="hljs-type">File</span> <span class="hljs-variable">file</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">File</span>(path);<br>        <span class="hljs-keyword">if</span> (!file.exists()) <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>        <span class="hljs-keyword">return</span> file.length();<br>    &#125;<br><br>    <span class="hljs-type">long</span> <span class="hljs-variable">sizeofFiles</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>;<br>    <span class="hljs-keyword">for</span> (FileSystemNode fileOrDir : subNodes) &#123;<br>         sizeofFiles += fileOrDir.countSizeOfFiles();<br>    &#125;<br>    <span class="hljs-keyword">return</span> sizeofFiles;<br>&#125;<br></code></pre></td></tr></table></figure><p>å•çº¯ä»åŠŸèƒ½å®ç°è§’åº¦æ¥è¯´ï¼Œä¸Šé¢çš„ä»£ç æ²¡æœ‰é—®é¢˜ï¼Œå·²ç»å®ç°äº†æˆ‘ä»¬æƒ³è¦çš„åŠŸèƒ½ã€‚ä½†æ˜¯ï¼Œå¦‚æœæˆ‘ä»¬å¼€å‘çš„æ˜¯ä¸€ä¸ªå¤§å‹ç³»ç»Ÿï¼Œä»æ‰©å±•æ€§ï¼ˆæ–‡ä»¶æˆ–ç›®å½•å¯èƒ½ä¼šå¯¹åº”ä¸åŒçš„æ“ä½œï¼‰ã€ä¸šåŠ¡å»ºæ¨¡ï¼ˆæ–‡ä»¶å’Œç›®å½•ä»ä¸šåŠ¡ä¸Šæ˜¯ä¸¤ä¸ªæ¦‚å¿µï¼‰ã€ä»£ç çš„å¯è¯»æ€§ï¼ˆæ–‡ä»¶å’Œç›®å½•åŒºåˆ†å¯¹å¾…æ›´åŠ ç¬¦åˆäººä»¬å¯¹ä¸šåŠ¡çš„è®¤çŸ¥ï¼‰çš„è§’åº¦æ¥è¯´ï¼Œæœ€å¥½å¯¹æ–‡ä»¶å’Œç›®å½•è¿›è¡ŒåŒºåˆ†è®¾è®¡ï¼Œå®šä¹‰ä¸º File å’Œ Directory ä¸¤ä¸ªç±»ã€‚</p><p>æŒ‰ç…§è¿™ä¸ªè®¾è®¡æ€è·¯ï¼Œæˆ‘ä»¬å¯¹ä»£ç è¿›è¡Œé‡æ„ã€‚é‡æ„ä¹‹åçš„ä»£ç å¦‚ä¸‹æ‰€ç¤ºï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">abstract</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">FileSystemNode</span> &#123;<br>  <span class="hljs-keyword">protected</span> String path;<br><br>  <span class="hljs-keyword">public</span> <span class="hljs-title function_">FileSystemNode</span><span class="hljs-params">(String path)</span> &#123;<br>    <span class="hljs-built_in">this</span>.path = path;<br>  &#125;<br><br>  <span class="hljs-keyword">public</span> <span class="hljs-keyword">abstract</span> <span class="hljs-type">int</span> <span class="hljs-title function_">countNumOfFiles</span><span class="hljs-params">()</span>;<br>  <span class="hljs-keyword">public</span> <span class="hljs-keyword">abstract</span> <span class="hljs-type">long</span> <span class="hljs-title function_">countSizeOfFiles</span><span class="hljs-params">()</span>;<br>  <br>  <span class="hljs-keyword">public</span> String <span class="hljs-title function_">getPath</span><span class="hljs-params">()</span> &#123;<br>    <span class="hljs-keyword">return</span> path;<br>  &#125;<br>&#125;<br><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">File</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_">FileSystemNode</span> &#123;<br><br>  <span class="hljs-keyword">public</span> <span class="hljs-title function_">File</span><span class="hljs-params">(String path)</span> &#123;<br>    <span class="hljs-built_in">super</span>(path);<br>  &#125;<br><br>  <span class="hljs-meta">@Override</span><br>  <span class="hljs-keyword">public</span> <span class="hljs-type">int</span> <span class="hljs-title function_">countNumOfFiles</span><span class="hljs-params">()</span> &#123;<br>    <span class="hljs-keyword">return</span> <span class="hljs-number">1</span>;<br>  &#125;<br><br>  <span class="hljs-meta">@Override</span><br>  <span class="hljs-keyword">public</span> <span class="hljs-type">long</span> <span class="hljs-title function_">countSizeOfFiles</span><span class="hljs-params">()</span> &#123;<br>    java.io.<span class="hljs-type">File</span> <span class="hljs-variable">file</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">java</span>.io.File(path);<br>    <span class="hljs-keyword">if</span> (!file.exists()) <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>    <span class="hljs-keyword">return</span> file.length();<br>  &#125;<br>&#125;<br><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Directory</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_">FileSystemNode</span> &#123;<br><br>  <span class="hljs-keyword">private</span> List&lt;FileSystemNode&gt; subNodes = <span class="hljs-keyword">new</span> <span class="hljs-title class_">ArrayList</span>&lt;&gt;();<br><br>  <span class="hljs-keyword">public</span> <span class="hljs-title function_">Directory</span><span class="hljs-params">(String path)</span> &#123;<br>    <span class="hljs-built_in">super</span>(path);<br>  &#125;<br><br>  <span class="hljs-meta">@Override</span><br>  <span class="hljs-keyword">public</span> <span class="hljs-type">int</span> <span class="hljs-title function_">countNumOfFiles</span><span class="hljs-params">()</span> &#123;<br>    <span class="hljs-type">int</span> <span class="hljs-variable">numOfFiles</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>;<br>    <span class="hljs-keyword">for</span> (FileSystemNode fileOrDir : subNodes) &#123;<br>      numOfFiles += fileOrDir.countNumOfFiles();<br>    &#125;<br>    <span class="hljs-keyword">return</span> numOfFiles;<br>  &#125;<br><br>  <span class="hljs-meta">@Override</span><br>  <span class="hljs-keyword">public</span> <span class="hljs-type">long</span> <span class="hljs-title function_">countSizeOfFiles</span><span class="hljs-params">()</span> &#123;<br>    <span class="hljs-type">long</span> <span class="hljs-variable">sizeofFiles</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>;<br>    <span class="hljs-keyword">for</span> (FileSystemNode fileOrDir : subNodes) &#123;<br>      sizeofFiles += fileOrDir.countSizeOfFiles();<br>    &#125;<br>    <span class="hljs-keyword">return</span> sizeofFiles;<br>  &#125;<br><br>  <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">addSubNode</span><span class="hljs-params">(FileSystemNode fileOrDir)</span> &#123;<br>    subNodes.add(fileOrDir);<br>  &#125;<br><br>  <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">removeSubNode</span><span class="hljs-params">(FileSystemNode fileOrDir)</span> &#123;<br>    <span class="hljs-type">int</span> <span class="hljs-variable">size</span> <span class="hljs-operator">=</span> subNodes.size();<br>    <span class="hljs-type">int</span> <span class="hljs-variable">i</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>;<br>    <span class="hljs-keyword">for</span> (; i &lt; size; ++i) &#123;<br>      <span class="hljs-keyword">if</span> (subNodes.get(i).getPath().equalsIgnoreCase(fileOrDir.getPath())) &#123;<br>        <span class="hljs-keyword">break</span>;<br>      &#125;<br>    &#125;<br><br>    <span class="hljs-keyword">if</span> (i &lt; size) &#123;<br>      subNodes.remove(i);<br>    &#125;<br>  &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>æ–‡ä»¶å’Œç›®å½•ç±»éƒ½è®¾è®¡å¥½äº†ï¼Œæˆ‘ä»¬æ¥çœ‹ï¼Œå¦‚ä½•ç”¨å®ƒä»¬æ¥è¡¨ç¤ºä¸€ä¸ªæ–‡ä»¶ç³»ç»Ÿä¸­çš„ç›®å½•æ ‘ç»“æ„ã€‚å…·ä½“çš„ä»£ç ç¤ºä¾‹å¦‚ä¸‹æ‰€ç¤ºï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Demo</span> &#123;<br><br>  <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span> &#123;<br><br>    <span class="hljs-comment">/**</span><br><span class="hljs-comment">     * /</span><br><span class="hljs-comment">     *</span><br><span class="hljs-comment">     * &lt;p&gt;/wz/</span><br><span class="hljs-comment">     *</span><br><span class="hljs-comment">     * &lt;p&gt;/wz/a.txt</span><br><span class="hljs-comment">     *</span><br><span class="hljs-comment">     * &lt;p&gt;/wz/b.txt</span><br><span class="hljs-comment">     *</span><br><span class="hljs-comment">     * &lt;p&gt;/wz/movies/</span><br><span class="hljs-comment">     *</span><br><span class="hljs-comment">     * &lt;p&gt;/wz/movies/c.avi</span><br><span class="hljs-comment">     *</span><br><span class="hljs-comment">     * &lt;p&gt;/xzg/</span><br><span class="hljs-comment">     *</span><br><span class="hljs-comment">     * &lt;p&gt;/xzg/docs/</span><br><span class="hljs-comment">     *</span><br><span class="hljs-comment">     * &lt;p&gt;/xzg/docs/d.txt</span><br><span class="hljs-comment">     */</span><br>    <span class="hljs-type">Directory</span> <span class="hljs-variable">fileSystemTree</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Directory</span>(<span class="hljs-string">&quot;/&quot;</span>);<br>    <span class="hljs-type">Directory</span> <span class="hljs-variable">node_wz</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Directory</span>(<span class="hljs-string">&quot;/wz/&quot;</span>);<br>    <span class="hljs-type">Directory</span> <span class="hljs-variable">node_xzg</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Directory</span>(<span class="hljs-string">&quot;/xzg/&quot;</span>);<br>    fileSystemTree.addSubNode(node_wz);<br>    fileSystemTree.addSubNode(node_xzg);<br><br>    <br>    <span class="hljs-type">File</span> <span class="hljs-variable">node_wz_a</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">File</span>(<span class="hljs-string">&quot;/wz/a.txt&quot;</span>);<br>    <span class="hljs-type">File</span> <span class="hljs-variable">node_wz_b</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">File</span>(<span class="hljs-string">&quot;/wz/b.txt&quot;</span>);<br>    <span class="hljs-type">Directory</span> <span class="hljs-variable">node_wz_movies</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Directory</span>(<span class="hljs-string">&quot;/wz/movies/&quot;</span>);<br>    node_wz.addSubNode(node_wz_a);<br>    node_wz.addSubNode(node_wz_b);<br>    node_wz.addSubNode(node_wz_movies);<br><br>    <br>    <span class="hljs-type">File</span> <span class="hljs-variable">node_wz_movies_c</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">File</span>(<span class="hljs-string">&quot;/wz/movies/c.avi&quot;</span>);<br>    node_wz_movies.addSubNode(node_wz_movies_c);<br><br>    <br>    <span class="hljs-type">Directory</span> <span class="hljs-variable">node_xzg_docs</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Directory</span>(<span class="hljs-string">&quot;/xzg/docs/&quot;</span>);<br>    node_xzg.addSubNode(node_xzg_docs);<br><br>    <br>    <span class="hljs-type">File</span> <span class="hljs-variable">node_xzg_docs_d</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">File</span>(<span class="hljs-string">&quot;/xzg/docs/d.txt&quot;</span>);<br>    node_xzg_docs.addSubNode(node_xzg_docs_d);<br><br>    <br>    System.out.println(<span class="hljs-string">&quot;/ files num:&quot;</span> + fileSystemTree.countNumOfFiles());<br>    System.out.println(<span class="hljs-string">&quot;/wz/ files num:&quot;</span> + node_wz.countNumOfFiles());<br>  &#125;<br>&#125;<br></code></pre></td></tr></table></figure><ol><li>å¯¹ç…§ç€è¿™ä¸ªä¾‹å­ï¼Œå†é‡æ–°çœ‹ä¸€ä¸‹ç»„åˆæ¨¡å¼çš„å®šä¹‰ï¼šâ€œå°†ä¸€ç»„å¯¹è±¡ï¼ˆæ–‡ä»¶å’Œç›®å½•ï¼‰ç»„ç»‡æˆæ ‘å½¢ç»“æ„ï¼Œä»¥è¡¨ç¤ºä¸€ç§â€˜éƒ¨åˆ† - æ•´ä½“â€™çš„å±‚æ¬¡ç»“æ„ï¼ˆç›®å½•ä¸å­ç›®å½•çš„åµŒå¥—ç»“æ„ï¼‰ã€‚ç»„åˆæ¨¡å¼è®©å®¢æˆ·ç«¯å¯ä»¥ç»Ÿä¸€å•ä¸ªå¯¹è±¡ï¼ˆæ–‡ä»¶ï¼‰å’Œç»„åˆå¯¹è±¡ï¼ˆç›®å½•ï¼‰çš„å¤„ç†é€»è¾‘ï¼ˆé€’å½’éå†ï¼‰ã€‚â€</li><li>å®é™…ä¸Šï¼Œåˆšæ‰çš„è¿™ç§ç»„åˆæ¨¡å¼çš„è®¾è®¡æ€è·¯ï¼Œä¸å…¶è¯´æ˜¯ä¸€ç§è®¾è®¡æ¨¡å¼ï¼Œå€’ä¸å¦‚è¯´æ˜¯å¯¹ä¸šåŠ¡åœºæ™¯çš„ä¸€ç§æ•°æ®ç»“æ„å’Œç®—æ³•çš„æŠ½è±¡ã€‚å…¶ä¸­ï¼Œæ•°æ®å¯ä»¥è¡¨ç¤ºæˆæ ‘è¿™ç§æ•°æ®ç»“æ„ï¼Œä¸šåŠ¡éœ€æ±‚å¯ä»¥é€šè¿‡åœ¨æ ‘ä¸Šçš„é€’å½’éå†ç®—æ³•æ¥å®ç°ã€‚</li></ol><h2 id="2ã€ç»„åˆæ¨¡å¼çš„åº”ç”¨åœºæ™¯ä¸¾ä¾‹"><a href="#2ã€ç»„åˆæ¨¡å¼çš„åº”ç”¨åœºæ™¯ä¸¾ä¾‹" class="headerlink" title="2ã€ç»„åˆæ¨¡å¼çš„åº”ç”¨åœºæ™¯ä¸¾ä¾‹"></a>2ã€ç»„åˆæ¨¡å¼çš„åº”ç”¨åœºæ™¯ä¸¾ä¾‹</h2><ol><li>åˆšåˆšæåˆ°äº†æ–‡ä»¶ç³»ç»Ÿçš„ä¾‹å­ï¼Œå¯¹äºç»„åˆæ¨¡å¼ï¼Œå†ä¸¾ä¸€ä¸ªä¾‹å­ã€‚åœ¨å®é™…çš„é¡¹ç›®ä¸­ï¼Œé‡åˆ°ç±»ä¼¼çš„å¯ä»¥è¡¨ç¤ºæˆæ ‘å½¢ç»“æ„çš„ä¸šåŠ¡åœºæ™¯ï¼Œåªè¦â€œç…§è‘«èŠ¦ç”»ç“¢â€å»è®¾è®¡å°±å¯ä»¥äº†ã€‚</li><li>å‡è®¾æˆ‘ä»¬åœ¨å¼€å‘ä¸€ä¸ª OA ç³»ç»Ÿï¼ˆåŠå…¬è‡ªåŠ¨åŒ–ç³»ç»Ÿï¼‰ã€‚å…¬å¸çš„ç»„ç»‡ç»“æ„åŒ…å«éƒ¨é—¨å’Œå‘˜å·¥ä¸¤ç§æ•°æ®ç±»å‹ã€‚å…¶ä¸­ï¼Œéƒ¨é—¨åˆå¯ä»¥åŒ…å«å­éƒ¨é—¨å’Œå‘˜å·¥ã€‚åœ¨æ•°æ®åº“ä¸­çš„è¡¨ç»“æ„å¦‚ä¸‹æ‰€ç¤ºï¼š</li></ol><p><img src="/2022/09/27/05-jie-gou-xing-men-mian-zu-he-xiang-yuan/image-20220927191655637.png"></p><ol><li>æˆ‘ä»¬å¸Œæœ›åœ¨å†…å­˜ä¸­æ„å»ºæ•´ä¸ªå…¬å¸çš„äººå‘˜æ¶æ„å›¾ï¼ˆéƒ¨é—¨ã€å­éƒ¨é—¨ã€å‘˜å·¥çš„éš¶å±å…³ç³»ï¼‰ï¼Œå¹¶ä¸”æä¾›æ¥å£è®¡ç®—å‡ºéƒ¨é—¨çš„è–ªèµ„æˆæœ¬ï¼ˆéš¶å±äºè¿™ä¸ªéƒ¨é—¨çš„æ‰€æœ‰å‘˜å·¥çš„è–ªèµ„å’Œï¼‰ã€‚</li><li>éƒ¨é—¨åŒ…å«å­éƒ¨é—¨å’Œå‘˜å·¥ï¼Œè¿™æ˜¯ä¸€ç§åµŒå¥—ç»“æ„ï¼Œå¯ä»¥è¡¨ç¤ºæˆæ ‘è¿™ç§æ•°æ®ç»“æ„ã€‚è®¡ç®—æ¯ä¸ªéƒ¨é—¨çš„è–ªèµ„å¼€æ”¯è¿™æ ·ä¸€ä¸ªéœ€æ±‚ï¼Œä¹Ÿå¯ä»¥é€šè¿‡åœ¨æ ‘ä¸Šçš„éå†ç®—æ³•æ¥å®ç°ã€‚æ‰€ä»¥ï¼Œä»è¿™ä¸ªè§’åº¦æ¥çœ‹ï¼Œè¿™ä¸ªåº”ç”¨åœºæ™¯å¯ä»¥ä½¿ç”¨ç»„åˆæ¨¡å¼æ¥è®¾è®¡å’Œå®ç°ã€‚</li><li>è¿™ä¸ªä¾‹å­çš„ä»£ç ç»“æ„è·Ÿä¸Šä¸€ä¸ªä¾‹å­çš„å¾ˆç›¸ä¼¼ï¼Œä»£ç å®ç°è´´åœ¨ä¸‹é¢ã€‚å…¶ä¸­ï¼ŒHumanResource æ˜¯éƒ¨é—¨ç±»ï¼ˆDepartmentï¼‰å’Œå‘˜å·¥ç±»ï¼ˆEmployeeï¼‰æŠ½è±¡å‡ºæ¥çš„çˆ¶ç±»ï¼Œä¸ºçš„æ˜¯èƒ½ç»Ÿä¸€è–ªèµ„çš„å¤„ç†é€»è¾‘ã€‚Demo ä¸­çš„ä»£ç è´Ÿè´£ä»æ•°æ®åº“ä¸­è¯»å–æ•°æ®å¹¶åœ¨å†…å­˜ä¸­æ„å»ºç»„ç»‡æ¶æ„å›¾ã€‚</li></ol><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span>  <span class="hljs-keyword">abstract</span>  <span class="hljs-keyword">class</span>  <span class="hljs-title class_">HumanResource</span>  &#123;<br>  <span class="hljs-keyword">protected</span>  <span class="hljs-type">long</span> id;<br>  <span class="hljs-keyword">protected</span>  <span class="hljs-type">double</span> salary;<br><br>  <span class="hljs-keyword">public</span>  <span class="hljs-title function_">HumanResource</span><span class="hljs-params">(<span class="hljs-type">long</span> id)</span>  &#123;<br>    <span class="hljs-built_in">this</span>.id = id;<br>  &#125;<br><br>  <span class="hljs-keyword">public</span>  <span class="hljs-type">long</span>  <span class="hljs-title function_">getId</span><span class="hljs-params">()</span>  &#123;<br>    <span class="hljs-keyword">return</span> id;<br>  &#125;<br><br>  <span class="hljs-keyword">public</span>  <span class="hljs-keyword">abstract</span>  <span class="hljs-type">double</span>  <span class="hljs-title function_">calculateSalary</span><span class="hljs-params">()</span>;<br><br>&#125;<br><br><span class="hljs-keyword">public</span>  <span class="hljs-keyword">class</span>  <span class="hljs-title class_">Employee</span>  <span class="hljs-keyword">extends</span>  <span class="hljs-title class_">HumanResource</span>  &#123;<br><br>  <span class="hljs-keyword">public</span>  <span class="hljs-title function_">Employee</span><span class="hljs-params">(<span class="hljs-type">long</span> id, <span class="hljs-type">double</span> salary)</span>  &#123;<br>    <span class="hljs-built_in">super</span>(id);<br>    <span class="hljs-built_in">this</span>.salary = salary;<br>  &#125;<br><br>  <span class="hljs-meta">@Override</span><br><br>  <span class="hljs-keyword">public</span>  <span class="hljs-type">double</span>  <span class="hljs-title function_">calculateSalary</span><span class="hljs-params">()</span>  &#123;<br>    <span class="hljs-keyword">return</span> salary;<br>  &#125;<br>&#125;<br><br><span class="hljs-keyword">public</span>  <span class="hljs-keyword">class</span>  <span class="hljs-title class_">Department</span>  <span class="hljs-keyword">extends</span>  <span class="hljs-title class_">HumanResource</span>  &#123;<br>  <span class="hljs-keyword">private</span> List&lt;HumanResource&gt; subNodes = <span class="hljs-keyword">new</span> <span class="hljs-title class_">ArrayList</span>&lt;&gt;();<br><br>  <span class="hljs-keyword">public</span>  <span class="hljs-title function_">Department</span><span class="hljs-params">(<span class="hljs-type">long</span> id)</span>  &#123;<br>    <span class="hljs-built_in">super</span>(id);<br>  &#125;<br><br>  <span class="hljs-meta">@Override</span><br><br>  <span class="hljs-keyword">public</span>  <span class="hljs-type">double</span>  <span class="hljs-title function_">calculateSalary</span><span class="hljs-params">()</span>  &#123;<br>    <span class="hljs-type">double</span> <span class="hljs-variable">totalSalary</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>;<br>    <span class="hljs-keyword">for</span> (HumanResource hr : subNodes) &#123;<br>      totalSalary += hr.calculateSalary();<br>    &#125;<br>    <span class="hljs-built_in">this</span>.salary = totalSalary;<br>    <span class="hljs-keyword">return</span> totalSalary;<br><br>  &#125;<br><br>  <span class="hljs-keyword">public</span>  <span class="hljs-keyword">void</span>  <span class="hljs-title function_">addSubNode</span><span class="hljs-params">(HumanResource hr)</span>  &#123;<br>    subNodes.add(hr);<br>  &#125;<br>&#125;<br><br><span class="hljs-comment">// æ„å»ºç»„ç»‡æ¶æ„çš„ä»£ç </span><br><span class="hljs-keyword">public</span>  <span class="hljs-keyword">class</span>  <span class="hljs-title class_">Demo</span>  &#123;<br>  <span class="hljs-keyword">private</span>  <span class="hljs-keyword">static</span>  <span class="hljs-keyword">final</span>  <span class="hljs-type">long</span> ORGANIZATION\_ROOT\_ID = <span class="hljs-number">1001</span>;<br>  <span class="hljs-keyword">private</span> DepartmentRepo departmentRepo; <span class="hljs-comment">// ä¾èµ–æ³¨å…¥</span><br>  <span class="hljs-keyword">private</span> EmployeeRepo employeeRepo; <span class="hljs-comment">// ä¾èµ–æ³¨å…¥</span><br><br>  <span class="hljs-keyword">public</span>  <span class="hljs-keyword">void</span>  <span class="hljs-title function_">buildOrganization</span><span class="hljs-params">()</span>  &#123;<br>    <span class="hljs-type">Department</span> <span class="hljs-variable">rootDepartment</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Department</span>(ORGANIZATION\_ROOT\_ID);<br>    buildOrganization(rootDepartment);<br>  &#125;<br><br>  <span class="hljs-keyword">private</span>  <span class="hljs-keyword">void</span>  <span class="hljs-title function_">buildOrganization</span><span class="hljs-params">(Department department)</span>  &#123;<br>    List&lt;Long&gt; subDepartmentIds = departmentRepo.getSubDepartmentIds(department.getId());<br>    <span class="hljs-keyword">for</span> (Long subDepartmentId : subDepartmentIds) &#123;<br>      <span class="hljs-type">Department</span> <span class="hljs-variable">subDepartment</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Department</span>(subDepartmentId);<br>      department.addSubNode(subDepartment);<br>      buildOrganization(subDepartment);<br>    &#125;<br><br>    List&lt;Long&gt; employeeIds = employeeRepo.getDepartmentEmployeeIds(department.getId());<br>    <span class="hljs-keyword">for</span> (Long employeeId : employeeIds) &#123;<br>      <span class="hljs-type">double</span> <span class="hljs-variable">salary</span> <span class="hljs-operator">=</span> employeeRepo.getEmployeeSalary(employeeId);<br>      department.addSubNode(<span class="hljs-keyword">new</span> <span class="hljs-title class_">Employee</span>(employeeId, salary));<br>    &#125;<br>  &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>å†æ‹¿ç»„åˆæ¨¡å¼çš„å®šä¹‰è·Ÿè¿™ä¸ªä¾‹å­å¯¹ç…§ä¸€ä¸‹ï¼šâ€œå°†ä¸€ç»„å¯¹è±¡ï¼ˆå‘˜å·¥å’Œéƒ¨é—¨ï¼‰ç»„ç»‡æˆæ ‘å½¢ç»“æ„ï¼Œä»¥è¡¨ç¤ºä¸€ç§â€˜éƒ¨åˆ† - æ•´ä½“â€™çš„å±‚æ¬¡ç»“æ„ï¼ˆéƒ¨é—¨ä¸å­éƒ¨é—¨çš„åµŒå¥—ç»“æ„ï¼‰ã€‚ç»„åˆæ¨¡å¼è®©å®¢æˆ·ç«¯å¯ä»¥ç»Ÿä¸€å•ä¸ªå¯¹è±¡ï¼ˆå‘˜å·¥ï¼‰å’Œç»„åˆå¯¹è±¡ï¼ˆéƒ¨é—¨ï¼‰çš„å¤„ç†é€»è¾‘ï¼ˆé€’å½’éå†ï¼‰ã€‚â€</p><h1 id="ä¸‰ã€äº«å…ƒæ¨¡å¼ã€ä¸å¸¸ç”¨ã€‘"><a href="#ä¸‰ã€äº«å…ƒæ¨¡å¼ã€ä¸å¸¸ç”¨ã€‘" class="headerlink" title="ä¸‰ã€äº«å…ƒæ¨¡å¼ã€ä¸å¸¸ç”¨ã€‘"></a>ä¸‰ã€äº«å…ƒæ¨¡å¼ã€ä¸å¸¸ç”¨ã€‘</h1><p>è·Ÿå…¶ä»–æ‰€æœ‰çš„è®¾è®¡æ¨¡å¼ç±»ä¼¼ï¼Œäº«å…ƒæ¨¡å¼çš„åŸç†å’Œå®ç°ä¹Ÿéå¸¸ç®€å•ã€‚</p><h2 id="1ã€äº«å…ƒæ¨¡å¼åŸç†ä¸å®ç°"><a href="#1ã€äº«å…ƒæ¨¡å¼åŸç†ä¸å®ç°" class="headerlink" title="1ã€äº«å…ƒæ¨¡å¼åŸç†ä¸å®ç°"></a>1ã€äº«å…ƒæ¨¡å¼åŸç†ä¸å®ç°</h2><ol><li>æ‰€è°“â€œäº«å…ƒâ€ï¼Œé¡¾åæ€ä¹‰å°±æ˜¯è¢«å…±äº«çš„å•å…ƒã€‚äº«å…ƒæ¨¡å¼çš„æ„å›¾æ˜¯å¤ç”¨å¯¹è±¡ï¼ŒèŠ‚çœå†…å­˜ï¼Œå‰ææ˜¯<code>äº«å…ƒå¯¹è±¡æ˜¯ä¸å¯å˜å¯¹è±¡</code>ã€‚</li><li>å…·ä½“æ¥è®²ï¼Œå½“ä¸€ä¸ªç³»ç»Ÿä¸­å­˜åœ¨å¤§é‡é‡å¤å¯¹è±¡çš„æ—¶å€™ï¼Œå¦‚æœè¿™äº›é‡å¤çš„å¯¹è±¡æ˜¯ä¸å¯å˜å¯¹è±¡ï¼Œæˆ‘ä»¬å°±å¯ä»¥åˆ©ç”¨äº«å…ƒæ¨¡å¼å°†å¯¹è±¡è®¾è®¡æˆäº«å…ƒï¼Œåœ¨å†…å­˜ä¸­åªä¿ç•™ä¸€ä»½å®ä¾‹ï¼Œä¾›å¤šå¤„ä»£ç å¼•ç”¨ã€‚è¿™æ ·å¯ä»¥å‡å°‘å†…å­˜ä¸­å¯¹è±¡çš„æ•°é‡ï¼Œèµ·åˆ°èŠ‚çœå†…å­˜çš„ç›®çš„ã€‚å®é™…ä¸Šï¼Œä¸ä»…ä»…ç›¸åŒå¯¹è±¡å¯ä»¥è®¾è®¡æˆäº«å…ƒï¼Œå¯¹äºç›¸ä¼¼å¯¹è±¡ï¼Œæˆ‘ä»¬ä¹Ÿå¯ä»¥å°†è¿™äº›å¯¹è±¡ä¸­ç›¸åŒçš„éƒ¨åˆ†ï¼ˆå­—æ®µï¼‰æå–å‡ºæ¥ï¼Œè®¾è®¡æˆäº«å…ƒï¼Œè®©è¿™äº›å¤§é‡ç›¸ä¼¼å¯¹è±¡å¼•ç”¨è¿™äº›äº«å…ƒã€‚</li><li>è¿™é‡Œæˆ‘ç¨å¾®è§£é‡Šä¸€ä¸‹ï¼Œå®šä¹‰ä¸­çš„â€œä¸å¯å˜å¯¹è±¡â€æŒ‡çš„æ˜¯ï¼Œä¸€æ—¦é€šè¿‡æ„é€ å‡½æ•°åˆå§‹åŒ–å®Œæˆä¹‹åï¼Œå®ƒçš„çŠ¶æ€ï¼ˆå¯¹è±¡çš„æˆå‘˜å˜é‡æˆ–è€…å±æ€§ï¼‰å°±ä¸ä¼šå†è¢«ä¿®æ”¹äº†ã€‚æ‰€ä»¥ï¼Œä¸å¯å˜å¯¹è±¡<code>ä¸èƒ½æš´éœ²ä»»ä½• set() ç­‰ä¿®æ”¹å†…éƒ¨çŠ¶æ€çš„æ–¹æ³•</code>ã€‚ä¹‹æ‰€ä»¥è¦æ±‚äº«å…ƒæ˜¯ä¸å¯å˜å¯¹è±¡ï¼Œé‚£æ˜¯å› ä¸ºå®ƒä¼šè¢«å¤šå¤„ä»£ç å…±äº«ä½¿ç”¨ï¼Œé¿å…ä¸€å¤„ä»£ç å¯¹äº«å…ƒè¿›è¡Œäº†ä¿®æ”¹ï¼Œå½±å“åˆ°å…¶ä»–ä½¿ç”¨å®ƒçš„ä»£ç ã€‚</li><li>æ¥ä¸‹æ¥ï¼Œé€šè¿‡ä¸€ä¸ªç®€å•çš„ä¾‹å­è§£é‡Šä¸€ä¸‹äº«å…ƒæ¨¡å¼ã€‚</li><li>å‡è®¾æˆ‘ä»¬åœ¨å¼€å‘ä¸€ä¸ªæ£‹ç‰Œæ¸¸æˆï¼ˆæ¯”å¦‚è±¡æ£‹ï¼‰ã€‚ä¸€ä¸ªæ¸¸æˆå…ä¸­æœ‰æˆåƒä¸Šä¸‡ä¸ªâ€œæˆ¿é—´â€ï¼Œæ¯ä¸ªæˆ¿é—´å¯¹åº”ä¸€ä¸ªæ£‹å±€ã€‚æ£‹å±€è¦ä¿å­˜æ¯ä¸ªæ£‹å­çš„æ•°æ®ï¼Œæ¯”å¦‚ï¼šæ£‹å­ç±»å‹ï¼ˆå°†ã€ç›¸ã€å£«ã€ç‚®ç­‰ï¼‰ã€æ£‹å­é¢œè‰²ï¼ˆçº¢æ–¹ã€é»‘æ–¹ï¼‰ã€æ£‹å­åœ¨æ£‹å±€ä¸­çš„ä½ç½®ã€‚åˆ©ç”¨è¿™äº›æ•°æ®ï¼Œæˆ‘ä»¬å°±èƒ½æ˜¾ç¤ºä¸€ä¸ªå®Œæ•´çš„æ£‹ç›˜ç»™ç©å®¶ã€‚å…·ä½“çš„ä»£ç å¦‚ä¸‹æ‰€ç¤ºã€‚å…¶ä¸­ï¼ŒChessPiece ç±»è¡¨ç¤ºæ£‹å­ï¼ŒChessBoard ç±»è¡¨ç¤ºä¸€ä¸ªæ£‹å±€ï¼Œé‡Œé¢ä¿å­˜äº†è±¡æ£‹ä¸­ 30 ä¸ªæ£‹å­çš„ä¿¡æ¯ã€‚</li></ol><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">ChessPiece</span> &#123; <span class="hljs-comment">// æ£‹å­</span><br>  <span class="hljs-keyword">private</span> <span class="hljs-type">int</span> id;<br>  <span class="hljs-keyword">private</span> String text;<br>  <span class="hljs-keyword">private</span> Color color;<br>  <span class="hljs-keyword">private</span> <span class="hljs-type">int</span> positionX;<br>  <span class="hljs-keyword">private</span> <span class="hljs-type">int</span> positionY;<br><br>  <span class="hljs-keyword">public</span> <span class="hljs-title function_">ChessPiece</span><span class="hljs-params">(<span class="hljs-type">int</span> id, String text, Color color, <span class="hljs-type">int</span> positionX, <span class="hljs-type">int</span> positionY)</span> &#123;<br>    <span class="hljs-built_in">this</span>.id = id;<br>    <span class="hljs-built_in">this</span>.text = text;<br>    <span class="hljs-built_in">this</span>.color = color;<br>    <span class="hljs-built_in">this</span>.positionX = positionX;<br>    <span class="hljs-built_in">this</span>.positionY = positionX;<br>  &#125;<br><br>  <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">enum</span> <span class="hljs-title class_">Color</span> &#123;<br>    RED,<br>    BLACK<br>  &#125;<br><br>  <span class="hljs-comment">// ...çœç•¥å…¶ä»–å±æ€§å’Œgetter/setteræ–¹æ³•...</span><br><br>&#125;<br><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">ChessBoard</span> &#123; <span class="hljs-comment">// æ£‹å±€</span><br>  <span class="hljs-keyword">private</span> Map&lt;Integer, ChessPiece&gt; chessPieces = <span class="hljs-keyword">new</span> <span class="hljs-title class_">HashMap</span>&lt;&gt;();<br><br>  <span class="hljs-keyword">public</span> <span class="hljs-title function_">ChessBoard</span><span class="hljs-params">()</span> &#123;<br>    init();<br>  &#125;<br><br>  <span class="hljs-keyword">private</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">init</span><span class="hljs-params">()</span> &#123;<br>    chessPieces.put(<span class="hljs-number">1</span>, <span class="hljs-keyword">new</span> <span class="hljs-title class_">ChessPiece</span>(<span class="hljs-number">1</span>, <span class="hljs-string">&quot;è»Š&quot;</span>, ChessPiece.Color.BLACK, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>));<br>    chessPieces.put(<span class="hljs-number">2</span>, <span class="hljs-keyword">new</span> <span class="hljs-title class_">ChessPiece</span>(<span class="hljs-number">2</span>, <span class="hljs-string">&quot;é¦¬&quot;</span>, ChessPiece.Color.BLACK, <span class="hljs-number">0</span>, <span class="hljs-number">1</span>));<br>    <span class="hljs-comment">// ...çœç•¥æ‘†æ”¾å…¶ä»–æ£‹å­çš„ä»£ç ...</span><br>  &#125;<br><br>  <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">move</span><span class="hljs-params">(<span class="hljs-type">int</span> chessPieceId, <span class="hljs-type">int</span> toPositionX, <span class="hljs-type">int</span> toPositionY)</span> &#123;<br>    <span class="hljs-comment">// ...çœç•¥...</span><br>  &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>ä¸ºäº†è®°å½•æ¯ä¸ªæˆ¿é—´å½“å‰çš„æ£‹å±€æƒ…å†µï¼Œæˆ‘ä»¬éœ€è¦ç»™æ¯ä¸ªæˆ¿é—´éƒ½åˆ›å»ºä¸€ä¸ª ChessBoard æ£‹å±€å¯¹è±¡ã€‚å› ä¸ºæ¸¸æˆå¤§å…ä¸­æœ‰æˆåƒä¸Šä¸‡çš„æˆ¿é—´ï¼ˆå®é™…ä¸Šï¼Œç™¾ä¸‡äººåŒæ—¶åœ¨çº¿çš„æ¸¸æˆå¤§å…ä¹Ÿæœ‰å¾ˆå¤šï¼‰ï¼Œé‚£ä¿å­˜è¿™ä¹ˆå¤šæ£‹å±€å¯¹è±¡å°±ä¼šæ¶ˆè€—å¤§é‡çš„å†…å­˜ã€‚æœ‰æ²¡æœ‰ä»€ä¹ˆåŠæ³•æ¥èŠ‚çœå†…å­˜å‘¢ï¼Ÿ</p><p>è¿™ä¸ªæ—¶å€™ï¼Œäº«å…ƒæ¨¡å¼å°±å¯ä»¥æ´¾ä¸Šç”¨åœºäº†ã€‚åƒåˆšåˆšçš„å®ç°æ–¹å¼ï¼Œåœ¨å†…å­˜ä¸­ä¼šæœ‰å¤§é‡çš„ç›¸ä¼¼å¯¹è±¡ã€‚è¿™äº›ç›¸ä¼¼å¯¹è±¡çš„ idã€textã€color éƒ½æ˜¯ç›¸åŒçš„ï¼Œå”¯ç‹¬ positionXã€positionY ä¸åŒã€‚å®é™…ä¸Šï¼Œæˆ‘ä»¬å¯ä»¥å°†æ£‹å­çš„ idã€textã€color å±æ€§æ‹†åˆ†å‡ºæ¥ï¼Œè®¾è®¡æˆç‹¬ç«‹çš„ç±»ï¼Œå¹¶ä¸”ä½œä¸ºäº«å…ƒä¾›å¤šä¸ªæ£‹ç›˜å¤ç”¨ã€‚è¿™æ ·ï¼Œæ£‹ç›˜åªéœ€è¦è®°å½•æ¯ä¸ªæ£‹å­çš„ä½ç½®ä¿¡æ¯å°±å¯ä»¥äº†ã€‚å…·ä½“çš„ä»£ç å®ç°å¦‚ä¸‹æ‰€ç¤ºï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-comment">// äº«å…ƒç±»</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">ChessPieceUnit</span> &#123;<br>  <span class="hljs-keyword">private</span> <span class="hljs-type">int</span> id;<br>  <span class="hljs-keyword">private</span> String text;<br>  <span class="hljs-keyword">private</span> Color color;<br><br>  <span class="hljs-keyword">public</span> <span class="hljs-title function_">ChessPieceUnit</span><span class="hljs-params">(<span class="hljs-type">int</span> id, String text, Color color)</span> &#123;<br>    <span class="hljs-built_in">this</span>.id = id;<br>    <span class="hljs-built_in">this</span>.text = text;<br>    <span class="hljs-built_in">this</span>.color = color;<br>  &#125;<br><br>  <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">enum</span> <span class="hljs-title class_">Color</span> &#123;<br>    RED,<br>    BLACK<br>  &#125;<br>  <span class="hljs-comment">// ...çœç•¥å…¶ä»–å±æ€§å’Œgetteræ–¹æ³•...</span><br><br>&#125;<br><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">ChessPieceUnitFactory</span> &#123;<br>  <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> Map&lt;Integer, ChessPieceUnit&gt; pieces = <span class="hljs-keyword">new</span> <span class="hljs-title class_">HashMap</span>&lt;&gt;();<br><br>  <span class="hljs-keyword">static</span> &#123;<br>    pieces.put(<span class="hljs-number">1</span>, <span class="hljs-keyword">new</span> <span class="hljs-title class_">ChessPieceUnit</span>(<span class="hljs-number">1</span>, <span class="hljs-string">&quot;è»Š&quot;</span>, ChessPieceUnit.Color.BLACK));<br>    pieces.put(<span class="hljs-number">2</span>, <span class="hljs-keyword">new</span> <span class="hljs-title class_">ChessPieceUnit</span>(<span class="hljs-number">2</span>, <span class="hljs-string">&quot;é¦¬&quot;</span>, ChessPieceUnit.Color.BLACK));<br>    <span class="hljs-comment">// ...çœç•¥æ‘†æ”¾å…¶ä»–æ£‹å­çš„ä»£ç ...</span><br>  &#125;<br><br>  <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> ChessPieceUnit <span class="hljs-title function_">getChessPiece</span><span class="hljs-params">(<span class="hljs-type">int</span> chessPieceId)</span> &#123;<br>    <span class="hljs-keyword">return</span> pieces.get(chessPieceId);<br>  &#125;<br>&#125;<br><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">ChessPiece</span> &#123;<br>  <span class="hljs-keyword">private</span> ChessPieceUnit chessPieceUnit;<br>  <span class="hljs-keyword">private</span> <span class="hljs-type">int</span> positionX;<br>  <span class="hljs-keyword">private</span> <span class="hljs-type">int</span> positionY;<br><br>  <span class="hljs-keyword">public</span> <span class="hljs-title function_">ChessPiece</span><span class="hljs-params">(ChessPieceUnit unit, <span class="hljs-type">int</span> positionX, <span class="hljs-type">int</span> positionY)</span> &#123;<br>    <span class="hljs-built_in">this</span>.chessPieceUnit = unit;<br>    <span class="hljs-built_in">this</span>.positionX = positionX;<br>    <span class="hljs-built_in">this</span>.positionY = positionY;<br>  &#125;<br><br>  <span class="hljs-comment">// çœç•¥getterã€setteræ–¹æ³•</span><br>&#125;<br><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">ChessBoard</span> &#123;<br>  <span class="hljs-keyword">private</span> Map&lt;Integer, ChessPiece&gt; chessPieces = <span class="hljs-keyword">new</span> <span class="hljs-title class_">HashMap</span>&lt;&gt;();<br>  <br>  <span class="hljs-keyword">public</span> <span class="hljs-title function_">ChessBoard</span><span class="hljs-params">()</span> &#123;<br>    init();<br>  &#125;<br><br>  <span class="hljs-keyword">private</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">init</span><span class="hljs-params">()</span> &#123;<br>    chessPieces.put(<span class="hljs-number">1</span>, <span class="hljs-keyword">new</span> <span class="hljs-title class_">ChessPiece</span>(ChessPieceUnitFactory.getChessPiece(<span class="hljs-number">1</span>), <span class="hljs-number">0</span>, <span class="hljs-number">0</span>));<br>    chessPieces.put(<span class="hljs-number">1</span>, <span class="hljs-keyword">new</span> <span class="hljs-title class_">ChessPiece</span>(ChessPieceUnitFactory.getChessPiece(<span class="hljs-number">2</span>), <span class="hljs-number">1</span>, <span class="hljs-number">0</span>));<br>    <span class="hljs-comment">// ...çœç•¥æ‘†æ”¾å…¶ä»–æ£‹å­çš„ä»£ç ...</span><br>  &#125;<br><br>  <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">move</span><span class="hljs-params">(<span class="hljs-type">int</span> chessPieceId, <span class="hljs-type">int</span> toPositionX, <span class="hljs-type">int</span> toPositionY)</span> &#123;<br>    <span class="hljs-comment">// ...çœç•¥...</span><br>  &#125;<br>&#125;<br></code></pre></td></tr></table></figure><ol><li>åœ¨ä¸Šé¢çš„ä»£ç å®ç°ä¸­ï¼Œåˆ©ç”¨å·¥å‚ç±»æ¥ç¼“å­˜ ChessPieceUnit ä¿¡æ¯ï¼ˆä¹Ÿå°±æ˜¯ idã€textã€colorï¼‰ã€‚é€šè¿‡å·¥å‚ç±»è·å–åˆ°çš„ ChessPieceUnit å°±æ˜¯äº«å…ƒã€‚æ‰€æœ‰çš„ ChessBoard å¯¹è±¡å…±äº«è¿™ 30 ä¸ª ChessPieceUnit å¯¹è±¡ï¼ˆå› ä¸ºè±¡æ£‹ä¸­åªæœ‰ 30 ä¸ªæ£‹å­ï¼‰ã€‚åœ¨ä½¿ç”¨äº«å…ƒæ¨¡å¼ä¹‹å‰ï¼Œè®°å½• 1 ä¸‡ä¸ªæ£‹å±€ï¼Œæˆ‘ä»¬è¦åˆ›å»º 30 ä¸‡ï¼ˆ30*1 ä¸‡ï¼‰ä¸ªæ£‹å­çš„ ChessPieceUnit å¯¹è±¡ã€‚åˆ©ç”¨äº«å…ƒæ¨¡å¼ï¼Œæˆ‘ä»¬åªéœ€è¦åˆ›å»º 30 ä¸ªäº«å…ƒå¯¹è±¡ä¾›æ‰€æœ‰æ£‹å±€å…±äº«ä½¿ç”¨å³å¯ï¼Œå¤§å¤§èŠ‚çœäº†å†…å­˜ã€‚</li><li>é‚£äº«å…ƒæ¨¡å¼çš„åŸç†è®²å®Œäº†ï¼Œæˆ‘ä»¬æ¥æ€»ç»“ä¸€ä¸‹å®ƒçš„ä»£ç ç»“æ„ã€‚å®é™…ä¸Šï¼Œå®ƒçš„ä»£ç å®ç°éå¸¸ç®€å•ï¼Œä¸»è¦æ˜¯é€šè¿‡å·¥å‚æ¨¡å¼ï¼Œåœ¨å·¥å‚ç±»ä¸­ï¼Œé€šè¿‡ä¸€ä¸ª Map æ¥ç¼“å­˜å·²ç»åˆ›å»ºè¿‡çš„äº«å…ƒå¯¹è±¡ï¼Œæ¥è¾¾åˆ°å¤ç”¨çš„ç›®çš„ã€‚</li></ol><h2 id="2ã€äº«å…ƒæ¨¡å¼åœ¨æ–‡æœ¬ç¼–è¾‘å™¨ä¸­çš„åº”ç”¨"><a href="#2ã€äº«å…ƒæ¨¡å¼åœ¨æ–‡æœ¬ç¼–è¾‘å™¨ä¸­çš„åº”ç”¨" class="headerlink" title="2ã€äº«å…ƒæ¨¡å¼åœ¨æ–‡æœ¬ç¼–è¾‘å™¨ä¸­çš„åº”ç”¨"></a>2ã€äº«å…ƒæ¨¡å¼åœ¨æ–‡æœ¬ç¼–è¾‘å™¨ä¸­çš„åº”ç”¨</h2><ol><li>å¼„æ‡‚äº†äº«å…ƒæ¨¡å¼çš„åŸç†å’Œå®ç°ä¹‹åï¼Œå†æ¥çœ‹å¦å¤–ä¸€ä¸ªä¾‹å­ï¼Œå¦‚ä½•åˆ©ç”¨äº«å…ƒæ¨¡å¼æ¥ä¼˜åŒ–æ–‡æœ¬ç¼–è¾‘å™¨çš„å†…å­˜å ç”¨ï¼Ÿ</li><li>å¯ä»¥æŠŠè¿™é‡Œæåˆ°çš„æ–‡æœ¬ç¼–è¾‘å™¨æƒ³è±¡æˆ Office çš„ Wordã€‚ä¸è¿‡ï¼Œä¸ºäº†ç®€åŒ–éœ€æ±‚èƒŒæ™¯ï¼Œæˆ‘ä»¬å‡è®¾è¿™ä¸ªæ–‡æœ¬ç¼–è¾‘å™¨åªå®ç°äº†æ–‡å­—ç¼–è¾‘åŠŸèƒ½ï¼Œä¸åŒ…å«å›¾ç‰‡ã€è¡¨æ ¼ç­‰å¤æ‚çš„ç¼–è¾‘åŠŸèƒ½ã€‚å¯¹äºç®€åŒ–ä¹‹åçš„æ–‡æœ¬ç¼–è¾‘å™¨ï¼Œæˆ‘ä»¬è¦åœ¨å†…å­˜ä¸­è¡¨ç¤ºä¸€ä¸ªæ–‡æœ¬æ–‡ä»¶ï¼Œåªéœ€è¦è®°å½•æ–‡å­—å’Œæ ¼å¼ä¸¤éƒ¨åˆ†ä¿¡æ¯å°±å¯ä»¥äº†ï¼Œå…¶ä¸­ï¼Œæ ¼å¼åˆåŒ…æ‹¬æ–‡å­—çš„å­—ä½“ã€å¤§å°ã€é¢œè‰²ç­‰ä¿¡æ¯ã€‚</li><li>å°½ç®¡åœ¨å®é™…çš„æ–‡æ¡£ç¼–å†™ä¸­ï¼Œæˆ‘ä»¬ä¸€èˆ¬éƒ½æ˜¯æŒ‰ç…§æ–‡æœ¬ç±»å‹ï¼ˆæ ‡é¢˜ã€æ­£æ–‡â€¦â€¦ï¼‰æ¥è®¾ç½®æ–‡å­—çš„æ ¼å¼ï¼Œæ ‡é¢˜æ˜¯ä¸€ç§æ ¼å¼ï¼Œæ­£æ–‡æ˜¯å¦ä¸€ç§æ ¼å¼ç­‰ç­‰ã€‚ä½†æ˜¯ï¼Œä»ç†è®ºä¸Šè®²ï¼Œæˆ‘ä»¬å¯ä»¥ç»™æ–‡æœ¬æ–‡ä»¶ä¸­çš„æ¯ä¸ªæ–‡å­—éƒ½è®¾ç½®ä¸åŒçš„æ ¼å¼ã€‚ä¸ºäº†å®ç°å¦‚æ­¤çµæ´»çš„æ ¼å¼è®¾ç½®ï¼Œå¹¶ä¸”ä»£ç å®ç°åˆä¸è¿‡äºå¤ªå¤æ‚ï¼Œæˆ‘ä»¬æŠŠæ¯ä¸ªæ–‡å­—éƒ½å½“ä½œä¸€ä¸ªç‹¬ç«‹çš„å¯¹è±¡æ¥çœ‹å¾…ï¼Œå¹¶ä¸”åœ¨å…¶ä¸­åŒ…å«å®ƒçš„æ ¼å¼ä¿¡æ¯ã€‚å…·ä½“çš„ä»£ç ç¤ºä¾‹å¦‚ä¸‹æ‰€ç¤ºï¼š</li></ol><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Character</span> &#123; <span class="hljs-comment">// æ–‡å­—</span><br>  <span class="hljs-keyword">private</span> <span class="hljs-type">char</span> c;<br><br>  <span class="hljs-keyword">private</span> Font font;<br>  <span class="hljs-keyword">private</span> <span class="hljs-type">int</span> size;<br>  <span class="hljs-keyword">private</span> <span class="hljs-type">int</span> colorRGB;<br><br>  <span class="hljs-keyword">public</span> <span class="hljs-title function_">Character</span><span class="hljs-params">(<span class="hljs-type">char</span> c, Font font, <span class="hljs-type">int</span> size, <span class="hljs-type">int</span> colorRGB)</span> &#123;<br>    <span class="hljs-built_in">this</span>.c = c;<br>    <span class="hljs-built_in">this</span>.font = font;<br>    <span class="hljs-built_in">this</span>.size = size;<br>    <span class="hljs-built_in">this</span>.colorRGB = colorRGB;<br>  &#125;<br>&#125;<br><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Editor</span> &#123;<br>  <span class="hljs-keyword">private</span> List&lt;Character&gt; chars = <span class="hljs-keyword">new</span> <span class="hljs-title class_">ArrayList</span>&lt;&gt;();<br><br>  <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">appendCharacter</span><span class="hljs-params">(<span class="hljs-type">char</span> c, Font font, <span class="hljs-type">int</span> size, <span class="hljs-type">int</span> colorRGB)</span> &#123;<br>    <span class="hljs-type">Character</span> <span class="hljs-variable">character</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Character</span>(c, font, size, colorRGB);<br>    chars.add(character);<br>  &#125;<br>&#125;<br></code></pre></td></tr></table></figure><ol><li>åœ¨æ–‡æœ¬ç¼–è¾‘å™¨ä¸­ï¼Œæˆ‘ä»¬æ¯æ•²ä¸€ä¸ªæ–‡å­—ï¼Œéƒ½ä¼šè°ƒç”¨ Editor ç±»ä¸­çš„ appendCharacter() æ–¹æ³•ï¼Œåˆ›å»ºä¸€ä¸ªæ–°çš„ Character å¯¹è±¡ï¼Œä¿å­˜åˆ° chars æ•°ç»„ä¸­ã€‚å¦‚æœä¸€ä¸ªæ–‡æœ¬æ–‡ä»¶ä¸­ï¼Œæœ‰ä¸Šä¸‡ã€åå‡ ä¸‡ã€å‡ åä¸‡çš„æ–‡å­—ï¼Œé‚£æˆ‘ä»¬å°±è¦åœ¨å†…å­˜ä¸­å­˜å‚¨è¿™ä¹ˆå¤š Character å¯¹è±¡ã€‚é‚£æœ‰æ²¡æœ‰åŠæ³•å¯ä»¥èŠ‚çœä¸€ç‚¹å†…å­˜å‘¢ï¼Ÿ</li><li>å®é™…ä¸Šï¼Œåœ¨ä¸€ä¸ªæ–‡æœ¬æ–‡ä»¶ä¸­ï¼Œç”¨åˆ°çš„å­—ä½“æ ¼å¼ä¸ä¼šå¤ªå¤šï¼Œæ¯•ç«Ÿä¸å¤§å¯èƒ½æœ‰äººæŠŠæ¯ä¸ªæ–‡å­—éƒ½è®¾ç½®æˆä¸åŒçš„æ ¼å¼ã€‚æ‰€ä»¥ï¼Œå¯¹äºå­—ä½“æ ¼å¼ï¼Œæˆ‘ä»¬å¯ä»¥å°†å®ƒè®¾è®¡æˆäº«å…ƒï¼Œè®©ä¸åŒçš„æ–‡å­—å…±äº«ä½¿ç”¨ã€‚æŒ‰ç…§è¿™ä¸ªè®¾è®¡æ€è·¯ï¼Œæˆ‘ä»¬å¯¹ä¸Šé¢çš„ä»£ç è¿›è¡Œé‡æ„ã€‚é‡æ„åçš„ä»£ç å¦‚ä¸‹æ‰€ç¤ºï¼š</li></ol><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">CharacterStyle</span> &#123;<br>  <span class="hljs-keyword">private</span> Font font;<br>  <span class="hljs-keyword">private</span> <span class="hljs-type">int</span> size;<br>  <span class="hljs-keyword">private</span> <span class="hljs-type">int</span> colorRGB;<br><br>  <span class="hljs-keyword">public</span> <span class="hljs-title function_">CharacterStyle</span><span class="hljs-params">(Font font, <span class="hljs-type">int</span> size, <span class="hljs-type">int</span> colorRGB)</span> &#123;<br>    <span class="hljs-built_in">this</span>.font = font;<br>    <span class="hljs-built_in">this</span>.size = size;<br>    <span class="hljs-built_in">this</span>.colorRGB = colorRGB;<br>  &#125;<br><br>  <span class="hljs-meta">@Override</span><br>  <span class="hljs-keyword">public</span> <span class="hljs-type">boolean</span> <span class="hljs-title function_">equals</span><span class="hljs-params">(Object o)</span> &#123;<br>    <span class="hljs-type">CharacterStyle</span> <span class="hljs-variable">otherStyle</span> <span class="hljs-operator">=</span> (CharacterStyle) o;<br>    <span class="hljs-keyword">return</span> font.equals(otherStyle.font)<br>        &amp;&amp; size == otherStyle.size<br>        &amp;&amp; colorRGB == otherStyle.colorRGB;<br>  &#125;<br>&#125;<br><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">CharacterStyleFactory</span> &#123;<br>  <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> List&lt;CharacterStyle&gt; styles = <span class="hljs-keyword">new</span> <span class="hljs-title class_">ArrayList</span>&lt;&gt;();<br><br>  <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> CharacterStyle <span class="hljs-title function_">getStyle</span><span class="hljs-params">(Font font, <span class="hljs-type">int</span> size, <span class="hljs-type">int</span> colorRGB)</span> &#123;<br>    <span class="hljs-type">CharacterStyle</span> <span class="hljs-variable">newStyle</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">CharacterStyle</span>(font, size, colorRGB);<br>    <span class="hljs-keyword">for</span> (CharacterStyle style : styles) &#123;<br>      <span class="hljs-keyword">if</span> (style.equals(newStyle)) &#123;<br>        <span class="hljs-keyword">return</span> style;<br>      &#125;<br>    &#125;<br>    styles.add(newStyle);<br>    <span class="hljs-keyword">return</span> newStyle;<br>  &#125;<br>&#125;<br><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Character</span> &#123;<br>  <span class="hljs-keyword">private</span> <span class="hljs-type">char</span> c;<br>  <span class="hljs-keyword">private</span> CharacterStyle style;<br><br>  <span class="hljs-keyword">public</span> <span class="hljs-title function_">Character</span><span class="hljs-params">(<span class="hljs-type">char</span> c, CharacterStyle style)</span> &#123;<br>    <span class="hljs-built_in">this</span>.c = c;<br>    <span class="hljs-built_in">this</span>.style = style;<br>  &#125;<br>&#125;<br><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Editor</span> &#123;<br>  <span class="hljs-keyword">private</span> List&lt;Character&gt; chars = <span class="hljs-keyword">new</span> <span class="hljs-title class_">ArrayList</span>&lt;&gt;();<br><br>  <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">appendCharacter</span><span class="hljs-params">(<span class="hljs-type">char</span> c, Font font, <span class="hljs-type">int</span> size, <span class="hljs-type">int</span> colorRGB)</span> &#123;<br>    <span class="hljs-type">Character</span> <span class="hljs-variable">character</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Character</span>(c, CharacterStyleFactory.getStyle(font, size, colorRGB));<br>    chars.add(character);<br>  &#125;<br>&#125;<br></code></pre></td></tr></table></figure><h2 id="3ã€äº«å…ƒæ¨¡å¼-vs-å•ä¾‹ã€ç¼“å­˜ã€å¯¹è±¡æ± "><a href="#3ã€äº«å…ƒæ¨¡å¼-vs-å•ä¾‹ã€ç¼“å­˜ã€å¯¹è±¡æ± " class="headerlink" title="3ã€äº«å…ƒæ¨¡å¼ vs å•ä¾‹ã€ç¼“å­˜ã€å¯¹è±¡æ± "></a>3ã€äº«å…ƒæ¨¡å¼ vs å•ä¾‹ã€ç¼“å­˜ã€å¯¹è±¡æ± </h2><p>åœ¨ä¸Šé¢çš„è®²è§£ä¸­ï¼Œå¤šæ¬¡æåˆ°â€œå…±äº«â€â€œç¼“å­˜â€â€œå¤ç”¨â€è¿™äº›å­—çœ¼ï¼Œé‚£å®ƒè·Ÿå•ä¾‹ã€ç¼“å­˜ã€å¯¹è±¡æ± è¿™äº›æ¦‚å¿µæœ‰ä»€ä¹ˆåŒºåˆ«å‘¢ï¼Ÿæˆ‘ä»¬æ¥ç®€å•å¯¹æ¯”ä¸€ä¸‹ã€‚</p><h3 id="1ã€äº«å…ƒæ¨¡å¼è·Ÿå•ä¾‹çš„åŒºåˆ«"><a href="#1ã€äº«å…ƒæ¨¡å¼è·Ÿå•ä¾‹çš„åŒºåˆ«" class="headerlink" title="1ã€äº«å…ƒæ¨¡å¼è·Ÿå•ä¾‹çš„åŒºåˆ«"></a>1ã€äº«å…ƒæ¨¡å¼è·Ÿå•ä¾‹çš„åŒºåˆ«</h3><ol><li>åœ¨å•ä¾‹æ¨¡å¼ä¸­ï¼Œä¸€ä¸ªç±»åªèƒ½åˆ›å»ºä¸€ä¸ªå¯¹è±¡ï¼Œè€Œåœ¨äº«å…ƒæ¨¡å¼ä¸­ï¼Œä¸€ä¸ªç±»å¯ä»¥åˆ›å»ºå¤šä¸ªå¯¹è±¡ï¼Œæ¯ä¸ªå¯¹è±¡è¢«å¤šå¤„ä»£ç å¼•ç”¨å…±äº«ã€‚å®é™…ä¸Šï¼Œäº«å…ƒæ¨¡å¼æœ‰ç‚¹ç±»ä¼¼äºä¹‹å‰è®²åˆ°çš„å•ä¾‹çš„å˜ä½“ï¼šå¤šä¾‹ã€‚</li><li>æˆ‘ä»¬å‰é¢ä¹Ÿå¤šæ¬¡æåˆ°ï¼ŒåŒºåˆ«ä¸¤ç§è®¾è®¡æ¨¡å¼ï¼Œä¸èƒ½å…‰çœ‹ä»£ç å®ç°ï¼Œè€Œæ˜¯è¦çœ‹è®¾è®¡æ„å›¾ï¼Œä¹Ÿå°±æ˜¯è¦è§£å†³çš„é—®é¢˜ã€‚å°½ç®¡ä»ä»£ç å®ç°ä¸Šæ¥çœ‹ï¼Œäº«å…ƒæ¨¡å¼å’Œå¤šä¾‹æœ‰å¾ˆå¤šç›¸ä¼¼ä¹‹å¤„ï¼Œä½†ä»è®¾è®¡æ„å›¾ä¸Šæ¥çœ‹ï¼Œå®ƒä»¬æ˜¯å®Œå…¨ä¸åŒçš„ã€‚åº”ç”¨äº«å…ƒæ¨¡å¼æ˜¯ä¸ºäº†<code>å¯¹è±¡å¤ç”¨ï¼ŒèŠ‚çœå†…å­˜</code>ï¼Œè€Œåº”ç”¨å¤šä¾‹æ¨¡å¼æ˜¯ä¸ºäº†<code>é™åˆ¶å¯¹è±¡çš„ä¸ªæ•°</code>ã€‚</li></ol><h3 id="2ã€äº«å…ƒæ¨¡å¼è·Ÿç¼“å­˜çš„åŒºåˆ«"><a href="#2ã€äº«å…ƒæ¨¡å¼è·Ÿç¼“å­˜çš„åŒºåˆ«" class="headerlink" title="2ã€äº«å…ƒæ¨¡å¼è·Ÿç¼“å­˜çš„åŒºåˆ«"></a>2ã€äº«å…ƒæ¨¡å¼è·Ÿç¼“å­˜çš„åŒºåˆ«</h3><p>åœ¨äº«å…ƒæ¨¡å¼çš„å®ç°ä¸­ï¼Œæˆ‘ä»¬é€šè¿‡å·¥å‚ç±»æ¥â€œç¼“å­˜â€å·²ç»åˆ›å»ºå¥½çš„å¯¹è±¡ã€‚è¿™é‡Œçš„â€œç¼“å­˜â€å®é™…ä¸Šæ˜¯â€œå­˜å‚¨â€çš„æ„æ€ï¼Œè·Ÿæˆ‘ä»¬å¹³æ—¶æ‰€è¯´çš„â€œæ•°æ®åº“ç¼“å­˜â€â€œCPU ç¼“å­˜â€â€œMemCache ç¼“å­˜â€æ˜¯ä¸¤å›äº‹ã€‚æˆ‘ä»¬å¹³æ—¶æ‰€è®²çš„ç¼“å­˜ï¼Œä¸»è¦æ˜¯ä¸ºäº†æé«˜è®¿é—®æ•ˆç‡ï¼Œè€Œéå¤ç”¨ã€‚</p><h3 id="3ã€äº«å…ƒæ¨¡å¼è·Ÿå¯¹è±¡æ± çš„åŒºåˆ«"><a href="#3ã€äº«å…ƒæ¨¡å¼è·Ÿå¯¹è±¡æ± çš„åŒºåˆ«" class="headerlink" title="3ã€äº«å…ƒæ¨¡å¼è·Ÿå¯¹è±¡æ± çš„åŒºåˆ«"></a>3ã€äº«å…ƒæ¨¡å¼è·Ÿå¯¹è±¡æ± çš„åŒºåˆ«</h3><ol><li>å¯¹è±¡æ± ã€è¿æ¥æ± ï¼ˆæ¯”å¦‚æ•°æ®åº“è¿æ¥æ± ï¼‰ã€çº¿ç¨‹æ± ç­‰ä¹Ÿæ˜¯ä¸ºäº†å¤ç”¨ï¼Œé‚£å®ƒä»¬è·Ÿäº«å…ƒæ¨¡å¼æœ‰ä»€ä¹ˆåŒºåˆ«å‘¢ï¼Ÿ</li><li>åƒ C++ è¿™æ ·çš„ç¼–ç¨‹è¯­è¨€ï¼Œå†…å­˜çš„ç®¡ç†æ˜¯ç”±ç¨‹åºå‘˜è´Ÿè´£çš„ã€‚ä¸ºäº†é¿å…é¢‘ç¹åœ°è¿›è¡Œå¯¹è±¡åˆ›å»ºå’Œé‡Šæ”¾å¯¼è‡´å†…å­˜ç¢ç‰‡ï¼Œæˆ‘ä»¬å¯ä»¥é¢„å…ˆç”³è¯·ä¸€ç‰‡è¿ç»­çš„å†…å­˜ç©ºé—´ï¼Œä¹Ÿå°±æ˜¯è¿™é‡Œè¯´çš„å¯¹è±¡æ± ã€‚æ¯æ¬¡åˆ›å»ºå¯¹è±¡æ—¶ï¼Œæˆ‘ä»¬ä»å¯¹è±¡æ± ä¸­ç›´æ¥å–å‡ºä¸€ä¸ªç©ºé—²å¯¹è±¡æ¥ä½¿ç”¨ï¼Œå¯¹è±¡ä½¿ç”¨å®Œæˆä¹‹åï¼Œå†æ”¾å›åˆ°å¯¹è±¡æ± ä¸­ä»¥ä¾›åç»­å¤ç”¨ï¼Œè€Œéç›´æ¥é‡Šæ”¾æ‰ã€‚</li><li>è™½ç„¶å¯¹è±¡æ± ã€è¿æ¥æ± ã€çº¿ç¨‹æ± ã€äº«å…ƒæ¨¡å¼éƒ½æ˜¯ä¸ºäº†å¤ç”¨ï¼Œä½†æ˜¯ï¼Œå¦‚æœæˆ‘ä»¬å†ç»†è‡´åœ°æŠ ä¸€æŠ â€œå¤ç”¨â€è¿™ä¸ªå­—çœ¼çš„è¯ï¼Œå¯¹è±¡æ± ã€è¿æ¥æ± ã€çº¿ç¨‹æ± ç­‰æ± åŒ–æŠ€æœ¯ä¸­çš„â€œå¤ç”¨â€å’Œäº«å…ƒæ¨¡å¼ä¸­çš„â€œå¤ç”¨â€å®é™…ä¸Šæ˜¯ä¸åŒçš„æ¦‚å¿µã€‚</li><li>æ± åŒ–æŠ€æœ¯ä¸­çš„â€œå¤ç”¨â€å¯ä»¥ç†è§£ä¸ºâ€œé‡å¤ä½¿ç”¨â€ï¼Œä¸»è¦ç›®çš„æ˜¯<code>èŠ‚çœæ—¶é—´</code>ï¼ˆæ¯”å¦‚ä»æ•°æ®åº“æ± ä¸­å–ä¸€ä¸ªè¿æ¥ï¼Œä¸éœ€è¦é‡æ–°åˆ›å»ºï¼‰ã€‚åœ¨ä»»æ„æ—¶åˆ»ï¼Œæ¯ä¸€ä¸ªå¯¹è±¡ã€è¿æ¥ã€çº¿ç¨‹ï¼Œå¹¶ä¸ä¼šè¢«å¤šå¤„ä½¿ç”¨ï¼Œè€Œæ˜¯è¢«ä¸€ä¸ªä½¿ç”¨è€…ç‹¬å ï¼Œå½“ä½¿ç”¨å®Œæˆä¹‹åï¼Œæ”¾å›åˆ°æ± ä¸­ï¼Œå†ç”±å…¶ä»–ä½¿ç”¨è€…é‡å¤åˆ©ç”¨ã€‚äº«å…ƒæ¨¡å¼ä¸­çš„â€œå¤ç”¨â€å¯ä»¥ç†è§£ä¸ºâ€œå…±äº«ä½¿ç”¨â€ï¼Œåœ¨æ•´ä¸ªç”Ÿå‘½å‘¨æœŸä¸­ï¼Œéƒ½æ˜¯è¢«æ‰€æœ‰ä½¿ç”¨è€…å…±äº«çš„ï¼Œä¸»è¦ç›®çš„æ˜¯<code>èŠ‚çœç©ºé—´</code>ã€‚</li></ol><h2 id="4ã€äº«å…ƒæ¨¡å¼åœ¨Java-Integerã€Stringä¸­çš„åº”ç”¨"><a href="#4ã€äº«å…ƒæ¨¡å¼åœ¨Java-Integerã€Stringä¸­çš„åº”ç”¨" class="headerlink" title="4ã€äº«å…ƒæ¨¡å¼åœ¨Java Integerã€Stringä¸­çš„åº”ç”¨"></a>4ã€äº«å…ƒæ¨¡å¼åœ¨Java Integerã€Stringä¸­çš„åº”ç”¨</h2><p>å…ˆæ¥çœ‹ä¸€æ®µä»£ç </p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-type">Integer</span> <span class="hljs-variable">i1</span> <span class="hljs-operator">=</span> <span class="hljs-number">56</span>;<br><span class="hljs-type">Integer</span> <span class="hljs-variable">i2</span> <span class="hljs-operator">=</span> <span class="hljs-number">56</span>;<br><span class="hljs-type">Integer</span> <span class="hljs-variable">i3</span> <span class="hljs-operator">=</span> <span class="hljs-number">129</span>;<br><span class="hljs-type">Integer</span> <span class="hljs-variable">i4</span> <span class="hljs-operator">=</span> <span class="hljs-number">129</span>;<br>System.out.println(i1 == i2);<br>System.out.println(i3 == i4);<br></code></pre></td></tr></table></figure><ol><li>Javaæä¾›äº†è‡ªåŠ¨æ‹†ç®±ä¸è£…ç®±æœºåˆ¶ï¼Œæ¯”å¦‚intçš„è£…ç®±å°±æ˜¯Integer.valueOf(); æ‹†ç®±å°±æ˜¯i.intValue();</li><li>å‰ 4 è¡Œèµ‹å€¼è¯­å¥éƒ½ä¼šè§¦å‘è‡ªåŠ¨è£…ç®±æ“ä½œï¼Œä¹Ÿå°±æ˜¯ä¼šåˆ›å»º Integer å¯¹è±¡å¹¶ä¸”èµ‹å€¼ç»™ i1ã€i2ã€i3ã€i4 è¿™å››ä¸ªå˜é‡ã€‚æ ¹æ®åˆšåˆšçš„è®²è§£ï¼Œi1ã€i2 å°½ç®¡å­˜å‚¨çš„æ•°å€¼ç›¸åŒï¼Œéƒ½æ˜¯ 56ï¼Œä½†æ˜¯æŒ‡å‘ä¸åŒçš„ Integer å¯¹è±¡ï¼Œæ‰€ä»¥é€šè¿‡â€==â€æ¥åˆ¤å®šæ˜¯å¦ç›¸åŒçš„æ—¶å€™ï¼Œä¼šè¿”å› falseã€‚åŒç†ï¼Œi3 i4 åˆ¤å®šè¯­å¥ä¹Ÿä¼šè¿”å› falseã€‚</li><li>ä¸è¿‡ï¼Œä¸Šé¢çš„åˆ†æè¿˜æ˜¯ä¸å¯¹ï¼Œç­”æ¡ˆå¹¶éæ˜¯ä¸¤ä¸ª falseï¼Œè€Œæ˜¯ä¸€ä¸ª trueï¼Œä¸€ä¸ª falseã€‚çœ‹åˆ°è¿™é‡Œï¼Œå¯èƒ½ä¼šæ¯”è¾ƒçº³é—·äº†ã€‚å®é™…ä¸Šï¼Œè¿™æ­£æ˜¯å› ä¸º Integer ç”¨åˆ°äº†äº«å…ƒæ¨¡å¼æ¥å¤ç”¨å¯¹è±¡ï¼Œæ‰å¯¼è‡´äº†è¿™æ ·çš„è¿è¡Œç»“æœã€‚å½“æˆ‘ä»¬é€šè¿‡è‡ªåŠ¨è£…ç®±ï¼Œä¹Ÿå°±æ˜¯è°ƒç”¨ valueOf() æ¥åˆ›å»º Integer å¯¹è±¡çš„æ—¶å€™ï¼Œå¦‚æœè¦åˆ›å»ºçš„ Integer å¯¹è±¡çš„å€¼åœ¨ -128 åˆ° 127 ä¹‹é—´ï¼Œä¼šä» IntegerCache ç±»ä¸­ç›´æ¥è¿”å›ï¼Œå¦åˆ™æ‰è°ƒç”¨ new æ–¹æ³•åˆ›å»ºã€‚çœ‹ä»£ç æ›´åŠ æ¸…æ™°ä¸€äº›ï¼ŒInteger ç±»çš„ valueOf() å‡½æ•°çš„å…·ä½“ä»£ç å¦‚ä¸‹æ‰€ç¤ºï¼š</li></ol><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> Integer <span class="hljs-title function_">valueOf</span><span class="hljs-params">(<span class="hljs-type">int</span> i)</span> &#123;<br>       <span class="hljs-keyword">if</span> (i &gt;= IntegerCache.low &amp;&amp; i &lt;= IntegerCache.high)<br>           <span class="hljs-keyword">return</span> IntegerCache.cache[i + (-IntegerCache.low)];<br>       <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Integer</span>(i);<br>   &#125;<br></code></pre></td></tr></table></figure><p>å®é™…ä¸Šï¼Œè¿™é‡Œçš„ IntegerCache ç›¸å½“äºï¼Œæˆ‘ä»¬ä¸Šé¢è®²çš„ç”Ÿæˆäº«å…ƒå¯¹è±¡çš„å·¥å‚ç±»ï¼Œåªä¸è¿‡åå­—ä¸å« xxxFactory è€Œå·²ã€‚æˆ‘ä»¬æ¥çœ‹å®ƒçš„å…·ä½“ä»£ç å®ç°ã€‚è¿™ä¸ªç±»æ˜¯ Integer çš„å†…éƒ¨ç±»ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">IntegerCache</span> &#123;<br>       <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> <span class="hljs-type">int</span> <span class="hljs-variable">low</span> <span class="hljs-operator">=</span> -<span class="hljs-number">128</span>;<br>       <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> <span class="hljs-type">int</span> high;<br>       <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> Integer cache[];<br><br>       <span class="hljs-keyword">static</span> &#123;<br>           <span class="hljs-comment">// high value may be configured by property</span><br>           <span class="hljs-type">int</span> <span class="hljs-variable">h</span> <span class="hljs-operator">=</span> <span class="hljs-number">127</span>;<br>           <span class="hljs-type">String</span> <span class="hljs-variable">integerCacheHighPropValue</span> <span class="hljs-operator">=</span><br>               VM.getSavedProperty(<span class="hljs-string">&quot;java.lang.Integer.IntegerCache.high&quot;</span>);<br>           <span class="hljs-keyword">if</span> (integerCacheHighPropValue != <span class="hljs-literal">null</span>) &#123;<br>               <span class="hljs-keyword">try</span> &#123;<br>                   <span class="hljs-type">int</span> <span class="hljs-variable">i</span> <span class="hljs-operator">=</span> parseInt(integerCacheHighPropValue);<br>                   i = Math.max(i, <span class="hljs-number">127</span>);<br>                   <span class="hljs-comment">// Maximum array size is Integer.MAX_VALUE</span><br>                   h = Math.min(i, Integer.MAX_VALUE - (-low) -<span class="hljs-number">1</span>);<br>               &#125; <span class="hljs-keyword">catch</span>( NumberFormatException nfe) &#123;<br>                   <span class="hljs-comment">// If the property cannot be parsed into an int, ignore it.</span><br>               &#125;<br>           &#125;<br>           high = h;<br><br>           cache = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Integer</span>[(high - low) + <span class="hljs-number">1</span>];<br>           <span class="hljs-type">int</span> <span class="hljs-variable">j</span> <span class="hljs-operator">=</span> low;<br>           <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> <span class="hljs-variable">k</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>; k &lt; cache.length; k++)<br>               cache[k] = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Integer</span>(j++);<br><br>           <span class="hljs-comment">// range [-128, 127] must be interned (JLS7 5.1.7)</span><br>           <span class="hljs-keyword">assert</span> IntegerCache.high &gt;= <span class="hljs-number">127</span>;<br>       &#125;<br><br>       <span class="hljs-keyword">private</span> <span class="hljs-title function_">IntegerCache</span><span class="hljs-params">()</span> &#123;&#125;<br>   &#125;<br></code></pre></td></tr></table></figure><ol><li>ä¸ºä»€ä¹ˆ IntegerCache åªç¼“å­˜ -128 åˆ° 127 ä¹‹é—´çš„æ•´å‹å€¼å‘¢ï¼Ÿ</li><li>åœ¨ IntegerCache çš„ä»£ç å®ç°ä¸­ï¼Œå½“è¿™ä¸ªç±»è¢«åŠ è½½çš„æ—¶å€™ï¼Œç¼“å­˜çš„äº«å…ƒå¯¹è±¡ä¼šè¢«é›†ä¸­ä¸€æ¬¡æ€§åˆ›å»ºå¥½ã€‚æ¯•ç«Ÿæ•´å‹å€¼å¤ªå¤šäº†ï¼Œæˆ‘ä»¬ä¸å¯èƒ½åœ¨ IntegerCache ç±»ä¸­é¢„å…ˆåˆ›å»ºå¥½æ‰€æœ‰çš„æ•´å‹å€¼ï¼Œè¿™æ ·æ—¢å ç”¨å¤ªå¤šå†…å­˜ï¼Œä¹Ÿä½¿å¾—åŠ è½½ IntegerCache ç±»çš„æ—¶é—´è¿‡é•¿ã€‚æ‰€ä»¥ï¼Œæˆ‘ä»¬åªèƒ½é€‰æ‹©ç¼“å­˜å¯¹äºå¤§éƒ¨åˆ†åº”ç”¨æ¥è¯´æœ€å¸¸ç”¨çš„æ•´å‹å€¼ï¼Œä¹Ÿå°±æ˜¯ä¸€ä¸ªå­—èŠ‚çš„å¤§å°ï¼ˆ-128 åˆ° 127 ä¹‹é—´çš„æ•°æ®ï¼‰ã€‚</li><li>å®é™…ä¸Šï¼ŒJDK ä¹Ÿæä¾›äº†æ–¹æ³•æ¥è®©æˆ‘ä»¬å¯ä»¥è‡ªå®šä¹‰ç¼“å­˜çš„æœ€å¤§å€¼ï¼Œæœ‰ä¸‹é¢ä¸¤ç§æ–¹å¼ã€‚å¦‚æœé€šè¿‡åˆ†æåº”ç”¨çš„ JVM å†…å­˜å ç”¨æƒ…å†µï¼Œå‘ç° -128 åˆ° 255 ä¹‹é—´çš„æ•°æ®å ç”¨çš„å†…å­˜æ¯”è¾ƒå¤šï¼Œå°±å¯ä»¥ç”¨å¦‚ä¸‹æ–¹å¼ï¼Œå°†ç¼“å­˜çš„æœ€å¤§å€¼ä» 127 è°ƒæ•´åˆ° 255ã€‚ä¸è¿‡ï¼Œè¿™é‡Œæ³¨æ„ä¸€ä¸‹ï¼ŒJDK å¹¶æ²¡æœ‰æä¾›è®¾ç½®æœ€å°å€¼çš„æ–¹æ³•ã€‚</li></ol><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-comment">//æ–¹æ³•ä¸€ï¼š</span><br>-Djava.lang.Integer.IntegerCache.high=<span class="hljs-number">255</span><br><span class="hljs-comment">//æ–¹æ³•äºŒï¼š</span><br>-XX:AutoBoxCacheMax=<span class="hljs-number">255</span><br></code></pre></td></tr></table></figure><ol><li>ç°åœ¨ï¼Œè®©æˆ‘ä»¬å†å›åˆ°æœ€å¼€å§‹çš„é—®é¢˜ï¼Œå› ä¸º 56 å¤„äº -128 å’Œ 127 ä¹‹é—´ï¼Œi1 å’Œ i2 ä¼šæŒ‡å‘ç›¸åŒçš„äº«å…ƒå¯¹è±¡ï¼Œæ‰€ä»¥ i1 == i2 è¿”å› trueã€‚è€Œ 129 å¤§äº 127ï¼Œå¹¶ä¸ä¼šè¢«ç¼“å­˜ï¼Œæ¯æ¬¡éƒ½ä¼šåˆ›å»ºä¸€ä¸ªå…¨æ–°çš„å¯¹è±¡ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œi3 å’Œ i4 æŒ‡å‘ä¸åŒçš„ Integer å¯¹è±¡ï¼Œæ‰€ä»¥ i3 == i4 è¿”å› falseã€‚</li></ol><p>å®é™…ä¸Šï¼Œé™¤äº† Integer ç±»å‹ä¹‹å¤–ï¼Œå…¶ä»–åŒ…è£…å™¨ç±»å‹ï¼Œæ¯”å¦‚ Longã€Shortã€Byte ç­‰ï¼Œä¹Ÿéƒ½åˆ©ç”¨äº†äº«å…ƒæ¨¡å¼æ¥ç¼“å­˜ -128 åˆ° 127 ä¹‹é—´çš„æ•°æ®ã€‚</p><p>åœ¨æˆ‘ä»¬å¹³æ—¶çš„å¼€å‘ä¸­ï¼Œå¯¹äºä¸‹é¢è¿™æ ·ä¸‰ç§åˆ›å»ºæ•´å‹å¯¹è±¡çš„æ–¹å¼ï¼Œæˆ‘ä»¬ä¼˜å…ˆä½¿ç”¨åä¸¤ç§ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-type">Integer</span> <span class="hljs-variable">a</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Integer</span>(<span class="hljs-number">123</span>);<br><br><span class="hljs-type">Integer</span> <span class="hljs-variable">a</span> <span class="hljs-operator">=</span> <span class="hljs-number">123</span>;<br><br><span class="hljs-type">Integer</span> <span class="hljs-variable">a</span> <span class="hljs-operator">=</span> Integer.valueOf(<span class="hljs-number">123</span>);<br></code></pre></td></tr></table></figure><p>ç¬¬ä¸€ç§åˆ›å»ºæ–¹å¼å¹¶ä¸ä¼šä½¿ç”¨åˆ° IntegerCacheï¼Œè€Œåé¢ä¸¤ç§åˆ›å»ºæ–¹æ³•å¯ä»¥åˆ©ç”¨ IntegerCache ç¼“å­˜ï¼Œè¿”å›å…±äº«çš„å¯¹è±¡ï¼Œä»¥è¾¾åˆ°èŠ‚çœå†…å­˜çš„ç›®çš„ã€‚ä¸¾ä¸€ä¸ªæç«¯ä¸€ç‚¹çš„ä¾‹å­ï¼Œå‡è®¾ç¨‹åºéœ€è¦åˆ›å»º 1 ä¸‡ä¸ª -128 åˆ° 127 ä¹‹é—´çš„ Integer å¯¹è±¡ã€‚ä½¿ç”¨ç¬¬ä¸€ç§åˆ›å»ºæ–¹å¼ï¼Œæˆ‘ä»¬éœ€è¦åˆ†é… 1 ä¸‡ä¸ª Integer å¯¹è±¡çš„å†…å­˜ç©ºé—´ï¼›ä½¿ç”¨åä¸¤ç§åˆ›å»ºæ–¹å¼ï¼Œæˆ‘ä»¬æœ€å¤šåªéœ€è¦åˆ†é… 256 ä¸ª Integer å¯¹è±¡çš„å†…å­˜ç©ºé—´ã€‚</p><h2 id="5ã€äº«å…ƒæ¨¡å¼åœ¨-Java-String-ä¸­çš„åº”ç”¨"><a href="#5ã€äº«å…ƒæ¨¡å¼åœ¨-Java-String-ä¸­çš„åº”ç”¨" class="headerlink" title="5ã€äº«å…ƒæ¨¡å¼åœ¨ Java String ä¸­çš„åº”ç”¨"></a>5ã€äº«å…ƒæ¨¡å¼åœ¨ Java String ä¸­çš„åº”ç”¨</h2><p>åˆšåˆšæåˆ°äº«å…ƒæ¨¡å¼åœ¨ Java Integer ç±»ä¸­çš„åº”ç”¨ï¼Œç°åœ¨ï¼Œæˆ‘ä»¬å†æ¥çœ‹ä¸‹ï¼Œäº«å…ƒæ¨¡å¼åœ¨ Java String ç±»ä¸­çš„åº”ç”¨ã€‚åŒæ ·ï¼Œæˆ‘ä»¬è¿˜æ˜¯å…ˆæ¥çœ‹ä¸€æ®µä»£ç ï¼Œä½ è§‰å¾—è¿™æ®µä»£ç è¾“å‡ºçš„ç»“æœæ˜¯ä»€ä¹ˆå‘¢ï¼Ÿ</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-type">String</span> <span class="hljs-variable">s1</span> <span class="hljs-operator">=</span> <span class="hljs-string">&quot;å“ˆå“ˆå“ˆ&quot;</span>;<br><span class="hljs-type">String</span> <span class="hljs-variable">s2</span> <span class="hljs-operator">=</span> <span class="hljs-string">&quot;å“ˆå“ˆå“ˆ&quot;</span>;<br><span class="hljs-type">String</span> <span class="hljs-variable">s3</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span>  <span class="hljs-title class_">String</span>(<span class="hljs-string">&quot;å“ˆå“ˆå“ˆ&quot;</span>);<br><br>System.out.println(s1 == s2);<br>System.out.println(s1 == s3);<br></code></pre></td></tr></table></figure><ol><li>ä¸Šé¢ä»£ç çš„è¿è¡Œç»“æœæ˜¯ï¼šä¸€ä¸ª trueï¼Œä¸€ä¸ª falseã€‚è·Ÿ Integer ç±»çš„è®¾è®¡æ€è·¯ç›¸ä¼¼ï¼ŒString ç±»åˆ©ç”¨äº«å…ƒæ¨¡å¼æ¥å¤ç”¨ç›¸åŒçš„å­—ç¬¦ä¸²å¸¸é‡ï¼ˆä¹Ÿå°±æ˜¯ä»£ç ä¸­çš„â€œå°äº‰å“¥â€ï¼‰ã€‚JVM ä¼šä¸“é—¨å¼€è¾Ÿä¸€å—å­˜å‚¨åŒºæ¥å­˜å‚¨å­—ç¬¦ä¸²å¸¸é‡ï¼Œè¿™å—å­˜å‚¨åŒºå«ä½œâ€œå­—ç¬¦ä¸²å¸¸é‡æ± â€ã€‚</li><li>ä¸è¿‡ï¼ŒString ç±»çš„äº«å…ƒæ¨¡å¼çš„è®¾è®¡ï¼Œè·Ÿ Integer ç±»ç¨å¾®æœ‰äº›ä¸åŒã€‚Integer ç±»ä¸­è¦å…±äº«çš„å¯¹è±¡ï¼Œæ˜¯åœ¨ç±»åŠ è½½çš„æ—¶å€™ï¼Œå°±é›†ä¸­ä¸€æ¬¡æ€§åˆ›å»ºå¥½çš„ã€‚ä½†æ˜¯ï¼Œå¯¹äºå­—ç¬¦ä¸²æ¥è¯´ï¼Œæˆ‘ä»¬æ²¡æ³•äº‹å…ˆçŸ¥é“è¦å…±äº«å“ªäº›å­—ç¬¦ä¸²å¸¸é‡ï¼Œæ‰€ä»¥æ²¡åŠæ³•äº‹å…ˆåˆ›å»ºå¥½ï¼Œåªèƒ½åœ¨æŸä¸ªå­—ç¬¦ä¸²å¸¸é‡ç¬¬ä¸€æ¬¡è¢«ç”¨åˆ°çš„æ—¶å€™ï¼Œå­˜å‚¨åˆ°å¸¸é‡æ± ä¸­ï¼Œå½“ä¹‹åå†ç”¨åˆ°çš„æ—¶å€™ï¼Œç›´æ¥å¼•ç”¨å¸¸é‡æ± ä¸­å·²ç»å­˜åœ¨çš„å³å¯ï¼Œå°±ä¸éœ€è¦å†é‡æ–°åˆ›å»ºäº†ã€‚</li></ol>]]></content>
    
    
    <categories>
      
      <category>è®¾è®¡æ¨¡å¼</category>
      
    </categories>
    
    
    <tags>
      
      <tag>è®¾è®¡æ¨¡å¼</tag>
      
      <tag>ç»“æ„å‹</tag>
      
      <tag>é—¨é¢</tag>
      
      <tag>ç»„åˆ</tag>
      
      <tag>äº«å…ƒ</tag>
      
      <tag>å¤–è§‚</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>04-ç»“æ„å‹-è£…é¥°å™¨-é€‚é…å™¨</title>
    <link href="/2022/09/23/04-jie-gou-xing-zhuang-shi-qi-gua-pei-qi/"/>
    <url>/2022/09/23/04-jie-gou-xing-zhuang-shi-qi-gua-pei-qi/</url>
    
    <content type="html"><![CDATA[<h1 id="ä¸€ã€è£…é¥°å™¨æ¨¡å¼"><a href="#ä¸€ã€è£…é¥°å™¨æ¨¡å¼" class="headerlink" title="ä¸€ã€è£…é¥°å™¨æ¨¡å¼"></a>ä¸€ã€è£…é¥°å™¨æ¨¡å¼</h1><p>é€šè¿‡ä¸€ä¸ªdemoæ¥ç†è§£è£…é¥°å™¨æ¨¡å¼ã€‚</p><h2 id="1ã€Demoæ¡ˆä¾‹-å’–å•¡è®¢å•é¡¹ç›®"><a href="#1ã€Demoæ¡ˆä¾‹-å’–å•¡è®¢å•é¡¹ç›®" class="headerlink" title="1ã€Demoæ¡ˆä¾‹-å’–å•¡è®¢å•é¡¹ç›®"></a>1ã€Demoæ¡ˆä¾‹-å’–å•¡è®¢å•é¡¹ç›®</h2><h3 id="1ã€æ˜Ÿå·´å…‹è®¢å•éœ€æ±‚"><a href="#1ã€æ˜Ÿå·´å…‹è®¢å•éœ€æ±‚" class="headerlink" title="1ã€æ˜Ÿå·´å…‹è®¢å•éœ€æ±‚"></a>1ã€æ˜Ÿå·´å…‹è®¢å•éœ€æ±‚</h3><ol><li>å’–å•¡ç§ç±»/å•å“å’–å•¡ï¼šEspresso(æ„å¤§åˆ©æµ“å’–å•¡)ã€ShortBlackã€LongBlack(ç¾å¼å’–å•¡)ã€Decaf(æ— å› å’–å•¡)</li><li>è°ƒæ–™ï¼šMilkã€Soy(è±†æµ†)ã€Chocolate</li><li>è¦æ±‚åœ¨æ‰©å±•æ–°çš„å’–å•¡ç§ç±»æ—¶ï¼Œå…·æœ‰è‰¯å¥½çš„æ‰©å±•æ€§ã€æ”¹åŠ¨æ–¹ä¾¿ã€ç»´æŠ¤æ–¹ä¾¿</li><li>ä½¿ç”¨ OO çš„æ¥è®¡ç®—ä¸åŒç§ç±»å’–å•¡çš„è´¹ç”¨: å®¢æˆ·å¯ä»¥ç‚¹å•å“å’–å•¡ï¼Œä¹Ÿå¯ä»¥å•å“å’–å•¡+è°ƒæ–™ç»„åˆã€‚</li></ol><h3 id="2ã€æ–¹æ¡ˆä¸€"><a href="#2ã€æ–¹æ¡ˆä¸€" class="headerlink" title="2ã€æ–¹æ¡ˆä¸€"></a>2ã€æ–¹æ¡ˆä¸€</h3><p><img src="/2022/09/23/04-jie-gou-xing-zhuang-shi-qi-gua-pei-qi/image-20220926165413830.png" alt="æ–¹æ¡ˆ1"></p><ol><li>Drink æ˜¯ä¸€ä¸ªæŠ½è±¡ç±»ï¼Œè¡¨ç¤ºé¥®æ–™</li><li>deså°±æ˜¯å¯¹å’–å•¡çš„æè¿°, æ¯”å¦‚å’–å•¡çš„åå­— </li><li>cost() æ–¹æ³•å°±æ˜¯è®¡ç®—è´¹ç”¨ï¼ŒDrink ç±»ä¸­åšæˆä¸€ä¸ªæŠ½è±¡æ–¹æ³•</li><li>Decaf å°±æ˜¯å•å“å’–å•¡ï¼Œ ç»§æ‰¿Drink, å¹¶å®ç°cost</li><li>Espress &amp;&amp; Milk å°±æ˜¯å•å“å’–å•¡+è°ƒæ–™ï¼Œ è¿™ä¸ªç»„åˆå¾ˆå¤š</li><li><code>é—®é¢˜</code>ï¼šè¿™æ ·è®¾è®¡ï¼Œä¼šæœ‰å¾ˆå¤šç±»ï¼Œå½“æˆ‘ä»¬å¢åŠ ä¸€ä¸ªå•å“å’–å•¡ï¼Œæˆ–è€…ä¸€ä¸ªæ–°çš„è°ƒæ–™ï¼Œ ç±»çš„æ•°é‡å°±ä¼šå€å¢ï¼Œå°±ä¼šå‡ºç°ç±»çˆ†ç‚¸</li></ol><h3 id="3ã€æ–¹æ¡ˆäºŒ"><a href="#3ã€æ–¹æ¡ˆäºŒ" class="headerlink" title="3ã€æ–¹æ¡ˆäºŒ"></a>3ã€æ–¹æ¡ˆäºŒ</h3><p>å‰é¢åˆ†æåˆ°æ–¹æ¡ˆ 1 å› ä¸ºå’–å•¡å•å“+è°ƒæ–™ç»„åˆä¼šé€ æˆç±»çš„å€å¢ï¼Œå› æ­¤å¯ä»¥åšæ”¹è¿›ï¼Œå°†è°ƒæ–™å†…ç½®åˆ° Drink ç±»ï¼Œè¿™æ ·å°±ä¸ä¼šé€ æˆç±»æ•°é‡è¿‡å¤šã€‚ä»è€Œæé«˜é¡¹ç›®çš„ç»´æŠ¤æ€§(å¦‚å›¾)</p><p><img src="/2022/09/23/04-jie-gou-xing-zhuang-shi-qi-gua-pei-qi/image-20220926165735491.png" alt="æ–¹æ¡ˆ2"></p><ol><li>æ–¹æ¡ˆ 2 å¯ä»¥æ§åˆ¶ç±»çš„æ•°é‡ï¼Œä¸è‡³äºé€ æˆå¾ˆå¤šçš„ç±»</li><li>åœ¨å¢åŠ æˆ–è€…åˆ é™¤è°ƒæ–™ç§ç±»æ—¶ï¼Œä»£ç çš„ç»´æŠ¤é‡å¾ˆå¤§</li><li>è€ƒè™‘åˆ°ç”¨æˆ·å¯ä»¥æ·»åŠ å¤šä»½è°ƒæ–™æ—¶ï¼Œå¯ä»¥å°† hasMilk è¿”å›ä¸€ä¸ªå¯¹åº” int</li><li>è€ƒè™‘ä½¿ç”¨ <strong>è£…é¥°è€…</strong> æ¨¡å¼</li></ol><blockquote><p>æ³¨æ„ï¼šè£…é¥°å™¨æ¨¡å¼æ˜¯å¯¹åŠŸèƒ½çš„å¢å¼ºï¼Œè€Œä¸æ˜¯é™„åŠ æ–°çš„åŠŸèƒ½ã€‚ä»£ç†æ¨¡å¼æ‰æ˜¯é™„åŠ æ–°çš„åŠŸèƒ½ã€‚</p></blockquote><h3 id="4ã€è£…é¥°å™¨æ¨¡å¼ä»£ç "><a href="#4ã€è£…é¥°å™¨æ¨¡å¼ä»£ç " class="headerlink" title="4ã€è£…é¥°å™¨æ¨¡å¼ä»£ç "></a>4ã€è£…é¥°å™¨æ¨¡å¼ä»£ç </h3><p><img src="/2022/09/23/04-jie-gou-xing-zhuang-shi-qi-gua-pei-qi/image-20220926170746201.png" alt="è£…é¥°å™¨æ¨¡å¼"></p><h4 id="1ã€Drinkã€æŠ½è±¡ç±»-ä¸»ä½“Componentã€‘"><a href="#1ã€Drinkã€æŠ½è±¡ç±»-ä¸»ä½“Componentã€‘" class="headerlink" title="1ã€Drinkã€æŠ½è±¡ç±»-ä¸»ä½“Componentã€‘"></a>1ã€Drinkã€æŠ½è±¡ç±»-ä¸»ä½“Componentã€‘</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">abstract</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Drink</span> &#123;<br><br>   <span class="hljs-keyword">public</span> String des; <span class="hljs-comment">// æè¿°</span><br>   <span class="hljs-keyword">private</span> <span class="hljs-type">float</span> <span class="hljs-variable">price</span> <span class="hljs-operator">=</span> <span class="hljs-number">0.0f</span>;<br>   <span class="hljs-keyword">public</span> String <span class="hljs-title function_">getDes</span><span class="hljs-params">()</span> &#123;<br>      <span class="hljs-keyword">return</span> des;<br>   &#125;<br>   <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">setDes</span><span class="hljs-params">(String des)</span> &#123;<br>      <span class="hljs-built_in">this</span>.des = des;<br>   &#125;<br>   <span class="hljs-keyword">public</span> <span class="hljs-type">float</span> <span class="hljs-title function_">getPrice</span><span class="hljs-params">()</span> &#123;<br>      <span class="hljs-keyword">return</span> price;<br>   &#125;<br>   <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">setPrice</span><span class="hljs-params">(<span class="hljs-type">float</span> price)</span> &#123;<br>      <span class="hljs-built_in">this</span>.price = price;<br>   &#125;<br>   <br>   <span class="hljs-comment">//è®¡ç®—è´¹ç”¨çš„æŠ½è±¡æ–¹æ³•</span><br>   <span class="hljs-comment">//å­ç±»æ¥å®ç°</span><br>   <span class="hljs-keyword">public</span> <span class="hljs-keyword">abstract</span> <span class="hljs-type">float</span> <span class="hljs-title function_">cost</span><span class="hljs-params">()</span>;<br>   <br>&#125;<br></code></pre></td></tr></table></figure><h4 id="2ã€Decorator"><a href="#2ã€Decorator" class="headerlink" title="2ã€Decorator"></a>2ã€Decorator</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Decorator</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_">Drink</span> &#123;<br>   <span class="hljs-keyword">private</span> Drink obj;<br>   <br>   <span class="hljs-keyword">public</span> <span class="hljs-title function_">Decorator</span><span class="hljs-params">(Drink obj)</span> &#123; <span class="hljs-comment">//ç»„åˆ</span><br>      <span class="hljs-comment">// TODO Auto-generated constructor stub</span><br>      <span class="hljs-built_in">this</span>.obj = obj;<br>   &#125;<br>   <br>   <span class="hljs-meta">@Override</span><br>   <span class="hljs-keyword">public</span> <span class="hljs-type">float</span> <span class="hljs-title function_">cost</span><span class="hljs-params">()</span> &#123;<br>      <span class="hljs-comment">// TODO Auto-generated method stub</span><br>      <span class="hljs-comment">// getPrice è‡ªå·±ä»·æ ¼</span><br>      <span class="hljs-keyword">return</span> <span class="hljs-built_in">super</span>.getPrice() + obj.cost();<br>   &#125;<br>   <br>   <span class="hljs-meta">@Override</span><br>   <span class="hljs-keyword">public</span> String <span class="hljs-title function_">getDes</span><span class="hljs-params">()</span> &#123;<br>      <span class="hljs-comment">// TODO Auto-generated method stub</span><br>      <span class="hljs-comment">// obj.getDes() è¾“å‡ºè¢«è£…é¥°è€…çš„ä¿¡æ¯</span><br>      <span class="hljs-keyword">return</span> des + <span class="hljs-string">&quot; &quot;</span> + getPrice() + <span class="hljs-string">&quot; &amp;&amp; &quot;</span> + obj.getDes();<br>   &#125;<br>   <br>&#125;<br></code></pre></td></tr></table></figure><h4 id="3ã€Coffee"><a href="#3ã€Coffee" class="headerlink" title="3ã€Coffee"></a>3ã€Coffee</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Coffee</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_">Drink</span> &#123;<br><br>  <span class="hljs-meta">@Override</span><br>  <span class="hljs-keyword">public</span> <span class="hljs-type">float</span> <span class="hljs-title function_">cost</span><span class="hljs-params">()</span> &#123;<br>    <span class="hljs-comment">// TODO Auto-generated method stub</span><br>    <span class="hljs-keyword">return</span> <span class="hljs-built_in">super</span>.getPrice();<br>  &#125;<br>&#125;<br></code></pre></td></tr></table></figure><blockquote><p>å•å“ç±»</p></blockquote><h4 id="4ã€ShortBlack"><a href="#4ã€ShortBlack" class="headerlink" title="4ã€ShortBlack"></a>4ã€ShortBlack</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">ShortBlack</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_">Coffee</span>&#123;<br>   <br>   <span class="hljs-keyword">public</span> <span class="hljs-title function_">ShortBlack</span><span class="hljs-params">()</span> &#123;<br>      setDes(<span class="hljs-string">&quot; shortblack &quot;</span>);<br>      setPrice(<span class="hljs-number">4.0f</span>);<br>   &#125;<br>&#125;<br></code></pre></td></tr></table></figure><h4 id="5ã€LongBlack"><a href="#5ã€LongBlack" class="headerlink" title="5ã€LongBlack"></a>5ã€LongBlack</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">LongBlack</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_">Coffee</span> &#123;<br><br>   <span class="hljs-keyword">public</span> <span class="hljs-title function_">LongBlack</span><span class="hljs-params">()</span> &#123;<br>      setDes(<span class="hljs-string">&quot; longblack &quot;</span>);<br>      setPrice(<span class="hljs-number">5.0f</span>);<br>   &#125;<br>&#125;<br></code></pre></td></tr></table></figure><h4 id="6ã€DeCaf"><a href="#6ã€DeCaf" class="headerlink" title="6ã€DeCaf"></a>6ã€DeCaf</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">DeCaf</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_">Coffee</span> &#123;<br><br>   <span class="hljs-keyword">public</span> <span class="hljs-title function_">DeCaf</span><span class="hljs-params">()</span> &#123;<br>      setDes(<span class="hljs-string">&quot; æ— å› å’–å•¡ &quot;</span>);<br>      setPrice(<span class="hljs-number">1.0f</span>);<br>   &#125;<br>&#125;<br></code></pre></td></tr></table></figure><h4 id="7ã€Espresso"><a href="#7ã€Espresso" class="headerlink" title="7ã€Espresso"></a>7ã€Espresso</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Espresso</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_">Coffee</span> &#123;<br>   <br>   <span class="hljs-keyword">public</span> <span class="hljs-title function_">Espresso</span><span class="hljs-params">()</span> &#123;<br>      setDes(<span class="hljs-string">&quot; æ„å¤§åˆ©å’–å•¡ &quot;</span>);<br>      setPrice(<span class="hljs-number">6.0f</span>);<br>   &#125;<br>&#125;<br></code></pre></td></tr></table></figure><blockquote><p>è°ƒå‘³å“ç±»</p></blockquote><h4 id="8ã€Chocolate"><a href="#8ã€Chocolate" class="headerlink" title="8ã€Chocolate"></a>8ã€Chocolate</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-comment">//å…·ä½“çš„Decoratorï¼Œ è¿™é‡Œå°±æ˜¯è°ƒå‘³å“</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Chocolate</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_">Decorator</span> &#123;<br><br>   <span class="hljs-keyword">public</span> <span class="hljs-title function_">Chocolate</span><span class="hljs-params">(Drink obj)</span> &#123;<br>      <span class="hljs-built_in">super</span>(obj);<br>      setDes(<span class="hljs-string">&quot; å·§å…‹åŠ› &quot;</span>);<br>      setPrice(<span class="hljs-number">3.0f</span>); <span class="hljs-comment">// è°ƒå‘³å“ çš„ä»·æ ¼</span><br>   &#125;<br><br>&#125;<br></code></pre></td></tr></table></figure><h4 id="9ã€Milk"><a href="#9ã€Milk" class="headerlink" title="9ã€Milk"></a>9ã€Milk</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Milk</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_">Decorator</span> &#123;<br><br>   <span class="hljs-keyword">public</span> <span class="hljs-title function_">Milk</span><span class="hljs-params">(Drink obj)</span> &#123;<br>      <span class="hljs-built_in">super</span>(obj);<br>      <span class="hljs-comment">// TODO Auto-generated constructor stub</span><br>      setDes(<span class="hljs-string">&quot; ç‰›å¥¶ &quot;</span>);<br>      setPrice(<span class="hljs-number">2.0f</span>); <br>   &#125;<br><br>&#125;<br></code></pre></td></tr></table></figure><h4 id="10ã€Soy"><a href="#10ã€Soy" class="headerlink" title="10ã€Soy"></a>10ã€Soy</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Soy</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_">Decorator</span>&#123;<br><br>   <span class="hljs-keyword">public</span> <span class="hljs-title function_">Soy</span><span class="hljs-params">(Drink obj)</span> &#123;<br>      <span class="hljs-built_in">super</span>(obj);<br>      <span class="hljs-comment">// TODO Auto-generated constructor stub</span><br>      setDes(<span class="hljs-string">&quot; è±†æµ†  &quot;</span>);<br>      setPrice(<span class="hljs-number">1.5f</span>);<br>   &#125;<br><br>&#125;<br></code></pre></td></tr></table></figure><blockquote><p>ä¸»ç±»è°ƒè¯•</p></blockquote><h4 id="11ã€CoffeeBar"><a href="#11ã€CoffeeBar" class="headerlink" title="11ã€CoffeeBar"></a>11ã€CoffeeBar</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">CoffeeBar</span> &#123;<br><br>   <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span> &#123;<br>      <span class="hljs-comment">// TODO Auto-generated method stub</span><br>      <span class="hljs-comment">// è£…é¥°è€…æ¨¡å¼ä¸‹çš„è®¢å•ï¼š2ä»½å·§å…‹åŠ›+ä¸€ä»½ç‰›å¥¶çš„LongBlack</span><br><br>      <span class="hljs-comment">// 1. ç‚¹ä¸€ä»½ LongBlack</span><br>      <span class="hljs-type">Drink</span> <span class="hljs-variable">order</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">LongBlack</span>();<br>      System.out.println(<span class="hljs-string">&quot;è´¹ç”¨1=&quot;</span> + order.cost());<br>      System.out.println(<span class="hljs-string">&quot;æè¿°=&quot;</span> + order.getDes());<br><br>      <span class="hljs-comment">// 2. order åŠ å…¥ä¸€ä»½ç‰›å¥¶</span><br>      order = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Milk</span>(order);<br><br>      System.out.println(<span class="hljs-string">&quot;order åŠ å…¥ä¸€ä»½ç‰›å¥¶ è´¹ç”¨ =&quot;</span> + order.cost());<br>      System.out.println(<span class="hljs-string">&quot;order åŠ å…¥ä¸€ä»½ç‰›å¥¶ æè¿° = &quot;</span> + order.getDes());<br><br>      <span class="hljs-comment">// 3. order åŠ å…¥ä¸€ä»½å·§å…‹åŠ›</span><br><br>      order = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Chocolate</span>(order);<br><br>      System.out.println(<span class="hljs-string">&quot;order åŠ å…¥ä¸€ä»½ç‰›å¥¶ åŠ å…¥ä¸€ä»½å·§å…‹åŠ›  è´¹ç”¨ =&quot;</span> + order.cost());<br>      System.out.println(<span class="hljs-string">&quot;order åŠ å…¥ä¸€ä»½ç‰›å¥¶ åŠ å…¥ä¸€ä»½å·§å…‹åŠ› æè¿° = &quot;</span> + order.getDes());<br><br>      <span class="hljs-comment">// 3. order åŠ å…¥ä¸€ä»½å·§å…‹åŠ›</span><br><br>      order = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Chocolate</span>(order);<br><br>      System.out.println(<span class="hljs-string">&quot;order åŠ å…¥ä¸€ä»½ç‰›å¥¶ åŠ å…¥2ä»½å·§å…‹åŠ›   è´¹ç”¨ =&quot;</span> + order.cost());<br>      System.out.println(<span class="hljs-string">&quot;order åŠ å…¥ä¸€ä»½ç‰›å¥¶ åŠ å…¥2ä»½å·§å…‹åŠ› æè¿° = &quot;</span> + order.getDes());<br>   <br>      System.out.println(<span class="hljs-string">&quot;===========================&quot;</span>);<br>      <br>      <span class="hljs-type">Drink</span> <span class="hljs-variable">order2</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">DeCaf</span>();<br>      <br>      System.out.println(<span class="hljs-string">&quot;order2 æ— å› å’–å•¡  è´¹ç”¨ =&quot;</span> + order2.cost());<br>      System.out.println(<span class="hljs-string">&quot;order2 æ— å› å’–å•¡ æè¿° = &quot;</span> + order2.getDes());<br>      <br>      order2 = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Milk</span>(order2);<br>      <br>      System.out.println(<span class="hljs-string">&quot;order2 æ— å› å’–å•¡ åŠ å…¥ä¸€ä»½ç‰›å¥¶  è´¹ç”¨ =&quot;</span> + order2.cost());<br>      System.out.println(<span class="hljs-string">&quot;order2 æ— å› å’–å•¡ åŠ å…¥ä¸€ä»½ç‰›å¥¶ æè¿° = &quot;</span> + order2.getDes());<br><br>   <br>   &#125;<br><br>&#125;<br></code></pre></td></tr></table></figure><h2 id="2ã€è£…é¥°è€…æ¨¡å¼åŸç†"><a href="#2ã€è£…é¥°è€…æ¨¡å¼åŸç†" class="headerlink" title="2ã€è£…é¥°è€…æ¨¡å¼åŸç†"></a>2ã€è£…é¥°è€…æ¨¡å¼åŸç†</h2><p>è£…é¥°è€…æ¨¡å¼ï¼šåŠ¨æ€çš„å°†æ–°åŠŸèƒ½é™„åŠ åˆ°å¯¹è±¡ä¸Šã€‚åœ¨å¯¹è±¡åŠŸèƒ½æ‰©å±•æ–¹é¢ï¼Œå®ƒæ¯”ç»§æ‰¿æ›´ æœ‰å¼¹æ€§ï¼Œè£…é¥°è€…æ¨¡å¼ä¹Ÿä½“ç°äº†å¼€é—­åŸåˆ™(ocp)</p><ol><li><p>è£…é¥°è€…æ¨¡å¼å°±åƒæ‰“åŒ…ä¸€ä¸ªå¿«é€’</p><p>ä¸»ä½“ï¼šæ¯”å¦‚ï¼šé™¶ç“·ã€è¡£æœ (Component) // è¢«è£…é¥°è€…</p><p>åŒ…è£…ï¼šæ¯”å¦‚ï¼šæŠ¥çº¸å¡«å……ã€å¡‘æ–™æ³¡æ²«ã€çº¸æ¿ã€æœ¨æ¿(Decorator)</p></li><li><p>Component ä¸»ä½“ï¼šæ¯”å¦‚ç±»ä¼¼å‰é¢çš„ Drink</p></li><li><p>ConcreteComponent å’Œ Decorator</p><p>ConcreteComponentï¼šå…·ä½“çš„ä¸»ä½“ï¼Œ æ¯”å¦‚å‰é¢çš„å„ä¸ªå•å“å’–å•¡</p><p>Decorator: è£…é¥°è€…ï¼Œæ¯”å¦‚å„è°ƒæ–™</p></li><li><p>åœ¨Component ä¸ ConcreteComponent ä¹‹é—´ï¼Œå¦‚æœ ConcreteComponent ç±»å¾ˆå¤š,è¿˜å¯ä»¥è®¾è®¡ä¸€ä¸ªç¼“å†²å±‚ï¼Œå°† å…±æœ‰çš„éƒ¨åˆ†æå–å‡ºæ¥ï¼ŒæŠ½è±¡å±‚ä¸€ä¸ªç±»</p></li></ol><h2 id="3ã€Java-IO-ç±»çš„ç”¨æ³•"><a href="#3ã€Java-IO-ç±»çš„ç”¨æ³•" class="headerlink" title="3ã€Java IO ç±»çš„ç”¨æ³•"></a>3ã€Java IO ç±»çš„ç”¨æ³•</h2><p>Java IO ç±»åº“éå¸¸åºå¤§å’Œå¤æ‚ï¼Œæœ‰å‡ åä¸ªç±»ï¼Œè´Ÿè´£ IO æ•°æ®çš„è¯»å–å’Œå†™å…¥ã€‚å¦‚æœå¯¹ Java IO ç±»åšä¸€ä¸‹åˆ†ç±»ï¼Œæˆ‘ä»¬å¯ä»¥ä»ä¸‹é¢ä¸¤ä¸ªç»´åº¦å°†å®ƒåˆ’åˆ†ä¸ºå››ç±»ã€‚å…·ä½“å¦‚ä¸‹æ‰€ç¤ºï¼š</p><table><thead><tr><th></th><th>å­—èŠ‚æµ</th><th>å­—ç¬¦æµ</th></tr></thead><tbody><tr><td>è¾“å…¥æµ</td><td>InputStream</td><td>Reader</td></tr><tr><td>è¾“å‡ºæµ</td><td>OutputStream</td><td>Writer</td></tr></tbody></table><p>é’ˆå¯¹ä¸åŒçš„è¯»å–å’Œå†™å…¥åœºæ™¯ï¼ŒJava IO åˆåœ¨è¿™å››ä¸ªçˆ¶ç±»åŸºç¡€ä¹‹ä¸Šï¼Œæ‰©å±•å‡ºäº†å¾ˆå¤šå­ç±»ã€‚å…·ä½“å¦‚ä¸‹æ‰€ç¤ºï¼š</p><p><img src="/2022/09/23/04-jie-gou-xing-zhuang-shi-qi-gua-pei-qi/image-20220926174459489.png"></p><p><img src="/2022/09/23/04-jie-gou-xing-zhuang-shi-qi-gua-pei-qi/image-20220926175005022.png"></p><blockquote><p>è¯´æ˜</p><ol><li>InputStream æ˜¯æŠ½è±¡ç±», ç±»ä¼¼æˆ‘ä»¬å‰é¢è®²çš„ Drink</li><li>FileInputStream æ˜¯ InputStream å­ç±»ï¼Œç±»ä¼¼æˆ‘ä»¬å‰é¢çš„ DeCaf, LongBlack</li><li>FilterInputStream æ˜¯ InputStream å­ç±»ï¼šç±»ä¼¼æˆ‘ä»¬å‰é¢ çš„ Decorator ä¿®é¥°è€…</li><li>DataInputStream æ˜¯ FilterInputStream å­ç±»ï¼Œå…·ä½“çš„ä¿®é¥°è€…ï¼Œç±»ä¼¼å‰é¢çš„ Milk, Soy ç­‰</li><li>FilterInputStream ç±» æœ‰ protected volatile InputStream in; å³å«è¢«è£…é¥°è€…</li><li>åˆ†æå¾—å‡ºåœ¨jdk çš„ioä½“ç³»ä¸­ï¼Œå°±æ˜¯ä½¿ç”¨è£…é¥°è€…æ¨¡å¼</li></ol></blockquote><p>æ‰“å¼€æ–‡ä»¶ test.txtï¼Œä»ä¸­è¯»å–æ•°æ®ã€‚å…¶ä¸­ï¼ŒInputStream æ˜¯ä¸€ä¸ªæŠ½è±¡ç±»ï¼ŒFileInputStream æ˜¯ä¸“é—¨ç”¨æ¥è¯»å–æ–‡ä»¶æµçš„å­ç±»ã€‚BufferedInputStream æ˜¯ä¸€ä¸ªæ”¯æŒå¸¦ç¼“å­˜åŠŸèƒ½çš„æ•°æ®è¯»å–ç±»ï¼Œå¯ä»¥æé«˜æ•°æ®è¯»å–çš„æ•ˆç‡ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-type">InputStream</span> <span class="hljs-variable">in</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">FileInputStream</span>(<span class="hljs-string">&quot;/user/test.txt&quot;</span>);<br><span class="hljs-type">InputStream</span> <span class="hljs-variable">bin</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">BufferedInputStream</span>(in);<br><span class="hljs-type">byte</span>[] data = <span class="hljs-keyword">new</span> <span class="hljs-title class_">byte</span>[<span class="hljs-number">128</span>];<br><span class="hljs-keyword">while</span> (bin.read(data) != -<span class="hljs-number">1</span>) &#123;<br>    <span class="hljs-comment">//...</span><br>&#125;<br></code></pre></td></tr></table></figure><p>åˆçœ‹ä¸Šé¢çš„ä»£ç ï¼Œä¼šè§‰å¾— Java IO çš„ç”¨æ³•æ¯”è¾ƒéº»çƒ¦ï¼Œéœ€è¦å…ˆåˆ›å»ºä¸€ä¸ª FileInputStream å¯¹è±¡ï¼Œç„¶åå†ä¼ é€’ç»™ BufferedInputStream å¯¹è±¡æ¥ä½¿ç”¨ã€‚æˆ‘åœ¨æƒ³ï¼ŒJava IO ä¸ºä»€ä¹ˆä¸è®¾è®¡ä¸€ä¸ªç»§æ‰¿ FileInputStream å¹¶ä¸”æ”¯æŒç¼“å­˜çš„ BufferedFileInputStream ç±»å‘¢ï¼Ÿè¿™æ ·æˆ‘ä»¬å°±å¯ä»¥åƒä¸‹é¢çš„ä»£ç ä¸­è¿™æ ·ï¼Œç›´æ¥åˆ›å»ºä¸€ä¸ª BufferedFileInputStream ç±»å¯¹è±¡ï¼Œæ‰“å¼€æ–‡ä»¶è¯»å–æ•°æ®ï¼Œç”¨èµ·æ¥å²‚ä¸æ˜¯æ›´åŠ ç®€å•ï¼Ÿ</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-type">InputStream</span> <span class="hljs-variable">bin</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">BufferedFileInputStream</span>(<span class="hljs-string">&quot;/user/test.txt&quot;</span>);<br><span class="hljs-type">byte</span>[] data = <span class="hljs-keyword">new</span> <span class="hljs-title class_">byte</span>[<span class="hljs-number">128</span>];<br><span class="hljs-keyword">while</span> (bin.read(data) != -<span class="hljs-number">1</span>) &#123;<br>    <span class="hljs-comment">//...</span><br>&#125;<br></code></pre></td></tr></table></figure><h2 id="4ã€åŸºäºç»§æ‰¿çš„è®¾è®¡æ–¹æ¡ˆ"><a href="#4ã€åŸºäºç»§æ‰¿çš„è®¾è®¡æ–¹æ¡ˆ" class="headerlink" title="4ã€åŸºäºç»§æ‰¿çš„è®¾è®¡æ–¹æ¡ˆ"></a>4ã€åŸºäºç»§æ‰¿çš„è®¾è®¡æ–¹æ¡ˆ</h2><p>å¦‚æœ InputStream åªæœ‰ä¸€ä¸ªå­ç±» FileInputStream çš„è¯ï¼Œé‚£æˆ‘ä»¬åœ¨ FileInputStream åŸºç¡€ä¹‹ä¸Šï¼Œå†è®¾è®¡ä¸€ä¸ªå­™å­ç±» BufferedFileInputStreamï¼Œä¹Ÿç®—æ˜¯å¯ä»¥æ¥å—çš„ï¼Œæ¯•ç«Ÿç»§æ‰¿ç»“æ„è¿˜ç®—ç®€å•ã€‚ä½†å®é™…ä¸Šï¼Œç»§æ‰¿ InputStream çš„å­ç±»æœ‰å¾ˆå¤šã€‚æˆ‘ä»¬éœ€è¦ç»™æ¯ä¸€ä¸ª InputStream çš„å­ç±»ï¼Œå†ç»§ç»­æ´¾ç”Ÿæ”¯æŒç¼“å­˜è¯»å–çš„å­ç±»ã€‚</p><p>é™¤äº†æ”¯æŒç¼“å­˜è¯»å–ä¹‹å¤–ï¼Œå¦‚æœæˆ‘ä»¬è¿˜éœ€è¦å¯¹åŠŸèƒ½è¿›è¡Œå…¶ä»–æ–¹é¢çš„å¢å¼ºï¼Œæ¯”å¦‚ä¸‹é¢çš„ DataInputStream ç±»ï¼Œæ”¯æŒæŒ‰ç…§åŸºæœ¬æ•°æ®ç±»å‹ï¼ˆintã€booleanã€long ç­‰ï¼‰æ¥è¯»å–æ•°æ®ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-type">FileInputStream</span> <span class="hljs-variable">in</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">FileInputStream</span>(<span class="hljs-string">&quot;/user/test.txt&quot;</span>);<br><span class="hljs-type">DataInputStream</span> <span class="hljs-variable">din</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">DataInputStream</span>(in);<br><span class="hljs-type">int</span> <span class="hljs-variable">data</span> <span class="hljs-operator">=</span> din.readInt();<br></code></pre></td></tr></table></figure><p>åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œå¦‚æœæˆ‘ä»¬ç»§ç»­æŒ‰ç…§ç»§æ‰¿çš„æ–¹å¼æ¥å®ç°çš„è¯ï¼Œå°±éœ€è¦å†ç»§ç»­æ´¾ç”Ÿå‡º DataFileInputStreamã€DataPipedInputStream ç­‰ç±»ã€‚å¦‚æœæˆ‘ä»¬è¿˜éœ€è¦æ—¢æ”¯æŒç¼“å­˜ã€åˆæ”¯æŒæŒ‰ç…§åŸºæœ¬ç±»å‹è¯»å–æ•°æ®çš„ç±»ï¼Œé‚£å°±è¦å†ç»§ç»­æ´¾ç”Ÿå‡º BufferedDataFileInputStreamã€BufferedDataPipedInputStream ç­‰ n å¤šç±»ã€‚è¿™è¿˜åªæ˜¯é™„åŠ äº†ä¸¤ä¸ªå¢å¼ºåŠŸèƒ½ï¼Œå¦‚æœæˆ‘ä»¬éœ€è¦é™„åŠ æ›´å¤šçš„å¢å¼ºåŠŸèƒ½ï¼Œé‚£å°±ä¼šå¯¼è‡´ç»„åˆçˆ†ç‚¸ï¼Œç±»ç»§æ‰¿ç»“æ„å˜å¾—æ— æ¯”å¤æ‚ï¼Œä»£ç æ—¢ä¸å¥½æ‰©å±•ï¼Œä¹Ÿä¸å¥½ç»´æŠ¤ã€‚è¿™ä¹Ÿæ˜¯æˆ‘ä»¬ä¸æ¨èä½¿ç”¨ç»§æ‰¿çš„åŸå› ã€‚</p><h2 id="5ã€åŸºäºè£…é¥°å™¨æ¨¡å¼çš„è®¾è®¡æ–¹æ¡ˆ"><a href="#5ã€åŸºäºè£…é¥°å™¨æ¨¡å¼çš„è®¾è®¡æ–¹æ¡ˆ" class="headerlink" title="5ã€åŸºäºè£…é¥°å™¨æ¨¡å¼çš„è®¾è®¡æ–¹æ¡ˆ"></a>5ã€åŸºäºè£…é¥°å™¨æ¨¡å¼çš„è®¾è®¡æ–¹æ¡ˆ</h2><p>å‰é¢æåˆ°â€œç»„åˆä¼˜äºç»§æ‰¿â€ï¼Œå¯ä»¥â€œä½¿ç”¨ç»„åˆæ¥æ›¿ä»£ç»§æ‰¿â€ã€‚é’ˆå¯¹åˆšåˆšçš„ç»§æ‰¿ç»“æ„è¿‡äºå¤æ‚çš„é—®é¢˜ï¼Œå¯ä»¥é€šè¿‡å°†ç»§æ‰¿å…³ç³»æ”¹ä¸ºç»„åˆå…³ç³»æ¥è§£å†³ã€‚ä¸‹é¢çš„ä»£ç å±•ç¤ºäº† Java IO çš„è¿™ç§è®¾è®¡æ€è·¯ã€‚ä»¥ä¸‹æ˜¯ç®€åŒ–äº†çš„ä»£ç ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">import</span> java.io.IOException;<br><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">abstract</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">InputStream</span> &#123;<br>  <span class="hljs-comment">// ...</span><br>  <span class="hljs-keyword">public</span> <span class="hljs-type">int</span> <span class="hljs-title function_">read</span><span class="hljs-params">(<span class="hljs-type">byte</span> b[])</span> <span class="hljs-keyword">throws</span> IOException &#123;<br>    <span class="hljs-keyword">return</span> read(b, <span class="hljs-number">0</span>, b.length);<br>  &#125;<br>  <span class="hljs-keyword">public</span> <span class="hljs-type">int</span> <span class="hljs-title function_">read</span><span class="hljs-params">(<span class="hljs-type">byte</span> b[], <span class="hljs-type">int</span> off, <span class="hljs-type">int</span> len)</span> <span class="hljs-keyword">throws</span> IOException &#123;<br>    <span class="hljs-comment">// ...</span><br>  &#125;<br><br>  <span class="hljs-keyword">public</span> <span class="hljs-type">long</span> <span class="hljs-title function_">skip</span><span class="hljs-params">(<span class="hljs-type">long</span> n)</span> <span class="hljs-keyword">throws</span> IOException &#123;<br>    <span class="hljs-comment">// ...</span><br>  &#125;<br><br>  <span class="hljs-keyword">public</span> <span class="hljs-type">int</span> <span class="hljs-title function_">available</span><span class="hljs-params">()</span> <span class="hljs-keyword">throws</span> IOException &#123;<br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>  &#125;<br><br>  <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">close</span><span class="hljs-params">()</span> <span class="hljs-keyword">throws</span> IOException &#123;&#125;<br><br>  <span class="hljs-keyword">public</span> <span class="hljs-keyword">synchronized</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">mark</span><span class="hljs-params">(<span class="hljs-type">int</span> readlimit)</span> &#123;&#125;<br><br>  <span class="hljs-keyword">public</span> <span class="hljs-keyword">synchronized</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">reset</span><span class="hljs-params">()</span> <span class="hljs-keyword">throws</span> IOException &#123;<br>    <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">IOException</span>(<span class="hljs-string">&quot;mark/reset not supported&quot;</span>);<br>  &#125;<br><br>  <span class="hljs-keyword">public</span> <span class="hljs-type">boolean</span> <span class="hljs-title function_">markSupported</span><span class="hljs-params">()</span> &#123;<br>    <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;<br>  &#125;<br>&#125;<br><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">BufferedInputStream</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_">InputStream</span> &#123;<br>  <span class="hljs-keyword">protected</span> <span class="hljs-keyword">volatile</span> InputStream in;<br><br>  <span class="hljs-keyword">protected</span> <span class="hljs-title function_">BufferedInputStream</span><span class="hljs-params">(InputStream in)</span> &#123;<br>    <span class="hljs-built_in">this</span>.in = in;<br>  &#125;<br><br>  <span class="hljs-comment">// ...å®ç°åŸºäºç¼“å­˜çš„è¯»æ•°æ®æ¥å£...</span><br>&#125;<br><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">DataInputStream</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_">InputStream</span> &#123;<br>  <span class="hljs-keyword">protected</span> <span class="hljs-keyword">volatile</span> InputStream in;<br><br>  <span class="hljs-keyword">protected</span> <span class="hljs-title function_">DataInputStream</span><span class="hljs-params">(InputStream in)</span> &#123;<br>    <span class="hljs-built_in">this</span>.in = in;<br>  &#125;<br><br>  <span class="hljs-comment">// ...å®ç°è¯»å–åŸºæœ¬ç±»å‹æ•°æ®çš„æ¥å£</span><br>&#125;<br></code></pre></td></tr></table></figure><p>çœ‹äº†ä¸Šé¢çš„ä»£ç ï¼Œå¯èƒ½ä¼šé—®ï¼Œé‚£è£…é¥°å™¨æ¨¡å¼å°±æ˜¯ç®€å•çš„â€œç”¨ç»„åˆæ›¿ä»£ç»§æ‰¿â€å—ï¼Ÿå½“ç„¶ä¸æ˜¯ã€‚ä» Java IO çš„è®¾è®¡æ¥çœ‹ï¼Œè£…é¥°å™¨æ¨¡å¼ç›¸å¯¹äºç®€å•çš„ç»„åˆå…³ç³»ï¼Œè¿˜æœ‰ä¸¤ä¸ªæ¯”è¾ƒç‰¹æ®Šçš„åœ°æ–¹ã€‚</p><p><strong>ç¬¬ä¸€ä¸ªæ¯”è¾ƒç‰¹æ®Šçš„åœ°æ–¹æ˜¯ï¼šè£…é¥°å™¨ç±»å’ŒåŸå§‹ç±»ç»§æ‰¿åŒæ ·çš„çˆ¶ç±»ï¼Œè¿™æ ·æˆ‘ä»¬å¯ä»¥å¯¹åŸå§‹ç±»â€œåµŒå¥—â€å¤šä¸ªè£…é¥°å™¨ç±»ã€‚</strong>æ¯”å¦‚ï¼Œä¸‹é¢è¿™æ ·ä¸€æ®µä»£ç ï¼Œæˆ‘ä»¬å¯¹ FileInputStream åµŒå¥—äº†ä¸¤ä¸ªè£…é¥°å™¨ç±»ï¼šBufferedInputStream å’Œ DataInputStreamï¼Œè®©å®ƒæ—¢æ”¯æŒç¼“å­˜è¯»å–ï¼Œåˆæ”¯æŒæŒ‰ç…§åŸºæœ¬æ•°æ®ç±»å‹æ¥è¯»å–æ•°æ®ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-type">InputStream</span> <span class="hljs-variable">in</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">FileInputStream</span>(<span class="hljs-string">&quot;/user/test.txt&quot;</span>);<br><span class="hljs-type">InputStream</span> <span class="hljs-variable">bin</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">BufferedInputStream</span>(in);<br><span class="hljs-type">DataInputStream</span> <span class="hljs-variable">din</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">DataInputStream</span>(bin);<br><span class="hljs-type">int</span> <span class="hljs-variable">data</span> <span class="hljs-operator">=</span> din.readInt();<br></code></pre></td></tr></table></figure><p><strong>ç¬¬äºŒä¸ªæ¯”è¾ƒç‰¹æ®Šçš„åœ°æ–¹æ˜¯ï¼šè£…é¥°å™¨ç±»æ˜¯å¯¹åŠŸèƒ½çš„å¢å¼ºï¼Œè¿™ä¹Ÿæ˜¯è£…é¥°å™¨æ¨¡å¼åº”ç”¨åœºæ™¯çš„ä¸€ä¸ªé‡è¦ç‰¹ç‚¹ã€‚</strong>å®é™…ä¸Šï¼Œç¬¦åˆâ€œç»„åˆå…³ç³»â€è¿™ç§ä»£ç ç»“æ„çš„è®¾è®¡æ¨¡å¼æœ‰å¾ˆå¤šï¼Œæ¯”å¦‚ä¹‹å‰è®²è¿‡çš„ä»£ç†æ¨¡å¼ã€æ¡¥æ¥æ¨¡å¼ï¼Œè¿˜æœ‰ç°åœ¨çš„è£…é¥°å™¨æ¨¡å¼ã€‚å°½ç®¡å®ƒä»¬çš„ä»£ç ç»“æ„å¾ˆç›¸ä¼¼ï¼Œä½†æ˜¯æ¯ç§è®¾è®¡æ¨¡å¼çš„æ„å›¾æ˜¯ä¸åŒçš„ã€‚å°±æ‹¿æ¯”è¾ƒç›¸ä¼¼çš„ä»£ç†æ¨¡å¼å’Œè£…é¥°å™¨æ¨¡å¼æ¥è¯´å§ï¼Œä»£ç†æ¨¡å¼ä¸­ï¼Œ<code>ä»£ç†ç±»é™„åŠ çš„æ˜¯è·ŸåŸå§‹ç±»æ— å…³çš„åŠŸèƒ½</code>ï¼Œè€Œåœ¨è£…é¥°å™¨æ¨¡å¼ä¸­ï¼Œ<code>è£…é¥°å™¨ç±»é™„åŠ çš„æ˜¯è·ŸåŸå§‹ç±»ç›¸å…³çš„å¢å¼ºåŠŸèƒ½</code>ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-comment">// ä»£ç†æ¨¡å¼çš„ä»£ç ç»“æ„(ä¸‹é¢çš„æ¥å£ä¹Ÿå¯ä»¥æ›¿æ¢æˆæŠ½è±¡ç±»)</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">interface</span> <span class="hljs-title class_">IA</span> &#123;<br>    <span class="hljs-keyword">void</span> <span class="hljs-title function_">f</span><span class="hljs-params">()</span>;<br>&#125;<br><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">A</span> impelements IA &#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">f</span><span class="hljs-params">()</span> &#123; <br>        <span class="hljs-comment">//... </span><br>    &#125;<br>&#125;<br><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">AProxy</span> impements IA &#123;<br>    <span class="hljs-keyword">private</span> IA a;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-title function_">AProxy</span><span class="hljs-params">(IA a)</span> &#123;<br>        <span class="hljs-built_in">this</span>.a = a;<br>    &#125;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">f</span><span class="hljs-params">()</span> &#123;<br>        <span class="hljs-comment">// æ–°æ·»åŠ çš„ä»£ç†é€»è¾‘</span><br>        a.f();<br>        <span class="hljs-comment">// æ–°æ·»åŠ çš„ä»£ç†é€»è¾‘</span><br>    &#125;<br>&#125;<br><br><span class="hljs-comment">// è£…é¥°å™¨æ¨¡å¼çš„ä»£ç ç»“æ„(ä¸‹é¢çš„æ¥å£ä¹Ÿå¯ä»¥æ›¿æ¢æˆæŠ½è±¡ç±»)</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">interface</span> <span class="hljs-title class_">IA</span> &#123;<br>    <span class="hljs-keyword">void</span> <span class="hljs-title function_">f</span><span class="hljs-params">()</span>;<br>&#125;<br><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">A</span> impelements IA &#123;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">f</span><span class="hljs-params">()</span> &#123; <br>        <span class="hljs-comment">//... </span><br>    &#125;<br>&#125;<br><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">ADecorator</span> impements IA &#123;<br>    <span class="hljs-keyword">private</span> IA a;<br>    <span class="hljs-keyword">public</span> <span class="hljs-title function_">ADecorator</span><span class="hljs-params">(IA a)</span> &#123;<br>        <span class="hljs-built_in">this</span>.a = a;<br>    &#125;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">f</span><span class="hljs-params">()</span> &#123;<br>        <span class="hljs-comment">// åŠŸèƒ½å¢å¼ºä»£ç </span><br>        a.f();<br>        <span class="hljs-comment">// åŠŸèƒ½å¢å¼ºä»£ç </span><br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><ol><li>å®é™…ä¸Šï¼Œå¦‚æœå»æŸ¥çœ‹ JDK çš„æºç ï¼Œä¼šå‘ç°BufferedInputStreamã€DataInputStream å¹¶éç»§æ‰¿è‡ª InputStreamï¼Œè€Œæ˜¯å¦å¤–ä¸€ä¸ªå« FilterInputStream çš„ç±»ã€‚é‚£è¿™åˆæ˜¯å‡ºäºä»€ä¹ˆæ ·çš„è®¾è®¡æ„å›¾ï¼Œæ‰å¼•å…¥è¿™æ ·ä¸€ä¸ªç±»å‘¢ï¼Ÿ</li><li>å†é‡æ–°æ¥çœ‹ä¸€ä¸‹ BufferedInputStream ç±»çš„ä»£ç ã€‚InputStream æ˜¯ä¸€ä¸ªæŠ½è±¡ç±»è€Œéæ¥å£ï¼Œè€Œä¸”å®ƒçš„å¤§éƒ¨åˆ†å‡½æ•°ï¼ˆæ¯”å¦‚ read()ã€available()ï¼‰éƒ½æœ‰é»˜è®¤å®ç°ï¼ŒæŒ‰ç†æ¥è¯´ï¼Œæˆ‘ä»¬åªéœ€è¦åœ¨ BufferedInputStream ç±»ä¸­é‡æ–°å®ç°é‚£äº›éœ€è¦å¢åŠ ç¼“å­˜åŠŸèƒ½çš„å‡½æ•°å°±å¯ä»¥äº†ï¼Œå…¶ä»–å‡½æ•°ç»§æ‰¿ InputStream çš„é»˜è®¤å®ç°ã€‚ä½†å®é™…ä¸Šï¼Œè¿™æ ·åšæ˜¯è¡Œä¸é€šçš„ã€‚</li><li>å¯¹äºå³ä¾¿æ˜¯ä¸éœ€è¦å¢åŠ ç¼“å­˜åŠŸèƒ½çš„å‡½æ•°æ¥è¯´ï¼ŒBufferedInputStream è¿˜æ˜¯å¿…é¡»æŠŠå®ƒé‡æ–°å®ç°ä¸€éï¼Œç®€å•åŒ…è£¹å¯¹ InputStream å¯¹è±¡çš„å‡½æ•°è°ƒç”¨ã€‚å…·ä½“çš„ä»£ç ç¤ºä¾‹å¦‚ä¸‹æ‰€ç¤ºã€‚å¦‚æœä¸é‡æ–°å®ç°ï¼Œé‚£ BufferedInputStream ç±»å°±æ— æ³•å°†æœ€ç»ˆè¯»å–æ•°æ®çš„ä»»åŠ¡ï¼Œå§”æ‰˜ç»™ä¼ é€’è¿›æ¥çš„ InputStream å¯¹è±¡æ¥å®Œæˆã€‚</li></ol><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">BufferedInputStream</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_">InputStream</span> &#123;<br>    <span class="hljs-keyword">protected</span> <span class="hljs-keyword">volatile</span> InputStream in;<br><br>    <span class="hljs-keyword">protected</span> <span class="hljs-title function_">BufferedInputStream</span><span class="hljs-params">(InputStream in)</span> &#123;<br>        <span class="hljs-built_in">this</span>.in = in;<br>    &#125;<br><br><span class="hljs-comment">// f()å‡½æ•°ä¸éœ€è¦å¢å¼ºï¼Œåªæ˜¯é‡æ–°è°ƒç”¨ä¸€ä¸‹InputStream inå¯¹è±¡çš„f()</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">f</span><span class="hljs-params">()</span> &#123; <br>        in.f();<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>å®é™…ä¸Šï¼ŒDataInputStream ä¹Ÿå­˜åœ¨è·Ÿ BufferedInputStream åŒæ ·çš„é—®é¢˜ã€‚ä¸ºäº†é¿å…ä»£ç é‡å¤ï¼ŒJava IO æŠ½è±¡å‡ºäº†ä¸€ä¸ªè£…é¥°å™¨çˆ¶ç±» FilterInputStreamï¼Œä»£ç å®ç°å¦‚ä¸‹æ‰€ç¤ºã€‚InputStream çš„æ‰€æœ‰çš„è£…é¥°å™¨ç±»ï¼ˆBufferedInputStreamã€DataInputStreamï¼‰éƒ½ç»§æ‰¿è‡ªè¿™ä¸ªè£…é¥°å™¨çˆ¶ç±»ã€‚è¿™æ ·ï¼Œè£…é¥°å™¨ç±»åªéœ€è¦å®ç°å®ƒéœ€è¦å¢å¼ºçš„æ–¹æ³•å°±å¯ä»¥äº†ï¼Œå…¶ä»–æ–¹æ³•ç»§æ‰¿è£…é¥°å™¨çˆ¶ç±»çš„é»˜è®¤å®ç°ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">FilterInputStream</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_">InputStream</span> &#123;<br>    <span class="hljs-keyword">protected</span> <span class="hljs-keyword">volatile</span> InputStream in;<br><br>    <span class="hljs-keyword">protected</span> <span class="hljs-title function_">FilterInputStream</span><span class="hljs-params">(InputStream in)</span> &#123;<br>        <span class="hljs-built_in">this</span>.in = in;<br>    &#125;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-type">int</span> <span class="hljs-title function_">read</span><span class="hljs-params">()</span> <span class="hljs-keyword">throws</span> IOException &#123;<br>        <span class="hljs-keyword">return</span> in.read();<br>    &#125;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-type">int</span> <span class="hljs-title function_">read</span><span class="hljs-params">(<span class="hljs-type">byte</span> b[])</span> <span class="hljs-keyword">throws</span> IOException &#123; <br>        <span class="hljs-keyword">return</span> read(b, <span class="hljs-number">0</span>, b.length);<br>    &#125;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-type">int</span> <span class="hljs-title function_">read</span><span class="hljs-params">(<span class="hljs-type">byte</span> b[], <span class="hljs-type">int</span> off, <span class="hljs-type">int</span> len)</span> <span class="hljs-keyword">throws</span> IOException &#123;<br>        <span class="hljs-keyword">return</span> in.read(b, off, len);<br>    &#125;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-type">long</span> <span class="hljs-title function_">skip</span><span class="hljs-params">(<span class="hljs-type">long</span> n)</span> <span class="hljs-keyword">throws</span> IOException &#123;<br>        <span class="hljs-keyword">return</span> in.skip(n);<br>    &#125;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-type">int</span> <span class="hljs-title function_">available</span><span class="hljs-params">()</span> <span class="hljs-keyword">throws</span> IOException &#123;<br>        <span class="hljs-keyword">return</span> in.available();<br>    &#125;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">close</span><span class="hljs-params">()</span> <span class="hljs-keyword">throws</span> IOException &#123;<br>        in.close();<br>    &#125;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">synchronized</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">mark</span><span class="hljs-params">(<span class="hljs-type">int</span> readlimit)</span> &#123;<br>        in.mark(readlimit);<br>    &#125;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">synchronized</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">reset</span><span class="hljs-params">()</span> <span class="hljs-keyword">throws</span> IOException &#123;<br>        in.reset();<br>    &#125;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-type">boolean</span> <span class="hljs-title function_">markSupported</span><span class="hljs-params">()</span> &#123;<br>        <span class="hljs-keyword">return</span> in.markSupported();<br>    &#125;<br><br>&#125;<br></code></pre></td></tr></table></figure><h1 id="äºŒã€é€‚é…å™¨æ¨¡å¼"><a href="#äºŒã€é€‚é…å™¨æ¨¡å¼" class="headerlink" title="äºŒã€é€‚é…å™¨æ¨¡å¼"></a>äºŒã€é€‚é…å™¨æ¨¡å¼</h1><p>é€‚é…å™¨æ¨¡å¼(Adapter Pattern)å°†æŸä¸ªç±»çš„æ¥å£è½¬æ¢æˆå®¢æˆ·ç«¯æœŸæœ›çš„å¦ä¸€ä¸ªæ¥å£è¡¨ç¤ºï¼Œ<strong>ä¸»çš„ç›®çš„æ˜¯å…¼å®¹æ€§</strong>ï¼Œè®©åŸæœ¬å› æ¥å£ä¸åŒ¹é…ä¸èƒ½ä¸€èµ·å·¥ä½œçš„ä¸¤ä¸ªç±»å¯ä»¥ååŒå·¥ä½œã€‚å…¶åˆ«åä¸ºåŒ…è£…å™¨(Wrapper) ã€‚é€‚é…å™¨æ¨¡å¼å±äºç»“æ„å‹æ¨¡å¼ã€‚ä¸»è¦åˆ†ä¸ºä¸‰ç±»ï¼š<strong>ç±»é€‚é…å™¨æ¨¡å¼ã€å¯¹è±¡é€‚é…å™¨æ¨¡å¼ã€æ¥å£é€‚é…å™¨æ¨¡å¼</strong></p><h2 id="1ã€Demoæ¡ˆä¾‹-å……ç”µå™¨"><a href="#1ã€Demoæ¡ˆä¾‹-å……ç”µå™¨" class="headerlink" title="1ã€Demoæ¡ˆä¾‹-å……ç”µå™¨"></a>1ã€Demoæ¡ˆä¾‹-å……ç”µå™¨</h2><p>åŸºæœ¬ä»‹ç»ï¼šAdapter ç±»ï¼Œé€šè¿‡ç»§æ‰¿ src ç±»ï¼Œå®ç° dst ç±»æ¥å£ï¼Œå®Œæˆ src-&gt;dst çš„é€‚é…ã€‚</p><ul><li>ä»¥ç”Ÿæ´»ä¸­å……ç”µå™¨çš„ä¾‹å­æ¥è®²è§£é€‚é…å™¨ï¼Œå……ç”µå™¨æœ¬èº«ç›¸å½“äº Adapterï¼Œ220V äº¤æµç”µç›¸å½“äº src (å³è¢«é€‚é…è€…)ï¼Œæˆ‘ä»¬ çš„ç›® dst(å³ ç›®æ ‡)æ˜¯ 5V ç›´æµç”µ</li></ul><h3 id="1ã€ç±»é€‚é…å™¨ä»£ç å®ç°"><a href="#1ã€ç±»é€‚é…å™¨ä»£ç å®ç°" class="headerlink" title="1ã€ç±»é€‚é…å™¨ä»£ç å®ç°"></a>1ã€ç±»é€‚é…å™¨ä»£ç å®ç°</h3><h4 id="1ã€Voltage220V"><a href="#1ã€Voltage220V" class="headerlink" title="1ã€Voltage220V"></a>1ã€Voltage220V</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-comment">//è¢«é€‚é…çš„ç±»</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Voltage220V</span> &#123;<br>   <span class="hljs-comment">//è¾“å‡º220Vçš„ç”µå‹</span><br>   <span class="hljs-keyword">public</span> <span class="hljs-type">int</span> <span class="hljs-title function_">output220V</span><span class="hljs-params">()</span> &#123;<br>      <span class="hljs-type">int</span> <span class="hljs-variable">src</span> <span class="hljs-operator">=</span> <span class="hljs-number">220</span>;<br>      System.out.println(<span class="hljs-string">&quot;ç”µå‹=&quot;</span> + src + <span class="hljs-string">&quot;ä¼&quot;</span>);<br>      <span class="hljs-keyword">return</span> src;<br>   &#125;<br>&#125;<br></code></pre></td></tr></table></figure><h4 id="2ã€IVoltage5V"><a href="#2ã€IVoltage5V" class="headerlink" title="2ã€IVoltage5V"></a>2ã€IVoltage5V</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-comment">//é€‚é…æ¥å£</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">interface</span> <span class="hljs-title class_">IVoltage5V</span> &#123;<br>   <span class="hljs-keyword">public</span> <span class="hljs-type">int</span> <span class="hljs-title function_">output5V</span><span class="hljs-params">()</span>;<br>&#125;<br></code></pre></td></tr></table></figure><h4 id="3ã€Phone"><a href="#3ã€Phone" class="headerlink" title="3ã€Phone"></a>3ã€Phone</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Phone</span> &#123;<br><br>   <span class="hljs-comment">//å……ç”µ</span><br>   <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">charging</span><span class="hljs-params">(IVoltage5V iVoltage5V)</span> &#123;<br>      <span class="hljs-keyword">if</span>(iVoltage5V.output5V() == <span class="hljs-number">5</span>) &#123;<br>         System.out.println(<span class="hljs-string">&quot;ç”µå‹ä¸º5V, å¯ä»¥å……ç”µ~~&quot;</span>);<br>      &#125; <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (iVoltage5V.output5V() &gt; <span class="hljs-number">5</span>) &#123;<br>         System.out.println(<span class="hljs-string">&quot;ç”µå‹å¤§äº5V, ä¸èƒ½å……ç”µ~~&quot;</span>);<br>      &#125;<br>   &#125;<br>&#125;<br></code></pre></td></tr></table></figure><h4 id="4ã€VoltageAdapter"><a href="#4ã€VoltageAdapter" class="headerlink" title="4ã€VoltageAdapter"></a>4ã€VoltageAdapter</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-comment">//é€‚é…å™¨ç±»</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">VoltageAdapter</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_">Voltage220V</span> <span class="hljs-keyword">implements</span> <span class="hljs-title class_">IVoltage5V</span> &#123;<br><br>   <span class="hljs-meta">@Override</span><br>   <span class="hljs-keyword">public</span> <span class="hljs-type">int</span> <span class="hljs-title function_">output5V</span><span class="hljs-params">()</span> &#123;<br>      <span class="hljs-comment">// TODO Auto-generated method stub</span><br>      <span class="hljs-comment">//è·å–åˆ°220Vç”µå‹</span><br>      <span class="hljs-type">int</span> <span class="hljs-variable">srcV</span> <span class="hljs-operator">=</span> output220V();<br>      <span class="hljs-type">int</span> <span class="hljs-variable">dstV</span> <span class="hljs-operator">=</span> srcV / <span class="hljs-number">44</span> ; <span class="hljs-comment">//è½¬æˆ 5v</span><br>      <span class="hljs-keyword">return</span> dstV;<br>   &#125;<br><br>&#125;<br></code></pre></td></tr></table></figure><h4 id="5ã€Client"><a href="#5ã€Client" class="headerlink" title="5ã€Client"></a>5ã€Client</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Client</span> &#123;<br><br>   <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span> &#123;<br>      <span class="hljs-comment">// TODO Auto-generated method stub</span><br>      System.out.println(<span class="hljs-string">&quot; === ç±»é€‚é…å™¨æ¨¡å¼ ====&quot;</span>);<br>      <span class="hljs-type">Phone</span> <span class="hljs-variable">phone</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Phone</span>();<br>      phone.charging(<span class="hljs-keyword">new</span> <span class="hljs-title class_">VoltageAdapter</span>());<br>   &#125;<br><br>&#125;<br></code></pre></td></tr></table></figure><h3 id="2ã€å¯¹è±¡é€‚é…å™¨å®ç°"><a href="#2ã€å¯¹è±¡é€‚é…å™¨å®ç°" class="headerlink" title="2ã€å¯¹è±¡é€‚é…å™¨å®ç°"></a>2ã€å¯¹è±¡é€‚é…å™¨å®ç°</h3><p>åŸºæœ¬æ€è·¯å’Œç±»çš„é€‚é…å™¨æ¨¡å¼ç›¸åŒï¼Œåªæ˜¯å°† Adapter ç±»ä½œä¿®æ”¹ï¼Œä¸æ˜¯ç»§æ‰¿ src ç±»ï¼Œè€Œæ˜¯æŒæœ‰ src ç±»çš„å®ä¾‹ï¼Œä»¥è§£å†³ å…¼å®¹æ€§çš„é—®é¢˜ã€‚ å³ï¼šæŒæœ‰ src ç±»ï¼Œå®ç° dst ç±»æ¥å£ï¼Œå®Œæˆ src-&gt;dst çš„é€‚é… ï¼Œåœ¨ç³»ç»Ÿä¸­å°½é‡ä½¿ç”¨<strong>å…³è”å…³ç³»ï¼ˆèšåˆï¼Œç»„åˆï¼‰æ¥æ›¿ä»£ç»§æ‰¿</strong>å…³ç³»ã€‚</p><p>ä¸Šé¢çš„ä¾‹å­ä»£ç åŸºæœ¬æ²¡ç”¨ä»€ä¹ˆæ”¹å˜ï¼Œæ”¹å˜çš„åªæœ‰ä»¥ä¸‹ä¸¤ä¸ªç±»</p><h4 id="1ã€VoltageAdapter"><a href="#1ã€VoltageAdapter" class="headerlink" title="1ã€VoltageAdapter"></a>1ã€VoltageAdapter</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-comment">// é€‚é…å™¨ç±»</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">VoltageAdapter</span> <span class="hljs-keyword">implements</span> <span class="hljs-title class_">IVoltage5V</span> &#123;<br><br>  <span class="hljs-keyword">private</span> Voltage220V voltage220V; <span class="hljs-comment">// å…³è”å…³ç³»-èšåˆ</span><br><br>  <span class="hljs-comment">// é€šè¿‡æ„é€ å™¨ï¼Œä¼ å…¥ä¸€ä¸ª Voltage220V å®ä¾‹</span><br>  <span class="hljs-keyword">public</span> <span class="hljs-title function_">VoltageAdapter</span><span class="hljs-params">(Voltage220V voltage220v)</span> &#123;<br><br>    <span class="hljs-built_in">this</span>.voltage220V = voltage220v;<br>  &#125;<br><br>  <span class="hljs-meta">@Override</span><br>  <span class="hljs-keyword">public</span> <span class="hljs-type">int</span> <span class="hljs-title function_">output5V</span><span class="hljs-params">()</span> &#123;<br><br>    <span class="hljs-type">int</span> <span class="hljs-variable">dst</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>;<br>    <span class="hljs-keyword">if</span> (<span class="hljs-literal">null</span> != voltage220V) &#123;<br>      <span class="hljs-type">int</span> <span class="hljs-variable">src</span> <span class="hljs-operator">=</span> voltage220V.output220V(); <span class="hljs-comment">// è·å–220V ç”µå‹</span><br>      System.out.println(<span class="hljs-string">&quot;ä½¿ç”¨å¯¹è±¡é€‚é…å™¨ï¼Œè¿›è¡Œé€‚é…~~&quot;</span>);<br>      dst = src / <span class="hljs-number">44</span>;<br>      System.out.println(<span class="hljs-string">&quot;é€‚é…å®Œæˆï¼Œè¾“å‡ºçš„ç”µå‹ä¸º=&quot;</span> + dst);<br>    &#125;<br><br>    <span class="hljs-keyword">return</span> dst;<br>  &#125;<br>&#125;<br></code></pre></td></tr></table></figure><h4 id="2ã€Client"><a href="#2ã€Client" class="headerlink" title="2ã€Client"></a>2ã€Client</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Client</span> &#123;<br><br>  <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span> &#123;<br>    <span class="hljs-comment">// TODO Auto-generated method stub</span><br>    System.out.println(<span class="hljs-string">&quot; === å¯¹è±¡é€‚é…å™¨æ¨¡å¼ ====&quot;</span>);<br>    <span class="hljs-type">Phone</span> <span class="hljs-variable">phone</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Phone</span>();<br>    phone.charging(<span class="hljs-keyword">new</span> <span class="hljs-title class_">VoltageAdapter</span>(<span class="hljs-keyword">new</span> <span class="hljs-title class_">Voltage220V</span>()));<br>  &#125;<br>&#125;<br></code></pre></td></tr></table></figure><h2 id="2ã€é€‚é…å™¨æ¨¡å¼çš„åŸç†ä¸å®ç°"><a href="#2ã€é€‚é…å™¨æ¨¡å¼çš„åŸç†ä¸å®ç°" class="headerlink" title="2ã€é€‚é…å™¨æ¨¡å¼çš„åŸç†ä¸å®ç°"></a>2ã€é€‚é…å™¨æ¨¡å¼çš„åŸç†ä¸å®ç°</h2><p>é€‚é…å™¨æ¨¡å¼(Adapter Pattern)å°†æŸä¸ªç±»çš„æ¥å£è½¬æ¢æˆå®¢æˆ·ç«¯æœŸæœ›çš„å¦ä¸€ä¸ªæ¥å£è¡¨ç¤ºï¼Œä¸»è¦ç›®çš„æ˜¯å…¼å®¹æ€§ï¼Œè®©åŸæœ¬å› æ¥å£ä¸åŒ¹é…ä¸èƒ½ä¸€èµ·å·¥ä½œçš„ä¸¤ä¸ªç±»å¯ä»¥ååŒ å·¥ä½œã€‚å…¶åˆ«åä¸ºåŒ…è£…å™¨(Wrapper)</p><p>é€‚é…å™¨æ¨¡å¼æœ‰ä¸¤ç§å®ç°æ–¹å¼ï¼šç±»é€‚é…å™¨å’Œå¯¹è±¡é€‚é…å™¨ã€‚å…¶ä¸­ï¼Œç±»é€‚é…å™¨ä½¿ç”¨ç»§æ‰¿å…³ç³»æ¥å®ç°ï¼Œå¯¹è±¡é€‚é…å™¨ä½¿ç”¨ç»„åˆå…³ç³»æ¥å®ç°ã€‚å…·ä½“çš„ä»£ç å®ç°å¦‚ä¸‹æ‰€ç¤ºã€‚å…¶ä¸­ï¼ŒITarget è¡¨ç¤ºè¦è½¬åŒ–æˆçš„æ¥å£å®šä¹‰ã€‚Adaptee æ˜¯ä¸€ç»„ä¸å…¼å®¹ ITarget æ¥å£å®šä¹‰çš„æ¥å£ï¼ŒAdaptor å°† Adaptee è½¬åŒ–æˆä¸€ç»„ç¬¦åˆ ITarget æ¥å£å®šä¹‰çš„æ¥å£ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-comment">// ç±»é€‚é…å™¨: åŸºäºç»§æ‰¿</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">interface</span> <span class="hljs-title class_">ITarget</span> &#123;<br>    <span class="hljs-keyword">void</span> <span class="hljs-title function_">f1</span><span class="hljs-params">()</span>;<br>    <span class="hljs-keyword">void</span> <span class="hljs-title function_">f2</span><span class="hljs-params">()</span>;<br>    <span class="hljs-keyword">void</span> <span class="hljs-title function_">fc</span><span class="hljs-params">()</span>;<br>&#125;<br><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Adaptee</span> &#123;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">fa</span><span class="hljs-params">()</span> &#123; <br>        <span class="hljs-comment">//... </span><br>    &#125;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">fb</span><span class="hljs-params">()</span> &#123;<br>        <span class="hljs-comment">//... </span><br>    &#125;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">fc</span><span class="hljs-params">()</span>&#123;<br>        <span class="hljs-comment">//... </span><br>    &#125;<br><br>&#125;<br><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Adaptor</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_">Adaptee</span> <span class="hljs-keyword">implements</span> <span class="hljs-title class_">ITarget</span> &#123;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">f1</span><span class="hljs-params">()</span> &#123;<br>        <span class="hljs-built_in">super</span>.fa();<br>    &#125;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">f2</span><span class="hljs-params">()</span> &#123;<br>        <span class="hljs-comment">//...é‡æ–°å®ç°f2()...</span><br>    &#125;<br><br><span class="hljs-comment">// è¿™é‡Œfc()ä¸éœ€è¦å®ç°ï¼Œç›´æ¥ç»§æ‰¿è‡ªAdapteeï¼Œè¿™æ˜¯è·Ÿå¯¹è±¡é€‚é…å™¨æœ€å¤§çš„ä¸åŒç‚¹</span><br>&#125;<br><br><span class="hljs-comment">// å¯¹è±¡é€‚é…å™¨ï¼šåŸºäºç»„åˆ</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">interface</span> <span class="hljs-title class_">ITarget</span> &#123;<br>    <span class="hljs-keyword">void</span> <span class="hljs-title function_">f1</span><span class="hljs-params">()</span>;<br>    <span class="hljs-keyword">void</span> <span class="hljs-title function_">f2</span><span class="hljs-params">()</span>;<br>    <span class="hljs-keyword">void</span> <span class="hljs-title function_">fc</span><span class="hljs-params">()</span>;<br>&#125;<br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Adaptee</span> &#123;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">fa</span><span class="hljs-params">()</span> &#123;<br>        <span class="hljs-comment">//... </span><br>    &#125;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">fb</span><span class="hljs-params">()</span> &#123;<br>        <span class="hljs-comment">//... </span><br>    &#125;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">fc</span><span class="hljs-params">()</span>&#123;<br>        <span class="hljs-comment">//... </span><br>    &#125;<br><br>&#125;<br><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Adaptor</span> <span class="hljs-keyword">implements</span> <span class="hljs-title class_">ITarget</span> &#123;<br>    <span class="hljs-keyword">private</span> Adaptee adaptee;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-title function_">Adaptor</span><span class="hljs-params">(Adaptee adaptee)</span> &#123;<br>        <span class="hljs-built_in">this</span>.adaptee = adaptee;<br>    &#125;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">f1</span><span class="hljs-params">()</span> &#123;<br>        adaptee.fa(); <span class="hljs-comment">//å§”æ‰˜ç»™Adaptee</span><br>    &#125;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">f2</span><span class="hljs-params">()</span> &#123;<br>        <span class="hljs-comment">//...é‡æ–°å®ç°f2()...</span><br>    &#125;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">fc</span><span class="hljs-params">()</span> &#123;<br>        adaptee.fc();<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>é’ˆå¯¹è¿™ä¸¤ç§å®ç°æ–¹å¼ï¼Œåœ¨å®é™…çš„å¼€å‘ä¸­ï¼Œåˆ°åº•è¯¥å¦‚ä½•é€‰æ‹©ä½¿ç”¨å“ªä¸€ç§å‘¢ï¼Ÿåˆ¤æ–­çš„æ ‡å‡†ä¸»è¦æœ‰ä¸¤ä¸ªï¼Œä¸€ä¸ªæ˜¯ Adaptee æ¥å£çš„ä¸ªæ•°ï¼Œå¦ä¸€ä¸ªæ˜¯ Adaptee å’Œ ITarget çš„å¥‘åˆç¨‹åº¦ã€‚</p><ul><li>å¦‚æœ Adaptee æ¥å£å¹¶ä¸å¤šï¼Œé‚£ä¸¤ç§å®ç°æ–¹å¼éƒ½å¯ä»¥ã€‚</li><li>å¦‚æœ Adaptee æ¥å£å¾ˆå¤šï¼Œè€Œä¸” Adaptee å’Œ ITarget æ¥å£å®šä¹‰å¤§éƒ¨åˆ†éƒ½ç›¸åŒï¼Œé‚£æˆ‘ä»¬æ¨èä½¿ç”¨ç±»é€‚é…å™¨ï¼Œå› ä¸º Adaptor å¤ç”¨çˆ¶ç±» Adaptee çš„æ¥å£ï¼Œæ¯”èµ·å¯¹è±¡é€‚é…å™¨çš„å®ç°æ–¹å¼ï¼ŒAdaptor çš„ä»£ç é‡è¦å°‘ä¸€äº›ã€‚</li><li>å¦‚æœ Adaptee æ¥å£å¾ˆå¤šï¼Œè€Œä¸” Adaptee å’Œ ITarget æ¥å£å®šä¹‰å¤§éƒ¨åˆ†éƒ½ä¸ç›¸åŒï¼Œé‚£æˆ‘ä»¬æ¨èä½¿ç”¨å¯¹è±¡é€‚é…å™¨ï¼Œå› ä¸ºç»„åˆç»“æ„ç›¸å¯¹äºç»§æ‰¿æ›´åŠ çµæ´»ã€‚</li></ul><h2 id="3ã€é€‚é…å™¨æ¨¡å¼åº”ç”¨åœºæ™¯"><a href="#3ã€é€‚é…å™¨æ¨¡å¼åº”ç”¨åœºæ™¯" class="headerlink" title="3ã€é€‚é…å™¨æ¨¡å¼åº”ç”¨åœºæ™¯"></a>3ã€é€‚é…å™¨æ¨¡å¼åº”ç”¨åœºæ™¯</h2><p>ä¸€èˆ¬æ¥è¯´ï¼Œé€‚é…å™¨æ¨¡å¼å¯ä»¥çœ‹ä½œä¸€ç§â€œè¡¥å¿æ¨¡å¼â€ï¼Œç”¨æ¥è¡¥æ•‘è®¾è®¡ä¸Šçš„ç¼ºé™·ã€‚åº”ç”¨è¿™ç§æ¨¡å¼ç®—æ˜¯â€œæ— å¥ˆä¹‹ä¸¾â€ã€‚å¦‚æœåœ¨è®¾è®¡åˆæœŸï¼Œæˆ‘ä»¬å°±èƒ½åè°ƒè§„é¿æ¥å£ä¸å…¼å®¹çš„é—®é¢˜ï¼Œé‚£è¿™ç§æ¨¡å¼å°±æ²¡æœ‰åº”ç”¨çš„æœºä¼šäº†ã€‚</p><h3 id="1ã€å°è£…æœ‰ç¼ºé™·çš„æ¥å£è®¾è®¡"><a href="#1ã€å°è£…æœ‰ç¼ºé™·çš„æ¥å£è®¾è®¡" class="headerlink" title="1ã€å°è£…æœ‰ç¼ºé™·çš„æ¥å£è®¾è®¡"></a>1ã€å°è£…æœ‰ç¼ºé™·çš„æ¥å£è®¾è®¡</h3><p>å‡è®¾æˆ‘ä»¬ä¾èµ–çš„å¤–éƒ¨ç³»ç»Ÿåœ¨æ¥å£è®¾è®¡æ–¹é¢æœ‰ç¼ºé™·ï¼ˆæ¯”å¦‚åŒ…å«å¤§é‡é™æ€æ–¹æ³•ï¼‰ï¼Œå¼•å…¥ä¹‹åä¼šå½±å“åˆ°æˆ‘ä»¬è‡ªèº«ä»£ç çš„å¯æµ‹è¯•æ€§ã€‚ä¸ºäº†éš”ç¦»è®¾è®¡ä¸Šçš„ç¼ºé™·ï¼Œæˆ‘ä»¬å¸Œæœ›å¯¹å¤–éƒ¨ç³»ç»Ÿæä¾›çš„æ¥å£è¿›è¡ŒäºŒæ¬¡å°è£…ï¼ŒæŠ½è±¡å‡ºæ›´å¥½çš„æ¥å£è®¾è®¡ï¼Œè¿™ä¸ªæ—¶å€™å°±å¯ä»¥ä½¿ç”¨é€‚é…å™¨æ¨¡å¼äº†ã€‚</p><p>æ¯”å¦‚ä¸‹é¢çš„ä¾‹å­ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">CD</span> &#123; <span class="hljs-comment">//è¿™ä¸ªç±»æ¥è‡ªå¤–éƒ¨sdkï¼Œæˆ‘ä»¬æ— æƒä¿®æ”¹å®ƒçš„ä»£ç </span><br>    <span class="hljs-comment">//...</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">staticFunction1</span><span class="hljs-params">()</span> &#123; <span class="hljs-comment">//... &#125;</span><br>        <br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">uglyNamingFunction2</span><span class="hljs-params">()</span> &#123; <span class="hljs-comment">//... &#125;</span><br>        <br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">tooManyParamsFunction3</span><span class="hljs-params">(<span class="hljs-type">int</span> paramA, <span class="hljs-type">int</span> paramB, ...)</span> &#123; <span class="hljs-comment">//... &#125;</span><br><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">lowPerformanceFunction4</span><span class="hljs-params">()</span> &#123; <span class="hljs-comment">//... &#125;</span><br><br>&#125;<br><br><span class="hljs-comment">// ä½¿ç”¨é€‚é…å™¨æ¨¡å¼è¿›è¡Œé‡æ„</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">interface</span> <span class="hljs-title class_">ITarget</span> &#123;<br><br>    <span class="hljs-keyword">void</span> <span class="hljs-title function_">function1</span><span class="hljs-params">()</span>;<br>    <span class="hljs-keyword">void</span> <span class="hljs-title function_">function2</span><span class="hljs-params">()</span>;<br>    <span class="hljs-keyword">void</span> <span class="hljs-title function_">fucntion3</span><span class="hljs-params">(ParamsWrapperDefinition paramsWrapper)</span>;<br>    <span class="hljs-keyword">void</span> <span class="hljs-title function_">function4</span><span class="hljs-params">()</span>;<br>    <span class="hljs-comment">//...</span><br>&#125;<br><br><span class="hljs-comment">// æ³¨æ„ï¼šé€‚é…å™¨ç±»çš„å‘½åä¸ä¸€å®šéå¾—æœ«å°¾å¸¦Adaptor</span><br><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">CDAdaptor</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_">CD</span> <span class="hljs-keyword">implements</span> <span class="hljs-title class_">ITarget</span> &#123;<br>    <span class="hljs-comment">//...</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">function1</span><span class="hljs-params">()</span> &#123;<br>        <span class="hljs-built_in">super</span>.staticFunction1();<br>    &#125;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">function2</span><span class="hljs-params">()</span> &#123;<br>        <span class="hljs-built_in">super</span>.uglyNamingFucntion2();<br>    &#125;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">function3</span><span class="hljs-params">(ParamsWrapperDefinition paramsWrapper)</span> &#123; <br>        <span class="hljs-built_in">super</span>.tooManyParamsFunction3(paramsWrapper.getParamA(), ...);<br>    &#125;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">function4</span><span class="hljs-params">()</span> &#123;<br>        <span class="hljs-comment">//...reimplement it...</span><br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><h3 id="2ã€ç»Ÿä¸€å¤šä¸ªç±»çš„æ¥å£è®¾è®¡"><a href="#2ã€ç»Ÿä¸€å¤šä¸ªç±»çš„æ¥å£è®¾è®¡" class="headerlink" title="2ã€ç»Ÿä¸€å¤šä¸ªç±»çš„æ¥å£è®¾è®¡"></a>2ã€ç»Ÿä¸€å¤šä¸ªç±»çš„æ¥å£è®¾è®¡</h3><ol><li>æŸä¸ªåŠŸèƒ½çš„å®ç°ä¾èµ–å¤šä¸ªå¤–éƒ¨ç³»ç»Ÿï¼ˆæˆ–è€…è¯´ç±»ï¼‰ã€‚é€šè¿‡é€‚é…å™¨æ¨¡å¼ï¼Œå°†å®ƒä»¬çš„æ¥å£é€‚é…ä¸ºç»Ÿä¸€çš„æ¥å£å®šä¹‰ï¼Œç„¶åæˆ‘ä»¬å°±å¯ä»¥ä½¿ç”¨å¤šæ€çš„ç‰¹æ€§æ¥å¤ç”¨ä»£ç é€»è¾‘ã€‚å…·ä½“è¿˜æ˜¯ä¸¾ä¸ªä¾‹å­æ¥è§£é‡Šä¸€ä¸‹ã€‚</li><li>å‡è®¾æˆ‘ä»¬çš„ç³»ç»Ÿè¦å¯¹ç”¨æˆ·è¾“å…¥çš„æ–‡æœ¬å†…å®¹åšæ•æ„Ÿè¯è¿‡æ»¤ï¼Œä¸ºäº†æé«˜è¿‡æ»¤çš„å¬å›ç‡ï¼Œæˆ‘ä»¬å¼•å…¥äº†å¤šæ¬¾ç¬¬ä¸‰æ–¹æ•æ„Ÿè¯è¿‡æ»¤ç³»ç»Ÿï¼Œä¾æ¬¡å¯¹ç”¨æˆ·è¾“å…¥çš„å†…å®¹è¿›è¡Œè¿‡æ»¤ï¼Œè¿‡æ»¤æ‰å°½å¯èƒ½å¤šçš„æ•æ„Ÿè¯ã€‚ä½†æ˜¯ï¼Œæ¯ä¸ªç³»ç»Ÿæä¾›çš„è¿‡æ»¤æ¥å£éƒ½æ˜¯ä¸åŒçš„ã€‚è¿™å°±æ„å‘³ç€æˆ‘ä»¬æ²¡æ³•å¤ç”¨ä¸€å¥—é€»è¾‘æ¥è°ƒç”¨å„ä¸ªç³»ç»Ÿã€‚è¿™ä¸ªæ—¶å€™ï¼Œæˆ‘ä»¬å°±å¯ä»¥ä½¿ç”¨é€‚é…å™¨æ¨¡å¼ï¼Œå°†æ‰€æœ‰ç³»ç»Ÿçš„æ¥å£é€‚é…ä¸ºç»Ÿä¸€çš„æ¥å£å®šä¹‰ï¼Œè¿™æ ·æˆ‘ä»¬å¯ä»¥å¤ç”¨è°ƒç”¨æ•æ„Ÿè¯è¿‡æ»¤çš„ä»£ç ã€‚</li></ol><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">import</span> java.util.ArrayList;<br><span class="hljs-keyword">import</span> java.util.List;<br><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">ASensitiveWordsFilter</span> &#123; <span class="hljs-comment">// Aæ•æ„Ÿè¯è¿‡æ»¤ç³»ç»Ÿæä¾›çš„æ¥å£</span><br>  <span class="hljs-comment">// textæ˜¯åŸå§‹æ–‡æœ¬ï¼Œå‡½æ•°è¾“å‡ºç”¨***æ›¿æ¢æ•æ„Ÿè¯ä¹‹åçš„æ–‡æœ¬</span><br>  <span class="hljs-keyword">public</span> String <span class="hljs-title function_">filterSexyWords</span><span class="hljs-params">(String text)</span> &#123;<br>    <span class="hljs-comment">// ...</span><br>  &#125;<br><br>  <span class="hljs-keyword">public</span> String <span class="hljs-title function_">filterPoliticalWords</span><span class="hljs-params">(String text)</span> &#123;<br>    <span class="hljs-comment">// ...</span><br>  &#125;<br>&#125;<br><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">BSensitiveWordsFilter</span> &#123; <span class="hljs-comment">// Bæ•æ„Ÿè¯è¿‡æ»¤ç³»ç»Ÿæä¾›çš„æ¥å£</span><br>  <span class="hljs-keyword">public</span> String <span class="hljs-title function_">filter</span><span class="hljs-params">(String text)</span> &#123;<br>    <span class="hljs-comment">// ...</span><br>  &#125;<br>&#125;<br><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">CSensitiveWordsFilter</span> &#123; <span class="hljs-comment">// Cæ•æ„Ÿè¯è¿‡æ»¤ç³»ç»Ÿæä¾›çš„æ¥å£</span><br>  <span class="hljs-keyword">public</span> String <span class="hljs-title function_">filter</span><span class="hljs-params">(String text, String mask)</span> &#123;<br>    <span class="hljs-comment">// ...</span><br>  &#125;<br>&#125;<br><br><span class="hljs-comment">// æœªä½¿ç”¨é€‚é…å™¨æ¨¡å¼ä¹‹å‰çš„ä»£ç ï¼šä»£ç çš„å¯æµ‹è¯•æ€§ã€æ‰©å±•æ€§ä¸å¥½</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">RiskManagement</span> &#123;<br>  <span class="hljs-keyword">private</span> <span class="hljs-type">ASensitiveWordsFilter</span> <span class="hljs-variable">aFilter</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">ASensitiveWordsFilter</span>();<br>  <span class="hljs-keyword">private</span> <span class="hljs-type">BSensitiveWordsFilter</span> <span class="hljs-variable">bFilter</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">BSensitiveWordsFilter</span>();<br>  <span class="hljs-keyword">private</span> <span class="hljs-type">CSensitiveWordsFilter</span> <span class="hljs-variable">cFilter</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">CSensitiveWordsFilter</span>();<br><br>  <span class="hljs-keyword">public</span> String <span class="hljs-title function_">filterSensitiveWords</span><span class="hljs-params">(String text)</span> &#123;<br>    <span class="hljs-type">String</span> <span class="hljs-variable">maskedText</span> <span class="hljs-operator">=</span> aFilter.filterSexyWords(text);<br>    maskedText = aFilter.filterPoliticalWords(maskedText);<br>    maskedText = bFilter.filter(maskedText);<br>    maskedText = cFilter.filter(maskedText, <span class="hljs-string">&quot;***&quot;</span>);<br>    <span class="hljs-keyword">return</span> maskedText;<br>  &#125;<br>&#125;<br><br><span class="hljs-comment">// ä½¿ç”¨é€‚é…å™¨æ¨¡å¼è¿›è¡Œæ”¹é€ </span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">interface</span> <span class="hljs-title class_">ISensitiveWordsFilter</span> &#123; <span class="hljs-comment">// ç»Ÿä¸€æ¥å£å®šä¹‰</span><br>  String <span class="hljs-title function_">filter</span><span class="hljs-params">(String text)</span>;<br>&#125;<br><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">ASensitiveWordsFilterAdaptor</span> <span class="hljs-keyword">implements</span> <span class="hljs-title class_">ISensitiveWordsFilter</span> &#123;<br>  <span class="hljs-keyword">private</span> ASensitiveWordsFilter aFilter;<br><br>  <span class="hljs-keyword">public</span> String <span class="hljs-title function_">filter</span><span class="hljs-params">(String text)</span> &#123;<br>    <span class="hljs-type">String</span> <span class="hljs-variable">maskedText</span> <span class="hljs-operator">=</span> aFilter.filterSexyWords(text);<br>    maskedText = aFilter.filterPoliticalWords(maskedText);<br>    <span class="hljs-keyword">return</span> maskedText;<br>  &#125;<br>&#125;<br><br><span class="hljs-comment">// ...çœç•¥BSensitiveWordsFilterAdaptorã€CSensitiveWordsFilterAdaptor...</span><br><span class="hljs-comment">// æ‰©å±•æ€§æ›´å¥½ï¼Œæ›´åŠ ç¬¦åˆå¼€é—­åŸåˆ™ï¼Œå¦‚æœæ·»åŠ ä¸€ä¸ªæ–°çš„æ•æ„Ÿè¯è¿‡æ»¤ç³»ç»Ÿï¼Œ</span><br><span class="hljs-comment">// è¿™ä¸ªç±»å®Œå…¨ä¸éœ€è¦æ”¹åŠ¨ï¼›è€Œä¸”åŸºäºæ¥å£è€Œéå®ç°ç¼–ç¨‹ï¼Œä»£ç çš„å¯æµ‹è¯•æ€§æ›´å¥½ã€‚</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">RiskManagement</span> &#123;<br>  <span class="hljs-keyword">private</span> List&lt;ISensitiveWordsFilter&gt; filters = <span class="hljs-keyword">new</span> <span class="hljs-title class_">ArrayList</span>&lt;&gt;();<br><br>  <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">addSensitiveWordsFilter</span><span class="hljs-params">(ISensitiveWordsFilter filter)</span> &#123;<br>    filters.add(filter);<br>  &#125;<br><br>  <span class="hljs-keyword">public</span> String <span class="hljs-title function_">filterSensitiveWords</span><span class="hljs-params">(String text)</span> &#123;<br>    <span class="hljs-type">String</span> <span class="hljs-variable">maskedText</span> <span class="hljs-operator">=</span> text;<br>    <span class="hljs-keyword">for</span> (ISensitiveWordsFilter filter : filters) &#123;<br>      maskedText = filter.filter(maskedText);<br>    &#125;<br><br>    <span class="hljs-keyword">return</span> maskedText;<br>  &#125;<br>&#125;<br></code></pre></td></tr></table></figure><h3 id="3ã€æ›¿æ¢ä¾èµ–çš„å¤–éƒ¨ç³»ç»Ÿ"><a href="#3ã€æ›¿æ¢ä¾èµ–çš„å¤–éƒ¨ç³»ç»Ÿ" class="headerlink" title="3ã€æ›¿æ¢ä¾èµ–çš„å¤–éƒ¨ç³»ç»Ÿ"></a>3ã€æ›¿æ¢ä¾èµ–çš„å¤–éƒ¨ç³»ç»Ÿ</h3><p>å½“æˆ‘ä»¬æŠŠé¡¹ç›®ä¸­ä¾èµ–çš„ä¸€ä¸ªå¤–éƒ¨ç³»ç»Ÿæ›¿æ¢ä¸ºå¦ä¸€ä¸ªå¤–éƒ¨ç³»ç»Ÿçš„æ—¶å€™ï¼Œåˆ©ç”¨é€‚é…å™¨æ¨¡å¼ï¼Œå¯ä»¥å‡å°‘å¯¹ä»£ç çš„æ”¹åŠ¨ã€‚å…·ä½“çš„ä»£ç ç¤ºä¾‹å¦‚ä¸‹æ‰€ç¤ºï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-comment">// å¤–éƒ¨ç³»ç»ŸA</span><br><span class="hljs-keyword">public</span>  <span class="hljs-keyword">interface</span>  <span class="hljs-title class_">IA</span>  &#123;<br><span class="hljs-comment">//...</span><br>  <span class="hljs-keyword">void</span>  <span class="hljs-title function_">fa</span><span class="hljs-params">()</span>;<br>&#125;<br><span class="hljs-keyword">public</span>  <span class="hljs-keyword">class</span>  <span class="hljs-title class_">A</span>  <span class="hljs-keyword">implements</span>  <span class="hljs-title class_">IA</span>  &#123;<br><span class="hljs-comment">//...</span><br>  <span class="hljs-keyword">public</span>  <span class="hljs-keyword">void</span>  <span class="hljs-title function_">fa</span><span class="hljs-params">()</span>  &#123; <br>    <span class="hljs-comment">//... </span><br>  &#125;<br>&#125;<br><br><span class="hljs-comment">// åœ¨æˆ‘ä»¬çš„é¡¹ç›®ä¸­ï¼Œå¤–éƒ¨ç³»ç»ŸAçš„ä½¿ç”¨ç¤ºä¾‹</span><br><span class="hljs-keyword">public</span>  <span class="hljs-keyword">class</span>  <span class="hljs-title class_">Demo</span>  &#123;<br>  <span class="hljs-keyword">private</span> IA a;<br>  <span class="hljs-keyword">public</span>  <span class="hljs-title function_">Demo</span><span class="hljs-params">(IA a)</span>  &#123;<br>    <span class="hljs-built_in">this</span>.a = a;<br>  &#125;<br>  <span class="hljs-comment">//... </span><br><br>&#125;<br><br><span class="hljs-type">Demo</span> <span class="hljs-variable">d</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Demo</span>(<span class="hljs-keyword">new</span> <span class="hljs-title class_">A</span>());<br><br><span class="hljs-comment">// å°†å¤–éƒ¨ç³»ç»ŸAæ›¿æ¢æˆå¤–éƒ¨ç³»ç»ŸB</span><br><span class="hljs-keyword">public</span>  <span class="hljs-keyword">class</span>  <span class="hljs-title class_">BAdaptor</span>  implemnts  IA  &#123;<br>  <span class="hljs-keyword">private</span> B b;<br>  <span class="hljs-keyword">public</span>  <span class="hljs-title function_">BAdaptor</span><span class="hljs-params">(B b)</span>  &#123;<br>    <span class="hljs-built_in">this</span>.b= b;<br>  &#125;<br><br>  <span class="hljs-keyword">public</span>  <span class="hljs-keyword">void</span>  <span class="hljs-title function_">fa</span><span class="hljs-params">()</span>  &#123;<br>  <span class="hljs-comment">//...</span><br>    b.fb();<br>  &#125;<br>&#125;<br><br><span class="hljs-comment">// å€ŸåŠ©BAdaptorï¼ŒDemoçš„ä»£ç ä¸­ï¼Œè°ƒç”¨IAæ¥å£çš„åœ°æ–¹éƒ½æ— éœ€æ”¹åŠ¨ï¼Œ</span><br><span class="hljs-comment">// åªéœ€è¦å°†BAdaptorå¦‚ä¸‹æ³¨å…¥åˆ°Demoå³å¯ã€‚</span><br><span class="hljs-type">Demo</span> <span class="hljs-variable">d</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Demo</span>(<span class="hljs-keyword">new</span> <span class="hljs-title class_">BAdaptor</span>(<span class="hljs-keyword">new</span> <span class="hljs-title class_">B</span>()));<br></code></pre></td></tr></table></figure><h3 id="4ã€å…¼å®¹è€ç‰ˆæœ¬æ¥å£"><a href="#4ã€å…¼å®¹è€ç‰ˆæœ¬æ¥å£" class="headerlink" title="4ã€å…¼å®¹è€ç‰ˆæœ¬æ¥å£"></a>4ã€å…¼å®¹è€ç‰ˆæœ¬æ¥å£</h3><ol><li>åœ¨åšç‰ˆæœ¬å‡çº§çš„æ—¶å€™ï¼Œå¯¹äºä¸€äº›è¦åºŸå¼ƒçš„æ¥å£ï¼Œæˆ‘ä»¬ä¸ç›´æ¥å°†å…¶åˆ é™¤ï¼Œè€Œæ˜¯æš‚æ—¶ä¿ç•™ï¼Œå¹¶ä¸”æ ‡æ³¨ä¸º deprecatedï¼Œå¹¶å°†å†…éƒ¨å®ç°é€»è¾‘å§”æ‰˜ä¸ºæ–°çš„æ¥å£å®ç°ã€‚è¿™æ ·åšçš„å¥½å¤„æ˜¯ï¼Œè®©ä½¿ç”¨å®ƒçš„é¡¹ç›®æœ‰ä¸ªè¿‡æ¸¡æœŸï¼Œè€Œä¸æ˜¯å¼ºåˆ¶è¿›è¡Œä»£ç ä¿®æ”¹ã€‚è¿™ä¹Ÿå¯ä»¥ç²—ç•¥åœ°çœ‹ä½œé€‚é…å™¨æ¨¡å¼çš„ä¸€ä¸ªåº”ç”¨åœºæ™¯ã€‚åŒæ ·ï¼Œè¿˜æ˜¯é€šè¿‡ä¸€ä¸ªä¾‹å­ï¼Œæ¥è¿›ä¸€æ­¥è§£é‡Šä¸€ä¸‹ã€‚</li><li>JDK1.0 ä¸­åŒ…å«ä¸€ä¸ªéå†é›†åˆå®¹å™¨çš„ç±» Enumerationã€‚JDK2.0 å¯¹è¿™ä¸ªç±»è¿›è¡Œäº†é‡æ„ï¼Œå°†å®ƒæ”¹åä¸º Iterator ç±»ï¼Œå¹¶ä¸”å¯¹å®ƒçš„ä»£ç å®ç°åšäº†ä¼˜åŒ–ã€‚ä½†æ˜¯è€ƒè™‘åˆ°å¦‚æœå°† Enumeration ç›´æ¥ä» JDK2.0 ä¸­åˆ é™¤ï¼Œé‚£ä½¿ç”¨ JDK1.0 çš„é¡¹ç›®å¦‚æœåˆ‡æ¢åˆ° JDK2.0ï¼Œä»£ç å°±ä¼šç¼–è¯‘ä¸é€šè¿‡ã€‚ä¸ºäº†é¿å…è¿™ç§æƒ…å†µçš„å‘ç”Ÿï¼Œæˆ‘ä»¬å¿…é¡»æŠŠé¡¹ç›®ä¸­æ‰€æœ‰ä½¿ç”¨åˆ° Enumeration çš„åœ°æ–¹ï¼Œéƒ½ä¿®æ”¹ä¸ºä½¿ç”¨ Iterator æ‰è¡Œã€‚</li><li>å•ç‹¬ä¸€ä¸ªé¡¹ç›®åš Enumeration åˆ° Iterator çš„æ›¿æ¢ï¼Œå‹‰å¼ºè¿˜èƒ½æ¥å—ã€‚ä½†æ˜¯ï¼Œä½¿ç”¨ Java å¼€å‘çš„é¡¹ç›®å¤ªå¤šäº†ï¼Œä¸€æ¬¡ JDK çš„å‡çº§ï¼Œå¯¼è‡´æ‰€æœ‰çš„é¡¹ç›®ä¸åšä»£ç ä¿®æ”¹å°±ä¼šç¼–è¯‘æŠ¥é”™ï¼Œè¿™æ˜¾ç„¶æ˜¯ä¸åˆç†çš„ã€‚è¿™å°±æ˜¯æˆ‘ä»¬ç»å¸¸æ‰€è¯´çš„ä¸å…¼å®¹å‡çº§ã€‚ä¸ºäº†åšåˆ°å…¼å®¹ä½¿ç”¨ä½ç‰ˆæœ¬ JDK çš„è€ä»£ç ï¼Œæˆ‘ä»¬å¯ä»¥æš‚æ—¶ä¿ç•™ Enumeration ç±»ï¼Œå¹¶å°†å…¶å®ç°æ›¿æ¢ä¸ºç›´æ¥è°ƒç”¨ Itertorã€‚ä»£ç ç¤ºä¾‹å¦‚ä¸‹æ‰€ç¤ºï¼š</li></ol><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span>  <span class="hljs-keyword">class</span>  <span class="hljs-title class_">Collections</span>  &#123;<br>  <span class="hljs-keyword">public</span>  <span class="hljs-keyword">static</span> Emueration <span class="hljs-title function_">emumeration</span><span class="hljs-params">(<span class="hljs-keyword">final</span> Collection c)</span>  &#123;<br>    <span class="hljs-keyword">return</span>  <span class="hljs-keyword">new</span> <span class="hljs-title class_">Enumeration</span>() &#123;<br>      <span class="hljs-type">Iterator</span> <span class="hljs-variable">i</span> <span class="hljs-operator">=</span> c.iterator();<br><br>      <span class="hljs-keyword">public</span> <span class="hljs-type">boolean</span> <span class="hljs-title function_">hasMoreElments</span><span class="hljs-params">()</span>  &#123;<br>        <span class="hljs-keyword">return</span> i.hashNext();<br>      &#125;<br><br>      <span class="hljs-keyword">public</span> Object <span class="hljs-title function_">nextElement</span><span class="hljs-params">()</span>  &#123;<br>        <span class="hljs-keyword">return</span> i.next():<br>      &#125;<br>    &#125;<br>  &#125;<br>&#125;<br></code></pre></td></tr></table></figure><h3 id="5ã€é€‚é…ä¸åŒæ ¼å¼çš„æ•°æ®"><a href="#5ã€é€‚é…ä¸åŒæ ¼å¼çš„æ•°æ®" class="headerlink" title="5ã€é€‚é…ä¸åŒæ ¼å¼çš„æ•°æ®"></a>5ã€é€‚é…ä¸åŒæ ¼å¼çš„æ•°æ®</h3><p>å‰é¢æˆ‘ä»¬è®²åˆ°ï¼Œé€‚é…å™¨æ¨¡å¼ä¸»è¦ç”¨äºæ¥å£çš„é€‚é…ï¼Œå®é™…ä¸Šï¼Œå®ƒè¿˜å¯ä»¥ç”¨åœ¨ä¸åŒæ ¼å¼çš„æ•°æ®ä¹‹é—´çš„é€‚é…ã€‚æ¯”å¦‚ï¼ŒæŠŠä»ä¸åŒå¾ä¿¡ç³»ç»Ÿæ‹‰å–çš„ä¸åŒæ ¼å¼çš„å¾ä¿¡æ•°æ®ï¼Œç»Ÿä¸€ä¸ºç›¸åŒçš„æ ¼å¼ï¼Œä»¥æ–¹ä¾¿å­˜å‚¨å’Œä½¿ç”¨ã€‚å†æ¯”å¦‚ï¼ŒJava ä¸­çš„ Arrays.asList() ä¹Ÿå¯ä»¥çœ‹ä½œä¸€ç§æ•°æ®é€‚é…å™¨ï¼Œå°†æ•°ç»„ç±»å‹çš„æ•°æ®è½¬åŒ–ä¸ºé›†åˆå®¹å™¨ç±»å‹ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs java">List&lt;String&gt; stooges = Arrays.asList(<span class="hljs-string">&quot;Larry&quot;</span>, <span class="hljs-string">&quot;Moe&quot;</span>, <span class="hljs-string">&quot;Curly&quot;</span>);<br></code></pre></td></tr></table></figure><h3 id="6ã€é€‚é…å™¨æ¨¡å¼åœ¨-Java-æ—¥å¿—ä¸­çš„åº”ç”¨-Slf4j"><a href="#6ã€é€‚é…å™¨æ¨¡å¼åœ¨-Java-æ—¥å¿—ä¸­çš„åº”ç”¨-Slf4j" class="headerlink" title="6ã€é€‚é…å™¨æ¨¡å¼åœ¨ Java æ—¥å¿—ä¸­çš„åº”ç”¨(Slf4j)"></a>6ã€é€‚é…å™¨æ¨¡å¼åœ¨ Java æ—¥å¿—ä¸­çš„åº”ç”¨(Slf4j)</h3><ol><li>Java ä¸­æœ‰å¾ˆå¤šæ—¥å¿—æ¡†æ¶ï¼Œåœ¨é¡¹ç›®å¼€å‘ä¸­ï¼Œæˆ‘ä»¬å¸¸å¸¸ç”¨å®ƒä»¬æ¥æ‰“å°æ—¥å¿—ä¿¡æ¯ã€‚å…¶ä¸­ï¼Œæ¯”è¾ƒå¸¸ç”¨çš„æœ‰ log4jã€logbackï¼Œä»¥åŠ JDK æä¾›çš„ JUL(java.util.logging) å’Œ Apache çš„ JCL(Jakarta Commons Logging) ç­‰ã€‚</li><li>å¤§éƒ¨åˆ†æ—¥å¿—æ¡†æ¶éƒ½æä¾›äº†ç›¸ä¼¼çš„åŠŸèƒ½ï¼Œæ¯”å¦‚æŒ‰ç…§ä¸åŒçº§åˆ«ï¼ˆdebugã€infoã€warnã€erroâ€¦â€¦ï¼‰æ‰“å°æ—¥å¿—ç­‰ï¼Œä½†å®ƒä»¬å´å¹¶æ²¡æœ‰å®ç°ç»Ÿä¸€çš„æ¥å£ã€‚è¿™ä¸»è¦å¯èƒ½æ˜¯å†å²çš„åŸå› ï¼Œå®ƒä¸åƒ JDBC é‚£æ ·ï¼Œä¸€å¼€å§‹å°±åˆ¶å®šäº†æ•°æ®åº“æ“ä½œçš„æ¥å£è§„èŒƒã€‚</li><li>å¦‚æœæˆ‘ä»¬åªæ˜¯å¼€å‘ä¸€ä¸ªè‡ªå·±ç”¨çš„é¡¹ç›®ï¼Œé‚£ç”¨ä»€ä¹ˆæ—¥å¿—æ¡†æ¶éƒ½å¯ä»¥ï¼Œlog4jã€logback éšä¾¿é€‰ä¸€ä¸ªå°±å¥½ã€‚ä½†æ˜¯ï¼Œå¦‚æœæˆ‘ä»¬å¼€å‘çš„æ˜¯ä¸€ä¸ªé›†æˆåˆ°å…¶ä»–ç³»ç»Ÿçš„ç»„ä»¶ã€æ¡†æ¶ã€ç±»åº“ç­‰ï¼Œé‚£æ—¥å¿—æ¡†æ¶çš„é€‰æ‹©å°±æ²¡é‚£ä¹ˆéšæ„äº†ã€‚</li><li>æ¯”å¦‚ï¼Œé¡¹ç›®ä¸­ç”¨åˆ°çš„æŸä¸ªç»„ä»¶ä½¿ç”¨ log4j æ¥æ‰“å°æ—¥å¿—ï¼Œè€Œæˆ‘ä»¬é¡¹ç›®æœ¬èº«ä½¿ç”¨çš„æ˜¯ logbackã€‚å°†ç»„ä»¶å¼•å…¥åˆ°é¡¹ç›®ä¹‹åï¼Œæˆ‘ä»¬çš„é¡¹ç›®å°±ç›¸å½“äºæœ‰äº†ä¸¤å¥—æ—¥å¿—æ‰“å°æ¡†æ¶ã€‚æ¯ç§æ—¥å¿—æ¡†æ¶éƒ½æœ‰è‡ªå·±ç‰¹æœ‰çš„é…ç½®æ–¹å¼ã€‚æ‰€ä»¥ï¼Œæˆ‘ä»¬è¦é’ˆå¯¹æ¯ç§æ—¥å¿—æ¡†æ¶ç¼–å†™ä¸åŒçš„é…ç½®æ–‡ä»¶ï¼ˆæ¯”å¦‚ï¼Œæ—¥å¿—å­˜å‚¨çš„æ–‡ä»¶åœ°å€ã€æ‰“å°æ—¥å¿—çš„æ ¼å¼ï¼‰ã€‚å¦‚æœå¼•å…¥å¤šä¸ªç»„ä»¶ï¼Œæ¯ä¸ªç»„ä»¶ä½¿ç”¨çš„æ—¥å¿—æ¡†æ¶éƒ½ä¸ä¸€æ ·ï¼Œé‚£æ—¥å¿—æœ¬èº«çš„ç®¡ç†å·¥ä½œå°±å˜å¾—éå¸¸å¤æ‚ã€‚æ‰€ä»¥ï¼Œä¸ºäº†è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œæˆ‘ä»¬éœ€è¦ç»Ÿä¸€æ—¥å¿—æ‰“å°æ¡†æ¶ã€‚</li><li>å¦‚æœæ˜¯åš Java å¼€å‘çš„ï¼Œé‚£ Slf4j è¿™ä¸ªæ—¥å¿—æ¡†æ¶è‚¯å®šä¸é™Œç”Ÿï¼Œå®ƒç›¸å½“äº JDBC è§„èŒƒï¼Œæä¾›äº†ä¸€å¥—æ‰“å°æ—¥å¿—çš„ç»Ÿä¸€æ¥å£è§„èŒƒã€‚ä¸è¿‡ï¼Œå®ƒåªå®šä¹‰äº†æ¥å£ï¼Œå¹¶æ²¡æœ‰æä¾›å…·ä½“çš„å®ç°ï¼Œéœ€è¦é…åˆå…¶ä»–æ—¥å¿—æ¡†æ¶ï¼ˆlog4jã€logbackâ€¦â€¦ï¼‰æ¥ä½¿ç”¨ã€‚</li><li>ä¸ä»…å¦‚æ­¤ï¼ŒSlf4j çš„å‡ºç°æ™šäº JULã€JCLã€log4j ç­‰æ—¥å¿—æ¡†æ¶ï¼Œæ‰€ä»¥ï¼Œè¿™äº›æ—¥å¿—æ¡†æ¶ä¹Ÿä¸å¯èƒ½ç‰ºç‰²æ‰ç‰ˆæœ¬å…¼å®¹æ€§ï¼Œå°†æ¥å£æ”¹é€ æˆç¬¦åˆ Slf4j æ¥å£è§„èŒƒã€‚Slf4j ä¹Ÿäº‹å…ˆè€ƒè™‘åˆ°äº†è¿™ä¸ªé—®é¢˜ï¼Œæ‰€ä»¥ï¼Œå®ƒä¸ä»…ä»…æä¾›äº†ç»Ÿä¸€çš„æ¥å£å®šä¹‰ï¼Œè¿˜æä¾›äº†é’ˆå¯¹ä¸åŒæ—¥å¿—æ¡†æ¶çš„é€‚é…å™¨ã€‚å¯¹ä¸åŒæ—¥å¿—æ¡†æ¶çš„æ¥å£è¿›è¡ŒäºŒæ¬¡å°è£…ï¼Œé€‚é…æˆç»Ÿä¸€çš„ Slf4j æ¥å£å®šä¹‰ã€‚å…·ä½“çš„ä»£ç ç¤ºä¾‹å¦‚ä¸‹æ‰€ç¤ºï¼š</li></ol><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-comment">// slf4jç»Ÿä¸€çš„æ¥å£å®šä¹‰</span><br><span class="hljs-keyword">package</span> org.slf4j;<br><span class="hljs-keyword">public</span>  <span class="hljs-keyword">interface</span> <span class="hljs-title class_">Logger</span> &#123;<br>  <span class="hljs-keyword">public</span>  <span class="hljs-type">boolean</span> <span class="hljs-title function_">isTraceEnabled</span><span class="hljs-params">()</span>;<br>  <span class="hljs-keyword">public</span>  <span class="hljs-keyword">void</span> <span class="hljs-title function_">trace</span><span class="hljs-params">(String msg)</span>;<br>  <span class="hljs-keyword">public</span>  <span class="hljs-keyword">void</span> <span class="hljs-title function_">trace</span><span class="hljs-params">(String format, Object arg)</span>;<br>  <span class="hljs-keyword">public</span>  <span class="hljs-keyword">void</span> <span class="hljs-title function_">trace</span><span class="hljs-params">(String format, Object arg1, Object arg2)</span>;<br>  <span class="hljs-keyword">public</span>  <span class="hljs-keyword">void</span> <span class="hljs-title function_">trace</span><span class="hljs-params">(String format, Object[] argArray)</span>;<br>  <span class="hljs-keyword">public</span>  <span class="hljs-keyword">void</span> <span class="hljs-title function_">trace</span><span class="hljs-params">(String msg, Throwable t)</span>;<br>  <span class="hljs-keyword">public</span>  <span class="hljs-type">boolean</span> <span class="hljs-title function_">isDebugEnabled</span><span class="hljs-params">()</span>;<br>  <span class="hljs-keyword">public</span>  <span class="hljs-keyword">void</span> <span class="hljs-title function_">debug</span><span class="hljs-params">(String msg)</span>;<br>  <span class="hljs-keyword">public</span>  <span class="hljs-keyword">void</span> <span class="hljs-title function_">debug</span><span class="hljs-params">(String format, Object arg)</span>;<br>  <span class="hljs-keyword">public</span>  <span class="hljs-keyword">void</span> <span class="hljs-title function_">debug</span><span class="hljs-params">(String format, Object arg1, Object arg2)</span>;<br>  <span class="hljs-keyword">public</span>  <span class="hljs-keyword">void</span> <span class="hljs-title function_">debug</span><span class="hljs-params">(String format, Object[] argArray)</span>;<br>  <span class="hljs-keyword">public</span>  <span class="hljs-keyword">void</span> <span class="hljs-title function_">debug</span><span class="hljs-params">(String msg, Throwable t)</span>;<br><br><span class="hljs-comment">//...çœç•¥infoã€warnã€errorç­‰ä¸€å †æ¥å£</span><br>&#125;<br><br><br><span class="hljs-comment">// log4jæ—¥å¿—æ¡†æ¶çš„é€‚é…å™¨</span><br><span class="hljs-comment">// Log4jLoggerAdapterå®ç°äº†LocationAwareLoggeræ¥å£ï¼Œ</span><br><span class="hljs-comment">// å…¶ä¸­LocationAwareLoggerç»§æ‰¿è‡ªLoggeræ¥å£ï¼Œ</span><br><span class="hljs-comment">// ä¹Ÿå°±ç›¸å½“äºLog4jLoggerAdapterå®ç°äº†Loggeræ¥å£ã€‚</span><br><span class="hljs-keyword">package</span> org.slf4j.impl;<br><span class="hljs-keyword">public</span> <span class="hljs-keyword">final</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Log4jLoggerAdapter</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_">MarkerIgnoringBase</span><br>        <span class="hljs-keyword">implements</span> <span class="hljs-title class_">LocationAwareLogger</span>, Serializable &#123;<br><br>  <span class="hljs-keyword">final</span> <span class="hljs-keyword">transient</span> org.apache.log4j.Logger logger; <span class="hljs-comment">// log4j</span><br><br>  <span class="hljs-keyword">public</span>  <span class="hljs-type">boolean</span> <span class="hljs-title function_">isDebugEnabled</span><span class="hljs-params">()</span> &#123;<br>    <span class="hljs-keyword">return</span> logger.isDebugEnabled();<br>  &#125;<br><br>  <span class="hljs-keyword">public</span>  <span class="hljs-keyword">void</span> <span class="hljs-title function_">debug</span><span class="hljs-params">(String msg)</span> &#123;<br>    logger.log(FQCN, Level.DEBUG, msg, <span class="hljs-literal">null</span>);<br>  &#125;<br><br>  <span class="hljs-keyword">public</span>  <span class="hljs-keyword">void</span> <span class="hljs-title function_">debug</span><span class="hljs-params">(String format, Object arg)</span> &#123;<br>    <span class="hljs-keyword">if</span> (logger.isDebugEnabled()) &#123;<br>      <span class="hljs-type">FormattingTuple</span> <span class="hljs-variable">ft</span> <span class="hljs-operator">=</span> MessageFormatter.format(format, arg);<br>      logger.log(FQCN, Level.DEBUG, ft.getMessage(), ft.getThrowable());<br>    &#125;<br>  &#125;<br><br>  <span class="hljs-keyword">public</span>  <span class="hljs-keyword">void</span> <span class="hljs-title function_">debug</span><span class="hljs-params">(String format, Object arg1, Object arg2)</span> &#123;<br>    <span class="hljs-keyword">if</span> (logger.isDebugEnabled()) &#123;<br>      <span class="hljs-type">FormattingTuple</span> <span class="hljs-variable">ft</span> <span class="hljs-operator">=</span> MessageFormatter.format(format, arg1, arg2);<br>      logger.log(FQCN, Level.DEBUG, ft.getMessage(), ft.getThrowable());<br>    &#125;<br>  &#125;<br><br>  <span class="hljs-keyword">public</span>  <span class="hljs-keyword">void</span> <span class="hljs-title function_">debug</span><span class="hljs-params">(String format, Object\[\] argArray)</span> &#123;<br>    <span class="hljs-keyword">if</span> (logger.isDebugEnabled()) &#123;<br>      <span class="hljs-type">FormattingTuple</span> <span class="hljs-variable">ft</span> <span class="hljs-operator">=</span> MessageFormatter.arrayFormat(format, argArray);<br>      logger.log(FQCN, Level.DEBUG, ft.getMessage(), ft.getThrowable());<br>    &#125;<br>  &#125;<br><br>  <span class="hljs-keyword">public</span>  <span class="hljs-keyword">void</span> <span class="hljs-title function_">debug</span><span class="hljs-params">(String msg, Throwable t)</span> &#123;<br>    logger.log(FQCN, Level.DEBUG, msg, t);<br>  &#125;<br><br><span class="hljs-comment">//...çœç•¥ä¸€å †æ¥å£çš„å®ç°...</span><br>&#125;<br></code></pre></td></tr></table></figure><p>æ‰€ä»¥ï¼Œåœ¨å¼€å‘ä¸šåŠ¡ç³»ç»Ÿæˆ–è€…å¼€å‘æ¡†æ¶ã€ç»„ä»¶çš„æ—¶å€™ï¼Œæˆ‘ä»¬ç»Ÿä¸€ä½¿ç”¨ Slf4j æä¾›çš„æ¥å£æ¥ç¼–å†™æ‰“å°æ—¥å¿—çš„ä»£ç ï¼Œå…·ä½“ä½¿ç”¨å“ªç§æ—¥å¿—æ¡†æ¶å®ç°ï¼ˆlog4jã€logbackâ€¦â€¦ï¼‰ï¼Œæ˜¯å¯ä»¥åŠ¨æ€åœ°æŒ‡å®šçš„ï¼ˆä½¿ç”¨ Java çš„ SPI æŠ€æœ¯ï¼‰ï¼Œåªéœ€è¦å°†ç›¸åº”çš„ SDK å¯¼å…¥åˆ°é¡¹ç›®ä¸­å³å¯ã€‚</p><h2 id="4ã€ä»£ç†ã€æ¡¥æ¥ã€è£…é¥°å™¨ã€é€‚é…å™¨-4-ç§è®¾è®¡æ¨¡å¼çš„åŒºåˆ«"><a href="#4ã€ä»£ç†ã€æ¡¥æ¥ã€è£…é¥°å™¨ã€é€‚é…å™¨-4-ç§è®¾è®¡æ¨¡å¼çš„åŒºåˆ«" class="headerlink" title="4ã€ä»£ç†ã€æ¡¥æ¥ã€è£…é¥°å™¨ã€é€‚é…å™¨ 4 ç§è®¾è®¡æ¨¡å¼çš„åŒºåˆ«"></a>4ã€ä»£ç†ã€æ¡¥æ¥ã€è£…é¥°å™¨ã€é€‚é…å™¨ 4 ç§è®¾è®¡æ¨¡å¼çš„åŒºåˆ«</h2><ol><li>ä»£ç†ã€æ¡¥æ¥ã€è£…é¥°å™¨ã€é€‚é…å™¨ï¼Œè¿™ 4 ç§æ¨¡å¼æ˜¯æ¯”è¾ƒå¸¸ç”¨çš„ç»“æ„å‹è®¾è®¡æ¨¡å¼ã€‚å®ƒä»¬çš„ä»£ç ç»“æ„éå¸¸ç›¸ä¼¼ã€‚ç¬¼ç»Ÿæ¥è¯´ï¼Œå®ƒä»¬éƒ½å¯ä»¥ç§°ä¸º Wrapper æ¨¡å¼ï¼Œä¹Ÿå°±æ˜¯é€šè¿‡ Wrapper ç±»äºŒæ¬¡å°è£…åŸå§‹ç±»ã€‚</li><li>å°½ç®¡ä»£ç ç»“æ„ç›¸ä¼¼ï¼Œä½†è¿™ 4 ç§è®¾è®¡æ¨¡å¼çš„ç”¨æ„å®Œå…¨ä¸åŒï¼Œä¹Ÿå°±æ˜¯è¯´è¦è§£å†³çš„é—®é¢˜ã€åº”ç”¨åœºæ™¯ä¸åŒï¼Œè¿™ä¹Ÿæ˜¯å®ƒä»¬çš„ä¸»è¦åŒºåˆ«ã€‚</li></ol><ul><li>ä»£ç†æ¨¡å¼ï¼šåœ¨ä¸æ”¹å˜åŸå§‹ç±»æ¥å£çš„æ¡ä»¶ä¸‹ï¼Œä¸ºåŸå§‹ç±»å®šä¹‰ä¸€ä¸ªä»£ç†ç±»ï¼Œä¸»è¦ç›®çš„æ˜¯æ§åˆ¶è®¿é—®ï¼Œè€ŒéåŠ å¼ºåŠŸèƒ½ï¼Œè¿™æ˜¯å®ƒè·Ÿè£…é¥°å™¨æ¨¡å¼æœ€å¤§çš„ä¸åŒã€‚</li><li>æ¡¥æ¥æ¨¡å¼ï¼šç›®çš„æ˜¯å°†æ¥å£éƒ¨åˆ†å’Œå®ç°éƒ¨åˆ†åˆ†ç¦»ï¼Œä»è€Œè®©å®ƒä»¬å¯ä»¥è¾ƒä¸ºå®¹æ˜“ã€ä¹Ÿç›¸å¯¹ç‹¬ç«‹åœ°åŠ ä»¥æ”¹å˜ã€‚</li><li>è£…é¥°è€…æ¨¡å¼ï¼šåœ¨ä¸æ”¹å˜åŸå§‹ç±»æ¥å£çš„æƒ…å†µä¸‹ï¼Œå¯¹åŸå§‹ç±»åŠŸèƒ½è¿›è¡Œå¢å¼ºï¼Œå¹¶ä¸”æ”¯æŒå¤šä¸ªè£…é¥°å™¨çš„åµŒå¥—ä½¿ç”¨ã€‚</li><li>é€‚é…å™¨æ¨¡å¼ï¼šæ˜¯ä¸€ç§äº‹åçš„è¡¥æ•‘ç­–ç•¥ã€‚é€‚é…å™¨æä¾›è·ŸåŸå§‹ç±»ä¸åŒçš„æ¥å£ï¼Œè€Œä»£ç†æ¨¡å¼ã€è£…é¥°å™¨æ¨¡å¼æä¾›çš„éƒ½æ˜¯è·ŸåŸå§‹ç±»ç›¸åŒçš„æ¥å£ã€‚</li></ul>]]></content>
    
    
    <categories>
      
      <category>è®¾è®¡æ¨¡å¼</category>
      
    </categories>
    
    
    <tags>
      
      <tag>è®¾è®¡æ¨¡å¼</tag>
      
      <tag>ç»“æ„å‹</tag>
      
      <tag>è£…é¥°å™¨</tag>
      
      <tag>é€‚é…å™¨</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>03-ç»“æ„å‹-ä»£ç†-æ¡¥æ¥</title>
    <link href="/2022/09/23/03-jie-gou-xing-dai-li-qiao-jie/"/>
    <url>/2022/09/23/03-jie-gou-xing-dai-li-qiao-jie/</url>
    
    <content type="html"><![CDATA[<h2 id="ä¸€ã€ä»£ç†æ¨¡å¼ã€å¸¸ç”¨ã€‘"><a href="#ä¸€ã€ä»£ç†æ¨¡å¼ã€å¸¸ç”¨ã€‘" class="headerlink" title="ä¸€ã€ä»£ç†æ¨¡å¼ã€å¸¸ç”¨ã€‘"></a>ä¸€ã€ä»£ç†æ¨¡å¼ã€å¸¸ç”¨ã€‘</h2><ol><li>åˆ›å»ºå‹æ¨¡å¼ä¸»è¦è§£å†³å¯¹è±¡çš„åˆ›å»ºé—®é¢˜ï¼Œå°è£…å¤æ‚çš„åˆ›å»ºè¿‡ç¨‹ï¼Œè§£è€¦å¯¹è±¡çš„åˆ›å»ºä»£ç å’Œä½¿ç”¨ä»£ç ã€‚</li><li>å…¶ä¸­ï¼Œå•ä¾‹æ¨¡å¼ç”¨æ¥åˆ›å»ºå…¨å±€å”¯ä¸€çš„å¯¹è±¡ã€‚å·¥å‚æ¨¡å¼ç”¨æ¥åˆ›å»ºä¸åŒä½†æ˜¯ç›¸å…³ç±»å‹çš„å¯¹è±¡ï¼ˆç»§æ‰¿åŒä¸€çˆ¶ç±»æˆ–è€…æ¥å£çš„ä¸€ç»„å­ç±»ï¼‰ï¼Œç”±ç»™å®šçš„å‚æ•°æ¥å†³å®šåˆ›å»ºå“ªç§ç±»å‹çš„å¯¹è±¡ã€‚å»ºé€ è€…æ¨¡å¼æ˜¯ç”¨æ¥åˆ›å»ºå¤æ‚å¯¹è±¡ï¼Œå¯ä»¥é€šè¿‡è®¾ç½®ä¸åŒçš„å¯é€‰å‚æ•°ï¼Œâ€œå®šåˆ¶åŒ–â€åœ°åˆ›å»ºä¸åŒçš„å¯¹è±¡ã€‚åŸå‹æ¨¡å¼é’ˆå¯¹åˆ›å»ºæˆæœ¬æ¯”è¾ƒå¤§çš„å¯¹è±¡ï¼Œåˆ©ç”¨å¯¹å·²æœ‰å¯¹è±¡è¿›è¡Œå¤åˆ¶çš„æ–¹å¼è¿›è¡Œåˆ›å»ºï¼Œä»¥è¾¾åˆ°èŠ‚çœåˆ›å»ºæ—¶é—´çš„ç›®çš„ã€‚</li><li>å¦å¤–ä¸€ç§ç±»å‹çš„è®¾è®¡æ¨¡å¼ï¼šç»“æ„å‹æ¨¡å¼ã€‚ç»“æ„å‹æ¨¡å¼ä¸»è¦æ€»ç»“äº†ä¸€äº›ç±»æˆ–å¯¹è±¡ç»„åˆåœ¨ä¸€èµ·çš„ç»å…¸ç»“æ„ï¼Œè¿™äº›ç»å…¸çš„ç»“æ„å¯ä»¥è§£å†³ç‰¹å®šåº”ç”¨åœºæ™¯çš„é—®é¢˜ã€‚ç»“æ„å‹æ¨¡å¼åŒ…æ‹¬ï¼šä»£ç†æ¨¡å¼ã€æ¡¥æ¥æ¨¡å¼ã€è£…é¥°å™¨æ¨¡å¼ã€é€‚é…å™¨æ¨¡å¼ã€é—¨é¢æ¨¡å¼ã€ç»„åˆæ¨¡å¼ã€äº«å…ƒæ¨¡å¼ã€‚ä»£ç†æ¨¡å¼æ˜¯åœ¨å®é™…å¼€å‘ä¸­ç»å¸¸è¢«ç”¨åˆ°çš„ä¸€ç§è®¾è®¡æ¨¡å¼ã€‚</li><li>ä»£ç†æ¨¡å¼æœ‰ä¸åŒçš„å½¢å¼, ä¸»è¦æœ‰ä¸‰ç§ <strong>é™æ€ä»£ç†</strong>ã€<strong>åŠ¨æ€ä»£ç†</strong> (JDK ä»£ç†ã€æ¥å£ä»£ç†)å’Œ <strong>Cglib</strong> <strong>ä»£ç†</strong> (å¯ä»¥åœ¨å†…å­˜ åŠ¨æ€çš„åˆ›å»ºå¯¹è±¡ï¼Œè€Œä¸éœ€è¦å®ç°æ¥å£ï¼Œ ä»–æ˜¯å±äºåŠ¨æ€ä»£ç†çš„èŒƒç•´) ã€‚</li></ol><h3 id="1ã€é™æ€ä»£ç†"><a href="#1ã€é™æ€ä»£ç†" class="headerlink" title="1ã€é™æ€ä»£ç†"></a>1ã€é™æ€ä»£ç†</h3><p>å®ä¾‹å…·ä½“è¦æ±‚</p><ol><li>å®šä¹‰ä¸€ä¸ªæ¥å£:ITeacherDao</li><li>ç›®æ ‡å¯¹è±¡ TeacherDAO å®ç°æ¥å£ ITeacherDAO</li><li>ä½¿ç”¨é™æ€ä»£ç†æ–¹å¼,å°±éœ€è¦åœ¨ä»£ç†å¯¹è±¡ TeacherDAOProxy ä¸­ä¹Ÿå®ç° ITeacherDAO</li><li>è°ƒç”¨çš„æ—¶å€™é€šè¿‡è°ƒç”¨ä»£ç†å¯¹è±¡çš„æ–¹æ³•æ¥è°ƒç”¨ç›®æ ‡å¯¹è±¡</li><li>ç‰¹åˆ«æé†’ï¼šé™æ€ä»£ç†ç±»ä¸è¢«ä»£ç†ç±»è¦å®ç°ç›¸åŒçš„æ¥å£,ç„¶åé€šè¿‡è°ƒç”¨ç›¸åŒçš„æ–¹æ³•æ¥è°ƒç”¨ç›®æ ‡å¯¹è±¡çš„æ–¹æ³•</li></ol><blockquote><p><strong>ITeacherDao</strong></p></blockquote><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-comment">//æ¥å£</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">interface</span> <span class="hljs-title class_">ITeacherDao</span> &#123;<br><br><span class="hljs-keyword">void</span> <span class="hljs-title function_">teach</span><span class="hljs-params">()</span>; <span class="hljs-comment">// æˆè¯¾çš„æ–¹æ³•</span><br>&#125;<br></code></pre></td></tr></table></figure><blockquote><p><strong>TeacherDao</strong> â€”&gt; è¢«ä»£ç†ç±»</p></blockquote><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">TeacherDao</span> <span class="hljs-keyword">implements</span> <span class="hljs-title class_">ITeacherDao</span> &#123;<br><br><span class="hljs-meta">@Override</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">teach</span><span class="hljs-params">()</span> &#123;<br><span class="hljs-comment">// TODO Auto-generated method stub</span><br>System.out.println(<span class="hljs-string">&quot; è€å¸ˆæˆè¯¾ä¸­  ã€‚ã€‚ã€‚ã€‚ã€‚&quot;</span>);<br>&#125;<br>&#125;<br></code></pre></td></tr></table></figure><blockquote><p><strong>TeacherDaoProxy</strong> â€”&gt; ä»£ç†ç±»</p></blockquote><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-comment">//ä»£ç†å¯¹è±¡,é™æ€ä»£ç†</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">TeacherDaoProxy</span> <span class="hljs-keyword">implements</span> <span class="hljs-title class_">ITeacherDao</span>&#123;<br><br><span class="hljs-keyword">private</span> ITeacherDao target; <span class="hljs-comment">// ç›®æ ‡å¯¹è±¡ï¼Œé€šè¿‡æ¥å£æ¥èšåˆ</span><br><br><span class="hljs-comment">//æ„é€ å™¨</span><br><span class="hljs-keyword">public</span> <span class="hljs-title function_">TeacherDaoProxy</span><span class="hljs-params">(ITeacherDao target)</span> &#123;<br><span class="hljs-built_in">this</span>.target = target;<br>&#125;<br><br><span class="hljs-meta">@Override</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">teach</span><span class="hljs-params">()</span> &#123;<br><span class="hljs-comment">// TODO Auto-generated method stub</span><br>System.out.println(<span class="hljs-string">&quot;å¼€å§‹ä»£ç†  å®ŒæˆæŸäº›æ“ä½œã€‚ã€‚ã€‚ã€‚ã€‚ &quot;</span>);<span class="hljs-comment">//æ–¹æ³•</span><br>target.teach();<br>System.out.println(<span class="hljs-string">&quot;æäº¤ã€‚ã€‚ã€‚ã€‚ã€‚&quot;</span>);<span class="hljs-comment">//æ–¹æ³•</span><br>&#125;<br><br>&#125;<br></code></pre></td></tr></table></figure><blockquote><p>Client</p></blockquote><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Client</span> &#123;<br><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span> &#123;<br><span class="hljs-comment">// TODO Auto-generated method stub</span><br><span class="hljs-comment">//åˆ›å»ºç›®æ ‡å¯¹è±¡(è¢«ä»£ç†å¯¹è±¡)</span><br><span class="hljs-type">TeacherDao</span> <span class="hljs-variable">teacherDao</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">TeacherDao</span>();<br><br><span class="hljs-comment">//åˆ›å»ºä»£ç†å¯¹è±¡, åŒæ—¶å°†è¢«ä»£ç†å¯¹è±¡ä¼ é€’ç»™ä»£ç†å¯¹è±¡</span><br><span class="hljs-type">TeacherDaoProxy</span> <span class="hljs-variable">teacherDaoProxy</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">TeacherDaoProxy</span>(teacherDao);<br><br><span class="hljs-comment">//é€šè¿‡ä»£ç†å¯¹è±¡ï¼Œè°ƒç”¨åˆ°è¢«ä»£ç†å¯¹è±¡çš„æ–¹æ³•</span><br><span class="hljs-comment">//å³ï¼šæ‰§è¡Œçš„æ˜¯ä»£ç†å¯¹è±¡çš„æ–¹æ³•ï¼Œä»£ç†å¯¹è±¡å†å»è°ƒç”¨ç›®æ ‡å¯¹è±¡çš„æ–¹æ³• </span><br>teacherDaoProxy.teach();<br>&#125;<br><br>&#125;<br></code></pre></td></tr></table></figure><h3 id="2ã€åŠ¨æ€ä»£ç†"><a href="#2ã€åŠ¨æ€ä»£ç†" class="headerlink" title="2ã€åŠ¨æ€ä»£ç†"></a>2ã€åŠ¨æ€ä»£ç†</h3><ol><li>ä»£ç†å¯¹è±¡,ä¸éœ€è¦å®ç°æ¥å£ï¼Œä½†æ˜¯ç›®æ ‡å¯¹è±¡è¦å®ç°æ¥å£ï¼Œå¦åˆ™ä¸èƒ½ç”¨åŠ¨æ€ä»£ç†</li><li>ä»£ç†å¯¹è±¡çš„ç”Ÿæˆï¼Œæ˜¯åˆ©ç”¨ JDK çš„ APIï¼ŒåŠ¨æ€çš„åœ¨å†…å­˜ä¸­æ„å»ºä»£ç†å¯¹è±¡</li><li>åŠ¨æ€ä»£ç†ä¹Ÿå«åšï¼š<strong>JDK ä»£ç†</strong>ã€<strong>æ¥å£ä»£ç†</strong></li><li>ä»£ç†ç±»æ‰€åœ¨åŒ…:java.lang.reflect.Proxy</li><li>JDK å®ç°ä»£ç†åªéœ€è¦ä½¿ç”¨ <strong>newProxyInstance</strong> æ–¹æ³•,ä½†æ˜¯è¯¥æ–¹æ³•éœ€è¦æ¥æ”¶ä¸‰ä¸ªå‚æ•°,å®Œæ•´çš„å†™æ³•æ˜¯:</li></ol><p>static Object newProxyInstance(ClassLoader loader, Class&lt;?&gt;[] interfaces,InvocationHandler h )</p><blockquote><p>ITeacherDao</p></blockquote><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-comment">//æ¥å£</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">interface</span> <span class="hljs-title class_">ITeacherDao</span> &#123;<br><br>   <span class="hljs-keyword">void</span> <span class="hljs-title function_">teach</span><span class="hljs-params">()</span>; <span class="hljs-comment">// æˆè¯¾æ–¹æ³•</span><br>   <span class="hljs-keyword">void</span> <span class="hljs-title function_">sayHello</span><span class="hljs-params">(String name)</span>;<br>&#125;<br></code></pre></td></tr></table></figure><blockquote><p>TeacherDao</p></blockquote><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">TeacherDao</span> <span class="hljs-keyword">implements</span> <span class="hljs-title class_">ITeacherDao</span> &#123;<br><br>   <span class="hljs-meta">@Override</span><br>   <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">teach</span><span class="hljs-params">()</span> &#123;<br>      <span class="hljs-comment">// TODO Auto-generated method stub</span><br>      System.out.println(<span class="hljs-string">&quot; è€å¸ˆæˆè¯¾ä¸­.... &quot;</span>);<br>   &#125;<br><br>   <span class="hljs-meta">@Override</span><br>   <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">sayHello</span><span class="hljs-params">(String name)</span> &#123;<br>      <span class="hljs-comment">// TODO Auto-generated method stub</span><br>      System.out.println(<span class="hljs-string">&quot;hello &quot;</span> + name);<br>   &#125;<br>   <br>&#125;<br></code></pre></td></tr></table></figure><blockquote><p>ProxyFactory</p></blockquote><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">import</span> java.lang.reflect.InvocationHandler;<br><span class="hljs-keyword">import</span> java.lang.reflect.Method;<br><span class="hljs-keyword">import</span> java.lang.reflect.Proxy;<br><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">ProxyFactory</span> &#123;<br><br>   <span class="hljs-comment">//ç»´æŠ¤ä¸€ä¸ªç›®æ ‡å¯¹è±¡ , Object</span><br>   <span class="hljs-keyword">private</span> Object target;<br><br>   <span class="hljs-comment">//æ„é€ å™¨ ï¼Œ å¯¹target è¿›è¡Œåˆå§‹åŒ–</span><br>   <span class="hljs-keyword">public</span> <span class="hljs-title function_">ProxyFactory</span><span class="hljs-params">(Object target)</span> &#123;<br>      <br>      <span class="hljs-built_in">this</span>.target = target;<br>   &#125; <br>   <br>   <span class="hljs-comment">//ç»™ç›®æ ‡å¯¹è±¡ ç”Ÿæˆä¸€ä¸ªä»£ç†å¯¹è±¡</span><br>   <span class="hljs-keyword">public</span> Object <span class="hljs-title function_">getProxyInstance</span><span class="hljs-params">()</span> &#123;<br>      <br>      <span class="hljs-comment">/* è¯´æ˜</span><br><span class="hljs-comment">         public static Object newProxyInstance(ClassLoader loader,</span><br><span class="hljs-comment">                                          Class&lt;?&gt;[] interfaces,</span><br><span class="hljs-comment">                                          InvocationHandler h)</span><br><span class="hljs-comment">                                          </span><br><span class="hljs-comment">            1. ClassLoader loader ï¼š æŒ‡å®šå½“å‰ç›®æ ‡å¯¹è±¡ä½¿ç”¨çš„ç±»åŠ è½½å™¨, è·å–åŠ è½½å™¨çš„æ–¹æ³•å›ºå®š</span><br><span class="hljs-comment">            2. Class&lt;?&gt;[] interfaces: ç›®æ ‡å¯¹è±¡å®ç°çš„æ¥å£ç±»å‹ï¼Œä½¿ç”¨æ³›å‹æ–¹æ³•ç¡®è®¤ç±»å‹</span><br><span class="hljs-comment">            3. InvocationHandler h : äº‹æƒ…å¤„ç†ï¼Œæ‰§è¡Œç›®æ ‡å¯¹è±¡çš„æ–¹æ³•æ—¶ï¼Œä¼šè§¦å‘äº‹æƒ…å¤„ç†å™¨æ–¹æ³•, </span><br><span class="hljs-comment">             ä¼šæŠŠå½“å‰æ‰§è¡Œçš„ç›®æ ‡å¯¹è±¡æ–¹æ³•ä½œä¸ºå‚æ•°ä¼ å…¥</span><br><span class="hljs-comment">       */</span><br>      <span class="hljs-keyword">return</span> Proxy.newProxyInstance(target.getClass().getClassLoader(), <br>            target.getClass().getInterfaces(), <br>            <span class="hljs-keyword">new</span> <span class="hljs-title class_">InvocationHandler</span>() &#123;<br>               <br>               <span class="hljs-meta">@Override</span><br>               <span class="hljs-keyword">public</span> Object <span class="hljs-title function_">invoke</span><span class="hljs-params">(Object proxy, Method method, Object[] args)</span> <span class="hljs-keyword">throws</span> Throwable &#123;<br>                  <span class="hljs-comment">// TODO Auto-generated method stub</span><br>                  System.out.println(<span class="hljs-string">&quot;JDKä»£ç†å¼€å§‹~~&quot;</span>);<br>                  <span class="hljs-comment">//åå°„æœºåˆ¶è°ƒç”¨ç›®æ ‡å¯¹è±¡çš„æ–¹æ³•</span><br>                  <span class="hljs-type">Object</span> <span class="hljs-variable">returnVal</span> <span class="hljs-operator">=</span> method.invoke(target, args);<br>                  System.out.println(<span class="hljs-string">&quot;JDKä»£ç†æäº¤&quot;</span>);<br>                  <span class="hljs-keyword">return</span> returnVal;<br>               &#125;<br>            &#125;); <br>   &#125;<br>&#125;<br></code></pre></td></tr></table></figure><blockquote><p>Client</p></blockquote><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Client</span> &#123;<br><br>   <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span> &#123;<br>      <span class="hljs-comment">// TODO Auto-generated method stub</span><br>      <span class="hljs-comment">//åˆ›å»ºç›®æ ‡å¯¹è±¡</span><br>      <span class="hljs-type">ITeacherDao</span> <span class="hljs-variable">target</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">TeacherDao</span>();<br>      <br>      <span class="hljs-comment">//ç»™ç›®æ ‡å¯¹è±¡ï¼Œåˆ›å»ºä»£ç†å¯¹è±¡, å¯ä»¥è½¬æˆ ITeacherDao</span><br>      <span class="hljs-type">ITeacherDao</span> <span class="hljs-variable">proxyInstance</span> <span class="hljs-operator">=</span> (ITeacherDao)<span class="hljs-keyword">new</span> <span class="hljs-title class_">ProxyFactory</span>(target).getProxyInstance();<br>   <br>      <span class="hljs-comment">// proxyInstance=class com.sun.proxy.$Proxy0 å†…å­˜ä¸­åŠ¨æ€ç”Ÿæˆäº†ä»£ç†å¯¹è±¡</span><br>      System.out.println(<span class="hljs-string">&quot;proxyInstance=&quot;</span> + proxyInstance.getClass());<br>      <br>      <span class="hljs-comment">//é€šè¿‡ä»£ç†å¯¹è±¡ï¼Œè°ƒç”¨ç›®æ ‡å¯¹è±¡çš„æ–¹æ³•</span><br>      <span class="hljs-comment">//proxyInstance.teach();</span><br>      <br>      proxyInstance.sayHello(<span class="hljs-string">&quot; tom &quot;</span>);<br>   &#125;<br><br>&#125;<br></code></pre></td></tr></table></figure><h3 id="3ã€Cglibä»£ç†"><a href="#3ã€Cglibä»£ç†" class="headerlink" title="3ã€Cglibä»£ç†"></a>3ã€Cglibä»£ç†</h3><ol><li><p>é™æ€ä»£ç†å’Œ JDK ä»£ç†æ¨¡å¼éƒ½è¦æ±‚ç›®æ ‡å¯¹è±¡æ˜¯å®ç°ä¸€ä¸ªæ¥å£,ä½†æ˜¯æœ‰æ—¶å€™ç›®æ ‡å¯¹è±¡åªæ˜¯ä¸€ä¸ªå•ç‹¬çš„å¯¹è±¡,å¹¶æ²¡æœ‰å®ç°ä»»ä½•çš„æ¥å£,è¿™ä¸ªæ—¶å€™å¯ä½¿ç”¨ç›®æ ‡å¯¹è±¡å­ç±»æ¥å®ç°ä»£ç†-è¿™å°±æ˜¯Cglibä»£ç†</p></li><li><p>Cglibä»£ç†ä¹Ÿå«ä½œ<strong>å­ç±»ä»£ç†</strong>ï¼Œå®ƒæ˜¯åœ¨å†…å­˜ä¸­æ„å»ºä¸€ä¸ªå­ç±»å¯¹è±¡ä»è€Œå®ç°å¯¹ç›®æ ‡å¯¹è±¡åŠŸèƒ½æ‰©å±•, æœ‰äº›ä¹¦ä¹Ÿå°†Cglibä»£ç†å½’å±åˆ°åŠ¨æ€ä»£ç†ã€‚</p></li><li><p>Cglib æ˜¯ä¸€ä¸ªå¼ºå¤§çš„é«˜æ€§èƒ½çš„ä»£ç ç”ŸæˆåŒ…,å®ƒå¯ä»¥åœ¨è¿è¡ŒæœŸæ‰©å±• java ç±»ä¸å®ç° java æ¥å£.å®ƒå¹¿æ³›çš„è¢«è®¸å¤š AOP çš„ æ¡†æ¶ä½¿ç”¨,ä¾‹å¦‚ Spring AOPï¼Œå®ç°æ–¹æ³•æ‹¦æˆª</p></li><li><p>åœ¨ AOP ç¼–ç¨‹ä¸­å¦‚ä½•é€‰æ‹©ä»£ç†æ¨¡å¼ï¼š</p><ul><li>ç›®æ ‡å¯¹è±¡éœ€è¦å®ç°æ¥å£ï¼Œç”¨ JDK ä»£ç†</li><li>ç›®æ ‡å¯¹è±¡ä¸éœ€è¦å®ç°æ¥å£ï¼Œç”¨ Cglib ä»£ç†</li></ul></li><li><p>Cglib åŒ…çš„åº•å±‚æ˜¯é€šè¿‡ä½¿ç”¨å­—èŠ‚ç å¤„ç†æ¡†æ¶ ASM æ¥è½¬æ¢å­—èŠ‚ç å¹¶ç”Ÿæˆæ–°çš„ç±»</p></li><li><p>éœ€è¦å¼•å…¥ cglib çš„ jar æ–‡ä»¶ï¼Œåœ¨å†…å­˜ä¸­åŠ¨æ€æ„å»ºå­ç±»ï¼Œæ³¨æ„ä»£ç†çš„ç±»ä¸èƒ½ä¸º finalï¼Œå¦åˆ™æŠ¥é”™</p><p><code>java.lang.IllegalArgumentException</code>ï¼Œç›®æ ‡å¯¹è±¡çš„æ–¹æ³•å¦‚æœä¸º final/static,é‚£ä¹ˆå°±ä¸ä¼šè¢«æ‹¦æˆª,å³ä¸ä¼šæ‰§è¡Œç›®æ ‡å¯¹è±¡é¢å¤–çš„ä¸šåŠ¡æ–¹æ³•ã€‚</p></li></ol><blockquote><p>TeacherDao</p></blockquote><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">TeacherDao</span> &#123;<br><br>   <span class="hljs-keyword">public</span> String <span class="hljs-title function_">teach</span><span class="hljs-params">()</span> &#123;<br>      System.out.println(<span class="hljs-string">&quot; è€å¸ˆæˆè¯¾ä¸­  ï¼Œ æˆ‘æ˜¯cglibä»£ç†ï¼Œä¸éœ€è¦å®ç°æ¥å£ &quot;</span>);<br>      <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;hello&quot;</span>;<br>   &#125;<br>&#125;<br></code></pre></td></tr></table></figure><blockquote><p>ProxyFactory</p></blockquote><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">import</span> java.lang.reflect.Method;<br><span class="hljs-keyword">import</span> net.sf.cglib.proxy.Enhancer;<br><span class="hljs-keyword">import</span> net.sf.cglib.proxy.MethodInterceptor;<br><span class="hljs-keyword">import</span> net.sf.cglib.proxy.MethodProxy;<br><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">ProxyFactory</span> <span class="hljs-keyword">implements</span> <span class="hljs-title class_">MethodInterceptor</span> &#123;<br><br>   <span class="hljs-comment">//ç»´æŠ¤ä¸€ä¸ªç›®æ ‡å¯¹è±¡</span><br>   <span class="hljs-keyword">private</span> Object target;<br>   <br>   <span class="hljs-comment">//æ„é€ å™¨ï¼Œä¼ å…¥ä¸€ä¸ªè¢«ä»£ç†çš„å¯¹è±¡</span><br>   <span class="hljs-keyword">public</span> <span class="hljs-title function_">ProxyFactory</span><span class="hljs-params">(Object target)</span> &#123;<br>      <span class="hljs-built_in">this</span>.target = target;<br>   &#125;<br><br>   <span class="hljs-comment">//è¿”å›ä¸€ä¸ªä»£ç†å¯¹è±¡:  æ˜¯ target å¯¹è±¡çš„ä»£ç†å¯¹è±¡</span><br>   <span class="hljs-keyword">public</span> Object <span class="hljs-title function_">getProxyInstance</span><span class="hljs-params">()</span> &#123;<br>      <span class="hljs-comment">//1. åˆ›å»ºä¸€ä¸ªå·¥å…·ç±»</span><br>      <span class="hljs-type">Enhancer</span> <span class="hljs-variable">enhancer</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Enhancer</span>();<br>      <span class="hljs-comment">//2. è®¾ç½®çˆ¶ç±»</span><br>      enhancer.setSuperclass(target.getClass());<br>      <span class="hljs-comment">//3. è®¾ç½®å›è°ƒå‡½æ•°</span><br>      enhancer.setCallback(<span class="hljs-built_in">this</span>);<br>      <span class="hljs-comment">//4. åˆ›å»ºå­ç±»å¯¹è±¡ï¼Œå³ä»£ç†å¯¹è±¡</span><br>      <span class="hljs-keyword">return</span> enhancer.create();<br>      <br>   &#125;<br>   <br><br>   <span class="hljs-comment">//é‡å†™  intercept æ–¹æ³•ï¼Œä¼šè°ƒç”¨ç›®æ ‡å¯¹è±¡çš„æ–¹æ³•</span><br>   <span class="hljs-meta">@Override</span><br>   <span class="hljs-keyword">public</span> Object <span class="hljs-title function_">intercept</span><span class="hljs-params">(Object arg0, Method method, Object[] args, MethodProxy arg3)</span> <span class="hljs-keyword">throws</span> Throwable &#123;<br>      <span class="hljs-comment">// TODO Auto-generated method stub</span><br>      System.out.println(<span class="hljs-string">&quot;Cglibä»£ç†æ¨¡å¼ ~~ å¼€å§‹&quot;</span>);<br>      <span class="hljs-type">Object</span> <span class="hljs-variable">returnVal</span> <span class="hljs-operator">=</span> method.invoke(target, args);<br>      System.out.println(<span class="hljs-string">&quot;Cglibä»£ç†æ¨¡å¼ ~~ æäº¤&quot;</span>);<br>      <span class="hljs-keyword">return</span> returnVal;<br>   &#125;<br><br>&#125;<br></code></pre></td></tr></table></figure><blockquote><p>Client</p></blockquote><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Client</span> &#123;<br><br>   <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span> &#123;<br>      <span class="hljs-comment">// TODO Auto-generated method stub</span><br>      <span class="hljs-comment">//åˆ›å»ºç›®æ ‡å¯¹è±¡</span><br>      <span class="hljs-type">TeacherDao</span> <span class="hljs-variable">target</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">TeacherDao</span>();<br>      <span class="hljs-comment">//è·å–åˆ°ä»£ç†å¯¹è±¡ï¼Œå¹¶ä¸”å°†ç›®æ ‡å¯¹è±¡ä¼ é€’ç»™ä»£ç†å¯¹è±¡</span><br>      <span class="hljs-type">TeacherDao</span> <span class="hljs-variable">proxyInstance</span> <span class="hljs-operator">=</span> (TeacherDao)<span class="hljs-keyword">new</span> <span class="hljs-title class_">ProxyFactory</span>(target).getProxyInstance();<br><br>      <span class="hljs-comment">//æ‰§è¡Œä»£ç†å¯¹è±¡çš„æ–¹æ³•ï¼Œè§¦å‘intecept æ–¹æ³•ï¼Œä»è€Œå®ç° å¯¹ç›®æ ‡å¯¹è±¡çš„è°ƒç”¨</span><br>      <span class="hljs-type">String</span> <span class="hljs-variable">res</span> <span class="hljs-operator">=</span> proxyInstance.teach();<br>      System.out.println(<span class="hljs-string">&quot;res=&quot;</span> + res);<br>   &#125;<br><br>&#125;<br></code></pre></td></tr></table></figure><h3 id="4ã€ä»£ç†æ¨¡å¼çš„åŸç†è§£æ"><a href="#4ã€ä»£ç†æ¨¡å¼çš„åŸç†è§£æ" class="headerlink" title="4ã€ä»£ç†æ¨¡å¼çš„åŸç†è§£æ"></a>4ã€ä»£ç†æ¨¡å¼çš„åŸç†è§£æ</h3><ol><li>ä»£ç†æ¨¡å¼ï¼ˆProxy Design Patternï¼‰çš„åŸç†å’Œä»£ç å®ç°éƒ½ä¸éš¾æŒæ¡ã€‚å®ƒåœ¨ä¸æ”¹å˜åŸå§‹ç±»ï¼ˆæˆ–å«è¢«ä»£ç†ç±»ï¼‰ä»£ç çš„æƒ…å†µä¸‹ï¼Œé€šè¿‡å¼•å…¥ä»£ç†ç±»æ¥ç»™åŸå§‹ç±»é™„åŠ åŠŸèƒ½ã€<strong>è£…é¥°å™¨æ˜¯å¢å¼ºåŠŸèƒ½ï¼Œä»£ç†æ˜¯é™„åŠ æ–°çš„åŠŸèƒ½</strong>ã€‘ã€‚æˆ‘ä»¬é€šè¿‡ä¸€ä¸ªç®€å•çš„ä¾‹å­æ¥è§£é‡Šä¸€ä¸‹è¿™æ®µè¯ã€‚</li><li>æˆ‘ä»¬å¼€å‘äº†ä¸€ä¸ª MetricsCollector ç±»ï¼Œç”¨æ¥æ”¶é›†æ¥å£è¯·æ±‚çš„åŸå§‹æ•°æ®ï¼Œæ¯”å¦‚è®¿é—®æ—¶é—´ã€å¤„ç†æ—¶é•¿ç­‰ã€‚åœ¨ä¸šåŠ¡ç³»ç»Ÿä¸­ï¼Œæˆ‘ä»¬é‡‡ç”¨å¦‚ä¸‹æ–¹å¼æ¥ä½¿ç”¨è¿™ä¸ª MetricsCollector ç±»ï¼š</li></ol><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">UserController</span> &#123;<br>  <span class="hljs-comment">//...çœç•¥å…¶ä»–å±æ€§å’Œæ–¹æ³•...</span><br>  <span class="hljs-keyword">private</span> MetricsCollector metricsCollector; <span class="hljs-comment">// ä¾èµ–æ³¨å…¥</span><br><br>  <span class="hljs-keyword">public</span> UserVo <span class="hljs-title function_">login</span><span class="hljs-params">(String telephone, String password)</span> &#123;<br>    <span class="hljs-type">long</span> <span class="hljs-variable">startTimestamp</span> <span class="hljs-operator">=</span> System.currentTimeMillis();<br><br>    <span class="hljs-comment">// ... çœç•¥loginé€»è¾‘...</span><br><br>    <span class="hljs-type">long</span> <span class="hljs-variable">endTimeStamp</span> <span class="hljs-operator">=</span> System.currentTimeMillis();<br>    <span class="hljs-type">long</span> <span class="hljs-variable">responseTime</span> <span class="hljs-operator">=</span> endTimeStamp - startTimestamp;<br>    <span class="hljs-type">RequestInfo</span> <span class="hljs-variable">requestInfo</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">RequestInfo</span>(<span class="hljs-string">&quot;login&quot;</span>, responseTime, startTimestamp);<br>    metricsCollector.recordRequest(requestInfo);<br><br>    <span class="hljs-comment">//...è¿”å›UserVoæ•°æ®...</span><br>  &#125;<br><br>  <span class="hljs-keyword">public</span> UserVo <span class="hljs-title function_">register</span><span class="hljs-params">(String telephone, String password)</span> &#123;<br>    <span class="hljs-type">long</span> <span class="hljs-variable">startTimestamp</span> <span class="hljs-operator">=</span> System.currentTimeMillis();<br><br>    <span class="hljs-comment">// ... çœç•¥registeré€»è¾‘...</span><br><br>    <span class="hljs-type">long</span> <span class="hljs-variable">endTimeStamp</span> <span class="hljs-operator">=</span> System.currentTimeMillis();<br>    <span class="hljs-type">long</span> <span class="hljs-variable">responseTime</span> <span class="hljs-operator">=</span> endTimeStamp - startTimestamp;<br>    <span class="hljs-type">RequestInfo</span> <span class="hljs-variable">requestInfo</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">RequestInfo</span>(<span class="hljs-string">&quot;register&quot;</span>, responseTime, startTimestamp);<br>    metricsCollector.recordRequest(requestInfo);<br><br>    <span class="hljs-comment">//...è¿”å›UserVoæ•°æ®...</span><br>  &#125;<br>&#125;<br></code></pre></td></tr></table></figure><ol><li>å¾ˆæ˜æ˜¾ï¼Œä¸Šé¢çš„å†™æ³•æœ‰ä¸¤ä¸ªé—®é¢˜ã€‚ç¬¬ä¸€ï¼Œæ€§èƒ½è®¡æ•°å™¨æ¡†æ¶ä»£ç ä¾µå…¥åˆ°ä¸šåŠ¡ä»£ç ä¸­ï¼Œè·Ÿä¸šåŠ¡ä»£ç é«˜åº¦è€¦åˆã€‚å¦‚æœæœªæ¥éœ€è¦æ›¿æ¢è¿™ä¸ªæ¡†æ¶ï¼Œé‚£æ›¿æ¢çš„æˆæœ¬ä¼šæ¯”è¾ƒå¤§ã€‚ç¬¬äºŒï¼Œæ”¶é›†æ¥å£è¯·æ±‚çš„ä»£ç è·Ÿä¸šåŠ¡ä»£ç æ— å…³ï¼Œæœ¬å°±ä¸åº”è¯¥æ”¾åˆ°ä¸€ä¸ªç±»ä¸­ã€‚ä¸šåŠ¡ç±»æœ€å¥½èŒè´£æ›´åŠ å•ä¸€ï¼Œåªèšç„¦ä¸šåŠ¡å¤„ç†ã€‚</li><li>ä¸ºäº†å°†æ¡†æ¶ä»£ç å’Œä¸šåŠ¡ä»£ç è§£è€¦ï¼Œä»£ç†æ¨¡å¼å°±æ´¾ä¸Šç”¨åœºäº†ã€‚ä»£ç†ç±» UserControllerProxy å’ŒåŸå§‹ç±» UserController å®ç°ç›¸åŒçš„æ¥å£ IUserControllerã€‚UserController ç±»åªè´Ÿè´£ä¸šåŠ¡åŠŸèƒ½ã€‚ä»£ç†ç±» UserControllerProxy è´Ÿè´£åœ¨ä¸šåŠ¡ä»£ç æ‰§è¡Œå‰åé™„åŠ å…¶ä»–é€»è¾‘ä»£ç ï¼Œå¹¶é€šè¿‡å§”æ‰˜çš„æ–¹å¼è°ƒç”¨åŸå§‹ç±»æ¥æ‰§è¡Œä¸šåŠ¡ä»£ç ã€‚å…·ä½“çš„ä»£ç å®ç°å¦‚ä¸‹æ‰€ç¤ºï¼š</li></ol><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">interface</span> <span class="hljs-title class_">IUserController</span> &#123;<br>  UserVo <span class="hljs-title function_">login</span><span class="hljs-params">(String telephone, String password)</span>;<br>  UserVo <span class="hljs-title function_">register</span><span class="hljs-params">(String telephone, String password)</span>;<br>&#125;<br><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">UserController</span> <span class="hljs-keyword">implements</span> <span class="hljs-title class_">IUserController</span> &#123;<br>  <span class="hljs-comment">//...çœç•¥å…¶ä»–å±æ€§å’Œæ–¹æ³•...</span><br><br>  <span class="hljs-meta">@Override</span><br>  <span class="hljs-keyword">public</span> UserVo <span class="hljs-title function_">login</span><span class="hljs-params">(String telephone, String password)</span> &#123;<br>    <span class="hljs-comment">//...çœç•¥loginé€»è¾‘...</span><br>    <span class="hljs-comment">//...è¿”å›UserVoæ•°æ®...</span><br>  &#125;<br><br>  <span class="hljs-meta">@Override</span><br>  <span class="hljs-keyword">public</span> UserVo <span class="hljs-title function_">register</span><span class="hljs-params">(String telephone, String password)</span> &#123;<br>    <span class="hljs-comment">//...çœç•¥registeré€»è¾‘...</span><br>    <span class="hljs-comment">//...è¿”å›UserVoæ•°æ®...</span><br>  &#125;<br>&#125;<br><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">UserControllerProxy</span> <span class="hljs-keyword">implements</span> <span class="hljs-title class_">IUserController</span> &#123;<br>  <span class="hljs-keyword">private</span> MetricsCollector metricsCollector;<br>  <span class="hljs-keyword">private</span> UserController userController;<br><br>  <span class="hljs-keyword">public</span> <span class="hljs-title function_">UserControllerProxy</span><span class="hljs-params">(UserController userController)</span> &#123;<br>    <span class="hljs-built_in">this</span>.userController = userController;<br>    <span class="hljs-built_in">this</span>.metricsCollector = <span class="hljs-keyword">new</span> <span class="hljs-title class_">MetricsCollector</span>();<br>  &#125;<br><br>  <span class="hljs-meta">@Override</span><br>  <span class="hljs-keyword">public</span> UserVo <span class="hljs-title function_">login</span><span class="hljs-params">(String telephone, String password)</span> &#123;<br>    <span class="hljs-type">long</span> <span class="hljs-variable">startTimestamp</span> <span class="hljs-operator">=</span> System.currentTimeMillis();<br><br>    <span class="hljs-comment">// å§”æ‰˜</span><br>    <span class="hljs-type">UserVo</span> <span class="hljs-variable">userVo</span> <span class="hljs-operator">=</span> userController.login(telephone, password);<br><br>    <span class="hljs-type">long</span> <span class="hljs-variable">endTimeStamp</span> <span class="hljs-operator">=</span> System.currentTimeMillis();<br>    <span class="hljs-type">long</span> <span class="hljs-variable">responseTime</span> <span class="hljs-operator">=</span> endTimeStamp - startTimestamp;<br>    <span class="hljs-type">RequestInfo</span> <span class="hljs-variable">requestInfo</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">RequestInfo</span>(<span class="hljs-string">&quot;login&quot;</span>, responseTime, startTimestamp);<br>    metricsCollector.recordRequest(requestInfo);<br><br>    <span class="hljs-keyword">return</span> userVo;<br>  &#125;<br><br>  <span class="hljs-meta">@Override</span><br>  <span class="hljs-keyword">public</span> UserVo <span class="hljs-title function_">register</span><span class="hljs-params">(String telephone, String password)</span> &#123;<br>    <span class="hljs-type">long</span> <span class="hljs-variable">startTimestamp</span> <span class="hljs-operator">=</span> System.currentTimeMillis();<br><br>    <span class="hljs-type">UserVo</span> <span class="hljs-variable">userVo</span> <span class="hljs-operator">=</span> userController.register(telephone, password);<br><br>    <span class="hljs-type">long</span> <span class="hljs-variable">endTimeStamp</span> <span class="hljs-operator">=</span> System.currentTimeMillis();<br>    <span class="hljs-type">long</span> <span class="hljs-variable">responseTime</span> <span class="hljs-operator">=</span> endTimeStamp - startTimestamp;<br>    <span class="hljs-type">RequestInfo</span> <span class="hljs-variable">requestInfo</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">RequestInfo</span>(<span class="hljs-string">&quot;register&quot;</span>, responseTime, startTimestamp);<br>    metricsCollector.recordRequest(requestInfo);<br><br>    <span class="hljs-keyword">return</span> userVo;<br>  &#125;<br>&#125;<br><br><span class="hljs-comment">//UserControllerProxyä½¿ç”¨ä¸¾ä¾‹</span><br><span class="hljs-comment">//å› ä¸ºåŸå§‹ç±»å’Œä»£ç†ç±»å®ç°ç›¸åŒçš„æ¥å£ï¼Œæ˜¯åŸºäºæ¥å£è€Œéå®ç°ç¼–ç¨‹</span><br><span class="hljs-comment">//å°†UserControllerç±»å¯¹è±¡æ›¿æ¢ä¸ºUserControllerProxyç±»å¯¹è±¡ï¼Œä¸éœ€è¦æ”¹åŠ¨å¤ªå¤šä»£ç </span><br><span class="hljs-type">IUserController</span> <span class="hljs-variable">userController</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">UserControllerProxy</span>(<span class="hljs-keyword">new</span> <span class="hljs-title class_">UserController</span>());<br></code></pre></td></tr></table></figure><ol><li>å‚ç…§åŸºäº==æ¥å£==è€Œéå®ç°ç¼–ç¨‹çš„è®¾è®¡æ€æƒ³ï¼Œå°†åŸå§‹ç±»å¯¹è±¡æ›¿æ¢ä¸ºä»£ç†ç±»å¯¹è±¡çš„æ—¶å€™ï¼Œä¸ºäº†è®©ä»£ç æ”¹åŠ¨å°½é‡å°‘ï¼Œåœ¨åˆšåˆšçš„ä»£ç†æ¨¡å¼çš„ä»£ç å®ç°ä¸­ï¼Œä»£ç†ç±»å’ŒåŸå§‹ç±»éœ€è¦å®ç°ç›¸åŒçš„æ¥å£ã€‚ä½†æ˜¯ï¼Œå¦‚æœåŸå§‹ç±»å¹¶æ²¡æœ‰å®šä¹‰æ¥å£ï¼Œå¹¶ä¸”åŸå§‹ç±»ä»£ç å¹¶ä¸æ˜¯æˆ‘ä»¬å¼€å‘ç»´æŠ¤çš„ï¼ˆæ¯”å¦‚å®ƒæ¥è‡ªä¸€ä¸ªç¬¬ä¸‰æ–¹çš„ç±»åº“ï¼‰ï¼Œæˆ‘ä»¬ä¹Ÿæ²¡åŠæ³•ç›´æ¥ä¿®æ”¹åŸå§‹ç±»ï¼Œç»™å®ƒé‡æ–°å®šä¹‰ä¸€ä¸ªæ¥å£ã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬è¯¥å¦‚ä½•å®ç°ä»£ç†æ¨¡å¼å‘¢ï¼Ÿ</li><li><code>å¯¹äºè¿™ç§å¤–éƒ¨ç±»çš„æ‰©å±•ï¼Œæˆ‘ä»¬ä¸€èˆ¬éƒ½æ˜¯é‡‡ç”¨ç»§æ‰¿çš„æ–¹å¼</code>ã€‚è¿™é‡Œä¹Ÿä¸ä¾‹å¤–ã€‚æˆ‘ä»¬è®©ä»£ç†ç±»ç»§æ‰¿åŸå§‹ç±»ï¼Œç„¶åæ‰©å±•é™„åŠ åŠŸèƒ½ã€‚åŸç†å¾ˆç®€å•ï¼Œç›´æ¥çœ‹ä»£ç ã€‚å…·ä½“ä»£ç å¦‚ä¸‹æ‰€ç¤ºï¼š</li></ol><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">UserControllerProxy</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_">UserController</span> &#123;<br>  <span class="hljs-keyword">private</span> MetricsCollector metricsCollector;<br><br>  <span class="hljs-keyword">public</span> <span class="hljs-title function_">UserControllerProxy</span><span class="hljs-params">()</span> &#123;<br>    <span class="hljs-built_in">this</span>.metricsCollector = <span class="hljs-keyword">new</span> <span class="hljs-title class_">MetricsCollector</span>();<br>  &#125;<br><br>  <span class="hljs-keyword">public</span> UserVo <span class="hljs-title function_">login</span><span class="hljs-params">(String telephone, String password)</span> &#123;<br>    <span class="hljs-type">long</span> <span class="hljs-variable">startTimestamp</span> <span class="hljs-operator">=</span> System.currentTimeMillis();<br><br>    <span class="hljs-type">UserVo</span> <span class="hljs-variable">userVo</span> <span class="hljs-operator">=</span> <span class="hljs-built_in">super</span>.login(telephone, password);<br><br>    <span class="hljs-type">long</span> <span class="hljs-variable">endTimeStamp</span> <span class="hljs-operator">=</span> System.currentTimeMillis();<br>    <span class="hljs-type">long</span> <span class="hljs-variable">responseTime</span> <span class="hljs-operator">=</span> endTimeStamp - startTimestamp;<br>    <span class="hljs-type">RequestInfo</span> <span class="hljs-variable">requestInfo</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">RequestInfo</span>(<span class="hljs-string">&quot;login&quot;</span>, responseTime, startTimestamp);<br>    metricsCollector.recordRequest(requestInfo);<br><br>    <span class="hljs-keyword">return</span> userVo;<br>  &#125;<br><br>  <span class="hljs-keyword">public</span> UserVo <span class="hljs-title function_">register</span><span class="hljs-params">(String telephone, String password)</span> &#123;<br>    <span class="hljs-type">long</span> <span class="hljs-variable">startTimestamp</span> <span class="hljs-operator">=</span> System.currentTimeMillis();<br><br>    <span class="hljs-type">UserVo</span> <span class="hljs-variable">userVo</span> <span class="hljs-operator">=</span> <span class="hljs-built_in">super</span>.register(telephone, password);<br><br>    <span class="hljs-type">long</span> <span class="hljs-variable">endTimeStamp</span> <span class="hljs-operator">=</span> System.currentTimeMillis();<br>    <span class="hljs-type">long</span> <span class="hljs-variable">responseTime</span> <span class="hljs-operator">=</span> endTimeStamp - startTimestamp;<br>    <span class="hljs-type">RequestInfo</span> <span class="hljs-variable">requestInfo</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">RequestInfo</span>(<span class="hljs-string">&quot;register&quot;</span>, responseTime, startTimestamp);<br>    metricsCollector.recordRequest(requestInfo);<br><br>    <span class="hljs-keyword">return</span> userVo;<br>  &#125;<br>&#125;<br><span class="hljs-comment">//UserControllerProxyä½¿ç”¨ä¸¾ä¾‹</span><br><span class="hljs-type">UserController</span> <span class="hljs-variable">userController</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">UserControllerProxy</span>();<br></code></pre></td></tr></table></figure><h3 id="5ã€åŠ¨æ€ä»£ç†çš„åŸç†è§£æ"><a href="#5ã€åŠ¨æ€ä»£ç†çš„åŸç†è§£æ" class="headerlink" title="5ã€åŠ¨æ€ä»£ç†çš„åŸç†è§£æ"></a>5ã€åŠ¨æ€ä»£ç†çš„åŸç†è§£æ</h3><ol><li>ä¸è¿‡ï¼Œåˆšåˆšçš„ä»£ç å®ç°è¿˜æ˜¯æœ‰ç‚¹é—®é¢˜ã€‚ä¸€æ–¹é¢ï¼Œæˆ‘ä»¬éœ€è¦åœ¨ä»£ç†ç±»ä¸­ï¼Œå°†åŸå§‹ç±»ä¸­çš„æ‰€æœ‰çš„æ–¹æ³•ï¼Œéƒ½é‡æ–°å®ç°ä¸€éï¼Œå¹¶ä¸”ä¸ºæ¯ä¸ªæ–¹æ³•éƒ½é™„åŠ ç›¸ä¼¼çš„ä»£ç é€»è¾‘ã€‚å¦ä¸€æ–¹é¢ï¼Œå¦‚æœè¦æ·»åŠ çš„é™„åŠ åŠŸèƒ½çš„ç±»æœ‰ä¸æ­¢ä¸€ä¸ªï¼Œæˆ‘ä»¬éœ€è¦é’ˆå¯¹æ¯ä¸ªç±»éƒ½åˆ›å»ºä¸€ä¸ªä»£ç†ç±»ã€‚</li><li>å¦‚æœæœ‰ 50 ä¸ªè¦æ·»åŠ é™„åŠ åŠŸèƒ½çš„åŸå§‹ç±»ï¼Œé‚£æˆ‘ä»¬å°±è¦åˆ›å»º 50 ä¸ªå¯¹åº”çš„ä»£ç†ç±»ã€‚è¿™ä¼šå¯¼è‡´é¡¹ç›®ä¸­ç±»çš„ä¸ªæ•°æˆå€å¢åŠ ï¼Œå¢åŠ äº†ä»£ç ç»´æŠ¤æˆæœ¬ã€‚å¹¶ä¸”ï¼Œæ¯ä¸ªä»£ç†ç±»ä¸­çš„ä»£ç éƒ½æœ‰ç‚¹åƒæ¨¡æ¿å¼çš„â€œé‡å¤â€ä»£ç ï¼Œä¹Ÿå¢åŠ äº†ä¸å¿…è¦çš„å¼€å‘æˆæœ¬ã€‚é‚£è¿™ä¸ªé—®é¢˜æ€ä¹ˆè§£å†³å‘¢ï¼Ÿ</li><li>æˆ‘ä»¬å¯ä»¥ä½¿ç”¨åŠ¨æ€ä»£ç†æ¥è§£å†³è¿™ä¸ªé—®é¢˜ã€‚æ‰€è°“åŠ¨æ€ä»£ç†ï¼ˆDynamic Proxyï¼‰ï¼Œå°±æ˜¯æˆ‘ä»¬ä¸äº‹å…ˆä¸ºæ¯ä¸ªåŸå§‹ç±»ç¼–å†™ä»£ç†ç±»ï¼Œè€Œæ˜¯åœ¨è¿è¡Œçš„æ—¶å€™ï¼ŒåŠ¨æ€åœ°åˆ›å»ºåŸå§‹ç±»å¯¹åº”çš„ä»£ç†ç±»ï¼Œç„¶ååœ¨ç³»ç»Ÿä¸­ç”¨ä»£ç†ç±»æ›¿æ¢æ‰åŸå§‹ç±»ã€‚é‚£å¦‚ä½•å®ç°åŠ¨æ€ä»£ç†å‘¢ï¼Ÿ</li><li>å¦‚æœä½ ç†Ÿæ‚‰çš„æ˜¯ Java è¯­è¨€ï¼Œå®ç°åŠ¨æ€ä»£ç†å°±æ˜¯ä»¶å¾ˆç®€å•çš„äº‹æƒ…ã€‚å› ä¸º Java è¯­è¨€æœ¬èº«å°±å·²ç»æä¾›äº†åŠ¨æ€ä»£ç†çš„è¯­æ³•ï¼ˆå®é™…ä¸Šï¼ŒåŠ¨æ€ä»£ç†åº•å±‚ä¾èµ–çš„å°±æ˜¯ Java çš„åå°„è¯­æ³•ï¼‰ã€‚æˆ‘ä»¬æ¥çœ‹ä¸€ä¸‹ï¼Œå¦‚ä½•ç”¨ Java çš„åŠ¨æ€ä»£ç†æ¥å®ç°åˆšåˆšçš„åŠŸèƒ½ã€‚å…·ä½“çš„ä»£ç å¦‚ä¸‹æ‰€ç¤ºã€‚å…¶ä¸­ï¼ŒMetricsCollectorProxy ä½œä¸ºä¸€ä¸ªåŠ¨æ€ä»£ç†ç±»ï¼ŒåŠ¨æ€åœ°ç»™æ¯ä¸ªéœ€è¦æ”¶é›†æ¥å£è¯·æ±‚ä¿¡æ¯çš„ç±»åˆ›å»ºä»£ç†ç±»ã€‚ã€</li></ol><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">MetricsCollectorProxy</span> &#123;<br>  <span class="hljs-keyword">private</span> MetricsCollector metricsCollector;<br><br>  <span class="hljs-keyword">public</span> <span class="hljs-title function_">MetricsCollectorProxy</span><span class="hljs-params">()</span> &#123;<br>    <span class="hljs-built_in">this</span>.metricsCollector = <span class="hljs-keyword">new</span> <span class="hljs-title class_">MetricsCollector</span>();<br>  &#125;<br><br>  <span class="hljs-keyword">public</span> Object <span class="hljs-title function_">createProxy</span><span class="hljs-params">(Object proxiedObject)</span> &#123;<br>    Class&lt;?&gt;[] interfaces = proxiedObject.getClass().getInterfaces();<br>    <span class="hljs-type">DynamicProxyHandler</span> <span class="hljs-variable">handler</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">DynamicProxyHandler</span>(proxiedObject);<br>    <span class="hljs-keyword">return</span> Proxy.newProxyInstance(proxiedObject.getClass().getClassLoader(), interfaces, handler);<br>  &#125;<br><br>  <span class="hljs-keyword">private</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">DynamicProxyHandler</span> <span class="hljs-keyword">implements</span> <span class="hljs-title class_">InvocationHandler</span> &#123;<br>    <span class="hljs-keyword">private</span> Object proxiedObject;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-title function_">DynamicProxyHandler</span><span class="hljs-params">(Object proxiedObject)</span> &#123;<br>      <span class="hljs-built_in">this</span>.proxiedObject = proxiedObject;<br>    &#125;<br><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-keyword">public</span> Object <span class="hljs-title function_">invoke</span><span class="hljs-params">(Object proxy, Method method, Object[] args)</span> <span class="hljs-keyword">throws</span> Throwable &#123;<br>      <span class="hljs-type">long</span> <span class="hljs-variable">startTimestamp</span> <span class="hljs-operator">=</span> System.currentTimeMillis();<br>      <span class="hljs-type">Object</span> <span class="hljs-variable">result</span> <span class="hljs-operator">=</span> method.invoke(proxiedObject, args);<br>      <span class="hljs-type">long</span> <span class="hljs-variable">endTimeStamp</span> <span class="hljs-operator">=</span> System.currentTimeMillis();<br>      <span class="hljs-type">long</span> <span class="hljs-variable">responseTime</span> <span class="hljs-operator">=</span> endTimeStamp - startTimestamp;<br>      <span class="hljs-type">String</span> <span class="hljs-variable">apiName</span> <span class="hljs-operator">=</span> proxiedObject.getClass().getName() + <span class="hljs-string">&quot;:&quot;</span> + method.getName();<br>      <span class="hljs-type">RequestInfo</span> <span class="hljs-variable">requestInfo</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">RequestInfo</span>(apiName, responseTime, startTimestamp);<br>      metricsCollector.recordRequest(requestInfo);<br>      <span class="hljs-keyword">return</span> result;<br>    &#125;<br>  &#125;<br>&#125;<br><br><span class="hljs-comment">//MetricsCollectorProxyä½¿ç”¨ä¸¾ä¾‹</span><br><span class="hljs-type">MetricsCollectorProxy</span> <span class="hljs-variable">proxy</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">MetricsCollectorProxy</span>();<br><span class="hljs-type">IUserController</span> <span class="hljs-variable">userController</span> <span class="hljs-operator">=</span> (IUserController) proxy.createProxy(<span class="hljs-keyword">new</span> <span class="hljs-title class_">UserController</span>());<br></code></pre></td></tr></table></figure><p>å®é™…ä¸Šï¼ŒSpring AOP åº•å±‚çš„å®ç°åŸç†å°±æ˜¯åŸºäºåŠ¨æ€ä»£ç†ã€‚ç”¨æˆ·é…ç½®å¥½éœ€è¦ç»™å“ªäº›ç±»åˆ›å»ºä»£ç†ï¼Œå¹¶å®šä¹‰å¥½åœ¨æ‰§è¡ŒåŸå§‹ç±»çš„ä¸šåŠ¡ä»£ç å‰åæ‰§è¡Œå“ªäº›é™„åŠ åŠŸèƒ½ã€‚Spring ä¸ºè¿™äº›ç±»åˆ›å»ºåŠ¨æ€ä»£ç†å¯¹è±¡ï¼Œå¹¶åœ¨ JVM ä¸­æ›¿ä»£åŸå§‹ç±»å¯¹è±¡ã€‚åŸæœ¬åœ¨ä»£ç ä¸­æ‰§è¡Œçš„åŸå§‹ç±»çš„æ–¹æ³•ï¼Œè¢«æ¢ä½œæ‰§è¡Œä»£ç†ç±»çš„æ–¹æ³•ï¼Œä¹Ÿå°±å®ç°äº†ç»™åŸå§‹ç±»æ·»åŠ é™„åŠ åŠŸèƒ½çš„ç›®çš„ã€‚</p><h3 id="6ã€ä»£ç†æ¨¡å¼çš„åº”ç”¨åœºæ™¯"><a href="#6ã€ä»£ç†æ¨¡å¼çš„åº”ç”¨åœºæ™¯" class="headerlink" title="6ã€ä»£ç†æ¨¡å¼çš„åº”ç”¨åœºæ™¯"></a>6ã€ä»£ç†æ¨¡å¼çš„åº”ç”¨åœºæ™¯</h3><h4 id="1ã€ä¸šåŠ¡ç³»ç»Ÿçš„éåŠŸèƒ½æ€§éœ€æ±‚å¼€å‘"><a href="#1ã€ä¸šåŠ¡ç³»ç»Ÿçš„éåŠŸèƒ½æ€§éœ€æ±‚å¼€å‘" class="headerlink" title="1ã€ä¸šåŠ¡ç³»ç»Ÿçš„éåŠŸèƒ½æ€§éœ€æ±‚å¼€å‘"></a>1ã€ä¸šåŠ¡ç³»ç»Ÿçš„éåŠŸèƒ½æ€§éœ€æ±‚å¼€å‘</h4><p>ä»£ç†æ¨¡å¼æœ€å¸¸ç”¨çš„ä¸€ä¸ªåº”ç”¨åœºæ™¯å°±æ˜¯ï¼Œåœ¨ä¸šåŠ¡ç³»ç»Ÿä¸­å¼€å‘ä¸€äº›éåŠŸèƒ½æ€§éœ€æ±‚ï¼Œæ¯”å¦‚ï¼šç›‘æ§ã€ç»Ÿè®¡ã€é‰´æƒã€é™æµã€äº‹åŠ¡ã€å¹‚ç­‰ã€æ—¥å¿—ã€‚æˆ‘ä»¬å°†è¿™äº›é™„åŠ åŠŸèƒ½ä¸ä¸šåŠ¡åŠŸèƒ½è§£è€¦ï¼Œæ”¾åˆ°ä»£ç†ç±»ä¸­ç»Ÿä¸€å¤„ç†ï¼Œè®©ç¨‹åºå‘˜åªéœ€è¦å…³æ³¨ä¸šåŠ¡æ–¹é¢çš„å¼€å‘ã€‚å®é™…ä¸Šï¼Œå‰é¢ä¸¾çš„æœé›†æ¥å£è¯·æ±‚ä¿¡æ¯çš„ä¾‹å­ï¼Œå°±æ˜¯è¿™ä¸ªåº”ç”¨åœºæ™¯çš„ä¸€ä¸ªå…¸å‹ä¾‹å­ã€‚</p><p>å¦‚æœä½ ç†Ÿæ‚‰ Java è¯­è¨€å’Œ Spring å¼€å‘æ¡†æ¶ï¼Œè¿™éƒ¨åˆ†å·¥ä½œéƒ½æ˜¯å¯ä»¥åœ¨ Spring AOP åˆ‡é¢ä¸­å®Œæˆçš„ã€‚å‰é¢æˆ‘ä»¬ä¹Ÿæåˆ°ï¼ŒSpring AOP åº•å±‚çš„å®ç°åŸç†å°±æ˜¯åŸºäºåŠ¨æ€ä»£ç†ã€‚</p><h4 id="2ã€ä»£ç†æ¨¡å¼åœ¨-RPCã€ç¼“å­˜ä¸­çš„åº”ç”¨"><a href="#2ã€ä»£ç†æ¨¡å¼åœ¨-RPCã€ç¼“å­˜ä¸­çš„åº”ç”¨" class="headerlink" title="2ã€ä»£ç†æ¨¡å¼åœ¨ RPCã€ç¼“å­˜ä¸­çš„åº”ç”¨"></a>2ã€ä»£ç†æ¨¡å¼åœ¨ RPCã€ç¼“å­˜ä¸­çš„åº”ç”¨</h4><p>å®é™…ä¸Šï¼ŒRPC æ¡†æ¶ä¹Ÿå¯ä»¥çœ‹ä½œä¸€ç§ä»£ç†æ¨¡å¼ï¼ŒGoF çš„ã€Šè®¾è®¡æ¨¡å¼ã€‹ä¸€ä¹¦ä¸­æŠŠå®ƒç§°ä½œè¿œç¨‹ä»£ç†ã€‚é€šè¿‡è¿œç¨‹ä»£ç†ï¼Œå°†ç½‘ç»œé€šä¿¡ã€æ•°æ®ç¼–è§£ç ç­‰ç»†èŠ‚éšè—èµ·æ¥ã€‚å®¢æˆ·ç«¯åœ¨ä½¿ç”¨ RPC æœåŠ¡çš„æ—¶å€™ï¼Œå°±åƒä½¿ç”¨æœ¬åœ°å‡½æ•°ä¸€æ ·ï¼Œæ— éœ€äº†è§£è·ŸæœåŠ¡å™¨äº¤äº’çš„ç»†èŠ‚ã€‚é™¤æ­¤ä¹‹å¤–ï¼ŒRPC æœåŠ¡çš„å¼€å‘è€…ä¹Ÿåªéœ€è¦å¼€å‘ä¸šåŠ¡é€»è¾‘ï¼Œå°±åƒå¼€å‘æœ¬åœ°ä½¿ç”¨çš„å‡½æ•°ä¸€æ ·ï¼Œä¸éœ€è¦å…³æ³¨è·Ÿå®¢æˆ·ç«¯çš„äº¤äº’ç»†èŠ‚ã€‚</p><h4 id="3ã€ä»£ç†æ¨¡å¼åœ¨ç¼“å­˜ä¸­çš„åº”ç”¨"><a href="#3ã€ä»£ç†æ¨¡å¼åœ¨ç¼“å­˜ä¸­çš„åº”ç”¨" class="headerlink" title="3ã€ä»£ç†æ¨¡å¼åœ¨ç¼“å­˜ä¸­çš„åº”ç”¨"></a>3ã€ä»£ç†æ¨¡å¼åœ¨ç¼“å­˜ä¸­çš„åº”ç”¨</h4><ol><li>å‡è®¾æˆ‘ä»¬è¦å¼€å‘ä¸€ä¸ªæ¥å£è¯·æ±‚çš„ç¼“å­˜åŠŸèƒ½ï¼Œå¯¹äºæŸäº›æ¥å£è¯·æ±‚ï¼Œå¦‚æœå…¥å‚ç›¸åŒï¼Œåœ¨è®¾å®šçš„è¿‡æœŸæ—¶é—´å†…ï¼Œç›´æ¥è¿”å›ç¼“å­˜ç»“æœï¼Œè€Œä¸ç”¨é‡æ–°è¿›è¡Œé€»è¾‘å¤„ç†ã€‚æ¯”å¦‚ï¼Œé’ˆå¯¹è·å–ç”¨æˆ·ä¸ªäººä¿¡æ¯çš„éœ€æ±‚ï¼Œæˆ‘ä»¬å¯ä»¥å¼€å‘ä¸¤ä¸ªæ¥å£ï¼Œä¸€ä¸ªæ”¯æŒç¼“å­˜ï¼Œä¸€ä¸ªæ”¯æŒå®æ—¶æŸ¥è¯¢ã€‚å¯¹äºéœ€è¦å®æ—¶æ•°æ®çš„éœ€æ±‚ï¼Œæˆ‘ä»¬è®©å…¶è°ƒç”¨å®æ—¶æŸ¥è¯¢æ¥å£ï¼Œå¯¹äºä¸éœ€è¦å®æ—¶æ•°æ®çš„éœ€æ±‚ï¼Œæˆ‘ä»¬è®©å…¶è°ƒç”¨æ”¯æŒç¼“å­˜çš„æ¥å£ã€‚é‚£å¦‚ä½•æ¥å®ç°æ¥å£è¯·æ±‚çš„ç¼“å­˜åŠŸèƒ½å‘¢ï¼Ÿ</li><li>æœ€ç®€å•çš„å®ç°æ–¹æ³•å°±æ˜¯åˆšåˆšæˆ‘ä»¬è®²åˆ°çš„ï¼Œç»™æ¯ä¸ªéœ€è¦æ”¯æŒç¼“å­˜çš„æŸ¥è¯¢éœ€æ±‚éƒ½å¼€å‘ä¸¤ä¸ªä¸åŒçš„æ¥å£ï¼Œä¸€ä¸ªæ”¯æŒç¼“å­˜ï¼Œä¸€ä¸ªæ”¯æŒå®æ—¶æŸ¥è¯¢ã€‚ä½†æ˜¯ï¼Œè¿™æ ·åšæ˜¾ç„¶å¢åŠ äº†å¼€å‘æˆæœ¬ï¼Œè€Œä¸”ä¼šè®©ä»£ç çœ‹èµ·æ¥éå¸¸è‡ƒè‚¿ï¼ˆæ¥å£ä¸ªæ•°æˆå€å¢åŠ ï¼‰ï¼Œä¹Ÿä¸æ–¹ä¾¿ç¼“å­˜æ¥å£çš„é›†ä¸­ç®¡ç†ï¼ˆå¢åŠ ã€åˆ é™¤ç¼“å­˜æ¥å£ï¼‰ã€é›†ä¸­é…ç½®ï¼ˆæ¯”å¦‚é…ç½®æ¯ä¸ªæ¥å£ç¼“å­˜è¿‡æœŸæ—¶é—´ï¼‰ã€‚</li><li>é’ˆå¯¹è¿™äº›é—®é¢˜ï¼Œä»£ç†æ¨¡å¼å°±èƒ½æ´¾ä¸Šç”¨åœºäº†ï¼Œç¡®åˆ‡åœ°è¯´ï¼Œåº”è¯¥æ˜¯åŠ¨æ€ä»£ç†ã€‚å¦‚æœæ˜¯åŸºäº Spring æ¡†æ¶æ¥å¼€å‘çš„è¯ï¼Œé‚£å°±å¯ä»¥åœ¨ AOP åˆ‡é¢ä¸­å®Œæˆæ¥å£ç¼“å­˜çš„åŠŸèƒ½ã€‚åœ¨åº”ç”¨å¯åŠ¨çš„æ—¶å€™ï¼Œæˆ‘ä»¬ä»é…ç½®æ–‡ä»¶ä¸­åŠ è½½éœ€è¦æ”¯æŒç¼“å­˜çš„æ¥å£ï¼Œä»¥åŠç›¸åº”çš„ç¼“å­˜ç­–ç•¥ï¼ˆæ¯”å¦‚è¿‡æœŸæ—¶é—´ï¼‰ç­‰ã€‚å½“è¯·æ±‚åˆ°æ¥çš„æ—¶å€™ï¼Œæˆ‘ä»¬åœ¨ AOP åˆ‡é¢ä¸­æ‹¦æˆªè¯·æ±‚ï¼Œå¦‚æœè¯·æ±‚ä¸­å¸¦æœ‰æ”¯æŒç¼“å­˜çš„å­—æ®µï¼ˆæ¯”å¦‚ http://â€¦?..&amp;cached=trueï¼‰ï¼Œæˆ‘ä»¬ä¾¿ä»ç¼“å­˜ï¼ˆå†…å­˜ç¼“å­˜æˆ–è€… Redis ç¼“å­˜ç­‰ï¼‰ä¸­è·å–æ•°æ®ç›´æ¥è¿”å›ã€‚</li></ol><h2 id="äºŒã€æ¡¥æ¥æ¨¡å¼ã€å¸¸ç”¨ã€‘"><a href="#äºŒã€æ¡¥æ¥æ¨¡å¼ã€å¸¸ç”¨ã€‘" class="headerlink" title="äºŒã€æ¡¥æ¥æ¨¡å¼ã€å¸¸ç”¨ã€‘"></a>äºŒã€æ¡¥æ¥æ¨¡å¼ã€å¸¸ç”¨ã€‘</h2><ol><li>å·²ç»äº†è§£äº†ç¬¬ä¸€ç§ç»“æ„å‹æ¨¡å¼ï¼šä»£ç†æ¨¡å¼ã€‚å®ƒåœ¨ä¸æ”¹å˜åŸå§‹ç±»ï¼ˆæˆ–è€…å«è¢«ä»£ç†ç±»ï¼‰ä»£ç çš„æƒ…å†µä¸‹ï¼Œé€šè¿‡å¼•å…¥ä»£ç†ç±»æ¥ç»™åŸå§‹ç±»é™„åŠ åŠŸèƒ½ã€‚ä»£ç†æ¨¡å¼åœ¨å¹³æ—¶çš„å¼€å‘ç»å¸¸è¢«ç”¨åˆ°ï¼Œå¸¸ç”¨åœ¨ä¸šåŠ¡ç³»ç»Ÿä¸­å¼€å‘ä¸€äº›éåŠŸèƒ½æ€§éœ€æ±‚ï¼Œæ¯”å¦‚ï¼šç›‘æ§ã€ç»Ÿè®¡ã€é‰´æƒã€é™æµã€äº‹åŠ¡ã€å¹‚ç­‰ã€æ—¥å¿—ã€‚</li><li>å¦ä¸€ç§ç»“æ„å‹æ¨¡å¼ï¼šæ¡¥æ¥æ¨¡å¼ã€‚æ¡¥æ¥æ¨¡å¼çš„ä»£ç å®ç°éå¸¸ç®€å•ï¼Œä½†æ˜¯ç†è§£èµ·æ¥ç¨å¾®æœ‰ç‚¹éš¾åº¦ï¼Œå¹¶ä¸”åº”ç”¨åœºæ™¯ä¹Ÿæ¯”è¾ƒå±€é™ï¼Œæ‰€ä»¥ï¼Œç›¸å½“äºä»£ç†æ¨¡å¼æ¥è¯´ï¼Œæ¡¥æ¥æ¨¡å¼åœ¨å®é™…çš„é¡¹ç›®ä¸­å¹¶æ²¡æœ‰é‚£ä¹ˆå¸¸ç”¨ï¼Œè§åˆ°èƒ½è®¤è¯†å°±å¯ä»¥ã€‚</li></ol><h3 id="1ã€Demoæ¡ˆä¾‹-æ‰‹æœºæ“ä½œé—®é¢˜"><a href="#1ã€Demoæ¡ˆä¾‹-æ‰‹æœºæ“ä½œé—®é¢˜" class="headerlink" title="1ã€Demoæ¡ˆä¾‹-æ‰‹æœºæ“ä½œé—®é¢˜"></a>1ã€Demoæ¡ˆä¾‹-æ‰‹æœºæ“ä½œé—®é¢˜</h3><h4 id="1ã€éœ€æ±‚"><a href="#1ã€éœ€æ±‚" class="headerlink" title="1ã€éœ€æ±‚"></a>1ã€éœ€æ±‚</h4><p>ç°åœ¨å¯¹ä¸åŒæ‰‹æœºç±»å‹çš„ä¸åŒå“ç‰Œå®ç°æ“ä½œç¼–ç¨‹(æ¯”å¦‚:å¼€æœºã€å…³æœºã€ä¸Šç½‘ï¼Œæ‰“ç”µè¯ç­‰)ï¼Œå¦‚å›¾:</p><p><img src="/2022/09/23/03-jie-gou-xing-dai-li-qiao-jie/image-20220926161449612.png"></p><h4 id="2ã€ä¼ ç»Ÿæ–¹æ¡ˆè§£å†³æ‰‹æœºæ“ä½œé—®é¢˜åˆ†æ"><a href="#2ã€ä¼ ç»Ÿæ–¹æ¡ˆè§£å†³æ‰‹æœºæ“ä½œé—®é¢˜åˆ†æ" class="headerlink" title="2ã€ä¼ ç»Ÿæ–¹æ¡ˆè§£å†³æ‰‹æœºæ“ä½œé—®é¢˜åˆ†æ"></a>2ã€ä¼ ç»Ÿæ–¹æ¡ˆè§£å†³æ‰‹æœºæ“ä½œé—®é¢˜åˆ†æ</h4><p>ä¼ ç»Ÿæ–¹æ³•å¯¹åº”çš„ç±»å›¾</p><p><img src="/2022/09/23/03-jie-gou-xing-dai-li-qiao-jie/image-20220926161534523.png" alt="ç±»å›¾"></p><ol><li>æ‰©å±•æ€§é—®é¢˜(<strong>ç±»çˆ†ç‚¸</strong>)ï¼Œå¦‚æœæˆ‘ä»¬å†å¢åŠ æ‰‹æœºçš„æ ·å¼(æ—‹è½¬å¼)ï¼Œå°±éœ€è¦å¢åŠ å„ä¸ªå“ç‰Œæ‰‹æœºçš„ç±»ï¼ŒåŒæ ·å¦‚æœæˆ‘ä»¬å¢åŠ ä¸€ä¸ªæ‰‹æœºå“ç‰Œï¼Œä¹Ÿè¦åœ¨å„ä¸ªæ‰‹æœºæ ·å¼ç±»ä¸‹å¢åŠ ã€‚</li><li>è¿åäº†å•ä¸€èŒè´£åŸåˆ™ï¼Œå½“æˆ‘ä»¬å¢åŠ æ‰‹æœºæ ·å¼æ—¶ï¼Œè¦åŒæ—¶å¢åŠ æ‰€æœ‰å“ç‰Œçš„æ‰‹æœºï¼Œè¿™æ ·å¢åŠ äº†ä»£ç ç»´æŠ¤æˆæœ¬.</li><li>è§£å†³æ–¹æ¡ˆ-ä½¿ç”¨<strong>æ¡¥æ¥æ¨¡</strong>å¼</li><li>Bridge æ¨¡å¼åŸºäºç±»çš„æœ€å°è®¾è®¡åŸåˆ™ï¼Œé€šè¿‡ä½¿ç”¨å°è£…ã€èšåˆåŠç»§æ‰¿ç­‰è¡Œä¸ºè®©ä¸åŒçš„ç±»æ‰¿æ‹…ä¸åŒçš„èŒè´£ã€‚å®ƒçš„ä¸»è¦ç‰¹ç‚¹æ˜¯æŠŠ<code>æŠ½è±¡(Abstraction)ä¸è¡Œä¸ºå®ç°(Implementation)åˆ†ç¦»å¼€æ¥</code>ï¼Œä»è€Œå¯ä»¥ä¿æŒå„éƒ¨åˆ†çš„ç‹¬ç«‹æ€§ä»¥åŠåº”å¯¹ä»–ä»¬çš„åŠŸèƒ½æ‰©å±•</li></ol><h4 id="3ã€ä½¿ç”¨æ¡¥æ¥æ¨¡å¼çš„ä»£ç "><a href="#3ã€ä½¿ç”¨æ¡¥æ¥æ¨¡å¼çš„ä»£ç " class="headerlink" title="3ã€ä½¿ç”¨æ¡¥æ¥æ¨¡å¼çš„ä»£ç "></a>3ã€ä½¿ç”¨æ¡¥æ¥æ¨¡å¼çš„ä»£ç </h4><h5 id="1ã€brandæ¥å£"><a href="#1ã€brandæ¥å£" class="headerlink" title="1ã€brandæ¥å£"></a>1ã€brandæ¥å£</h5><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-comment">//æ¥å£</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">interface</span> <span class="hljs-title class_">Brand</span> &#123;<br>   <span class="hljs-keyword">void</span> <span class="hljs-title function_">open</span><span class="hljs-params">()</span>;<br>   <span class="hljs-keyword">void</span> <span class="hljs-title function_">close</span><span class="hljs-params">()</span>;<br>   <span class="hljs-keyword">void</span> <span class="hljs-title function_">call</span><span class="hljs-params">()</span>;<br>&#125;<br></code></pre></td></tr></table></figure><h5 id="2ã€Phoneã€æŠ½è±¡ç±»ã€‘"><a href="#2ã€Phoneã€æŠ½è±¡ç±»ã€‘" class="headerlink" title="2ã€Phoneã€æŠ½è±¡ç±»ã€‘"></a>2ã€Phoneã€æŠ½è±¡ç±»ã€‘</h5><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">abstract</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Phone</span> &#123;<br>   <br>   <span class="hljs-comment">//ç»„åˆå“ç‰Œ</span><br>   <span class="hljs-keyword">private</span> Brand brand;<br><br>   <span class="hljs-comment">//æ„é€ å™¨</span><br>   <span class="hljs-keyword">public</span> <span class="hljs-title function_">Phone</span><span class="hljs-params">(Brand brand)</span> &#123;<br>      <span class="hljs-built_in">super</span>();<br>      <span class="hljs-built_in">this</span>.brand = brand;<br>   &#125;<br>   <br>   <span class="hljs-keyword">protected</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">open</span><span class="hljs-params">()</span> &#123;<br>      <span class="hljs-built_in">this</span>.brand.open();<br>   &#125;<br>   <span class="hljs-keyword">protected</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">close</span><span class="hljs-params">()</span> &#123;<br>      brand.close();<br>   &#125;<br>   <span class="hljs-keyword">protected</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">call</span><span class="hljs-params">()</span> &#123;<br>      brand.call();<br>   &#125;<br>   <br>&#125;<br></code></pre></td></tr></table></figure><h5 id="3ã€Vivo"><a href="#3ã€Vivo" class="headerlink" title="3ã€Vivo"></a>3ã€Vivo</h5><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Vivo</span> <span class="hljs-keyword">implements</span> <span class="hljs-title class_">Brand</span> &#123;<br><br>   <span class="hljs-meta">@Override</span><br>   <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">open</span><span class="hljs-params">()</span> &#123;<br>      <span class="hljs-comment">// TODO Auto-generated method stub</span><br>      System.out.println(<span class="hljs-string">&quot; Vivoæ‰‹æœºå¼€æœº &quot;</span>);<br>   &#125;<br><br>   <span class="hljs-meta">@Override</span><br>   <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">close</span><span class="hljs-params">()</span> &#123;<br>      <span class="hljs-comment">// TODO Auto-generated method stub</span><br>      System.out.println(<span class="hljs-string">&quot; Vivoæ‰‹æœºå…³æœº &quot;</span>);<br>   &#125;<br><br>   <span class="hljs-meta">@Override</span><br>   <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">call</span><span class="hljs-params">()</span> &#123;<br>      <span class="hljs-comment">// TODO Auto-generated method stub</span><br>      System.out.println(<span class="hljs-string">&quot; Vivoæ‰‹æœºæ‰“ç”µè¯ &quot;</span>);<br>   &#125;<br><br>&#125;<br></code></pre></td></tr></table></figure><h5 id="4ã€XiaoMi"><a href="#4ã€XiaoMi" class="headerlink" title="4ã€XiaoMi"></a>4ã€XiaoMi</h5><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">XiaoMi</span> <span class="hljs-keyword">implements</span> <span class="hljs-title class_">Brand</span> &#123;<br><br>   <span class="hljs-meta">@Override</span><br>   <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">open</span><span class="hljs-params">()</span> &#123;<br>      <span class="hljs-comment">// TODO Auto-generated method stub</span><br>      System.out.println(<span class="hljs-string">&quot; å°ç±³æ‰‹æœºå¼€æœº &quot;</span>);<br>   &#125;<br><br>   <span class="hljs-meta">@Override</span><br>   <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">close</span><span class="hljs-params">()</span> &#123;<br>      <span class="hljs-comment">// TODO Auto-generated method stub</span><br>      System.out.println(<span class="hljs-string">&quot; å°ç±³æ‰‹æœºå…³æœº &quot;</span>);<br>   &#125;<br><br>   <span class="hljs-meta">@Override</span><br>   <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">call</span><span class="hljs-params">()</span> &#123;<br>      <span class="hljs-comment">// TODO Auto-generated method stub</span><br>      System.out.println(<span class="hljs-string">&quot; å°ç±³æ‰‹æœºæ‰“ç”µè¯ &quot;</span>);<br>   &#125;<br><br>&#125;<br></code></pre></td></tr></table></figure><h5 id="5ã€FoldedPhone"><a href="#5ã€FoldedPhone" class="headerlink" title="5ã€FoldedPhone"></a>5ã€FoldedPhone</h5><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-comment">//æŠ˜å å¼æ‰‹æœºç±»ï¼Œç»§æ‰¿ æŠ½è±¡ç±» Phone</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">FoldedPhone</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_">Phone</span> &#123;<br><br>   <span class="hljs-comment">//æ„é€ å™¨</span><br>   <span class="hljs-keyword">public</span> <span class="hljs-title function_">FoldedPhone</span><span class="hljs-params">(Brand brand)</span> &#123;<br>      <span class="hljs-built_in">super</span>(brand);<br>   &#125;<br>   <br>   <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">open</span><span class="hljs-params">()</span> &#123;<br>      <span class="hljs-built_in">super</span>.open();<br>      System.out.println(<span class="hljs-string">&quot; æŠ˜å æ ·å¼æ‰‹æœº &quot;</span>);<br>   &#125;<br>   <br>   <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">close</span><span class="hljs-params">()</span> &#123;<br>      <span class="hljs-built_in">super</span>.close();<br>      System.out.println(<span class="hljs-string">&quot; æŠ˜å æ ·å¼æ‰‹æœº &quot;</span>);<br>   &#125;<br>   <br>   <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">call</span><span class="hljs-params">()</span> &#123;<br>      <span class="hljs-built_in">super</span>.call();<br>      System.out.println(<span class="hljs-string">&quot; æŠ˜å æ ·å¼æ‰‹æœº &quot;</span>);<br>   &#125;<br>&#125;<br></code></pre></td></tr></table></figure><h5 id="6ã€UpRightPhone"><a href="#6ã€UpRightPhone" class="headerlink" title="6ã€UpRightPhone"></a>6ã€UpRightPhone</h5><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">UpRightPhone</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_">Phone</span> &#123;<br>   <br>      <span class="hljs-comment">//æ„é€ å™¨</span><br>      <span class="hljs-keyword">public</span> <span class="hljs-title function_">UpRightPhone</span><span class="hljs-params">(Brand brand)</span> &#123;<br>         <span class="hljs-built_in">super</span>(brand);<br>      &#125;<br>      <br>      <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">open</span><span class="hljs-params">()</span> &#123;<br>         <span class="hljs-built_in">super</span>.open();<br>         System.out.println(<span class="hljs-string">&quot; ç›´ç«‹æ ·å¼æ‰‹æœº &quot;</span>);<br>      &#125;<br>      <br>      <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">close</span><span class="hljs-params">()</span> &#123;<br>         <span class="hljs-built_in">super</span>.close();<br>         System.out.println(<span class="hljs-string">&quot; ç›´ç«‹æ ·å¼æ‰‹æœº &quot;</span>);<br>      &#125;<br>      <br>      <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">call</span><span class="hljs-params">()</span> &#123;<br>         <span class="hljs-built_in">super</span>.call();<br>         System.out.println(<span class="hljs-string">&quot; ç›´ç«‹æ ·å¼æ‰‹æœº &quot;</span>);<br>      &#125;<br>&#125;<br></code></pre></td></tr></table></figure><h5 id="7ã€Client"><a href="#7ã€Client" class="headerlink" title="7ã€Client"></a>7ã€Client</h5><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Client</span> &#123;<br><br>   <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span> &#123;<br>      <br>      <span class="hljs-comment">//è·å–æŠ˜å å¼æ‰‹æœº (æ ·å¼ + å“ç‰Œ )</span><br>      <br>      <span class="hljs-type">Phone</span> <span class="hljs-variable">phone1</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">FoldedPhone</span>(<span class="hljs-keyword">new</span> <span class="hljs-title class_">XiaoMi</span>());<br>      <br>      phone1.open();<br>      phone1.call();<br>      phone1.close();<br>      <br>      System.out.println(<span class="hljs-string">&quot;=======================&quot;</span>);<br>      <br>      <span class="hljs-type">Phone</span> <span class="hljs-variable">phone2</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">FoldedPhone</span>(<span class="hljs-keyword">new</span> <span class="hljs-title class_">Vivo</span>());<br>      <br>      phone2.open();<br>      phone2.call();<br>      phone2.close();<br>      <br>      System.out.println(<span class="hljs-string">&quot;==============&quot;</span>);<br>      <br>      <span class="hljs-type">UpRightPhone</span> <span class="hljs-variable">phone3</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">UpRightPhone</span>(<span class="hljs-keyword">new</span> <span class="hljs-title class_">XiaoMi</span>());<br>      <br>      phone3.open();<br>      phone3.call();<br>      phone3.close();<br>      <br>      System.out.println(<span class="hljs-string">&quot;==============&quot;</span>);<br>      <br>      <span class="hljs-type">UpRightPhone</span> <span class="hljs-variable">phone4</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">UpRightPhone</span>(<span class="hljs-keyword">new</span> <span class="hljs-title class_">Vivo</span>());<br>      <br>      phone4.open();<br>      phone4.call();<br>      phone4.close();<br>   &#125;<br><br>&#125;<br></code></pre></td></tr></table></figure><h3 id="2ã€æ¡¥æ¥æ¨¡å¼çš„åŸç†è§£æ"><a href="#2ã€æ¡¥æ¥æ¨¡å¼çš„åŸç†è§£æ" class="headerlink" title="2ã€æ¡¥æ¥æ¨¡å¼çš„åŸç†è§£æ"></a>2ã€æ¡¥æ¥æ¨¡å¼çš„åŸç†è§£æ</h3><ol><li>æ¡¥æ¥æ¨¡å¼ï¼Œä¹Ÿå«ä½œæ¡¥æ¢æ¨¡å¼ï¼Œè‹±æ–‡æ˜¯Bridge Design Patternã€‚</li><li>åœ¨ GoF çš„ã€Šè®¾è®¡æ¨¡å¼ã€‹ä¸€ä¹¦ä¸­ï¼Œæ¡¥æ¥æ¨¡å¼æ˜¯è¿™ä¹ˆå®šä¹‰çš„ï¼šâ€œDecouple an abstraction from its implementation so that the two can vary independentlyã€‚â€ç¿»è¯‘æˆä¸­æ–‡å°±æ˜¯ï¼šâ€œå°†æŠ½è±¡å’Œå®ç°è§£è€¦ï¼Œè®©å®ƒä»¬å¯ä»¥ç‹¬ç«‹å˜åŒ–ã€‚â€</li><li>å…³äºæ¡¥æ¥æ¨¡å¼ï¼Œå¾ˆå¤šä¹¦ç±ã€èµ„æ–™ä¸­ï¼Œè¿˜æœ‰å¦å¤–ä¸€ç§ç†è§£æ–¹å¼ï¼šâ€œä¸€ä¸ªç±»å­˜åœ¨ä¸¤ä¸ªï¼ˆæˆ–å¤šä¸ªï¼‰ç‹¬ç«‹å˜åŒ–çš„ç»´åº¦ï¼Œæˆ‘ä»¬é€šè¿‡ç»„åˆçš„æ–¹å¼ï¼Œè®©è¿™ä¸¤ä¸ªï¼ˆæˆ–å¤šä¸ªï¼‰ç»´åº¦å¯ä»¥ç‹¬ç«‹è¿›è¡Œæ‰©å±•ã€‚â€é€šè¿‡ç»„åˆå…³ç³»æ¥æ›¿ä»£ç»§æ‰¿å…³ç³»ï¼Œé¿å…ç»§æ‰¿å±‚æ¬¡çš„æŒ‡æ•°çº§çˆ†ç‚¸ã€‚</li><li>GoF ç»™å‡ºçš„å®šä¹‰éå¸¸çš„ç®€çŸ­ï¼Œå•å‡­è¿™ä¸€å¥è¯ï¼Œä¼°è®¡æ²¡å‡ ä¸ªäººèƒ½çœ‹æ‡‚æ˜¯ä»€ä¹ˆæ„æ€ã€‚æ‰€ä»¥ï¼Œæˆ‘ä»¬é€šè¿‡ JDBC é©±åŠ¨çš„ä¾‹å­æ¥è§£é‡Šä¸€ä¸‹ã€‚JDBC é©±åŠ¨æ˜¯æ¡¥æ¥æ¨¡å¼çš„ç»å…¸åº”ç”¨ã€‚æˆ‘ä»¬å…ˆæ¥çœ‹ä¸€ä¸‹ï¼Œå¦‚ä½•åˆ©ç”¨ JDBC é©±åŠ¨æ¥æŸ¥è¯¢æ•°æ®åº“ã€‚å…·ä½“çš„ä»£ç å¦‚ä¸‹æ‰€ç¤ºï¼š</li></ol><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs java">Class.forName(<span class="hljs-string">&quot;com.mysql.jdbc.Driver&quot;</span>); <span class="hljs-comment">// åŠ è½½åŠæ³¨å†ŒJDBCé©±åŠ¨ç¨‹åº</span><br><span class="hljs-type">String</span> <span class="hljs-variable">url</span> <span class="hljs-operator">=</span> <span class="hljs-string">&quot;jdbc:mysql://localhost:3306/sample_db?user=root&amp;password=your_password&quot;</span>;<br><span class="hljs-type">Connection</span> <span class="hljs-variable">con</span> <span class="hljs-operator">=</span> DriverManager.getConnection(url);<br><span class="hljs-type">Statement</span> <span class="hljs-variable">stmt</span> <span class="hljs-operator">=</span> con.createStatement();<br><span class="hljs-type">String</span> <span class="hljs-variable">query</span> <span class="hljs-operator">=</span> <span class="hljs-string">&quot;select * from test&quot;</span>;<br><span class="hljs-type">ResultSet</span> <span class="hljs-variable">rs</span> <span class="hljs-operator">=</span> stmt.executeQuery(query);<br><span class="hljs-keyword">while</span> (rs.next()) &#123;<br>  rs.getString(<span class="hljs-number">1</span>);<br>  rs.getInt(<span class="hljs-number">2</span>);<br>&#125;<br></code></pre></td></tr></table></figure><ol><li>å¦‚æœæˆ‘ä»¬æƒ³è¦æŠŠ MySQL æ•°æ®åº“æ¢æˆ Oracle æ•°æ®åº“ï¼Œåªéœ€è¦æŠŠç¬¬ä¸€è¡Œä»£ç ä¸­çš„ com.mysql.jdbc.Driver æ¢æˆ oracle.jdbc.driver.OracleDriver å°±å¯ä»¥äº†ã€‚å½“ç„¶ï¼Œä¹Ÿæœ‰æ›´çµæ´»çš„å®ç°æ–¹å¼ï¼Œæˆ‘ä»¬å¯ä»¥æŠŠéœ€è¦åŠ è½½çš„ Driver ç±»å†™åˆ°é…ç½®æ–‡ä»¶ä¸­ï¼Œå½“ç¨‹åºå¯åŠ¨çš„æ—¶å€™ï¼Œè‡ªåŠ¨ä»é…ç½®æ–‡ä»¶ä¸­åŠ è½½ï¼Œè¿™æ ·åœ¨åˆ‡æ¢æ•°æ®åº“çš„æ—¶å€™ï¼Œæˆ‘ä»¬éƒ½ä¸éœ€è¦ä¿®æ”¹ä»£ç ï¼Œåªéœ€è¦ä¿®æ”¹é…ç½®æ–‡ä»¶å°±å¯ä»¥äº†ã€‚</li><li>ä¸ç®¡æ˜¯æ”¹ä»£ç è¿˜æ˜¯æ”¹é…ç½®ï¼Œåœ¨é¡¹ç›®ä¸­ï¼Œä»ä¸€ä¸ªæ•°æ®åº“åˆ‡æ¢åˆ°å¦ä¸€ç§æ•°æ®åº“ï¼Œéƒ½åªéœ€è¦æ”¹åŠ¨å¾ˆå°‘çš„ä»£ç ï¼Œæˆ–è€…å®Œå…¨ä¸éœ€è¦æ”¹åŠ¨ä»£ç ï¼Œé‚£å¦‚æ­¤ä¼˜é›…çš„æ•°æ®åº“åˆ‡æ¢æ˜¯å¦‚ä½•å®ç°çš„å‘¢ï¼Ÿ</li><li>å…ˆä» com.mysql.jdbc.Driver è¿™ä¸ªç±»çš„ä»£ç çœ‹èµ·ã€‚éƒ¨åˆ†ç›¸å…³ä»£ç ï¼š</li></ol><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">package</span> com.mysql.jdbc;<br><span class="hljs-keyword">import</span> java.sql.SQLException;<br><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Driver</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_">NonRegisteringDriver</span> <span class="hljs-keyword">implements</span> <span class="hljs-title class_">java</span>.sql.Driver &#123;<br>  <span class="hljs-keyword">static</span> &#123;<br>    <span class="hljs-keyword">try</span> &#123;<br>      java.sql.DriverManager.registerDriver(<span class="hljs-keyword">new</span> <span class="hljs-title class_">Driver</span>());<br>    &#125; <span class="hljs-keyword">catch</span> (SQLException E) &#123;<br>      <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">RuntimeException</span>(<span class="hljs-string">&quot;Can&#x27;t register driver!&quot;</span>);<br>    &#125;<br>  &#125;<br><br>  <span class="hljs-comment">/**</span><br><span class="hljs-comment">   * Construct a new driver and register it with DriverManager</span><br><span class="hljs-comment">   * <span class="hljs-doctag">@throws</span> SQLException if a database error occurs.</span><br><span class="hljs-comment">   */</span><br>  <span class="hljs-keyword">public</span> <span class="hljs-title function_">Driver</span><span class="hljs-params">()</span> <span class="hljs-keyword">throws</span> SQLException &#123;<br>  <span class="hljs-comment">// Required for Class.forName().newInstance()</span><br>  &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>ç»“åˆ com.mysql.jdbc.Driver çš„ä»£ç å®ç°ï¼Œå¯ä»¥å‘ç°ï¼Œå½“æ‰§è¡Œ Class.forName(â€œcom.mysql.jdbc.Driverâ€) è¿™æ¡è¯­å¥çš„æ—¶å€™ï¼Œå®é™…ä¸Šæ˜¯åšäº†ä¸¤ä»¶äº‹æƒ…ã€‚ç¬¬ä¸€ä»¶äº‹æƒ…æ˜¯è¦æ±‚ JVM æŸ¥æ‰¾å¹¶åŠ è½½æŒ‡å®šçš„ Driver ç±»ï¼Œç¬¬äºŒä»¶äº‹æƒ…æ˜¯æ‰§è¡Œè¯¥ç±»çš„é™æ€ä»£ç ï¼Œä¹Ÿå°±æ˜¯å°† MySQL Driver æ³¨å†Œåˆ° DriverManager ç±»ä¸­ã€‚</p><p>ç°åœ¨ï¼Œæˆ‘ä»¬å†æ¥çœ‹ä¸€ä¸‹ï¼ŒDriverManager ç±»æ˜¯å¹²ä»€ä¹ˆç”¨çš„ã€‚å…·ä½“çš„ä»£ç å¦‚ä¸‹æ‰€ç¤ºã€‚å½“æˆ‘ä»¬æŠŠå…·ä½“çš„ Driver å®ç°ç±»ï¼ˆæ¯”å¦‚ï¼Œcom.mysql.jdbc.Driverï¼‰æ³¨å†Œåˆ° DriverManager ä¹‹åï¼Œåç»­æ‰€æœ‰å¯¹ JDBC æ¥å£çš„è°ƒç”¨ï¼Œéƒ½ä¼šå§”æ´¾åˆ°å¯¹å…·ä½“çš„ Driver å®ç°ç±»æ¥æ‰§è¡Œã€‚è€Œ Driver å®ç°ç±»éƒ½å®ç°äº†ç›¸åŒçš„æ¥å£ï¼ˆjava.sql.Driver ï¼‰ï¼Œè¿™ä¹Ÿæ˜¯å¯ä»¥çµæ´»åˆ‡æ¢ Driver çš„åŸå› ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">DriverManager</span> &#123;<br>  <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span>  CopyOnWriteArrayList&lt;DriverInfo&gt; registeredDrivers =  = <span class="hljs-keyword">new</span> <span class="hljs-title class_">CopyOnWriteArrayList</span>();<br><br>  <span class="hljs-comment">// ...</span><br>  <span class="hljs-keyword">static</span> &#123;<br>    loadInitialDrivers();<br>    println(<span class="hljs-string">&quot;JDBC DriverManager initialized&quot;</span>);<br>  &#125;<br><br>  <span class="hljs-comment">// ...</span><br>  <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">synchronized</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">registerDriver</span><span class="hljs-params">(java.sql.Driver driver)</span> <span class="hljs-keyword">throws</span> SQLException &#123;<br>    <span class="hljs-keyword">if</span> (driver != <span class="hljs-literal">null</span>) &#123;<br>      registeredDrivers.addIfAbsent(<span class="hljs-keyword">new</span> <span class="hljs-title class_">DriverInfo</span>(driver));<br>    &#125; <span class="hljs-keyword">else</span> &#123;<br>      <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">NullPointerException</span>();<br>    &#125;<br>  &#125;<br><br>  <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> Connection <span class="hljs-title function_">getConnection</span><span class="hljs-params">(String url, String user, String password)</span><br>      <span class="hljs-keyword">throws</span> SQLException &#123;<br>    java.util.<span class="hljs-type">Properties</span> <span class="hljs-variable">info</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">java</span>.util.Properties();<br>    <span class="hljs-keyword">if</span> (user != <span class="hljs-literal">null</span>) &#123;<br>      info.put(<span class="hljs-string">&quot;user&quot;</span>, user);<br>    &#125;<br>    <span class="hljs-keyword">if</span> (password != <span class="hljs-literal">null</span>) &#123;<br>      info.put(<span class="hljs-string">&quot;password&quot;</span>, password);<br>    &#125;<br><br>    <span class="hljs-keyword">return</span> (getConnection(url, info, Reflection.getCallerClass()));<br>  &#125;<br>  <span class="hljs-comment">// ...</span><br>&#125;<br></code></pre></td></tr></table></figure><p>æ¡¥æ¥æ¨¡å¼çš„å®šä¹‰æ˜¯â€œå°†æŠ½è±¡å’Œå®ç°è§£è€¦ï¼Œè®©å®ƒä»¬å¯ä»¥ç‹¬ç«‹å˜åŒ–â€ã€‚é‚£å¼„æ‡‚å®šä¹‰ä¸­â€œæŠ½è±¡â€å’Œâ€œå®ç°â€ä¸¤ä¸ªæ¦‚å¿µï¼Œå°±æ˜¯ç†è§£æ¡¥æ¥æ¨¡å¼çš„å…³é”®ã€‚é‚£åœ¨ JDBC è¿™ä¸ªä¾‹å­ä¸­ï¼Œä»€ä¹ˆæ˜¯â€œæŠ½è±¡â€ï¼Ÿä»€ä¹ˆæ˜¯â€œå®ç°â€å‘¢ï¼Ÿ</p><p>å®é™…ä¸Šï¼ŒJDBC æœ¬èº«å°±ç›¸å½“äºâ€œæŠ½è±¡â€ã€‚æ³¨æ„ï¼Œè¿™é‡Œæ‰€è¯´çš„â€œæŠ½è±¡â€ï¼ŒæŒ‡çš„å¹¶éâ€œæŠ½è±¡ç±»â€æˆ–â€œæ¥å£â€ï¼Œè€Œæ˜¯è·Ÿå…·ä½“çš„æ•°æ®åº“æ— å…³çš„ã€è¢«æŠ½è±¡å‡ºæ¥çš„ä¸€å¥—â€œç±»åº“â€ã€‚å…·ä½“çš„ Driverï¼ˆæ¯”å¦‚ï¼Œcom.mysql.jdbc.Driverï¼‰å°±ç›¸å½“äºâ€œå®ç°â€ã€‚æ³¨æ„ï¼Œè¿™é‡Œæ‰€è¯´çš„â€œå®ç°â€ï¼Œä¹Ÿå¹¶éæŒ‡â€œæ¥å£çš„å®ç°ç±»â€ï¼Œè€Œæ˜¯è·Ÿå…·ä½“æ•°æ®åº“ç›¸å…³çš„ä¸€å¥—â€œç±»åº“â€ã€‚JDBC å’Œ Driver ç‹¬ç«‹å¼€å‘ï¼Œé€šè¿‡å¯¹è±¡ä¹‹é—´çš„ç»„åˆå…³ç³»ï¼Œç»„è£…åœ¨ä¸€èµ·ã€‚JDBC çš„æ‰€æœ‰é€»è¾‘æ“ä½œï¼Œæœ€ç»ˆéƒ½å§”æ‰˜ç»™ Driver æ¥æ‰§è¡Œã€‚</p><h3 id="3ã€æ¡¥æ¥æ¨¡å¼çš„åº”ç”¨ä¸¾ä¾‹"><a href="#3ã€æ¡¥æ¥æ¨¡å¼çš„åº”ç”¨ä¸¾ä¾‹" class="headerlink" title="3ã€æ¡¥æ¥æ¨¡å¼çš„åº”ç”¨ä¸¾ä¾‹"></a>3ã€æ¡¥æ¥æ¨¡å¼çš„åº”ç”¨ä¸¾ä¾‹</h3><p>åœ¨å‰é¢ï¼Œæœ‰ä¸€ä¸ª API æ¥å£ç›‘æ§å‘Šè­¦çš„ä¾‹å­ï¼šæ ¹æ®ä¸åŒçš„å‘Šè­¦è§„åˆ™ï¼Œè§¦å‘ä¸åŒç±»å‹çš„å‘Šè­¦ã€‚å‘Šè­¦æ”¯æŒå¤šç§é€šçŸ¥æ¸ é“ï¼ŒåŒ…æ‹¬ï¼šé‚®ä»¶ã€çŸ­ä¿¡ã€å¾®ä¿¡ã€è‡ªåŠ¨è¯­éŸ³ç”µè¯ã€‚é€šçŸ¥çš„ç´§æ€¥ç¨‹åº¦æœ‰å¤šç§ç±»å‹ï¼ŒåŒ…æ‹¬ï¼šSEVEREï¼ˆä¸¥é‡ï¼‰ã€URGENCYï¼ˆç´§æ€¥ï¼‰ã€NORMALï¼ˆæ™®é€šï¼‰ã€TRIVIALï¼ˆæ— å…³ç´§è¦ï¼‰ã€‚ä¸åŒçš„ç´§æ€¥ç¨‹åº¦å¯¹åº”ä¸åŒçš„é€šçŸ¥æ¸ é“ã€‚æ¯”å¦‚ï¼ŒSERVEï¼ˆä¸¥é‡ï¼‰çº§åˆ«çš„æ¶ˆæ¯ä¼šé€šè¿‡â€œè‡ªåŠ¨è¯­éŸ³ç”µè¯â€å‘ŠçŸ¥ç›¸å…³äººå‘˜ã€‚</p><p>åœ¨å½“æ—¶çš„ä»£ç å®ç°ä¸­ï¼Œå…³äºå‘é€å‘Šè­¦ä¿¡æ¯é‚£éƒ¨åˆ†ä»£ç ï¼Œåªç»™å‡ºäº†ç²—ç•¥çš„è®¾è®¡ï¼Œç°åœ¨ä¸€å—å®ç°ä¸€ä¸‹ã€‚å…ˆæ¥çœ‹æœ€ç®€å•ã€æœ€ç›´æ¥çš„ä¸€ç§å®ç°æ–¹å¼ã€‚ä»£ç å¦‚ä¸‹æ‰€ç¤ºï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">enum</span> <span class="hljs-title class_">NotificationEmergencyLevel</span> &#123;<br>  SEVERE,<br>  URGENCY,<br>  NORMAL,<br>  TRIVIAL<br>&#125;<br><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Notification</span> &#123;<br>  <span class="hljs-keyword">private</span> List&lt;String&gt; emailAddresses;<br>  <span class="hljs-keyword">private</span> List&lt;String&gt; telephones;<br>  <span class="hljs-keyword">private</span> List&lt;String&gt; wechatIds;<br><br>  <span class="hljs-keyword">public</span> <span class="hljs-title function_">Notification</span><span class="hljs-params">()</span> &#123;&#125;<br><br>  <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">setEmailAddress</span><span class="hljs-params">(List&lt;String&gt; emailAddress)</span> &#123;<br>    <span class="hljs-built_in">this</span>.emailAddresses = emailAddress;<br>  &#125;<br><br>  <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">setTelephones</span><span class="hljs-params">(List&lt;String&gt; telephones)</span> &#123;<br>    <span class="hljs-built_in">this</span>.telephones = telephones;<br>  &#125;<br><br>  <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">setWechatIds</span><span class="hljs-params">(List&lt;String&gt; wechatIds)</span> &#123;<br>    <span class="hljs-built_in">this</span>.wechatIds = wechatIds;<br>  &#125;<br><br>  <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">notify</span><span class="hljs-params">(NotificationEmergencyLevel level, String message)</span> &#123;<br>    <span class="hljs-keyword">if</span> (level.equals(NotificationEmergencyLevel.SEVERE)) &#123;<br>      <span class="hljs-comment">// ...è‡ªåŠ¨è¯­éŸ³ç”µè¯</span><br>    &#125; <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (level.equals(NotificationEmergencyLevel.URGENCY)) &#123;<br>      <span class="hljs-comment">// ...å‘å¾®ä¿¡</span><br>    &#125; <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (level.equals(NotificationEmergencyLevel.NORMAL)) &#123;<br>      <span class="hljs-comment">// ...å‘é‚®ä»¶</span><br>    &#125; <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (level.equals(NotificationEmergencyLevel.TRIVIAL)) &#123;<br>      <span class="hljs-comment">// ...å‘é‚®ä»¶</span><br>    &#125;<br>  &#125;<br>&#125;<br><br><span class="hljs-comment">// åœ¨APIç›‘æ§å‘Šè­¦çš„ä¾‹å­ä¸­ï¼Œæˆ‘ä»¬å¦‚ä¸‹æ–¹å¼æ¥ä½¿ç”¨Notificationç±»ï¼š</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">ErrorAlertHandler</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_">AlertHandler</span> &#123;<br>  <span class="hljs-keyword">public</span> <span class="hljs-title function_">ErrorAlertHandler</span><span class="hljs-params">(AlertRule rule, Notification notification)</span> &#123;<br>    <span class="hljs-built_in">super</span>(rule, notification);<br>  &#125;<br><br>  <span class="hljs-meta">@Override</span><br>  <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">check</span><span class="hljs-params">(ApiStatInfo apiStatInfo)</span> &#123;<br>    <span class="hljs-keyword">if</span> (apiStatInfo.getErrorCount()<br>        &gt; rule.getMatchedRule(apiStatInfo.getApi()).getMaxErrorCount()) &#123;<br>      notification.notify(NotificationEmergencyLevel.SEVERE, <span class="hljs-string">&quot;...&quot;</span>);<br>    &#125;<br>  &#125;<br>&#125;<br></code></pre></td></tr></table></figure><ol><li>Notification ç±»çš„ä»£ç å®ç°æœ‰ä¸€ä¸ªæœ€æ˜æ˜¾çš„é—®é¢˜ï¼Œé‚£å°±æ˜¯æœ‰å¾ˆå¤š if-else åˆ†æ”¯é€»è¾‘ã€‚å®é™…ä¸Šï¼Œå¦‚æœæ¯ä¸ªåˆ†æ”¯ä¸­çš„ä»£ç éƒ½ä¸å¤æ‚ï¼ŒåæœŸä¹Ÿæ²¡æœ‰æ— é™è†¨èƒ€çš„å¯èƒ½ï¼ˆå¢åŠ æ›´å¤š if-else åˆ†æ”¯åˆ¤æ–­ï¼‰ï¼Œé‚£è¿™æ ·çš„è®¾è®¡é—®é¢˜å¹¶ä¸å¤§ï¼Œæ²¡å¿…è¦éå¾—ä¸€å®šè¦æ‘’å¼ƒ if-else åˆ†æ”¯é€»è¾‘ã€‚</li><li>ä¸è¿‡ï¼ŒNotification çš„ä»£ç æ˜¾ç„¶ä¸ç¬¦åˆè¿™ä¸ªæ¡ä»¶ã€‚å› ä¸ºæ¯ä¸ª if-else åˆ†æ”¯ä¸­çš„ä»£ç é€»è¾‘éƒ½æ¯”è¾ƒå¤æ‚ï¼Œå‘é€é€šçŸ¥çš„æ‰€æœ‰é€»è¾‘éƒ½æ‰å †åœ¨ Notification ç±»ä¸­ã€‚æˆ‘ä»¬çŸ¥é“ï¼Œç±»çš„ä»£ç è¶Šå¤šï¼Œå°±è¶Šéš¾è¯»æ‡‚ï¼Œè¶Šéš¾ä¿®æ”¹ï¼Œç»´æŠ¤çš„æˆæœ¬ä¹Ÿå°±è¶Šé«˜ã€‚å¾ˆå¤šè®¾è®¡æ¨¡å¼éƒ½æ˜¯è¯•å›¾å°†åºå¤§çš„ç±»æ‹†åˆ†æˆæ›´ç»†å°çš„ç±»ï¼Œç„¶åå†é€šè¿‡æŸç§æ›´åˆç†çš„ç»“æ„ç»„è£…åœ¨ä¸€èµ·ã€‚</li><li>é’ˆå¯¹ Notification çš„ä»£ç ï¼Œæˆ‘ä»¬å°†ä¸åŒæ¸ é“çš„å‘é€é€»è¾‘å‰¥ç¦»å‡ºæ¥ï¼Œå½¢æˆç‹¬ç«‹çš„æ¶ˆæ¯å‘é€ç±»ï¼ˆMsgSender ç›¸å…³ç±»ï¼‰ã€‚å…¶ä¸­ï¼ŒNotification ç±»ç›¸å½“äºæŠ½è±¡ï¼ŒMsgSender ç±»ç›¸å½“äºå®ç°ï¼Œä¸¤è€…å¯ä»¥ç‹¬ç«‹å¼€å‘ï¼Œé€šè¿‡ç»„åˆå…³ç³»ï¼ˆä¹Ÿå°±æ˜¯æ¡¥æ¢ï¼‰ä»»æ„ç»„åˆåœ¨ä¸€èµ·ã€‚æ‰€è°“ä»»æ„ç»„åˆçš„æ„æ€å°±æ˜¯ï¼Œä¸åŒç´§æ€¥ç¨‹åº¦çš„æ¶ˆæ¯å’Œå‘é€æ¸ é“ä¹‹é—´çš„å¯¹åº”å…³ç³»ï¼Œä¸æ˜¯åœ¨ä»£ç ä¸­å›ºå®šå†™æ­»çš„ï¼Œæˆ‘ä»¬å¯ä»¥<code>åŠ¨æ€</code>åœ°å»æŒ‡å®šï¼ˆæ¯”å¦‚ï¼Œé€šè¿‡è¯»å–é…ç½®æ¥è·å–å¯¹åº”å…³ç³»ï¼‰ã€‚</li></ol><p>æŒ‰ç…§è¿™ä¸ªè®¾è®¡æ€è·¯ï¼Œæˆ‘ä»¬å¯¹ä»£ç è¿›è¡Œé‡æ„ã€‚é‡æ„ä¹‹åçš„ä»£ç å¦‚ä¸‹æ‰€ç¤ºï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">interface</span> <span class="hljs-title class_">MsgSender</span> &#123;<br>  <span class="hljs-keyword">void</span> <span class="hljs-title function_">send</span><span class="hljs-params">(String message)</span>;<br>&#125;<br><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">TelephoneMsgSender</span> <span class="hljs-keyword">implements</span> <span class="hljs-title class_">MsgSender</span> &#123;<br>  <span class="hljs-keyword">private</span> List&lt;String&gt; telephones;<br><br>  <span class="hljs-keyword">public</span> <span class="hljs-title function_">TelephoneMsgSender</span><span class="hljs-params">(List&lt;String&gt; telephones)</span> &#123;<br>    <span class="hljs-built_in">this</span>.telephones = telephones;<br>  &#125;<br><br>  <span class="hljs-meta">@Override</span><br>  <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">send</span><span class="hljs-params">(String message)</span> &#123;<br>    <span class="hljs-comment">// ...</span><br>  &#125;<br>&#125;<br><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">EmailMsgSender</span> <span class="hljs-keyword">implements</span> <span class="hljs-title class_">MsgSender</span> &#123;<br>  <span class="hljs-comment">// ä¸TelephoneMsgSenderä»£ç ç»“æ„ç±»ä¼¼ï¼Œæ‰€ä»¥çœç•¥...</span><br>&#125;<br><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">WechatMsgSender</span> <span class="hljs-keyword">implements</span> <span class="hljs-title class_">MsgSender</span> &#123;<br>  <span class="hljs-comment">// ä¸TelephoneMsgSenderä»£ç ç»“æ„ç±»ä¼¼ï¼Œæ‰€ä»¥çœç•¥...</span><br>&#125;<br><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">abstract</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Notification</span> &#123;<br>  <span class="hljs-keyword">protected</span> MsgSender msgSender;<br><br>  <span class="hljs-keyword">public</span> <span class="hljs-title function_">Notification</span><span class="hljs-params">(MsgSender msgSender)</span> &#123;<br>    <span class="hljs-built_in">this</span>.msgSender = msgSender;<br>  &#125;<br><br>  <span class="hljs-keyword">public</span> <span class="hljs-keyword">abstract</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">notify</span><span class="hljs-params">(String message)</span>;<br>&#125;<br><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">SevereNotification</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_">Notification</span> &#123;<br>  <span class="hljs-keyword">public</span> <span class="hljs-title function_">SevereNotification</span><span class="hljs-params">(MsgSender msgSender)</span> &#123;<br>    <span class="hljs-built_in">super</span>(msgSender);<br>  &#125;<br><br>  <span class="hljs-meta">@Override</span><br>  <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">notify</span><span class="hljs-params">(String message)</span> &#123;<br>    msgSender.send(message);<br>  &#125;<br>&#125;<br><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">UrgencyNotification</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_">Notification</span> &#123;<br>  <span class="hljs-comment">// ä¸SevereNotificationä»£ç ç»“æ„ç±»ä¼¼ï¼Œæ‰€ä»¥çœç•¥...</span><br>&#125;<br><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">NormalNotification</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_">Notification</span> &#123;<br>  <span class="hljs-comment">// ä¸SevereNotificationä»£ç ç»“æ„ç±»ä¼¼ï¼Œæ‰€ä»¥çœç•¥...</span><br>&#125;<br><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">TrivialNotification</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_">Notification</span> &#123;<br>  <span class="hljs-comment">// ä¸SevereNotificationä»£ç ç»“æ„ç±»ä¼¼ï¼Œæ‰€ä»¥çœç•¥...</span><br>&#125;<br></code></pre></td></tr></table></figure><h3 id="4ã€æ¡¥æ¥æ¨¡å¼çš„æ³¨æ„äº‹é¡¹å’Œç»†èŠ‚"><a href="#4ã€æ¡¥æ¥æ¨¡å¼çš„æ³¨æ„äº‹é¡¹å’Œç»†èŠ‚" class="headerlink" title="4ã€æ¡¥æ¥æ¨¡å¼çš„æ³¨æ„äº‹é¡¹å’Œç»†èŠ‚"></a>4ã€æ¡¥æ¥æ¨¡å¼çš„æ³¨æ„äº‹é¡¹å’Œç»†èŠ‚</h3><ol><li>å®ç°äº†æŠ½è±¡å’Œå®ç°éƒ¨åˆ†çš„åˆ†ç¦»ï¼Œä»è€Œæå¤§çš„æä¾›äº†ç³»ç»Ÿçš„çµæ´»æ€§ï¼Œè®©æŠ½è±¡éƒ¨åˆ†å’Œå®ç°éƒ¨åˆ†ç‹¬ç«‹å¼€æ¥ï¼Œè¿™æœ‰åŠ©äºç³»ç»Ÿè¿›è¡Œåˆ†å±‚è®¾è®¡ï¼Œä»è€Œäº§ç”Ÿæ›´å¥½çš„ç»“æ„åŒ–ç³»ç»Ÿã€‚</li><li>å¯¹äºç³»ç»Ÿçš„é«˜å±‚éƒ¨åˆ†ï¼Œåªéœ€è¦çŸ¥é“æŠ½è±¡éƒ¨åˆ†å’Œå®ç°éƒ¨åˆ†çš„æ¥å£å°±å¯ä»¥äº†ï¼Œå…¶å®ƒçš„éƒ¨åˆ†ç”±å…·ä½“ä¸šåŠ¡æ¥å®Œæˆã€‚</li><li>æ¡¥æ¥æ¨¡å¼æ›¿ä»£å¤šå±‚ç»§æ‰¿æ–¹æ¡ˆï¼Œå¯ä»¥å‡å°‘å­ç±»çš„ä¸ªæ•°ï¼Œé™ä½ç³»ç»Ÿçš„ç®¡ç†å’Œç»´æŠ¤æˆæœ¬</li><li>æ¡¥æ¥æ¨¡å¼çš„å¼•å…¥å¢åŠ äº†ç³»ç»Ÿçš„ç†è§£å’Œè®¾è®¡éš¾åº¦ï¼Œç”±äºèšåˆå…³è”å…³ç³»å»ºç«‹åœ¨æŠ½è±¡å±‚ï¼Œè¦æ±‚å¼€å‘è€…é’ˆå¯¹æŠ½è±¡è¿›è¡Œè®¾è®¡å’Œç¼–ç¨‹</li><li>æ¡¥æ¥æ¨¡å¼è¦æ±‚**æ­£ç¡®è¯†åˆ«å‡ºç³»ç»Ÿä¸­ä¸¤ä¸ªç‹¬ç«‹å˜åŒ–çš„ç»´åº¦(æŠ½è±¡ã€å’Œå®ç°)**ï¼Œå› æ­¤å…¶ä½¿ç”¨èŒƒå›´æœ‰ä¸€å®šçš„å±€é™æ€§ï¼Œå³éœ€è¦æœ‰è¿™æ ·çš„åº”ç”¨åœºæ™¯ã€‚</li></ol>]]></content>
    
    
    <categories>
      
      <category>è®¾è®¡æ¨¡å¼</category>
      
    </categories>
    
    
    <tags>
      
      <tag>è®¾è®¡æ¨¡å¼</tag>
      
      <tag>ç»“æ„å‹</tag>
      
      <tag>ä»£ç†</tag>
      
      <tag>æ¡¥æ¥</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>02-åˆ›å»ºå‹-å·¥å‚&amp;å»ºé€ è€…&amp;åŸå‹</title>
    <link href="/2022/09/22/02-chuang-jian-xing-gong-han-jian-zao-zhe-yuan-xing/"/>
    <url>/2022/09/22/02-chuang-jian-xing-gong-han-jian-zao-zhe-yuan-xing/</url>
    
    <content type="html"><![CDATA[<h2 id="ä¸€ã€å·¥å‚æ¨¡å¼ã€å¸¸ç”¨ã€‘"><a href="#ä¸€ã€å·¥å‚æ¨¡å¼ã€å¸¸ç”¨ã€‘" class="headerlink" title="ä¸€ã€å·¥å‚æ¨¡å¼ã€å¸¸ç”¨ã€‘"></a>ä¸€ã€å·¥å‚æ¨¡å¼ã€å¸¸ç”¨ã€‘</h2><ol><li>ä¸€èˆ¬æƒ…å†µä¸‹ï¼Œå·¥å‚æ¨¡å¼åˆ†ä¸ºä¸‰ç§æ›´åŠ ç»†åˆ†çš„ç±»å‹ï¼šç®€å•å·¥å‚ã€å·¥å‚æ–¹æ³•å’ŒæŠ½è±¡å·¥å‚ã€‚ä¸è¿‡ï¼Œåœ¨ GoF çš„ã€Šè®¾è®¡æ¨¡å¼ã€‹ä¸€ä¹¦ä¸­ï¼Œå®ƒå°†ç®€å•å·¥å‚æ¨¡å¼çœ‹ä½œæ˜¯å·¥å‚æ–¹æ³•æ¨¡å¼çš„ä¸€ç§ç‰¹ä¾‹ï¼Œæ‰€ä»¥å·¥å‚æ¨¡å¼åªè¢«åˆ†æˆäº†å·¥å‚æ–¹æ³•å’ŒæŠ½è±¡å·¥å‚ä¸¤ç±»ã€‚å®é™…ä¸Šï¼Œå‰é¢ä¸€ç§åˆ†ç±»æ–¹æ³•æ›´åŠ å¸¸è§ï¼Œæ‰€ä»¥ï¼Œåœ¨ä»Šå¤©çš„è®²è§£ä¸­ï¼Œæˆ‘ä»¬æ²¿ç”¨ç¬¬ä¸€ç§åˆ†ç±»æ–¹æ³•ã€‚</li><li>åœ¨è¿™ä¸‰ç§ç»†åˆ†çš„å·¥å‚æ¨¡å¼ä¸­ï¼Œç®€å•å·¥å‚ã€å·¥å‚æ–¹æ³•åŸç†æ¯”è¾ƒç®€å•ï¼Œåœ¨å®é™…çš„é¡¹ç›®ä¸­ä¹Ÿæ¯”è¾ƒå¸¸ç”¨ã€‚è€ŒæŠ½è±¡å·¥å‚çš„åŸç†ç¨å¾®å¤æ‚ç‚¹ï¼Œåœ¨å®é™…çš„é¡¹ç›®ä¸­ç›¸å¯¹ä¹Ÿä¸å¸¸ç”¨ã€‚æ‰€ä»¥ï¼Œé‡ç‚¹æ˜¯å‰ä¸¤ç§å·¥å‚æ¨¡å¼ã€‚å¯¹äºæŠ½è±¡å·¥å‚ï¼Œç¨å¾®äº†è§£ä¸€ä¸‹å³å¯ã€‚</li></ol><h3 id="1ã€ç®€å•å·¥å‚"><a href="#1ã€ç®€å•å·¥å‚" class="headerlink" title="1ã€ç®€å•å·¥å‚"></a>1ã€ç®€å•å·¥å‚</h3><p>ä»€ä¹ˆæ˜¯ç®€å•å·¥å‚æ¨¡å¼ï¼Ÿ</p><p>ç®€å•æ¥è¯´ï¼Œå°±æ˜¯å®šä¹‰ä¸€ä¸ªå·¥å‚ç±»ï¼Œå®ƒå¯ä»¥æ ¹æ®ä¸åŒçš„å‚æ•°è¿”å›ä¸åŒç±»çš„å®ä¾‹ï¼Œè¢«åˆ›å»ºçš„å®ä¾‹é€šå¸¸éƒ½å…·æœ‰å…±åŒçš„çˆ¶ç±»ã€‚</p><p>é€šè¿‡ä¸€ä¸ªä¾‹å­æ¥è§£é‡Šä¸€ä¸‹ç®€å•å·¥å‚ã€‚åœ¨ä¸‹é¢è¿™æ®µä»£ç ä¸­ï¼Œæˆ‘ä»¬æ ¹æ®é…ç½®æ–‡ä»¶çš„åç¼€ï¼ˆjsonã€xmlã€yamlã€propertiesï¼‰ï¼Œé€‰æ‹©ä¸åŒçš„è§£æå™¨ï¼ˆJsonRuleConfigParserã€XmlRuleConfigParserâ€¦â€¦ï¼‰ï¼Œå°†å­˜å‚¨åœ¨æ–‡ä»¶ä¸­çš„é…ç½®è§£ææˆå†…å­˜å¯¹è±¡ RuleConfigã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">RuleConfigSource</span> &#123;<br>  <span class="hljs-keyword">public</span> RuleConfig <span class="hljs-title function_">load</span><span class="hljs-params">(String ruleConfigFilePath)</span> &#123;<br>    <span class="hljs-type">String</span> <span class="hljs-variable">ruleConfigFileExtension</span> <span class="hljs-operator">=</span> getFileExtension(ruleConfigFilePath);<br>    <span class="hljs-type">IRuleConfigParser</span> <span class="hljs-variable">parser</span> <span class="hljs-operator">=</span> <span class="hljs-literal">null</span>;<br>    <span class="hljs-keyword">if</span> (<span class="hljs-string">&quot;json&quot;</span>.equalsIgnoreCase(ruleConfigFileExtension)) &#123;<br>      parser = <span class="hljs-keyword">new</span> <span class="hljs-title class_">JsonRuleConfigParser</span>();<br>    &#125; <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (<span class="hljs-string">&quot;xml&quot;</span>.equalsIgnoreCase(ruleConfigFileExtension)) &#123;<br>      parser = <span class="hljs-keyword">new</span> <span class="hljs-title class_">XmlRuleConfigParser</span>();<br>    &#125; <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (<span class="hljs-string">&quot;yaml&quot;</span>.equalsIgnoreCase(ruleConfigFileExtension)) &#123;<br>      parser = <span class="hljs-keyword">new</span> <span class="hljs-title class_">YamlRuleConfigParser</span>();<br>    &#125; <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (<span class="hljs-string">&quot;properties&quot;</span>.equalsIgnoreCase(ruleConfigFileExtension)) &#123;<br>      parser = <span class="hljs-keyword">new</span> <span class="hljs-title class_">PropertiesRuleConfigParser</span>();<br>    &#125; <span class="hljs-keyword">else</span> &#123;<br>      <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">InvalidRuleConfigException</span>(<br>             <span class="hljs-string">&quot;Rule config file format is not supported: &quot;</span> + ruleConfigFilePath);<br>    &#125;<br><br>    <span class="hljs-type">String</span> <span class="hljs-variable">configText</span> <span class="hljs-operator">=</span> <span class="hljs-string">&quot;&quot;</span>;<br>    <span class="hljs-comment">//ä»ruleConfigFilePathæ–‡ä»¶ä¸­è¯»å–é…ç½®æ–‡æœ¬åˆ°configTextä¸­</span><br>    <span class="hljs-type">RuleConfig</span> <span class="hljs-variable">ruleConfig</span> <span class="hljs-operator">=</span> parser.parse(configText);<br>    <span class="hljs-keyword">return</span> ruleConfig;<br>  &#125;<br><br>  <span class="hljs-keyword">private</span> String <span class="hljs-title function_">getFileExtension</span><span class="hljs-params">(String filePath)</span> &#123;<br>    <span class="hljs-comment">//...è§£ææ–‡ä»¶åè·å–æ‰©å±•åï¼Œæ¯”å¦‚rule.jsonï¼Œè¿”å›json</span><br>    <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;json&quot;</span>;<br>  &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>ä¸ºäº†è®©ä»£ç é€»è¾‘æ›´åŠ æ¸…æ™°ï¼Œå¯è¯»æ€§æ›´å¥½ï¼Œæˆ‘ä»¬è¦å–„äºå°†åŠŸèƒ½ç‹¬ç«‹çš„ä»£ç å—å°è£…æˆå‡½æ•°ã€‚æŒ‰ç…§è¿™ä¸ªè®¾è®¡æ€è·¯ï¼Œæˆ‘ä»¬å¯ä»¥å°†ä»£ç ä¸­æ¶‰åŠ parser åˆ›å»ºçš„éƒ¨åˆ†é€»è¾‘å‰¥ç¦»å‡ºæ¥ï¼ŒæŠ½è±¡æˆ createParser() å‡½æ•°ã€‚é‡æ„ä¹‹åçš„ä»£ç å¦‚ä¸‹æ‰€ç¤ºï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><code class="hljs java">  <span class="hljs-keyword">public</span> RuleConfig <span class="hljs-title function_">load</span><span class="hljs-params">(String ruleConfigFilePath)</span> &#123;<br>    <span class="hljs-type">String</span> <span class="hljs-variable">ruleConfigFileExtension</span> <span class="hljs-operator">=</span> getFileExtension(ruleConfigFilePath);<br>    <span class="hljs-type">IRuleConfigParser</span> <span class="hljs-variable">parser</span> <span class="hljs-operator">=</span> createParser(ruleConfigFileExtension);<br>    <span class="hljs-keyword">if</span> (parser == <span class="hljs-literal">null</span>) &#123;<br>      <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">InvalidRuleConfigException</span>(<br>              <span class="hljs-string">&quot;Rule config file format is not supported: &quot;</span> + ruleConfigFilePath);<br>    &#125;<br><br>    <span class="hljs-type">String</span> <span class="hljs-variable">configText</span> <span class="hljs-operator">=</span> <span class="hljs-string">&quot;&quot;</span>;<br>    <span class="hljs-comment">//ä»ruleConfigFilePathæ–‡ä»¶ä¸­è¯»å–é…ç½®æ–‡æœ¬åˆ°configTextä¸­</span><br>    <span class="hljs-type">RuleConfig</span> <span class="hljs-variable">ruleConfig</span> <span class="hljs-operator">=</span> parser.parse(configText);<br>    <span class="hljs-keyword">return</span> ruleConfig;<br>  &#125;<br><br>  <span class="hljs-keyword">private</span> String <span class="hljs-title function_">getFileExtension</span><span class="hljs-params">(String filePath)</span> &#123;<br>    <span class="hljs-comment">//...è§£ææ–‡ä»¶åè·å–æ‰©å±•åï¼Œæ¯”å¦‚rule.jsonï¼Œè¿”å›json</span><br>    <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;json&quot;</span>;<br>  &#125;<br><br>  <span class="hljs-keyword">private</span> IRuleConfigParser <span class="hljs-title function_">createParser</span><span class="hljs-params">(String configFormat)</span> &#123;<br>    <span class="hljs-type">IRuleConfigParser</span> <span class="hljs-variable">parser</span> <span class="hljs-operator">=</span> <span class="hljs-literal">null</span>;<br>    <span class="hljs-keyword">if</span> (<span class="hljs-string">&quot;json&quot;</span>.equalsIgnoreCase(configFormat)) &#123;<br>      parser = <span class="hljs-keyword">new</span> <span class="hljs-title class_">JsonRuleConfigParser</span>();<br>    &#125; <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (<span class="hljs-string">&quot;xml&quot;</span>.equalsIgnoreCase(configFormat)) &#123;<br>      parser = <span class="hljs-keyword">new</span> <span class="hljs-title class_">XmlRuleConfigParser</span>();<br>    &#125; <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (<span class="hljs-string">&quot;yaml&quot;</span>.equalsIgnoreCase(configFormat)) &#123;<br>      parser = <span class="hljs-keyword">new</span> <span class="hljs-title class_">YamlRuleConfigParser</span>();<br>    &#125; <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (<span class="hljs-string">&quot;properties&quot;</span>.equalsIgnoreCase(configFormat)) &#123;<br>      parser = <span class="hljs-keyword">new</span> <span class="hljs-title class_">PropertiesRuleConfigParser</span>();<br>    &#125;<br>    <span class="hljs-keyword">return</span> parser;<br>  &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>ä¸ºäº†è®©ç±»çš„èŒè´£æ›´åŠ å•ä¸€(<strong>è®¾è®¡æ¨¡å¼åŸåˆ™ä¸­çš„å•ä¸€èŒè´£</strong>ï¼Œ)ã€ä»£ç æ›´åŠ æ¸…æ™°ï¼Œæˆ‘ä»¬è¿˜å¯ä»¥è¿›ä¸€æ­¥å°† createParser() å‡½æ•°å‰¥ç¦»åˆ°ä¸€ä¸ªç‹¬ç«‹çš„ç±»ä¸­ï¼Œè®©è¿™ä¸ªç±»åªè´Ÿè´£å¯¹è±¡çš„åˆ›å»ºã€‚è€Œè¿™ä¸ªç±»å°±æ˜¯æˆ‘ä»¬ç°åœ¨è¦è®²çš„ç®€å•å·¥å‚æ¨¡å¼ç±»ã€‚å…·ä½“çš„ä»£ç å¦‚ä¸‹æ‰€ç¤ºï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">RuleConfigSource</span> &#123;<br>  <span class="hljs-keyword">public</span> RuleConfig <span class="hljs-title function_">load</span><span class="hljs-params">(String ruleConfigFilePath)</span> &#123;<br>    <span class="hljs-type">String</span> <span class="hljs-variable">ruleConfigFileExtension</span> <span class="hljs-operator">=</span> getFileExtension(ruleConfigFilePath);<br>    <span class="hljs-type">IRuleConfigParser</span> <span class="hljs-variable">parser</span> <span class="hljs-operator">=</span> RuleConfigParserFactory.createParser(ruleConfigFileExtension);<br>    <span class="hljs-keyword">if</span> (parser == <span class="hljs-literal">null</span>) &#123;<br>      <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">InvalidRuleConfigException</span>(<br>              <span class="hljs-string">&quot;Rule config file format is not supported: &quot;</span> + ruleConfigFilePath);<br>    &#125;<br><br>    <span class="hljs-type">String</span> <span class="hljs-variable">configText</span> <span class="hljs-operator">=</span> <span class="hljs-string">&quot;&quot;</span>;<br>    <span class="hljs-comment">//ä»ruleConfigFilePathæ–‡ä»¶ä¸­è¯»å–é…ç½®æ–‡æœ¬åˆ°configTextä¸­</span><br>    <span class="hljs-type">RuleConfig</span> <span class="hljs-variable">ruleConfig</span> <span class="hljs-operator">=</span> parser.parse(configText);<br>    <span class="hljs-keyword">return</span> ruleConfig;<br>  &#125;<br><br>  <span class="hljs-keyword">private</span> String <span class="hljs-title function_">getFileExtension</span><span class="hljs-params">(String filePath)</span> &#123;<br>    <span class="hljs-comment">//...è§£ææ–‡ä»¶åè·å–æ‰©å±•åï¼Œæ¯”å¦‚rule.jsonï¼Œè¿”å›json</span><br>    <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;json&quot;</span>;<br>  &#125;<br>&#125;<br><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">RuleConfigParserFactory</span> &#123;<br>  <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> IRuleConfigParser <span class="hljs-title function_">createParser</span><span class="hljs-params">(String configFormat)</span> &#123;<br>    <span class="hljs-type">IRuleConfigParser</span> <span class="hljs-variable">parser</span> <span class="hljs-operator">=</span> <span class="hljs-literal">null</span>;<br>    <span class="hljs-keyword">if</span> (<span class="hljs-string">&quot;json&quot;</span>.equalsIgnoreCase(configFormat)) &#123;<br>      parser = <span class="hljs-keyword">new</span> <span class="hljs-title class_">JsonRuleConfigParser</span>();<br>    &#125; <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (<span class="hljs-string">&quot;xml&quot;</span>.equalsIgnoreCase(configFormat)) &#123;<br>      parser = <span class="hljs-keyword">new</span> <span class="hljs-title class_">XmlRuleConfigParser</span>();<br>    &#125; <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (<span class="hljs-string">&quot;yaml&quot;</span>.equalsIgnoreCase(configFormat)) &#123;<br>      parser = <span class="hljs-keyword">new</span> <span class="hljs-title class_">YamlRuleConfigParser</span>();<br>    &#125; <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (<span class="hljs-string">&quot;properties&quot;</span>.equalsIgnoreCase(configFormat)) &#123;<br>      parser = <span class="hljs-keyword">new</span> <span class="hljs-title class_">PropertiesRuleConfigParser</span>();<br>    &#125;<br>    <span class="hljs-keyword">return</span> parser;<br>  &#125;<br>&#125;<br></code></pre></td></tr></table></figure><ol><li>åœ¨ä¸Šé¢çš„ä»£ç å®ç°ä¸­ï¼Œæˆ‘ä»¬æ¯æ¬¡è°ƒç”¨ RuleConfigParserFactory çš„ createParser() çš„æ—¶å€™ï¼Œéƒ½è¦åˆ›å»ºä¸€ä¸ªæ–°çš„ parserã€‚</li><li>å®é™…ä¸Šï¼Œå¦‚æœ parser å¯ä»¥å¤ç”¨ï¼Œä¸ºäº†èŠ‚çœå†…å­˜å’Œå¯¹è±¡åˆ›å»ºçš„æ—¶é—´ï¼Œæˆ‘ä»¬å¯ä»¥å°† parser äº‹å…ˆåˆ›å»ºå¥½ç¼“å­˜èµ·æ¥ã€‚å½“è°ƒç”¨ createParser() å‡½æ•°çš„æ—¶å€™ï¼Œæˆ‘ä»¬ä»ç¼“å­˜ä¸­å–å‡º parser å¯¹è±¡ç›´æ¥ä½¿ç”¨ã€‚è¿™æœ‰ç‚¹ç±»ä¼¼å•ä¾‹æ¨¡å¼å’Œç®€å•å·¥å‚æ¨¡å¼çš„ç»“åˆï¼Œå…·ä½“çš„ä»£ç å®ç°å¦‚ä¸‹æ‰€ç¤ºã€‚åœ¨æ¥ä¸‹æ¥çš„è®²è§£ä¸­ï¼Œæˆ‘ä»¬æŠŠä¸Šä¸€ç§å®ç°æ–¹æ³•å«ä½œç®€å•å·¥å‚æ¨¡å¼çš„ç¬¬ä¸€ç§å®ç°æ–¹æ³•ï¼ŒæŠŠä¸‹é¢è¿™ç§å®ç°æ–¹æ³•å«ä½œç®€å•å·¥å‚æ¨¡å¼çš„ç¬¬äºŒç§å®ç°æ–¹æ³•ã€‚</li></ol><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">RuleConfigParserFactory</span> &#123;<br>  <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> Map&lt;String, RuleConfigParser&gt; cachedParsers = <span class="hljs-keyword">new</span> <span class="hljs-title class_">HashMap</span>&lt;&gt;();<br><br>  <span class="hljs-keyword">static</span> &#123;<br>    cachedParsers.put(<span class="hljs-string">&quot;json&quot;</span>, <span class="hljs-keyword">new</span> <span class="hljs-title class_">JsonRuleConfigParser</span>());<br>    cachedParsers.put(<span class="hljs-string">&quot;xml&quot;</span>, <span class="hljs-keyword">new</span> <span class="hljs-title class_">XmlRuleConfigParser</span>());<br>    cachedParsers.put(<span class="hljs-string">&quot;yaml&quot;</span>, <span class="hljs-keyword">new</span> <span class="hljs-title class_">YamlRuleConfigParser</span>());<br>    cachedParsers.put(<span class="hljs-string">&quot;properties&quot;</span>, <span class="hljs-keyword">new</span> <span class="hljs-title class_">PropertiesRuleConfigParser</span>());<br>  &#125;<br><br>  <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> IRuleConfigParser <span class="hljs-title function_">createParser</span><span class="hljs-params">(String configFormat)</span> &#123;<br>    <span class="hljs-keyword">if</span> (configFormat == <span class="hljs-literal">null</span> || configFormat.isEmpty()) &#123;<br>      <span class="hljs-keyword">return</span> <span class="hljs-literal">null</span>;<span class="hljs-comment">//è¿”å›nullè¿˜æ˜¯IllegalArgumentExceptionå…¨å‡­ä½ è‡ªå·±è¯´äº†ç®—</span><br>    &#125;<br>    <span class="hljs-type">IRuleConfigParser</span> <span class="hljs-variable">parser</span> <span class="hljs-operator">=</span> cachedParsers.get(configFormat.toLowerCase());<br>    <span class="hljs-keyword">return</span> parser;<br>  &#125;<br>&#125;<br></code></pre></td></tr></table></figure><ol><li>å¯¹äºä¸Šé¢ä¸¤ç§ç®€å•å·¥å‚æ¨¡å¼çš„å®ç°æ–¹æ³•ï¼Œå¦‚æœæˆ‘ä»¬è¦æ·»åŠ æ–°çš„ parserï¼Œé‚£åŠ¿å¿…è¦æ”¹åŠ¨åˆ° RuleConfigParserFactory çš„ä»£ç ï¼Œé‚£è¿™æ˜¯ä¸æ˜¯è¿åå¼€é—­åŸåˆ™å‘¢ï¼Ÿå®é™…ä¸Šï¼Œå¦‚æœä¸æ˜¯éœ€è¦é¢‘ç¹åœ°æ·»åŠ æ–°çš„ parserï¼Œåªæ˜¯å¶å°”ä¿®æ”¹ä¸€ä¸‹ RuleConfigParserFactory ä»£ç ï¼Œç¨å¾®ä¸ç¬¦åˆå¼€é—­åŸåˆ™ï¼Œä¹Ÿæ˜¯å®Œå…¨å¯ä»¥æ¥å—çš„ã€‚</li><li>é™¤æ­¤ä¹‹å¤–ï¼Œåœ¨ RuleConfigParserFactory çš„ç¬¬ä¸€ç§ä»£ç å®ç°ä¸­ï¼Œæœ‰ä¸€ç»„ if åˆ†æ”¯åˆ¤æ–­é€»è¾‘ï¼Œæ˜¯ä¸æ˜¯åº”è¯¥ç”¨å¤šæ€æˆ–å…¶ä»–è®¾è®¡æ¨¡å¼æ¥æ›¿ä»£å‘¢ï¼Ÿå®é™…ä¸Šï¼Œå¦‚æœ if åˆ†æ”¯å¹¶ä¸æ˜¯å¾ˆå¤šï¼Œä»£ç ä¸­æœ‰ if åˆ†æ”¯ä¹Ÿæ˜¯å®Œå…¨å¯ä»¥æ¥å—çš„ã€‚åº”ç”¨å¤šæ€æˆ–è®¾è®¡æ¨¡å¼æ¥æ›¿ä»£ if åˆ†æ”¯åˆ¤æ–­é€»è¾‘ï¼Œä¹Ÿå¹¶ä¸æ˜¯æ²¡æœ‰ä»»ä½•ç¼ºç‚¹çš„ï¼Œå®ƒè™½ç„¶æé«˜äº†ä»£ç çš„æ‰©å±•æ€§ï¼Œæ›´åŠ ç¬¦åˆ<strong>å¼€é—­åŸåˆ™</strong>ï¼Œä½†ä¹Ÿå¢åŠ äº†ç±»çš„ä¸ªæ•°ï¼Œç‰ºç‰²äº†ä»£ç çš„å¯è¯»æ€§ã€‚</li></ol><h3 id="2ã€å·¥å‚æ¨¡å¼"><a href="#2ã€å·¥å‚æ¨¡å¼" class="headerlink" title="2ã€å·¥å‚æ¨¡å¼"></a>2ã€å·¥å‚æ¨¡å¼</h3><p>çœ‹ä¸€ä¸ªéœ€æ±‚ï¼šå®¢æˆ·åœ¨ç‚¹æŠ«è¨æ—¶ï¼Œå¯ä»¥ç‚¹ä¸åŒå£å‘³çš„æŠ«è¨ï¼Œæ¯”å¦‚ åŒ—äº¬çš„å¥¶é…ªpizzaã€ åŒ—äº¬çš„èƒ¡æ¤’pizza æˆ–è€…æ˜¯ä¼¦æ•¦çš„å¥¶é…ªpizzaã€ä¼¦æ•¦çš„èƒ¡æ¤’pizzaã€‚</p><p>å¦‚ä½•å®ç°ï¼Ÿ</p><p>æ€è·¯ä¸€ï¼šä½¿ç”¨ç®€å•å·¥å‚æ¨¡å¼ï¼Œåˆ›å»ºä¸åŒçš„ç®€å•å·¥å‚ç±»ï¼Œæ¯”å¦‚BJPizzaSimpleFactoryã€ LDPizzaSimpleFactory ç­‰ç­‰.ä»å½“å‰è¿™ä¸ªæ¡ˆä¾‹æ¥è¯´ï¼Œä¹Ÿæ˜¯å¯ä»¥çš„ï¼Œä½†æ˜¯è€ƒè™‘åˆ°é¡¹ç›®çš„ è§„æ¨¡ï¼Œä»¥åŠè½¯ä»¶çš„å¯ç»´æŠ¤æ€§ã€å¯æ‰©å±•æ€§å¹¶ä¸æ˜¯ç‰¹åˆ«å¥½</p><p>æ€è·¯äºŒï¼šä½¿ç”¨å·¥å‚æ¨¡å¼</p><p>å·¥å‚æ–¹æ³•æ¨¡å¼è®¾è®¡æ–¹æ¡ˆï¼šå°†æŠ«è¨é¡¹ç›®çš„å®ä¾‹åŒ–åŠŸèƒ½æŠ½è±¡æˆæŠ½è±¡æ–¹æ³•ï¼Œåœ¨ä¸åŒçš„å£å‘³ç‚¹ é¤å­ç±»ä¸­å…·ä½“å®ç°ã€‚ </p><p>å·¥å‚æ–¹æ³•æ¨¡å¼ï¼šå®šä¹‰äº†ä¸€ä¸ªåˆ›å»ºå¯¹è±¡çš„æŠ½è±¡æ–¹æ³•ï¼Œç”±å­ç±»å†³å®šè¦å®ä¾‹åŒ–çš„ç±»ã€‚å·¥å‚æ–¹æ³•æ¨¡å¼å°†å¯¹è±¡çš„å®ä¾‹åŒ–æ¨è¿Ÿåˆ°å­ç±»ã€‚</p><p>å†æ¥ç€ä¸Šè¿°ç®€å•å·¥å‚æ¨¡å¼çš„ä¾‹å­ï¼Œè‹¥æ˜¯éè¦å»æ‰ifå‘¢ï¼Œæ€ä¹ˆåŠï¼Ÿå°†ä»£ç é‡æ„åï¼Œä»£ç å¦‚ä¸‹ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">interface</span> <span class="hljs-title class_">IRuleConfigParserFactory</span> &#123;<br>  IRuleConfigParser <span class="hljs-title function_">createParser</span><span class="hljs-params">()</span>;<br>&#125;<br><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">JsonRuleConfigParserFactory</span> <span class="hljs-keyword">implements</span> <span class="hljs-title class_">IRuleConfigParserFactory</span> &#123;<br>  <span class="hljs-meta">@Override</span><br>  <span class="hljs-keyword">public</span> IRuleConfigParser <span class="hljs-title function_">createParser</span><span class="hljs-params">()</span> &#123;<br>    <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">JsonRuleConfigParser</span>();<br>  &#125;<br>&#125;<br><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">XmlRuleConfigParserFactory</span> <span class="hljs-keyword">implements</span> <span class="hljs-title class_">IRuleConfigParserFactory</span> &#123;<br>  <span class="hljs-meta">@Override</span><br>  <span class="hljs-keyword">public</span> IRuleConfigParser <span class="hljs-title function_">createParser</span><span class="hljs-params">()</span> &#123;<br>    <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">XmlRuleConfigParser</span>();<br>  &#125;<br>&#125;<br><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">YamlRuleConfigParserFactory</span> <span class="hljs-keyword">implements</span> <span class="hljs-title class_">IRuleConfigParserFactory</span> &#123;<br>  <span class="hljs-meta">@Override</span><br>  <span class="hljs-keyword">public</span> IRuleConfigParser <span class="hljs-title function_">createParser</span><span class="hljs-params">()</span> &#123;<br>    <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">YamlRuleConfigParser</span>();<br>  &#125;<br>&#125;<br><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">PropertiesRuleConfigParserFactory</span> <span class="hljs-keyword">implements</span> <span class="hljs-title class_">IRuleConfigParserFactory</span> &#123;<br>  <span class="hljs-meta">@Override</span><br>  <span class="hljs-keyword">public</span> IRuleConfigParser <span class="hljs-title function_">createParser</span><span class="hljs-params">()</span> &#123;<br>    <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">PropertiesRuleConfigParser</span>();<br>  &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>å®é™…ä¸Šï¼Œè¿™å°±æ˜¯å·¥å‚æ–¹æ³•æ¨¡å¼çš„å…¸å‹ä»£ç å®ç°ã€‚è¿™æ ·å½“æˆ‘ä»¬æ–°å¢ä¸€ç§ parser çš„æ—¶å€™ï¼Œåªéœ€è¦æ–°å¢ä¸€ä¸ªå®ç°äº† IRuleConfigParserFactory æ¥å£çš„ Factory ç±»å³å¯ã€‚æ‰€ä»¥ï¼Œå·¥å‚æ–¹æ³•æ¨¡å¼æ¯”èµ·ç®€å•å·¥å‚æ¨¡å¼æ›´åŠ ç¬¦åˆå¼€é—­åŸåˆ™ã€‚</p><p>ä½†æ˜¯ä¸Šè¿°ä»£ç å­˜åœ¨å¾ˆå¤§çš„é—®é¢˜ã€‚é—®é¢˜å­˜åœ¨äºè¿™äº›å·¥å‚ç±»çš„ä½¿ç”¨ä¸Šã€‚æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬çœ‹ä¸€ä¸‹ï¼Œå¦‚ä½•ç”¨è¿™äº›å·¥å‚ç±»æ¥å®ç° RuleConfigSource çš„ load() å‡½æ•°ã€‚å…·ä½“çš„ä»£ç å¦‚ä¸‹æ‰€ç¤ºï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">RuleConfigSource</span> &#123;<br>  <span class="hljs-keyword">public</span> RuleConfig <span class="hljs-title function_">load</span><span class="hljs-params">(String ruleConfigFilePath)</span> &#123;<br>    <span class="hljs-type">String</span> <span class="hljs-variable">ruleConfigFileExtension</span> <span class="hljs-operator">=</span> getFileExtension(ruleConfigFilePath);<br><br>    <span class="hljs-type">IRuleConfigParserFactory</span> <span class="hljs-variable">parserFactory</span> <span class="hljs-operator">=</span> <span class="hljs-literal">null</span>;<br>    <span class="hljs-keyword">if</span> (<span class="hljs-string">&quot;json&quot;</span>.equalsIgnoreCase(ruleConfigFileExtension)) &#123;<br>      parserFactory = <span class="hljs-keyword">new</span> <span class="hljs-title class_">JsonRuleConfigParserFactory</span>();<br>    &#125; <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (<span class="hljs-string">&quot;xml&quot;</span>.equalsIgnoreCase(ruleConfigFileExtension)) &#123;<br>      parserFactory = <span class="hljs-keyword">new</span> <span class="hljs-title class_">XmlRuleConfigParserFactory</span>();<br>    &#125; <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (<span class="hljs-string">&quot;yaml&quot;</span>.equalsIgnoreCase(ruleConfigFileExtension)) &#123;<br>      parserFactory = <span class="hljs-keyword">new</span> <span class="hljs-title class_">YamlRuleConfigParserFactory</span>();<br>    &#125; <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (<span class="hljs-string">&quot;properties&quot;</span>.equalsIgnoreCase(ruleConfigFileExtension)) &#123;<br>      parserFactory = <span class="hljs-keyword">new</span> <span class="hljs-title class_">PropertiesRuleConfigParserFactory</span>();<br>    &#125; <span class="hljs-keyword">else</span> &#123;<br>      <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">InvalidRuleConfigException</span>(<span class="hljs-string">&quot;Rule config file format is not supported: &quot;</span> + ruleConfigFilePath);<br>    &#125;<br>    <span class="hljs-type">IRuleConfigParser</span> <span class="hljs-variable">parser</span> <span class="hljs-operator">=</span> parserFactory.createParser();<br><br>    <span class="hljs-type">String</span> <span class="hljs-variable">configText</span> <span class="hljs-operator">=</span> <span class="hljs-string">&quot;&quot;</span>;<br>    <span class="hljs-comment">//ä»ruleConfigFilePathæ–‡ä»¶ä¸­è¯»å–é…ç½®æ–‡æœ¬åˆ°configTextä¸­</span><br>    <span class="hljs-type">RuleConfig</span> <span class="hljs-variable">ruleConfig</span> <span class="hljs-operator">=</span> parser.parse(configText);<br>    <span class="hljs-keyword">return</span> ruleConfig;<br>  &#125;<br><br>  <span class="hljs-keyword">private</span> String <span class="hljs-title function_">getFileExtension</span><span class="hljs-params">(String filePath)</span> &#123;<br>    <span class="hljs-comment">//...è§£ææ–‡ä»¶åè·å–æ‰©å±•åï¼Œæ¯”å¦‚rule.jsonï¼Œè¿”å›json</span><br>    <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;json&quot;</span>;<br>  &#125;<br>&#125;<br></code></pre></td></tr></table></figure><ol><li>ä»ä¸Šé¢çš„ä»£ç å®ç°æ¥çœ‹ï¼Œå·¥å‚ç±»å¯¹è±¡çš„åˆ›å»ºé€»è¾‘åˆè€¦åˆè¿›äº† load() å‡½æ•°ä¸­ï¼Œè·Ÿæˆ‘ä»¬æœ€åˆçš„ä»£ç ç‰ˆæœ¬éå¸¸ç›¸ä¼¼ï¼Œå¼•å…¥å·¥å‚æ–¹æ³•éä½†æ²¡æœ‰è§£å†³é—®é¢˜ï¼Œåå€’è®©è®¾è®¡å˜å¾—æ›´åŠ å¤æ‚äº†ã€‚</li><li>æˆ‘ä»¬å¯ä»¥ä¸ºå·¥å‚ç±»å†åˆ›å»ºä¸€ä¸ªç®€å•å·¥å‚ï¼Œä¹Ÿå°±æ˜¯å·¥å‚çš„å·¥å‚ï¼Œç”¨æ¥åˆ›å»ºå·¥å‚ç±»å¯¹è±¡ã€‚è¿™æ®µè¯å¬èµ·æ¥æœ‰ç‚¹ç»•ï¼Œä»£ç å®ç°å‡ºæ¥ï¼Œä¸€çœ‹å°±èƒ½æ˜ç™½ã€‚å…¶ä¸­ï¼ŒRuleConfigParserFactoryMap ç±»æ˜¯åˆ›å»ºå·¥å‚å¯¹è±¡çš„å·¥å‚ç±»ï¼ŒgetParserFactory() è¿”å›çš„æ˜¯ç¼“å­˜å¥½çš„å•ä¾‹å·¥å‚å¯¹è±¡ã€‚</li></ol><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">RuleConfigSource</span> &#123;<br>  <span class="hljs-keyword">public</span> RuleConfig <span class="hljs-title function_">load</span><span class="hljs-params">(String ruleConfigFilePath)</span> &#123;<br>    <span class="hljs-type">String</span> <span class="hljs-variable">ruleConfigFileExtension</span> <span class="hljs-operator">=</span> getFileExtension(ruleConfigFilePath);<br><br>    <span class="hljs-type">IRuleConfigParserFactory</span> <span class="hljs-variable">parserFactory</span> <span class="hljs-operator">=</span> RuleConfigParserFactoryMap.getParserFactory(ruleConfigFileExtension);<br>    <span class="hljs-keyword">if</span> (parserFactory == <span class="hljs-literal">null</span>) &#123;<br>      <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">InvalidRuleConfigException</span>(<span class="hljs-string">&quot;Rule config file format is not supported: &quot;</span> + ruleConfigFilePath);<br>    &#125;<br>    <span class="hljs-type">IRuleConfigParser</span> <span class="hljs-variable">parser</span> <span class="hljs-operator">=</span> parserFactory.createParser();<br><br>    <span class="hljs-type">String</span> <span class="hljs-variable">configText</span> <span class="hljs-operator">=</span> <span class="hljs-string">&quot;&quot;</span>;<br>    <span class="hljs-comment">//ä»ruleConfigFilePathæ–‡ä»¶ä¸­è¯»å–é…ç½®æ–‡æœ¬åˆ°configTextä¸­</span><br>    <span class="hljs-type">RuleConfig</span> <span class="hljs-variable">ruleConfig</span> <span class="hljs-operator">=</span> parser.parse(configText);<br>    <span class="hljs-keyword">return</span> ruleConfig;<br>  &#125;<br><br>  <span class="hljs-keyword">private</span> String <span class="hljs-title function_">getFileExtension</span><span class="hljs-params">(String filePath)</span> &#123;<br>    <span class="hljs-comment">//...è§£ææ–‡ä»¶åè·å–æ‰©å±•åï¼Œæ¯”å¦‚rule.jsonï¼Œè¿”å›json</span><br>    <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;json&quot;</span>;<br>  &#125;<br>&#125;<br><br><span class="hljs-comment">//å› ä¸ºå·¥å‚ç±»åªåŒ…å«æ–¹æ³•ï¼Œä¸åŒ…å«æˆå‘˜å˜é‡ï¼Œå®Œå…¨å¯ä»¥å¤ç”¨ï¼Œ</span><br><span class="hljs-comment">//ä¸éœ€è¦æ¯æ¬¡éƒ½åˆ›å»ºæ–°çš„å·¥å‚ç±»å¯¹è±¡ï¼Œæ‰€ä»¥ï¼Œç®€å•å·¥å‚æ¨¡å¼çš„ç¬¬äºŒç§å®ç°æ€è·¯æ›´åŠ åˆé€‚ã€‚</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">RuleConfigParserFactoryMap</span> &#123; <span class="hljs-comment">//å·¥å‚çš„å·¥å‚</span><br>  <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> Map&lt;String, IRuleConfigParserFactory&gt; cachedFactories = <span class="hljs-keyword">new</span> <span class="hljs-title class_">HashMap</span>&lt;&gt;();<br><br>  <span class="hljs-keyword">static</span> &#123;<br>    cachedFactories.put(<span class="hljs-string">&quot;json&quot;</span>, <span class="hljs-keyword">new</span> <span class="hljs-title class_">JsonRuleConfigParserFactory</span>());<br>    cachedFactories.put(<span class="hljs-string">&quot;xml&quot;</span>, <span class="hljs-keyword">new</span> <span class="hljs-title class_">XmlRuleConfigParserFactory</span>());<br>    cachedFactories.put(<span class="hljs-string">&quot;yaml&quot;</span>, <span class="hljs-keyword">new</span> <span class="hljs-title class_">YamlRuleConfigParserFactory</span>());<br>    cachedFactories.put(<span class="hljs-string">&quot;properties&quot;</span>, <span class="hljs-keyword">new</span> <span class="hljs-title class_">PropertiesRuleConfigParserFactory</span>());<br>  &#125;<br><br>  <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> IRuleConfigParserFactory <span class="hljs-title function_">getParserFactory</span><span class="hljs-params">(String type)</span> &#123;<br>    <span class="hljs-keyword">if</span> (type == <span class="hljs-literal">null</span> || type.isEmpty()) &#123;<br>      <span class="hljs-keyword">return</span> <span class="hljs-literal">null</span>;<br>    &#125;<br>    <span class="hljs-type">IRuleConfigParserFactory</span> <span class="hljs-variable">parserFactory</span> <span class="hljs-operator">=</span> cachedFactories.get(type.toLowerCase());<br>    <span class="hljs-keyword">return</span> parserFactory;<br>  &#125;<br>&#125;<br></code></pre></td></tr></table></figure><ol><li>å½“æˆ‘ä»¬éœ€è¦æ·»åŠ æ–°çš„è§„åˆ™é…ç½®è§£æå™¨çš„æ—¶å€™ï¼Œæˆ‘ä»¬åªéœ€è¦åˆ›å»ºæ–°çš„ parser ç±»å’Œ parser factory ç±»ï¼Œå¹¶ä¸”åœ¨ RuleConfigParserFactoryMap ç±»ä¸­ï¼Œå°†æ–°çš„ parser factory å¯¹è±¡æ·»åŠ åˆ° cachedFactories ä¸­å³å¯ã€‚ä»£ç çš„æ”¹åŠ¨éå¸¸å°‘ï¼ŒåŸºæœ¬ä¸Šç¬¦åˆå¼€é—­åŸåˆ™ã€‚</li><li>å®é™…ä¸Šï¼Œå¯¹äºè§„åˆ™é…ç½®æ–‡ä»¶è§£æè¿™ä¸ªåº”ç”¨åœºæ™¯æ¥è¯´ï¼Œå·¥å‚æ¨¡å¼éœ€è¦é¢å¤–åˆ›å»ºè¯¸å¤š Factory ç±»ï¼Œä¹Ÿä¼šå¢åŠ ä»£ç çš„å¤æ‚æ€§ï¼Œè€Œä¸”ï¼Œæ¯ä¸ª Factory ç±»åªæ˜¯åšç®€å•çš„ new æ“ä½œï¼ŒåŠŸèƒ½éå¸¸å•è–„ï¼ˆåªæœ‰ä¸€è¡Œä»£ç ï¼‰ï¼Œä¹Ÿæ²¡å¿…è¦è®¾è®¡æˆç‹¬ç«‹çš„ç±»ï¼Œæ‰€ä»¥ï¼Œåœ¨è¿™ä¸ªåº”ç”¨åœºæ™¯ä¸‹ï¼Œç®€å•å·¥å‚æ¨¡å¼ç®€å•å¥½ç”¨ï¼Œæ¯”å·¥å‚æ–¹æ³•æ¨¡å¼æ›´åŠ åˆé€‚ã€‚</li></ol><p>é—®é¢˜æ¥äº†ï¼šä»€ä¹ˆæ—¶å€™ç”¨ç®€å•å·¥å‚æ¨¡å¼ï¼Œä»€ä¹ˆæ—¶å€™ç”¨å·¥å‚æ¨¡å¼ï¼Ÿ</p><ol><li>å‰é¢æåˆ°ï¼Œä¹‹æ‰€ä»¥å°†æŸä¸ªä»£ç å—å‰¥ç¦»å‡ºæ¥ï¼Œç‹¬ç«‹ä¸ºå‡½æ•°æˆ–è€…ç±»ï¼ŒåŸå› æ˜¯è¿™ä¸ªä»£ç å—çš„é€»è¾‘è¿‡äºå¤æ‚ï¼Œå‰¥ç¦»ä¹‹åèƒ½è®©ä»£ç æ›´åŠ æ¸…æ™°ï¼Œæ›´åŠ å¯è¯»ã€å¯ç»´æŠ¤ã€‚ä½†æ˜¯ï¼Œå¦‚æœä»£ç å—æœ¬èº«å¹¶ä¸å¤æ‚ï¼Œå°±å‡ è¡Œä»£ç è€Œå·²ï¼Œæˆ‘ä»¬å®Œå…¨æ²¡å¿…è¦å°†å®ƒæ‹†åˆ†æˆå•ç‹¬çš„å‡½æ•°æˆ–è€…ç±»ã€‚</li><li>åŸºäºè¿™ä¸ªè®¾è®¡æ€æƒ³ï¼Œå½“å¯¹è±¡çš„åˆ›å»ºé€»è¾‘æ¯”è¾ƒå¤æ‚ï¼Œä¸åªæ˜¯ç®€å•çš„ new ä¸€ä¸‹å°±å¯ä»¥ï¼Œè€Œæ˜¯è¦ç»„åˆå…¶ä»–ç±»å¯¹è±¡ï¼Œåšå„ç§åˆå§‹åŒ–æ“ä½œçš„æ—¶å€™ï¼Œæˆ‘ä»¬æ¨èä½¿ç”¨å·¥å‚æ–¹æ³•æ¨¡å¼ï¼Œå°†å¤æ‚çš„åˆ›å»ºé€»è¾‘æ‹†åˆ†åˆ°å¤šä¸ªå·¥å‚ç±»ä¸­ï¼Œè®©æ¯ä¸ªå·¥å‚ç±»éƒ½ä¸è‡³äºè¿‡äºå¤æ‚ã€‚è€Œä½¿ç”¨ç®€å•å·¥å‚æ¨¡å¼ï¼Œå°†æ‰€æœ‰çš„åˆ›å»ºé€»è¾‘éƒ½æ”¾åˆ°ä¸€ä¸ªå·¥å‚ç±»ä¸­ï¼Œä¼šå¯¼è‡´è¿™ä¸ªå·¥å‚ç±»å˜å¾—å¾ˆå¤æ‚ã€‚</li><li>é™¤æ­¤ä¹‹å¤–ï¼Œåœ¨æŸäº›åœºæ™¯ä¸‹ï¼Œå¦‚æœå¯¹è±¡ä¸å¯å¤ç”¨ï¼Œé‚£å·¥å‚ç±»æ¯æ¬¡éƒ½è¦è¿”å›ä¸åŒçš„å¯¹è±¡ã€‚å¦‚æœæˆ‘ä»¬ä½¿ç”¨ç®€å•å·¥å‚æ¨¡å¼æ¥å®ç°ï¼Œå°±åªèƒ½é€‰æ‹©ç¬¬ä¸€ç§åŒ…å« if åˆ†æ”¯é€»è¾‘çš„å®ç°æ–¹å¼ã€‚å¦‚æœæˆ‘ä»¬è¿˜æƒ³é¿å…çƒ¦äººçš„ if-else åˆ†æ”¯é€»è¾‘ï¼Œè¿™ä¸ªæ—¶å€™ï¼Œæˆ‘ä»¬å°±æ¨èä½¿ç”¨å·¥å‚æ–¹æ³•æ¨¡å¼ã€‚</li></ol><h3 id="3ã€æŠ½è±¡å·¥å‚"><a href="#3ã€æŠ½è±¡å·¥å‚" class="headerlink" title="3ã€æŠ½è±¡å·¥å‚"></a>3ã€æŠ½è±¡å·¥å‚</h3><p>æŠ½è±¡å·¥å‚æ¨¡å¼ï¼šå®šä¹‰äº†ä¸€ä¸ªinterfaceç”¨äºåˆ›å»ºç›¸å…³æˆ–æœ‰ä¾èµ–å…³ç³»çš„å¯¹è±¡ç°‡ï¼Œè€Œæ— éœ€æŒ‡æ˜å…·ä½“çš„ç±» </p><p>æŠ½è±¡å·¥å‚æ¨¡å¼å¯ä»¥å°†ç®€å•å·¥å‚æ¨¡å¼å’Œå·¥å‚æ–¹æ³•æ¨¡å¼è¿›è¡Œæ•´åˆã€‚</p><p>ä»è®¾è®¡å±‚é¢çœ‹ï¼ŒæŠ½è±¡å·¥å‚æ¨¡å¼å°±æ˜¯å¯¹ç®€å•å·¥å‚æ¨¡å¼çš„æ”¹è¿›(æˆ–è€…ç§°ä¸ºè¿›ä¸€æ­¥çš„æŠ½è±¡)ã€‚ </p><p>å°†å·¥å‚æŠ½è±¡æˆä¸¤å±‚ï¼ŒAbsFactory(æŠ½è±¡å·¥å‚) å’Œ å…·ä½“å®ç°çš„å·¥å‚å­ç±»ã€‚ç¨‹åºå‘˜å¯ä»¥ æ ¹æ®åˆ›å»ºå¯¹è±¡ç±»å‹ä½¿ç”¨å¯¹åº”çš„å·¥å‚å­ç±»ã€‚è¿™æ ·å°†å•ä¸ªçš„ç®€å•å·¥å‚ç±»å˜æˆäº†å·¥å‚ç°‡ï¼Œ æ›´åˆ©äºä»£ç çš„ç»´æŠ¤å’Œæ‰©å±•ã€‚</p><p>æŠ½è±¡å·¥å‚æ²¡æœ‰å‰ä¸¤è€…å¸¸ç”¨ï¼Œç®€å•äº†è§£å³å¯ã€‚</p><p>åœ¨ç®€å•å·¥å‚å’Œå·¥å‚æ–¹æ³•ä¸­ï¼Œç±»åªæœ‰ä¸€ç§åˆ†ç±»æ–¹å¼ã€‚æ¯”å¦‚ï¼Œåœ¨è§„åˆ™é…ç½®è§£æé‚£ä¸ªä¾‹å­ä¸­ï¼Œè§£æå™¨ç±»åªä¼šæ ¹æ®é…ç½®æ–‡ä»¶æ ¼å¼ï¼ˆJsonã€Xmlã€Yamlâ€¦â€¦ï¼‰æ¥åˆ†ç±»ã€‚ä½†æ˜¯ï¼Œå¦‚æœç±»æœ‰ä¸¤ç§åˆ†ç±»æ–¹å¼ï¼Œæ¯”å¦‚ï¼Œæˆ‘ä»¬æ—¢å¯ä»¥æŒ‰ç…§é…ç½®æ–‡ä»¶æ ¼å¼æ¥åˆ†ç±»ï¼Œä¹Ÿå¯ä»¥æŒ‰ç…§è§£æçš„å¯¹è±¡ï¼ˆRule è§„åˆ™é…ç½®è¿˜æ˜¯ System ç³»ç»Ÿé…ç½®ï¼‰æ¥åˆ†ç±»ï¼Œé‚£å°±ä¼šå¯¹åº”ä¸‹é¢è¿™ 8 ä¸ª parser ç±»ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs java">é’ˆå¯¹è§„åˆ™é…ç½®çš„è§£æå™¨ï¼šåŸºäºæ¥å£IRuleConfigParser<br>JsonRuleConfigParser<br>XmlRuleConfigParser<br>YamlRuleConfigParser<br>PropertiesRuleConfigParser<br><br>é’ˆå¯¹ç³»ç»Ÿé…ç½®çš„è§£æå™¨ï¼šåŸºäºæ¥å£ISystemConfigParser<br>JsonSystemConfigParser<br>XmlSystemConfigParser<br>YamlSystemConfigParser<br>PropertiesSystemConfigParser<br></code></pre></td></tr></table></figure><ol><li>é’ˆå¯¹è¿™ç§ç‰¹æ®Šçš„åœºæ™¯ï¼Œå¦‚æœè¿˜æ˜¯ç»§ç»­ç”¨å·¥å‚æ–¹æ³•æ¥å®ç°çš„è¯ï¼Œæˆ‘ä»¬è¦é’ˆå¯¹æ¯ä¸ª parser éƒ½ç¼–å†™ä¸€ä¸ªå·¥å‚ç±»ï¼Œä¹Ÿå°±æ˜¯è¦ç¼–å†™ 8 ä¸ªå·¥å‚ç±»ã€‚å¦‚æœæˆ‘ä»¬æœªæ¥è¿˜éœ€è¦å¢åŠ é’ˆå¯¹ä¸šåŠ¡é…ç½®çš„è§£æå™¨ï¼ˆæ¯”å¦‚ IBizConfigParserï¼‰ï¼Œé‚£å°±è¦å†å¯¹åº”åœ°å¢åŠ  4 ä¸ªå·¥å‚ç±»ã€‚è€Œæˆ‘ä»¬çŸ¥é“ï¼Œè¿‡å¤šçš„ç±»ä¹Ÿä¼šè®©ç³»ç»Ÿéš¾ç»´æŠ¤ã€‚è¿™ä¸ªé—®é¢˜è¯¥æ€ä¹ˆè§£å†³å‘¢ï¼Ÿ</li><li>æŠ½è±¡å·¥å‚å°±æ˜¯é’ˆå¯¹è¿™ç§éå¸¸ç‰¹æ®Šçš„åœºæ™¯è€Œè¯ç”Ÿçš„ã€‚æˆ‘ä»¬å¯ä»¥è®©ä¸€ä¸ªå·¥å‚è´Ÿè´£åˆ›å»ºå¤šä¸ªä¸åŒç±»å‹çš„å¯¹è±¡ï¼ˆIRuleConfigParserã€ISystemConfigParser ç­‰ï¼‰ï¼Œè€Œä¸æ˜¯åªåˆ›å»ºä¸€ç§ parser å¯¹è±¡ã€‚è¿™æ ·å°±å¯ä»¥æœ‰æ•ˆåœ°å‡å°‘å·¥å‚ç±»çš„ä¸ªæ•°ã€‚å…·ä½“çš„ä»£ç å®ç°å¦‚ä¸‹æ‰€ç¤ºï¼š</li></ol><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">interface</span> <span class="hljs-title class_">IConfigParserFactory</span> &#123;<br>  IRuleConfigParser <span class="hljs-title function_">createRuleParser</span><span class="hljs-params">()</span>;<br>  ISystemConfigParser <span class="hljs-title function_">createSystemParser</span><span class="hljs-params">()</span>;<br>  <span class="hljs-comment">//æ­¤å¤„å¯ä»¥æ‰©å±•æ–°çš„parserç±»å‹ï¼Œæ¯”å¦‚IBizConfigParser</span><br>&#125;<br><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">JsonConfigParserFactory</span> <span class="hljs-keyword">implements</span> <span class="hljs-title class_">IConfigParserFactory</span> &#123;<br>  <span class="hljs-meta">@Override</span><br>  <span class="hljs-keyword">public</span> IRuleConfigParser <span class="hljs-title function_">createRuleParser</span><span class="hljs-params">()</span> &#123;<br>    <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">JsonRuleConfigParser</span>();<br>  &#125;<br><br>  <span class="hljs-meta">@Override</span><br>  <span class="hljs-keyword">public</span> ISystemConfigParser <span class="hljs-title function_">createSystemParser</span><span class="hljs-params">()</span> &#123;<br>    <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">JsonSystemConfigParser</span>();<br>  &#125;<br>&#125;<br><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">XmlConfigParserFactory</span> <span class="hljs-keyword">implements</span> <span class="hljs-title class_">IConfigParserFactory</span> &#123;<br>  <span class="hljs-meta">@Override</span><br>  <span class="hljs-keyword">public</span> IRuleConfigParser <span class="hljs-title function_">createRuleParser</span><span class="hljs-params">()</span> &#123;<br>    <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">XmlRuleConfigParser</span>();<br>  &#125;<br><br>  <span class="hljs-meta">@Override</span><br>  <span class="hljs-keyword">public</span> ISystemConfigParser <span class="hljs-title function_">createSystemParser</span><span class="hljs-params">()</span> &#123;<br>    <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">XmlSystemConfigParser</span>();<br>  &#125;<br>&#125;<br><br><span class="hljs-comment">// çœç•¥YamlConfigParserFactoryå’ŒPropertiesConfigParserFactoryä»£ç </span><br></code></pre></td></tr></table></figure><h3 id="4ã€DIå®¹å™¨"><a href="#4ã€DIå®¹å™¨" class="headerlink" title="4ã€DIå®¹å™¨"></a>4ã€DIå®¹å™¨</h3><p>å½“åˆ›å»ºå¯¹è±¡æ˜¯ä¸€ä¸ªâ€œå¤§å·¥ç¨‹â€çš„æ—¶å€™ï¼Œæˆ‘ä»¬ä¸€èˆ¬ä¼šé€‰æ‹©ä½¿ç”¨å·¥å‚æ¨¡å¼ï¼Œæ¥å°è£…å¯¹è±¡å¤æ‚çš„åˆ›å»ºè¿‡ç¨‹ï¼Œå°†å¯¹è±¡çš„åˆ›å»ºå’Œä½¿ç”¨åˆ†ç¦»ï¼Œè®©ä»£ç æ›´åŠ æ¸…æ™°ã€‚é‚£ä½•ä¸ºâ€œå¤§å·¥ç¨‹â€å‘¢ï¼Ÿä¸Šé¢æˆ‘ä»¬è®²äº†ä¸¤ç§æƒ…å†µï¼Œä¸€ç§æ˜¯åˆ›å»ºè¿‡ç¨‹æ¶‰åŠå¤æ‚çš„ if-else åˆ†æ”¯åˆ¤æ–­ï¼Œå¦ä¸€ç§æ˜¯å¯¹è±¡åˆ›å»ºéœ€è¦ç»„è£…å¤šä¸ªå…¶ä»–ç±»å¯¹è±¡æˆ–è€…éœ€è¦å¤æ‚çš„åˆå§‹åŒ–è¿‡ç¨‹ã€‚</p><p>ä»Šå¤©ï¼Œæˆ‘ä»¬å†æ¥è®²ä¸€ä¸ªåˆ›å»ºå¯¹è±¡çš„â€œå¤§å·¥ç¨‹â€ï¼Œä¾èµ–æ³¨å…¥æ¡†æ¶ï¼Œæˆ–è€…å«ä¾èµ–æ³¨å…¥å®¹å™¨ï¼ˆDependency Injection Containerï¼‰ï¼Œç®€ç§° DI å®¹å™¨ã€‚</p><p>DI å®¹å™¨è·Ÿæˆ‘ä»¬è®²çš„å·¥å‚æ¨¡å¼åˆæœ‰ä½•åŒºåˆ«å’Œè”ç³»ï¼ŸDI å®¹å™¨çš„æ ¸å¿ƒåŠŸèƒ½æœ‰å“ªäº›ï¼Œä»¥åŠå¦‚ä½•å®ç°ä¸€ä¸ªç®€å•çš„ DI å®¹å™¨ï¼Ÿ</p><h4 id="1ã€å·¥å‚æ¨¡å¼å’ŒDIå®¹å™¨æœ‰ä½•åŒºåˆ«"><a href="#1ã€å·¥å‚æ¨¡å¼å’ŒDIå®¹å™¨æœ‰ä½•åŒºåˆ«" class="headerlink" title="1ã€å·¥å‚æ¨¡å¼å’ŒDIå®¹å™¨æœ‰ä½•åŒºåˆ«"></a>1ã€å·¥å‚æ¨¡å¼å’ŒDIå®¹å™¨æœ‰ä½•åŒºåˆ«</h4><ol><li>å®é™…ä¸Šï¼ŒDI å®¹å™¨åº•å±‚æœ€åŸºæœ¬çš„è®¾è®¡æ€è·¯å°±æ˜¯åŸºäºå·¥å‚æ¨¡å¼çš„ã€‚DI å®¹å™¨ç›¸å½“äºä¸€ä¸ªå¤§çš„å·¥å‚ç±»ï¼Œè´Ÿè´£åœ¨ç¨‹åºå¯åŠ¨çš„æ—¶å€™ï¼Œæ ¹æ®é…ç½®ï¼ˆè¦åˆ›å»ºå“ªäº›ç±»å¯¹è±¡ï¼Œæ¯ä¸ªç±»å¯¹è±¡çš„åˆ›å»ºéœ€è¦ä¾èµ–å“ªäº›å…¶ä»–ç±»å¯¹è±¡ï¼‰äº‹å…ˆåˆ›å»ºå¥½å¯¹è±¡ã€‚å½“åº”ç”¨ç¨‹åºéœ€è¦ä½¿ç”¨æŸä¸ªç±»å¯¹è±¡çš„æ—¶å€™ï¼Œç›´æ¥ä»å®¹å™¨ä¸­è·å–å³å¯ã€‚æ­£æ˜¯å› ä¸ºå®ƒæŒæœ‰ä¸€å †å¯¹è±¡ï¼Œæ‰€ä»¥è¿™ä¸ªæ¡†æ¶æ‰è¢«ç§°ä¸ºâ€œå®¹å™¨â€ã€‚</li><li>DI å®¹å™¨ç›¸å¯¹äºæˆ‘ä»¬ä¸Šé¢è®²çš„å·¥å‚æ¨¡å¼çš„ä¾‹å­æ¥è¯´ï¼Œå®ƒå¤„ç†çš„æ˜¯æ›´å¤§çš„å¯¹è±¡åˆ›å»ºå·¥ç¨‹ã€‚ä¸Šé¢è®²çš„å·¥å‚æ¨¡å¼ä¸­ï¼Œä¸€ä¸ªå·¥å‚ç±»åªè´Ÿè´£æŸä¸ªç±»å¯¹è±¡æˆ–è€…æŸä¸€ç»„ç›¸å…³ç±»å¯¹è±¡ï¼ˆç»§æ‰¿è‡ªåŒä¸€æŠ½è±¡ç±»æˆ–è€…æ¥å£çš„å­ç±»ï¼‰çš„åˆ›å»ºï¼Œè€Œ DI å®¹å™¨è´Ÿè´£çš„æ˜¯æ•´ä¸ªåº”ç”¨ä¸­æ‰€æœ‰ç±»å¯¹è±¡çš„åˆ›å»ºã€‚</li><li>é™¤æ­¤ä¹‹å¤–ï¼ŒDI å®¹å™¨è´Ÿè´£çš„äº‹æƒ…è¦æ¯”å•çº¯çš„å·¥å‚æ¨¡å¼è¦å¤šã€‚æ¯”å¦‚ï¼Œå®ƒè¿˜åŒ…æ‹¬é…ç½®çš„è§£æã€å¯¹è±¡ç”Ÿå‘½å‘¨æœŸçš„ç®¡ç†ã€‚æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬å°±è¯¦ç»†è®²è®²ï¼Œä¸€ä¸ªç®€å•çš„ DI å®¹å™¨åº”è¯¥åŒ…å«å“ªäº›æ ¸å¿ƒåŠŸèƒ½ã€‚</li></ol><h4 id="2ã€DIå®¹å™¨çš„æ ¸å¿ƒåŠŸèƒ½"><a href="#2ã€DIå®¹å™¨çš„æ ¸å¿ƒåŠŸèƒ½" class="headerlink" title="2ã€DIå®¹å™¨çš„æ ¸å¿ƒåŠŸèƒ½"></a>2ã€DIå®¹å™¨çš„æ ¸å¿ƒåŠŸèƒ½</h4><p>ä¸€ä¸ªç®€å•çš„ DI å®¹å™¨çš„æ ¸å¿ƒåŠŸèƒ½ä¸€èˆ¬æœ‰ä¸‰ä¸ªï¼šé…ç½®è§£æã€å¯¹è±¡åˆ›å»ºå’Œå¯¹è±¡ç”Ÿå‘½å‘¨æœŸç®¡ç†ã€‚</p><blockquote><p>é…ç½®è§£æ</p></blockquote><ol><li>åœ¨ä¸Šé¢è®²çš„å·¥å‚æ¨¡å¼ä¸­ï¼Œå·¥å‚ç±»è¦åˆ›å»ºå“ªä¸ªç±»å¯¹è±¡æ˜¯äº‹å…ˆç¡®å®šå¥½çš„ï¼Œå¹¶ä¸”æ˜¯å†™æ­»åœ¨å·¥å‚ç±»ä»£ç ä¸­çš„ã€‚ä½œä¸ºä¸€ä¸ªé€šç”¨çš„æ¡†æ¶æ¥è¯´ï¼Œæ¡†æ¶ä»£ç è·Ÿåº”ç”¨ä»£ç åº”è¯¥æ˜¯é«˜åº¦è§£è€¦çš„ï¼ŒDI å®¹å™¨äº‹å…ˆå¹¶ä¸çŸ¥é“åº”ç”¨ä¼šåˆ›å»ºå“ªäº›å¯¹è±¡ï¼Œä¸å¯èƒ½æŠŠæŸä¸ªåº”ç”¨è¦åˆ›å»ºçš„å¯¹è±¡å†™æ­»åœ¨æ¡†æ¶ä»£ç ä¸­ã€‚æ‰€ä»¥ï¼Œæˆ‘ä»¬éœ€è¦é€šè¿‡ä¸€ç§å½¢å¼ï¼Œè®©åº”ç”¨å‘ŠçŸ¥ DI å®¹å™¨è¦åˆ›å»ºå“ªäº›å¯¹è±¡ã€‚è¿™ç§å½¢å¼å°±æ˜¯æˆ‘ä»¬è¦è®²çš„é…ç½®ã€‚</li><li>æˆ‘ä»¬å°†éœ€è¦ç”± DI å®¹å™¨æ¥åˆ›å»ºçš„ç±»å¯¹è±¡å’Œåˆ›å»ºç±»å¯¹è±¡çš„å¿…è¦ä¿¡æ¯ï¼ˆä½¿ç”¨å“ªä¸ªæ„é€ å‡½æ•°ä»¥åŠå¯¹åº”çš„æ„é€ å‡½æ•°å‚æ•°éƒ½æ˜¯ä»€ä¹ˆç­‰ç­‰ï¼‰ï¼Œæ”¾åˆ°é…ç½®æ–‡ä»¶ä¸­ã€‚å®¹å™¨è¯»å–é…ç½®æ–‡ä»¶ï¼Œæ ¹æ®é…ç½®æ–‡ä»¶æä¾›çš„ä¿¡æ¯æ¥åˆ›å»ºå¯¹è±¡ã€‚</li><li>ä¸‹é¢æ˜¯ä¸€ä¸ªå…¸å‹çš„ Spring å®¹å™¨çš„é…ç½®æ–‡ä»¶ã€‚Spring å®¹å™¨è¯»å–è¿™ä¸ªé…ç½®æ–‡ä»¶ï¼Œè§£æå‡ºè¦åˆ›å»ºçš„ä¸¤ä¸ªå¯¹è±¡ï¼šrateLimiter å’Œ redisCounterï¼Œå¹¶ä¸”å¾—åˆ°ä¸¤è€…çš„ä¾èµ–å…³ç³»ï¼šrateLimiter ä¾èµ– redisCounterã€‚</li></ol><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">RateLimiter</span> &#123;<br>  <span class="hljs-keyword">private</span> RedisCounter redisCounter;<br>  <span class="hljs-keyword">public</span> <span class="hljs-title function_">RateLimiter</span><span class="hljs-params">(RedisCounter redisCounter)</span> &#123;<br>    <span class="hljs-built_in">this</span>.redisCounter = redisCounter;<br>  &#125;<br>  <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">test</span><span class="hljs-params">()</span> &#123;<br>    System.out.println(<span class="hljs-string">&quot;Hello World!&quot;</span>);<br>  &#125;<br>  <span class="hljs-comment">//...</span><br>&#125;<br><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">RedisCounter</span> &#123;<br>  <span class="hljs-keyword">private</span> String ipAddress;<br>  <span class="hljs-keyword">private</span> <span class="hljs-type">int</span> port;<br>  <span class="hljs-keyword">public</span> <span class="hljs-title function_">RedisCounter</span><span class="hljs-params">(String ipAddress, <span class="hljs-type">int</span> port)</span> &#123;<br>    <span class="hljs-built_in">this</span>.ipAddress = ipAddress;<br>    <span class="hljs-built_in">this</span>.port = port;<br>  &#125;<br>  <span class="hljs-comment">//...</span><br>&#125;<br><br>é…ç½®æ–‡ä»¶beans.xmlï¼š<br>&lt;beans&gt;<br>   &lt;bean id=<span class="hljs-string">&quot;rateLimiter&quot;</span> class=<span class="hljs-string">&quot;com.zb.RateLimiter&quot;</span>&gt;<br>      &lt;constructor-arg ref=<span class="hljs-string">&quot;redisCounter&quot;</span>/&gt;<br>   &lt;/bean&gt;<br> <br>   &lt;bean id=<span class="hljs-string">&quot;redisCounter&quot;</span> class=<span class="hljs-string">&quot;com.zb.redisCounter&quot;</span>&gt;<br>     &lt;constructor-arg type=<span class="hljs-string">&quot;String&quot;</span> value=<span class="hljs-string">&quot;127.0.0.1&quot;</span>&gt;<br>     &lt;constructor-arg type=<span class="hljs-string">&quot;int&quot;</span> value=<span class="hljs-number">1234</span>&gt;<br>   &lt;/bean&gt;<br>&lt;/beans&gt;<br></code></pre></td></tr></table></figure><blockquote><p>å¯¹è±¡åˆ›å»º</p></blockquote><ol><li>åœ¨ DI å®¹å™¨ä¸­ï¼Œå¦‚æœæˆ‘ä»¬ç»™æ¯ä¸ªç±»éƒ½å¯¹åº”åˆ›å»ºä¸€ä¸ªå·¥å‚ç±»ï¼Œé‚£é¡¹ç›®ä¸­ç±»çš„ä¸ªæ•°ä¼šæˆå€å¢åŠ ï¼Œè¿™ä¼šå¢åŠ ä»£ç çš„ç»´æŠ¤æˆæœ¬ã€‚è¦è§£å†³è¿™ä¸ªé—®é¢˜å¹¶ä¸éš¾ã€‚æˆ‘ä»¬åªéœ€è¦å°†æ‰€æœ‰ç±»å¯¹è±¡çš„åˆ›å»ºéƒ½æ”¾åˆ°ä¸€ä¸ªå·¥å‚ç±»ä¸­å®Œæˆå°±å¯ä»¥äº†ï¼Œæ¯”å¦‚ BeansFactoryã€‚</li><li>ä½ å¯èƒ½ä¼šè¯´ï¼Œå¦‚æœè¦åˆ›å»ºçš„ç±»å¯¹è±¡éå¸¸å¤šï¼ŒBeansFactory ä¸­çš„ä»£ç ä¼šä¸ä¼šçº¿æ€§è†¨èƒ€ï¼ˆä»£ç é‡è·Ÿåˆ›å»ºå¯¹è±¡çš„ä¸ªæ•°æˆæ­£æ¯”ï¼‰å‘¢ï¼Ÿå®é™…ä¸Šå¹¶ä¸ä¼šã€‚å¾…ä¼šè®²åˆ° DI å®¹å™¨çš„å…·ä½“å®ç°çš„æ—¶å€™ï¼Œæˆ‘ä»¬ä¼šè®²â€œåå°„â€è¿™ç§æœºåˆ¶ï¼Œå®ƒèƒ½åœ¨ç¨‹åºè¿è¡Œçš„è¿‡ç¨‹ä¸­ï¼ŒåŠ¨æ€åœ°åŠ è½½ç±»ã€åˆ›å»ºå¯¹è±¡ï¼Œä¸éœ€è¦äº‹å…ˆåœ¨ä»£ç ä¸­å†™æ­»è¦åˆ›å»ºå“ªäº›å¯¹è±¡ã€‚æ‰€ä»¥ï¼Œä¸ç®¡æ˜¯åˆ›å»ºä¸€ä¸ªå¯¹è±¡è¿˜æ˜¯åä¸ªå¯¹è±¡ï¼ŒBeansFactory å·¥å‚ç±»ä»£ç éƒ½æ˜¯ä¸€æ ·çš„ã€‚</li></ol><blockquote><p>å¯¹è±¡çš„å£°æ˜å‘¨æœŸç®¡ç†</p></blockquote><ol><li>ä¸Šé¢æˆ‘ä»¬è®²åˆ°ï¼Œç®€å•å·¥å‚æ¨¡å¼æœ‰ä¸¤ç§å®ç°æ–¹å¼ï¼Œä¸€ç§æ˜¯æ¯æ¬¡éƒ½è¿”å›æ–°åˆ›å»ºçš„å¯¹è±¡ï¼Œå¦ä¸€ç§æ˜¯æ¯æ¬¡éƒ½è¿”å›åŒä¸€ä¸ªäº‹å…ˆåˆ›å»ºå¥½çš„å¯¹è±¡ï¼Œä¹Ÿå°±æ˜¯æ‰€è°“çš„å•ä¾‹å¯¹è±¡ã€‚åœ¨ Spring æ¡†æ¶ä¸­ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡é…ç½® scope å±æ€§ï¼Œæ¥åŒºåˆ†è¿™ä¸¤ç§ä¸åŒç±»å‹çš„å¯¹è±¡ã€‚scope=prototype è¡¨ç¤ºè¿”å›æ–°åˆ›å»ºçš„å¯¹è±¡ï¼Œscope=singleton è¡¨ç¤ºè¿”å›å•ä¾‹å¯¹è±¡ã€‚</li><li>é™¤æ­¤ä¹‹å¤–ï¼Œæˆ‘ä»¬è¿˜å¯ä»¥é…ç½®å¯¹è±¡æ˜¯å¦æ”¯æŒæ‡’åŠ è½½ã€‚å¦‚æœ lazy-init=trueï¼Œå¯¹è±¡åœ¨çœŸæ­£è¢«ä½¿ç”¨åˆ°çš„æ—¶å€™ï¼ˆæ¯”å¦‚ï¼šBeansFactory.getBean(â€œuserServiceâ€)ï¼‰æ‰è¢«è¢«åˆ›å»ºï¼›å¦‚æœ lazy-init=falseï¼Œå¯¹è±¡åœ¨åº”ç”¨å¯åŠ¨çš„æ—¶å€™å°±äº‹å…ˆåˆ›å»ºå¥½ã€‚</li><li>ä¸ä»…å¦‚æ­¤ï¼Œæˆ‘ä»¬è¿˜å¯ä»¥é…ç½®å¯¹è±¡çš„ init-method å’Œ destroy-method æ–¹æ³•ï¼Œæ¯”å¦‚ init-method=loadProperties()ï¼Œdestroy-method=updateConfigFile()ã€‚DI å®¹å™¨åœ¨åˆ›å»ºå¥½å¯¹è±¡ä¹‹åï¼Œä¼šä¸»åŠ¨è°ƒç”¨ init-method å±æ€§æŒ‡å®šçš„æ–¹æ³•æ¥åˆå§‹åŒ–å¯¹è±¡ã€‚åœ¨å¯¹è±¡è¢«æœ€ç»ˆé”€æ¯ä¹‹å‰ï¼ŒDI å®¹å™¨ä¼šä¸»åŠ¨è°ƒç”¨ destroy-method å±æ€§æŒ‡å®šçš„æ–¹æ³•æ¥åšä¸€äº›æ¸…ç†å·¥ä½œï¼Œæ¯”å¦‚é‡Šæ”¾æ•°æ®åº“è¿æ¥æ± ã€å…³é—­æ–‡ä»¶ã€‚</li></ol><h3 id="5ã€å®ç°ç®€å•çš„DIå®¹å™¨"><a href="#5ã€å®ç°ç®€å•çš„DIå®¹å™¨" class="headerlink" title="5ã€å®ç°ç®€å•çš„DIå®¹å™¨"></a>5ã€å®ç°ç®€å•çš„DIå®¹å™¨</h3><p>ç”¨ Java è¯­è¨€æ¥å®ç°ä¸€ä¸ªç®€å•çš„ DI å®¹å™¨ï¼Œæ ¸å¿ƒé€»è¾‘åªéœ€è¦åŒ…æ‹¬è¿™æ ·ä¸¤ä¸ªéƒ¨åˆ†ï¼šé…ç½®æ–‡ä»¶è§£æã€æ ¹æ®é…ç½®æ–‡ä»¶é€šè¿‡â€œåå°„â€è¯­æ³•æ¥åˆ›å»ºå¯¹è±¡ã€‚</p><h4 id="1ã€æœ€å°åŸå‹è®¾è®¡"><a href="#1ã€æœ€å°åŸå‹è®¾è®¡" class="headerlink" title="1ã€æœ€å°åŸå‹è®¾è®¡"></a>1ã€æœ€å°åŸå‹è®¾è®¡</h4><p>å› ä¸ºæˆ‘ä»¬ä¸»è¦æ˜¯è®²è§£è®¾è®¡æ¨¡å¼ï¼Œæ‰€ä»¥ï¼Œåœ¨ä»Šå¤©çš„è®²è§£ä¸­ï¼Œæˆ‘ä»¬åªå®ç°ä¸€ä¸ª DI å®¹å™¨çš„æœ€å°åŸå‹ã€‚åƒ Spring æ¡†æ¶è¿™æ ·çš„ DI å®¹å™¨ï¼Œå®ƒæ”¯æŒçš„é…ç½®æ ¼å¼éå¸¸çµæ´»å’Œå¤æ‚ã€‚ä¸ºäº†ç®€åŒ–ä»£ç å®ç°ï¼Œé‡ç‚¹è®²è§£åŸç†ï¼Œåœ¨æœ€å°åŸå‹ä¸­ï¼Œæˆ‘ä»¬åªæ”¯æŒä¸‹é¢é…ç½®æ–‡ä»¶ä¸­æ¶‰åŠçš„é…ç½®è¯­æ³•ã€‚</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs xml">é…ç½®æ–‡ä»¶beans.xml<br><span class="hljs-tag">&lt;<span class="hljs-name">beans</span>&gt;</span><br>   <span class="hljs-tag">&lt;<span class="hljs-name">bean</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;rateLimiter&quot;</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;com.zb.RateLimiter&quot;</span>&gt;</span><br>      <span class="hljs-tag">&lt;<span class="hljs-name">constructor-arg</span> <span class="hljs-attr">ref</span>=<span class="hljs-string">&quot;redisCounter&quot;</span>/&gt;</span><br>   <span class="hljs-tag">&lt;/<span class="hljs-name">bean</span>&gt;</span><br> <br>   <span class="hljs-tag">&lt;<span class="hljs-name">bean</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;redisCounter&quot;</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;com.zb.redisCounter&quot;</span> <span class="hljs-attr">scope</span>=<span class="hljs-string">&quot;singleton&quot;</span> <span class="hljs-attr">lazy-init</span>=<span class="hljs-string">&quot;true&quot;</span>&gt;</span><br>     <span class="hljs-tag">&lt;<span class="hljs-name">constructor-arg</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;String&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;127.0.0.1&quot;</span>&gt;</span><br>     <span class="hljs-tag">&lt;<span class="hljs-name">constructor-arg</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;int&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">1234</span>&gt;</span><br>   <span class="hljs-tag">&lt;/<span class="hljs-name">bean</span>&gt;</span><br>&lt;/bean<br></code></pre></td></tr></table></figure><p>æœ€å°åŸå‹çš„ä½¿ç”¨æ–¹å¼è·Ÿ Spring æ¡†æ¶éå¸¸ç±»ä¼¼ï¼Œç¤ºä¾‹ä»£ç å¦‚ä¸‹æ‰€ç¤ºï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Demo</span> &#123;<br>  <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span> &#123;<br>    <span class="hljs-type">ApplicationContext</span> <span class="hljs-variable">applicationContext</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">ClassPathXmlApplicationContext</span>(<br>            <span class="hljs-string">&quot;beans.xml&quot;</span>);<br>    <span class="hljs-type">RateLimiter</span> <span class="hljs-variable">rateLimiter</span> <span class="hljs-operator">=</span> (RateLimiter) applicationContext.getBean(<span class="hljs-string">&quot;rateLimiter&quot;</span>);<br>    rateLimiter.test();<br>    <span class="hljs-comment">//...</span><br>  &#125;<br>&#125;<br></code></pre></td></tr></table></figure><h4 id="2ã€æä¾›æ‰§è¡Œå…¥å£"><a href="#2ã€æä¾›æ‰§è¡Œå…¥å£" class="headerlink" title="2ã€æä¾›æ‰§è¡Œå…¥å£"></a>2ã€æä¾›æ‰§è¡Œå…¥å£</h4><p>é¢å‘å¯¹è±¡è®¾è®¡çš„æœ€åä¸€æ­¥æ˜¯ï¼šç»„è£…ç±»å¹¶æä¾›æ‰§è¡Œå…¥å£ã€‚åœ¨è¿™é‡Œï¼Œæ‰§è¡Œå…¥å£å°±æ˜¯ä¸€ç»„æš´éœ²ç»™å¤–éƒ¨ä½¿ç”¨çš„æ¥å£å’Œç±»ã€‚é€šè¿‡åˆšåˆšçš„æœ€å°åŸå‹ä½¿ç”¨ç¤ºä¾‹ä»£ç ï¼Œæˆ‘ä»¬å¯ä»¥çœ‹å‡ºï¼Œæ‰§è¡Œå…¥å£ä¸»è¦åŒ…å«ä¸¤éƒ¨åˆ†ï¼šApplicationContext å’Œ ClassPathXmlApplicationContextã€‚å…¶ä¸­ï¼ŒApplicationContext æ˜¯æ¥å£ï¼ŒClassPathXmlApplicationContext æ˜¯æ¥å£çš„å®ç°ç±»ã€‚ä¸¤ä¸ªç±»å…·ä½“å®ç°å¦‚ä¸‹æ‰€ç¤ºï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">interface</span> <span class="hljs-title class_">ApplicationContext</span> &#123;<br>  Object <span class="hljs-title function_">getBean</span><span class="hljs-params">(String beanId)</span>;<br>&#125;<br><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">ClassPathXmlApplicationContext</span> <span class="hljs-keyword">implements</span> <span class="hljs-title class_">ApplicationContext</span> &#123;<br>  <span class="hljs-keyword">private</span> BeansFactory beansFactory;<br>  <span class="hljs-keyword">private</span> BeanConfigParser beanConfigParser;<br><br>  <span class="hljs-keyword">public</span> <span class="hljs-title function_">ClassPathXmlApplicationContext</span><span class="hljs-params">(String configLocation)</span> &#123;<br>    <span class="hljs-built_in">this</span>.beansFactory = <span class="hljs-keyword">new</span> <span class="hljs-title class_">BeansFactory</span>();<br>    <span class="hljs-built_in">this</span>.beanConfigParser = <span class="hljs-keyword">new</span> <span class="hljs-title class_">XmlBeanConfigParser</span>();<br>    loadBeanDefinitions(configLocation);<br>  &#125;<br><br>  <span class="hljs-keyword">private</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">loadBeanDefinitions</span><span class="hljs-params">(String configLocation)</span> &#123;<br>    <span class="hljs-type">InputStream</span> <span class="hljs-variable">in</span> <span class="hljs-operator">=</span> <span class="hljs-literal">null</span>;<br>    <span class="hljs-keyword">try</span> &#123;<br>      in = <span class="hljs-built_in">this</span>.getClass().getResourceAsStream(<span class="hljs-string">&quot;/&quot;</span> + configLocation);<br>      <span class="hljs-keyword">if</span> (in == <span class="hljs-literal">null</span>) &#123;<br>        <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">RuntimeException</span>(<span class="hljs-string">&quot;Can not find config file: &quot;</span> + configLocation);<br>      &#125;<br>      List&lt;BeanDefinition&gt; beanDefinitions = beanConfigParser.parse(in);<br>      beansFactory.addBeanDefinitions(beanDefinitions);<br>    &#125; <span class="hljs-keyword">finally</span> &#123;<br>      <span class="hljs-keyword">if</span> (in != <span class="hljs-literal">null</span>) &#123;<br>        <span class="hljs-keyword">try</span> &#123;<br>          in.close();<br>        &#125; <span class="hljs-keyword">catch</span> (IOException e) &#123;<br>          <span class="hljs-comment">// <span class="hljs-doctag">TODO:</span> log error</span><br>        &#125;<br>      &#125;<br>    &#125;<br>  &#125;<br><br>  <span class="hljs-meta">@Override</span><br>  <span class="hljs-keyword">public</span> Object <span class="hljs-title function_">getBean</span><span class="hljs-params">(String beanId)</span> &#123;<br>    <span class="hljs-keyword">return</span> beansFactory.getBean(beanId);<br>  &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>ä»ä¸Šé¢çš„ä»£ç ä¸­ï¼Œæˆ‘ä»¬å¯ä»¥çœ‹å‡ºï¼ŒClassPathXmlApplicationContext è´Ÿè´£ç»„è£… BeansFactory å’Œ BeanConfigParser ä¸¤ä¸ªç±»ï¼Œä¸²è”æ‰§è¡Œæµç¨‹ï¼šä» classpath ä¸­åŠ è½½ XML æ ¼å¼çš„é…ç½®æ–‡ä»¶ï¼Œé€šè¿‡ BeanConfigParser è§£æä¸ºç»Ÿä¸€çš„ BeanDefinition æ ¼å¼ï¼Œç„¶åï¼ŒBeansFactory æ ¹æ® BeanDefinition æ¥åˆ›å»ºå¯¹è±¡ã€‚</p><h4 id="3ã€é…ç½®æ–‡ä»¶è§£æ"><a href="#3ã€é…ç½®æ–‡ä»¶è§£æ" class="headerlink" title="3ã€é…ç½®æ–‡ä»¶è§£æ"></a>3ã€é…ç½®æ–‡ä»¶è§£æ</h4><p>é…ç½®æ–‡ä»¶è§£æä¸»è¦åŒ…å« BeanConfigParser æ¥å£å’Œ XmlBeanConfigParser å®ç°ç±»ï¼Œè´Ÿè´£å°†é…ç½®æ–‡ä»¶è§£æä¸º BeanDefinition ç»“æ„ï¼Œä»¥ä¾¿ BeansFactory æ ¹æ®è¿™ä¸ªç»“æ„æ¥åˆ›å»ºå¯¹è±¡ã€‚é…ç½®æ–‡ä»¶çš„è§£ææ¯”è¾ƒç¹çï¼Œä¸æ¶‰åŠæˆ‘ä»¬è¦è®²çš„ç†è®ºçŸ¥è¯†ï¼Œä¸æ˜¯æˆ‘ä»¬è®²è§£çš„é‡ç‚¹ï¼Œæ‰€ä»¥è¿™é‡Œæˆ‘åªç»™å‡ºä¸¤ä¸ªç±»çš„å¤§è‡´è®¾è®¡æ€è·¯ï¼Œå¹¶æœªç»™å‡ºå…·ä½“çš„å®ç°ä»£ç ã€‚å…·ä½“çš„ä»£ç æ¡†æ¶å¦‚ä¸‹æ‰€ç¤ºï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">interface</span> <span class="hljs-title class_">BeanConfigParser</span> &#123;<br>  List&lt;BeanDefinition&gt; <span class="hljs-title function_">parse</span><span class="hljs-params">(InputStream inputStream)</span>;<br>  List&lt;BeanDefinition&gt; <span class="hljs-title function_">parse</span><span class="hljs-params">(String configContent)</span>;<br>&#125;<br><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">XmlBeanConfigParser</span> <span class="hljs-keyword">implements</span> <span class="hljs-title class_">BeanConfigParser</span> &#123;<br><br>  <span class="hljs-meta">@Override</span><br>  <span class="hljs-keyword">public</span> List&lt;BeanDefinition&gt; <span class="hljs-title function_">parse</span><span class="hljs-params">(InputStream inputStream)</span> &#123;<br>    <span class="hljs-type">String</span> <span class="hljs-variable">content</span> <span class="hljs-operator">=</span> <span class="hljs-literal">null</span>;<br>    <span class="hljs-comment">// <span class="hljs-doctag">TODO:</span>...</span><br>    <span class="hljs-keyword">return</span> parse(content);<br>  &#125;<br><br>  <span class="hljs-meta">@Override</span><br>  <span class="hljs-keyword">public</span> List&lt;BeanDefinition&gt; <span class="hljs-title function_">parse</span><span class="hljs-params">(String configContent)</span> &#123;<br>    List&lt;BeanDefinition&gt; beanDefinitions = <span class="hljs-keyword">new</span> <span class="hljs-title class_">ArrayList</span>&lt;&gt;();<br>    <span class="hljs-comment">// <span class="hljs-doctag">TODO:</span>...</span><br>    <span class="hljs-keyword">return</span> beanDefinitions;<br>  &#125;<br><br>&#125;<br><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">BeanDefinition</span> &#123;<br>  <span class="hljs-keyword">private</span> String id;<br>  <span class="hljs-keyword">private</span> String className;<br>  <span class="hljs-keyword">private</span> List&lt;ConstructorArg&gt; constructorArgs = <span class="hljs-keyword">new</span> <span class="hljs-title class_">ArrayList</span>&lt;&gt;();<br>  <span class="hljs-keyword">private</span> <span class="hljs-type">Scope</span> <span class="hljs-variable">scope</span> <span class="hljs-operator">=</span> Scope.SINGLETON;<br>  <span class="hljs-keyword">private</span> <span class="hljs-type">boolean</span> <span class="hljs-variable">lazyInit</span> <span class="hljs-operator">=</span> <span class="hljs-literal">false</span>;<br>  <span class="hljs-comment">// çœç•¥å¿…è¦çš„getter/setter/constructors</span><br> <br>  <span class="hljs-keyword">public</span> <span class="hljs-type">boolean</span> <span class="hljs-title function_">isSingleton</span><span class="hljs-params">()</span> &#123;<br>    <span class="hljs-keyword">return</span> scope.equals(Scope.SINGLETON);<br>  &#125;<br><br><br>  <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">enum</span> <span class="hljs-title class_">Scope</span> &#123;<br>    SINGLETON,<br>    PROTOTYPE<br>  &#125;<br>  <br>  <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">ConstructorArg</span> &#123;<br>    <span class="hljs-keyword">private</span> <span class="hljs-type">boolean</span> isRef;<br>    <span class="hljs-keyword">private</span> Class type;<br>    <span class="hljs-keyword">private</span> Object arg;<br>    <span class="hljs-comment">// çœç•¥å¿…è¦çš„getter/setter/constructors</span><br>  &#125;<br>&#125;<br></code></pre></td></tr></table></figure><h4 id="4ã€æ ¸å¿ƒå·¥å‚ç±»è®¾è®¡"><a href="#4ã€æ ¸å¿ƒå·¥å‚ç±»è®¾è®¡" class="headerlink" title="4ã€æ ¸å¿ƒå·¥å‚ç±»è®¾è®¡"></a>4ã€æ ¸å¿ƒå·¥å‚ç±»è®¾è®¡</h4><ol><li>æœ€åï¼Œæˆ‘ä»¬æ¥çœ‹ï¼ŒBeansFactory æ˜¯å¦‚ä½•è®¾è®¡å’Œå®ç°çš„ã€‚è¿™ä¹Ÿæ˜¯æˆ‘ä»¬è¿™ä¸ª DI å®¹å™¨æœ€æ ¸å¿ƒçš„ä¸€ä¸ªç±»äº†ã€‚å®ƒè´Ÿè´£æ ¹æ®ä»é…ç½®æ–‡ä»¶è§£æå¾—åˆ°çš„ BeanDefinition æ¥åˆ›å»ºå¯¹è±¡ã€‚</li><li>å¦‚æœå¯¹è±¡çš„ scope å±æ€§æ˜¯ singletonï¼Œé‚£å¯¹è±¡åˆ›å»ºä¹‹åä¼šç¼“å­˜åœ¨ singletonObjects è¿™æ ·ä¸€ä¸ª map ä¸­ï¼Œä¸‹æ¬¡å†è¯·æ±‚æ­¤å¯¹è±¡çš„æ—¶å€™ï¼Œç›´æ¥ä» map ä¸­å–å‡ºè¿”å›ï¼Œä¸éœ€è¦é‡æ–°åˆ›å»ºã€‚å¦‚æœå¯¹è±¡çš„ scope å±æ€§æ˜¯ prototypeï¼Œé‚£æ¯æ¬¡è¯·æ±‚å¯¹è±¡ï¼ŒBeansFactory éƒ½ä¼šåˆ›å»ºä¸€ä¸ªæ–°çš„å¯¹è±¡è¿”å›ã€‚</li><li>å®é™…ä¸Šï¼ŒBeansFactory åˆ›å»ºå¯¹è±¡ç”¨åˆ°çš„ä¸»è¦æŠ€æœ¯ç‚¹å°±æ˜¯ Java ä¸­çš„==åå°„==è¯­æ³•ï¼š<code>ä¸€ç§åŠ¨æ€åŠ è½½ç±»å’Œåˆ›å»ºå¯¹è±¡çš„æœºåˆ¶</code>ã€‚æˆ‘ä»¬çŸ¥é“ï¼ŒJVM åœ¨å¯åŠ¨çš„æ—¶å€™ä¼šæ ¹æ®ä»£ç è‡ªåŠ¨åœ°åŠ è½½ç±»ã€åˆ›å»ºå¯¹è±¡ã€‚è‡³äºéƒ½è¦åŠ è½½å“ªäº›ç±»ã€åˆ›å»ºå“ªäº›å¯¹è±¡ï¼Œè¿™äº›éƒ½æ˜¯åœ¨ä»£ç ä¸­å†™æ­»çš„ï¼Œæˆ–è€…è¯´æå‰å†™å¥½çš„ã€‚ä½†æ˜¯ï¼Œå¦‚æœæŸä¸ªå¯¹è±¡çš„åˆ›å»ºå¹¶ä¸æ˜¯å†™æ­»åœ¨ä»£ç ä¸­ï¼Œè€Œæ˜¯æ”¾åˆ°é…ç½®æ–‡ä»¶ä¸­ï¼Œæˆ‘ä»¬éœ€è¦åœ¨ç¨‹åºè¿è¡ŒæœŸé—´ï¼ŒåŠ¨æ€åœ°æ ¹æ®é…ç½®æ–‡ä»¶æ¥åŠ è½½ç±»ã€åˆ›å»ºå¯¹è±¡ï¼Œé‚£è¿™éƒ¨åˆ†å·¥ä½œå°±æ²¡æ³•è®© JVM å¸®æˆ‘ä»¬è‡ªåŠ¨å®Œæˆäº†ï¼Œæˆ‘ä»¬éœ€è¦åˆ©ç”¨ Java æä¾›çš„åå°„è¯­æ³•è‡ªå·±å»ç¼–å†™ä»£ç ã€‚</li><li>ææ¸…æ¥šäº†åå°„çš„åŸç†ï¼ŒBeansFactory çš„ä»£ç å°±ä¸éš¾çœ‹æ‡‚äº†ã€‚å…·ä½“ä»£ç å®ç°å¦‚ä¸‹æ‰€ç¤ºï¼š</li></ol><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">BeansFactory</span> &#123;<br>  <span class="hljs-keyword">private</span> ConcurrentHashMap&lt;String, Object&gt; singletonObjects = <span class="hljs-keyword">new</span> <span class="hljs-title class_">ConcurrentHashMap</span>&lt;&gt;();<br>  <span class="hljs-keyword">private</span> ConcurrentHashMap&lt;String, BeanDefinition&gt; beanDefinitions = <span class="hljs-keyword">new</span> <span class="hljs-title class_">ConcurrentHashMap</span>&lt;&gt;();<br><br>  <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">addBeanDefinitions</span><span class="hljs-params">(List&lt;BeanDefinition&gt; beanDefinitionList)</span> &#123;<br>    <span class="hljs-keyword">for</span> (BeanDefinition beanDefinition : beanDefinitionList) &#123;<br>      <span class="hljs-built_in">this</span>.beanDefinitions.putIfAbsent(beanDefinition.getId(), beanDefinition);<br>    &#125;<br><br>    <span class="hljs-keyword">for</span> (BeanDefinition beanDefinition : beanDefinitionList) &#123;<br>      <span class="hljs-keyword">if</span> (beanDefinition.isLazyInit() == <span class="hljs-literal">false</span> &amp;&amp; beanDefinition.isSingleton()) &#123;<br>        createBean(beanDefinition);<br>      &#125;<br>    &#125;<br>  &#125;<br><br>  <span class="hljs-keyword">public</span> Object <span class="hljs-title function_">getBean</span><span class="hljs-params">(String beanId)</span> &#123;<br>    <span class="hljs-type">BeanDefinition</span> <span class="hljs-variable">beanDefinition</span> <span class="hljs-operator">=</span> beanDefinitions.get(beanId);<br>    <span class="hljs-keyword">if</span> (beanDefinition == <span class="hljs-literal">null</span>) &#123;<br>      <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">NoSuchBeanDefinitionException</span>(<span class="hljs-string">&quot;Bean is not defined: &quot;</span> + beanId);<br>    &#125;<br>    <span class="hljs-keyword">return</span> createBean(beanDefinition);<br>  &#125;<br><br>  <span class="hljs-meta">@VisibleForTesting</span><br>  <span class="hljs-keyword">protected</span> Object <span class="hljs-title function_">createBean</span><span class="hljs-params">(BeanDefinition beanDefinition)</span> &#123;<br>    <span class="hljs-keyword">if</span> (beanDefinition.isSingleton() &amp;&amp; singletonObjects.contains(beanDefinition.getId())) &#123;<br>      <span class="hljs-keyword">return</span> singletonObjects.get(beanDefinition.getId());<br>    &#125;<br><br>    <span class="hljs-type">Object</span> <span class="hljs-variable">bean</span> <span class="hljs-operator">=</span> <span class="hljs-literal">null</span>;<br>    <span class="hljs-keyword">try</span> &#123;<br>      <span class="hljs-type">Class</span> <span class="hljs-variable">beanClass</span> <span class="hljs-operator">=</span> Class.forName(beanDefinition.getClassName());<br>      List&lt;BeanDefinition.ConstructorArg&gt; args = beanDefinition.getConstructorArgs();<br>      <span class="hljs-keyword">if</span> (args.isEmpty()) &#123;<br>        bean = beanClass.newInstance();<br>      &#125; <span class="hljs-keyword">else</span> &#123;<br>        Class[] argClasses = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Class</span>[args.size()];<br>        Object[] argObjects = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Object</span>[args.size()];<br>        <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> <span class="hljs-variable">i</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>; i &lt; args.size(); ++i) &#123;<br>          BeanDefinition.<span class="hljs-type">ConstructorArg</span> <span class="hljs-variable">arg</span> <span class="hljs-operator">=</span> args.get(i);<br>          <span class="hljs-keyword">if</span> (!arg.getIsRef()) &#123;<br>            argClasses[i] = arg.getType();<br>            argObjects[i] = arg.getArg();<br>          &#125; <span class="hljs-keyword">else</span> &#123;<br>            <span class="hljs-type">BeanDefinition</span> <span class="hljs-variable">refBeanDefinition</span> <span class="hljs-operator">=</span> beanDefinitions.get(arg.getArg());<br>            <span class="hljs-keyword">if</span> (refBeanDefinition == <span class="hljs-literal">null</span>) &#123;<br>              <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">NoSuchBeanDefinitionException</span>(<span class="hljs-string">&quot;Bean is not defined: &quot;</span> + arg.getArg());<br>            &#125;<br>            argClasses[i] = Class.forName(refBeanDefinition.getClassName());<br>            argObjects[i] = createBean(refBeanDefinition);<br>          &#125;<br>        &#125;<br>        bean = beanClass.getConstructor(argClasses).newInstance(argObjects);<br>      &#125;<br>    &#125; <span class="hljs-keyword">catch</span> (ClassNotFoundException | IllegalAccessException<br>            | InstantiationException | NoSuchMethodException | InvocationTargetException e) &#123;<br>      <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">BeanCreationFailureException</span>(<span class="hljs-string">&quot;&quot;</span>, e);<br>    &#125;<br><br>    <span class="hljs-keyword">if</span> (bean != <span class="hljs-literal">null</span> &amp;&amp; beanDefinition.isSingleton()) &#123;<br>      singletonObjects.putIfAbsent(beanDefinition.getId(), bean);<br>      <span class="hljs-keyword">return</span> singletonObjects.get(beanDefinition.getId());<br>    &#125;<br>    <span class="hljs-keyword">return</span> bean;<br>  &#125;<br>&#125;<br></code></pre></td></tr></table></figure><ol><li>æ‰§è¡Œå…¥å£é‚£é‡Œè°ƒç”¨<code>addBeanDefinitions</code></li><li>ç„¶å<code>addBeanDefinitions</code>å†è°ƒç”¨createBeanåˆ©ç”¨åå°„åˆ›å»ºå¯¹è±¡ï¼Œå¦‚æœå¯¹è±¡çš„ scope å±æ€§æ˜¯ singletonï¼Œé‚£å¯¹è±¡åˆ›å»ºä¹‹åä¼šç¼“å­˜åœ¨ singletonObjects è¿™æ ·ä¸€ä¸ª map ä¸­</li><li>æœ€åæœ€å°åŸå‹è®¾è®¡é‚£é‡Œå†è°ƒç”¨getBeanä»singletonObjects è·å–å¯¹è±¡ã€‚</li></ol><h2 id="äºŒã€å»ºé€ è€…æ¨¡å¼ã€å¸¸ç”¨ã€‘"><a href="#äºŒã€å»ºé€ è€…æ¨¡å¼ã€å¸¸ç”¨ã€‘" class="headerlink" title="äºŒã€å»ºé€ è€…æ¨¡å¼ã€å¸¸ç”¨ã€‘"></a>äºŒã€å»ºé€ è€…æ¨¡å¼ã€å¸¸ç”¨ã€‘</h2><p>å»ºé€ è€…æ¨¡å¼çš„åŸç†å’Œä»£ç å®ç°éå¸¸ç®€å•ï¼ŒæŒæ¡èµ·æ¥å¹¶ä¸éš¾ï¼Œéš¾ç‚¹åœ¨äºåº”ç”¨åœºæ™¯ã€‚æ¯”å¦‚ï¼Œæœ‰æ²¡æœ‰è€ƒè™‘è¿‡è¿™æ ·å‡ ä¸ªé—®é¢˜ï¼šç›´æ¥ä½¿ç”¨æ„é€ å‡½æ•°æˆ–è€…é…åˆ set æ–¹æ³•å°±èƒ½åˆ›å»ºå¯¹è±¡ï¼Œä¸ºä»€ä¹ˆè¿˜éœ€è¦å»ºé€ è€…æ¨¡å¼æ¥åˆ›å»ºå‘¢ï¼Ÿå»ºé€ è€…æ¨¡å¼å’Œå·¥å‚æ¨¡å¼éƒ½å¯ä»¥åˆ›å»ºå¯¹è±¡ï¼Œé‚£å®ƒä»¬ä¸¤ä¸ªçš„åŒºåˆ«åœ¨å“ªé‡Œå‘¢ï¼Ÿ</p><p>åŸºæœ¬ä»‹ç»ï¼š å»ºé€ è€…æ¨¡å¼ï¼ˆBuilder Patternï¼‰ åˆå«ç”Ÿæˆå™¨æ¨¡å¼ï¼Œæ˜¯ä¸€ç§å¯¹è±¡æ„å»ºæ¨¡å¼ã€‚å®ƒå¯ä»¥ å°†å¤æ‚å¯¹è±¡çš„å»ºé€ è¿‡ç¨‹æŠ½è±¡å‡ºæ¥ï¼ˆæŠ½è±¡ç±»åˆ«ï¼‰ï¼Œä½¿è¿™ä¸ªæŠ½è±¡è¿‡ç¨‹çš„ä¸åŒå®ç°æ–¹ æ³•å¯ä»¥æ„é€ å‡ºä¸åŒè¡¨ç°ï¼ˆå±æ€§ï¼‰çš„å¯¹è±¡ã€‚å»ºé€ è€…æ¨¡å¼ æ˜¯ä¸€æ­¥ä¸€æ­¥åˆ›å»ºä¸€ä¸ªå¤æ‚çš„å¯¹è±¡ï¼Œå®ƒå…è®¸ç”¨æˆ·åªé€šè¿‡æŒ‡å®šå¤æ‚å¯¹è±¡ çš„ç±»å‹å’Œå†…å®¹å°±å¯ä»¥æ„å»ºå®ƒä»¬ï¼Œç”¨æˆ·ä¸éœ€è¦çŸ¥é“å†…éƒ¨çš„å…·ä½“æ„å»ºç»†èŠ‚ã€‚</p><h3 id="1ã€ä¸ºä½•éœ€è¦å»ºé€ è€…æ¨¡å¼ï¼Ÿ"><a href="#1ã€ä¸ºä½•éœ€è¦å»ºé€ è€…æ¨¡å¼ï¼Ÿ" class="headerlink" title="1ã€ä¸ºä½•éœ€è¦å»ºé€ è€…æ¨¡å¼ï¼Ÿ"></a>1ã€ä¸ºä½•éœ€è¦å»ºé€ è€…æ¨¡å¼ï¼Ÿ</h3><ol><li>åœ¨å¹³æ—¶çš„å¼€å‘ä¸­ï¼Œåˆ›å»ºä¸€ä¸ªå¯¹è±¡æœ€å¸¸ç”¨çš„æ–¹å¼æ˜¯ï¼Œä½¿ç”¨ new å…³é”®å­—è°ƒç”¨ç±»çš„æ„é€ å‡½æ•°æ¥å®Œæˆã€‚ä½†æ˜¯ï¼Œä»€ä¹ˆæƒ…å†µä¸‹è¿™ç§æ–¹å¼å°±ä¸é€‚ç”¨äº†ï¼Œå°±éœ€è¦é‡‡ç”¨å»ºé€ è€…æ¨¡å¼æ¥åˆ›å»ºå¯¹è±¡å‘¢ï¼Ÿ</li><li>å‡è®¾æœ‰è¿™æ ·ä¸€é“è®¾è®¡é¢è¯•é¢˜ï¼šæˆ‘ä»¬éœ€è¦å®šä¹‰ä¸€ä¸ªèµ„æºæ± é…ç½®ç±» ResourcePoolConfigã€‚è¿™é‡Œçš„èµ„æºæ± ï¼Œä½ å¯ä»¥ç®€å•ç†è§£ä¸ºçº¿ç¨‹æ± ã€è¿æ¥æ± ã€å¯¹è±¡æ± ç­‰ã€‚åœ¨è¿™ä¸ªèµ„æºæ± é…ç½®ç±»ä¸­ï¼Œæœ‰ä»¥ä¸‹å‡ ä¸ªæˆå‘˜å˜é‡ï¼Œä¹Ÿå°±æ˜¯å¯é…ç½®é¡¹ã€‚ç°åœ¨ï¼Œè¯·ä½ ç¼–å†™ä»£ç å®ç°è¿™ä¸ª ResourcePoolConfig ç±»ã€‚</li></ol><p><img src="/2022/09/22/02-chuang-jian-xing-gong-han-jian-zao-zhe-yuan-xing/image-20220923155455175.png"></p><p>åªè¦ç¨å¾®æœ‰ç‚¹å¼€å‘ç»éªŒï¼Œé‚£å®ç°è¿™æ ·ä¸€ä¸ªç±»å¹¶ä¸æ˜¯ä»¶éš¾äº‹ã€‚æœ€å¸¸è§ã€æœ€å®¹æ˜“æƒ³åˆ°çš„å®ç°æ€è·¯å¦‚ä¸‹ä»£ç æ‰€ç¤ºã€‚å› ä¸º maxTotalã€maxIdleã€minIdle ä¸æ˜¯å¿…å¡«å˜é‡ï¼Œæ‰€ä»¥åœ¨åˆ›å»º ResourcePoolConfig å¯¹è±¡çš„æ—¶å€™ï¼Œæˆ‘ä»¬é€šè¿‡å¾€æ„é€ å‡½æ•°ä¸­ï¼Œç»™è¿™å‡ ä¸ªå‚æ•°ä¼ é€’ null å€¼ï¼Œæ¥è¡¨ç¤ºä½¿ç”¨é»˜è®¤å€¼ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">ResourcePoolConfig</span> &#123;<br>  <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> <span class="hljs-type">int</span> <span class="hljs-variable">DEFAULT_MAX_TOTAL</span> <span class="hljs-operator">=</span> <span class="hljs-number">8</span>;<br>  <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> <span class="hljs-type">int</span> <span class="hljs-variable">DEFAULT_MAX_IDLE</span> <span class="hljs-operator">=</span> <span class="hljs-number">8</span>;<br>  <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> <span class="hljs-type">int</span> <span class="hljs-variable">DEFAULT_MIN_IDLE</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>;<br><br>  <span class="hljs-keyword">private</span> String name;<br>  <span class="hljs-keyword">private</span> <span class="hljs-type">int</span> <span class="hljs-variable">maxTotal</span> <span class="hljs-operator">=</span> DEFAULT_MAX_TOTAL;<br>  <span class="hljs-keyword">private</span> <span class="hljs-type">int</span> <span class="hljs-variable">maxIdle</span> <span class="hljs-operator">=</span> DEFAULT_MAX_IDLE;<br>  <span class="hljs-keyword">private</span> <span class="hljs-type">int</span> <span class="hljs-variable">minIdle</span> <span class="hljs-operator">=</span> DEFAULT_MIN_IDLE;<br><br>  <span class="hljs-keyword">public</span> <span class="hljs-title function_">ResourcePoolConfig</span><span class="hljs-params">(String name, Integer maxTotal, Integer maxIdle, Integer minIdle)</span> &#123;<br>    <span class="hljs-keyword">if</span> (StringUtils.isBlank(name)) &#123;<br>      <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">IllegalArgumentException</span>(<span class="hljs-string">&quot;name should not be empty.&quot;</span>);<br>    &#125;<br>    <span class="hljs-built_in">this</span>.name = name;<br><br>    <span class="hljs-keyword">if</span> (maxTotal != <span class="hljs-literal">null</span>) &#123;<br>      <span class="hljs-keyword">if</span> (maxTotal &lt;= <span class="hljs-number">0</span>) &#123;<br>        <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">IllegalArgumentException</span>(<span class="hljs-string">&quot;maxTotal should be positive.&quot;</span>);<br>      &#125;<br>      <span class="hljs-built_in">this</span>.maxTotal = maxTotal;<br>    &#125;<br><br>    <span class="hljs-keyword">if</span> (maxIdle != <span class="hljs-literal">null</span>) &#123;<br>      <span class="hljs-keyword">if</span> (maxIdle &lt; <span class="hljs-number">0</span>) &#123;<br>        <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">IllegalArgumentException</span>(<span class="hljs-string">&quot;maxIdle should not be negative.&quot;</span>);<br>      &#125;<br>      <span class="hljs-built_in">this</span>.maxIdle = maxIdle;<br>    &#125;<br><br>    <span class="hljs-keyword">if</span> (minIdle != <span class="hljs-literal">null</span>) &#123;<br>      <span class="hljs-keyword">if</span> (minIdle &lt; <span class="hljs-number">0</span>) &#123;<br>        <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">IllegalArgumentException</span>(<span class="hljs-string">&quot;minIdle should not be negative.&quot;</span>);<br>      &#125;<br>      <span class="hljs-built_in">this</span>.minIdle = minIdle;<br>    &#125;<br>  &#125;<br>  <span class="hljs-comment">//...çœç•¥getteræ–¹æ³•...</span><br>&#125;<br></code></pre></td></tr></table></figure><p>ç°åœ¨ï¼ŒResourcePoolConfig åªæœ‰ 4 ä¸ªå¯é…ç½®é¡¹ï¼Œå¯¹åº”åˆ°æ„é€ å‡½æ•°ä¸­ï¼Œä¹Ÿåªæœ‰ 4 ä¸ªå‚æ•°ï¼Œå‚æ•°çš„ä¸ªæ•°ä¸å¤šã€‚ä½†æ˜¯ï¼Œå¦‚æœå¯é…ç½®é¡¹é€æ¸å¢å¤šï¼Œå˜æˆäº† 8 ä¸ªã€10 ä¸ªï¼Œç”šè‡³æ›´å¤šï¼Œé‚£ç»§ç»­æ²¿ç”¨ç°åœ¨çš„è®¾è®¡æ€è·¯ï¼Œæ„é€ å‡½æ•°çš„å‚æ•°åˆ—è¡¨ä¼šå˜å¾—å¾ˆé•¿ï¼Œä»£ç åœ¨å¯è¯»æ€§å’Œæ˜“ç”¨æ€§ä¸Šéƒ½ä¼šå˜å·®ã€‚åœ¨ä½¿ç”¨æ„é€ å‡½æ•°çš„æ—¶å€™ï¼Œæˆ‘ä»¬å°±å®¹æ˜“æé”™å„å‚æ•°çš„é¡ºåºï¼Œä¼ é€’è¿›é”™è¯¯çš„å‚æ•°å€¼ï¼Œå¯¼è‡´éå¸¸éšè”½çš„ bugã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-comment">// å‚æ•°å¤ªå¤šï¼Œå¯¼è‡´å¯è¯»æ€§å·®ã€å‚æ•°å¯èƒ½ä¼ é€’é”™è¯¯</span><br><span class="hljs-type">ResourcePoolConfig</span> <span class="hljs-variable">config</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">ResourcePoolConfig</span>(<span class="hljs-string">&quot;dbconnectionpool&quot;</span>, <span class="hljs-number">16</span>, <span class="hljs-literal">null</span>, <span class="hljs-number">8</span>, <span class="hljs-literal">null</span>, <span class="hljs-literal">false</span> , <span class="hljs-literal">true</span>, <span class="hljs-number">10</span>, <span class="hljs-number">20</span>ï¼Œ<span class="hljs-literal">false</span>ï¼Œ <span class="hljs-literal">true</span>);<br></code></pre></td></tr></table></figure><p>è§£å†³è¿™ä¸ªé—®é¢˜çš„åŠæ³•åº”è¯¥ä¹Ÿå·²ç»æƒ³åˆ°äº†ï¼Œé‚£å°±æ˜¯ç”¨ set() å‡½æ•°æ¥ç»™æˆå‘˜å˜é‡èµ‹å€¼ï¼Œä»¥æ›¿ä»£å†—é•¿çš„æ„é€ å‡½æ•°ã€‚æˆ‘ä»¬ç›´æ¥çœ‹ä»£ç ï¼Œå…·ä½“å¦‚ä¸‹æ‰€ç¤ºã€‚å…¶ä¸­ï¼Œé…ç½®é¡¹ name æ˜¯å¿…å¡«çš„ï¼Œæ‰€ä»¥æˆ‘ä»¬æŠŠå®ƒæ”¾åˆ°æ„é€ å‡½æ•°ä¸­è®¾ç½®ï¼Œå¼ºåˆ¶åˆ›å»ºç±»å¯¹è±¡çš„æ—¶å€™å°±è¦å¡«å†™ã€‚å…¶ä»–é…ç½®é¡¹ maxTotalã€maxIdleã€minIdle éƒ½ä¸æ˜¯å¿…å¡«çš„ï¼Œæ‰€ä»¥æˆ‘ä»¬é€šè¿‡ set() å‡½æ•°æ¥è®¾ç½®ï¼Œè®©ä½¿ç”¨è€…è‡ªä¸»é€‰æ‹©å¡«å†™æˆ–è€…ä¸å¡«å†™ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">ResourcePoolConfig</span> &#123;<br>  <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> <span class="hljs-type">int</span> <span class="hljs-variable">DEFAULT_MAX_TOTAL</span> <span class="hljs-operator">=</span> <span class="hljs-number">8</span>;<br>  <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> <span class="hljs-type">int</span> <span class="hljs-variable">DEFAULT_MAX_IDLE</span> <span class="hljs-operator">=</span> <span class="hljs-number">8</span>;<br>  <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> <span class="hljs-type">int</span> <span class="hljs-variable">DEFAULT_MIN_IDLE</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>;<br><br>  <span class="hljs-keyword">private</span> String name;<br>  <span class="hljs-keyword">private</span> <span class="hljs-type">int</span> <span class="hljs-variable">maxTotal</span> <span class="hljs-operator">=</span> DEFAULT_MAX_TOTAL;<br>  <span class="hljs-keyword">private</span> <span class="hljs-type">int</span> <span class="hljs-variable">maxIdle</span> <span class="hljs-operator">=</span> DEFAULT_MAX_IDLE;<br>  <span class="hljs-keyword">private</span> <span class="hljs-type">int</span> <span class="hljs-variable">minIdle</span> <span class="hljs-operator">=</span> DEFAULT_MIN_IDLE;<br>  <br>  <span class="hljs-keyword">public</span> <span class="hljs-title function_">ResourcePoolConfig</span><span class="hljs-params">(String name)</span> &#123;<br>    <span class="hljs-keyword">if</span> (StringUtils.isBlank(name)) &#123;<br>      <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">IllegalArgumentException</span>(<span class="hljs-string">&quot;name should not be empty.&quot;</span>);<br>    &#125;<br>    <span class="hljs-built_in">this</span>.name = name;<br>  &#125;<br><br>  <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">setMaxTotal</span><span class="hljs-params">(<span class="hljs-type">int</span> maxTotal)</span> &#123;<br>    <span class="hljs-keyword">if</span> (maxTotal &lt;= <span class="hljs-number">0</span>) &#123;<br>      <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">IllegalArgumentException</span>(<span class="hljs-string">&quot;maxTotal should be positive.&quot;</span>);<br>    &#125;<br>    <span class="hljs-built_in">this</span>.maxTotal = maxTotal;<br>  &#125;<br><br>  <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">setMaxIdle</span><span class="hljs-params">(<span class="hljs-type">int</span> maxIdle)</span> &#123;<br>    <span class="hljs-keyword">if</span> (maxIdle &lt; <span class="hljs-number">0</span>) &#123;<br>      <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">IllegalArgumentException</span>(<span class="hljs-string">&quot;maxIdle should not be negative.&quot;</span>);<br>    &#125;<br>    <span class="hljs-built_in">this</span>.maxIdle = maxIdle;<br>  &#125;<br><br>  <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">setMinIdle</span><span class="hljs-params">(<span class="hljs-type">int</span> minIdle)</span> &#123;<br>    <span class="hljs-keyword">if</span> (minIdle &lt; <span class="hljs-number">0</span>) &#123;<br>      <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">IllegalArgumentException</span>(<span class="hljs-string">&quot;minIdle should not be negative.&quot;</span>);<br>    &#125;<br>    <span class="hljs-built_in">this</span>.minIdle = minIdle;<br>  &#125;<br>  <span class="hljs-comment">//...çœç•¥getteræ–¹æ³•...</span><br>&#125;<br></code></pre></td></tr></table></figure><p>æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬æ¥çœ‹æ–°çš„ ResourcePoolConfig ç±»è¯¥å¦‚ä½•ä½¿ç”¨ã€‚æˆ‘å†™äº†ä¸€ä¸ªç¤ºä¾‹ä»£ç ï¼Œå¦‚ä¸‹æ‰€ç¤ºã€‚æ²¡æœ‰äº†å†—é•¿çš„å‡½æ•°è°ƒç”¨å’Œå‚æ•°åˆ—è¡¨ï¼Œä»£ç åœ¨å¯è¯»æ€§å’Œæ˜“ç”¨æ€§ä¸Šæé«˜äº†å¾ˆå¤šã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-comment">// ResourcePoolConfigä½¿ç”¨ä¸¾ä¾‹</span><br><span class="hljs-type">ResourcePoolConfig</span> <span class="hljs-variable">config</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">ResourcePoolConfig</span>(<span class="hljs-string">&quot;dbconnectionpool&quot;</span>);<br>config.setMaxTotal(<span class="hljs-number">16</span>);<br>config.setMaxIdle(<span class="hljs-number">8</span>);<br></code></pre></td></tr></table></figure><p>è‡³æ­¤ï¼Œæˆ‘ä»¬ä»ç„¶æ²¡æœ‰ç”¨åˆ°å»ºé€ è€…æ¨¡å¼ï¼Œé€šè¿‡æ„é€ å‡½æ•°è®¾ç½®å¿…å¡«é¡¹ï¼Œé€šè¿‡ set() æ–¹æ³•è®¾ç½®å¯é€‰é…ç½®é¡¹ï¼Œå°±èƒ½å®ç°æˆ‘ä»¬çš„è®¾è®¡éœ€æ±‚ã€‚å¦‚æœæˆ‘ä»¬æŠŠé—®é¢˜çš„éš¾åº¦å†åŠ å¤§ç‚¹ï¼Œæ¯”å¦‚ï¼Œè¿˜éœ€è¦è§£å†³ä¸‹é¢è¿™ä¸‰ä¸ªé—®é¢˜ï¼Œé‚£ç°åœ¨çš„è®¾è®¡æ€è·¯å°±ä¸èƒ½æ»¡è¶³äº†ã€‚</p><ul><li>æˆ‘ä»¬åˆšåˆšè®²åˆ°ï¼Œname æ˜¯å¿…å¡«çš„ï¼Œæ‰€ä»¥ï¼Œæˆ‘ä»¬æŠŠå®ƒæ”¾åˆ°æ„é€ å‡½æ•°ä¸­ï¼Œå¼ºåˆ¶åˆ›å»ºå¯¹è±¡çš„æ—¶å€™å°±è®¾ç½®ã€‚å¦‚æœå¿…å¡«çš„é…ç½®é¡¹æœ‰å¾ˆå¤šï¼ŒæŠŠè¿™äº›å¿…å¡«é…ç½®é¡¹éƒ½æ”¾åˆ°æ„é€ å‡½æ•°ä¸­è®¾ç½®ï¼Œé‚£æ„é€ å‡½æ•°å°±åˆä¼šå‡ºç°å‚æ•°åˆ—è¡¨å¾ˆé•¿çš„é—®é¢˜ã€‚å¦‚æœæˆ‘ä»¬æŠŠå¿…å¡«é¡¹ä¹Ÿé€šè¿‡ set() æ–¹æ³•è®¾ç½®ï¼Œé‚£æ ¡éªŒè¿™äº›å¿…å¡«é¡¹æ˜¯å¦å·²ç»å¡«å†™çš„é€»è¾‘å°±æ— å¤„å®‰æ”¾äº†ã€‚</li><li>é™¤æ­¤ä¹‹å¤–ï¼Œå‡è®¾é…ç½®é¡¹ä¹‹é—´æœ‰ä¸€å®šçš„ä¾èµ–å…³ç³»ï¼Œæ¯”å¦‚ï¼Œå¦‚æœç”¨æˆ·è®¾ç½®äº† maxTotalã€maxIdleã€minIdle å…¶ä¸­ä¸€ä¸ªï¼Œå°±å¿…é¡»æ˜¾å¼åœ°è®¾ç½®å¦å¤–ä¸¤ä¸ªï¼›æˆ–è€…é…ç½®é¡¹ä¹‹é—´æœ‰ä¸€å®šçš„çº¦æŸæ¡ä»¶ï¼Œæ¯”å¦‚ï¼ŒmaxIdle å’Œ minIdle è¦å°äºç­‰äº maxTotalã€‚å¦‚æœæˆ‘ä»¬ç»§ç»­ä½¿ç”¨ç°åœ¨çš„è®¾è®¡æ€è·¯ï¼Œé‚£è¿™äº›é…ç½®é¡¹ä¹‹é—´çš„ä¾èµ–å…³ç³»æˆ–è€…çº¦æŸæ¡ä»¶çš„æ ¡éªŒé€»è¾‘å°±æ— å¤„å®‰æ”¾äº†ã€‚</li><li>å¦‚æœæˆ‘ä»¬å¸Œæœ› ResourcePoolConfig ç±»å¯¹è±¡æ˜¯ä¸å¯å˜å¯¹è±¡ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œå¯¹è±¡åœ¨åˆ›å»ºå¥½ä¹‹åï¼Œå°±ä¸èƒ½å†ä¿®æ”¹å†…éƒ¨çš„å±æ€§å€¼ã€‚è¦å®ç°è¿™ä¸ªåŠŸèƒ½ï¼Œæˆ‘ä»¬å°±ä¸èƒ½åœ¨ ResourcePoolConfig ç±»ä¸­æš´éœ² set() æ–¹æ³•ã€‚</li></ul><p>ä¸ºäº†è§£å†³è¿™äº›é—®é¢˜ï¼Œå»ºé€ è€…æ¨¡å¼å°±æ´¾ä¸Šç”¨åœºäº†ã€‚æˆ‘ä»¬å¯ä»¥æŠŠæ ¡éªŒé€»è¾‘æ”¾ç½®åˆ° Builder ç±»ä¸­ï¼Œå…ˆåˆ›å»ºå»ºé€ è€…ï¼Œå¹¶ä¸”é€šè¿‡ set() æ–¹æ³•è®¾ç½®å»ºé€ è€…çš„å˜é‡å€¼ï¼Œç„¶ååœ¨ä½¿ç”¨ build() æ–¹æ³•çœŸæ­£åˆ›å»ºå¯¹è±¡ä¹‹å‰ï¼Œåšé›†ä¸­çš„æ ¡éªŒï¼Œæ ¡éªŒé€šè¿‡ä¹‹åæ‰ä¼šåˆ›å»ºå¯¹è±¡ã€‚é™¤æ­¤ä¹‹å¤–ï¼Œæˆ‘ä»¬æŠŠ ResourcePoolConfig çš„æ„é€ å‡½æ•°æ”¹ä¸º private ç§æœ‰æƒé™ã€‚è¿™æ ·æˆ‘ä»¬å°±åªèƒ½é€šè¿‡å»ºé€ è€…æ¥åˆ›å»º ResourcePoolConfig ç±»å¯¹è±¡ã€‚å¹¶ä¸”ï¼ŒResourcePoolConfig æ²¡æœ‰æä¾›ä»»ä½• set() æ–¹æ³•ï¼Œè¿™æ ·æˆ‘ä»¬åˆ›å»ºå‡ºæ¥çš„å¯¹è±¡å°±æ˜¯ä¸å¯å˜å¯¹è±¡äº†ã€‚æˆ‘ä»¬ç”¨å»ºé€ è€…æ¨¡å¼é‡æ–°å®ç°äº†ä¸Šé¢çš„éœ€æ±‚ï¼Œå…·ä½“çš„ä»£ç å¦‚ä¸‹æ‰€ç¤ºï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">ResourcePoolConfig</span> &#123;<br>  <span class="hljs-keyword">private</span> String name;<br>  <span class="hljs-keyword">private</span> <span class="hljs-type">int</span> maxTotal;<br>  <span class="hljs-keyword">private</span> <span class="hljs-type">int</span> maxIdle;<br>  <span class="hljs-keyword">private</span> <span class="hljs-type">int</span> minIdle;<br><br>  <span class="hljs-keyword">private</span> <span class="hljs-title function_">ResourcePoolConfig</span><span class="hljs-params">(Builder builder)</span> &#123;<br>    <span class="hljs-built_in">this</span>.name = builder.name;<br>    <span class="hljs-built_in">this</span>.maxTotal = builder.maxTotal;<br>    <span class="hljs-built_in">this</span>.maxIdle = builder.maxIdle;<br>    <span class="hljs-built_in">this</span>.minIdle = builder.minIdle;<br>  &#125;<br>  <span class="hljs-comment">//...çœç•¥getteræ–¹æ³•...</span><br><br>  <span class="hljs-comment">//æˆ‘ä»¬å°†Builderç±»è®¾è®¡æˆäº†ResourcePoolConfigçš„å†…éƒ¨ç±»ã€‚</span><br>  <span class="hljs-comment">//æˆ‘ä»¬ä¹Ÿå¯ä»¥å°†Builderç±»è®¾è®¡æˆç‹¬ç«‹çš„éå†…éƒ¨ç±»ResourcePoolConfigBuilderã€‚</span><br>  <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Builder</span> &#123;<br>    <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> <span class="hljs-type">int</span> <span class="hljs-variable">DEFAULT_MAX_TOTAL</span> <span class="hljs-operator">=</span> <span class="hljs-number">8</span>;<br>    <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> <span class="hljs-type">int</span> <span class="hljs-variable">DEFAULT_MAX_IDLE</span> <span class="hljs-operator">=</span> <span class="hljs-number">8</span>;<br>    <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> <span class="hljs-type">int</span> <span class="hljs-variable">DEFAULT_MIN_IDLE</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>;<br><br>    <span class="hljs-keyword">private</span> String name;<br>    <span class="hljs-keyword">private</span> <span class="hljs-type">int</span> <span class="hljs-variable">maxTotal</span> <span class="hljs-operator">=</span> DEFAULT_MAX_TOTAL;<br>    <span class="hljs-keyword">private</span> <span class="hljs-type">int</span> <span class="hljs-variable">maxIdle</span> <span class="hljs-operator">=</span> DEFAULT_MAX_IDLE;<br>    <span class="hljs-keyword">private</span> <span class="hljs-type">int</span> <span class="hljs-variable">minIdle</span> <span class="hljs-operator">=</span> DEFAULT_MIN_IDLE;<br><br>    <span class="hljs-keyword">public</span> ResourcePoolConfig <span class="hljs-title function_">build</span><span class="hljs-params">()</span> &#123;<br>      <span class="hljs-comment">// æ ¡éªŒé€»è¾‘æ”¾åˆ°è¿™é‡Œæ¥åšï¼ŒåŒ…æ‹¬å¿…å¡«é¡¹æ ¡éªŒã€ä¾èµ–å…³ç³»æ ¡éªŒã€çº¦æŸæ¡ä»¶æ ¡éªŒç­‰</span><br>      <span class="hljs-keyword">if</span> (StringUtils.isBlank(name)) &#123;<br>        <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">IllegalArgumentException</span>(<span class="hljs-string">&quot;...&quot;</span>);<br>      &#125;<br>      <span class="hljs-keyword">if</span> (maxIdle &gt; maxTotal) &#123;<br>        <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">IllegalArgumentException</span>(<span class="hljs-string">&quot;...&quot;</span>);<br>      &#125;<br>      <span class="hljs-keyword">if</span> (minIdle &gt; maxTotal || minIdle &gt; maxIdle) &#123;<br>        <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">IllegalArgumentException</span>(<span class="hljs-string">&quot;...&quot;</span>);<br>      &#125;<br><br>      <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">ResourcePoolConfig</span>(<span class="hljs-built_in">this</span>);<br>    &#125;<br><br>    <span class="hljs-keyword">public</span> Builder <span class="hljs-title function_">setName</span><span class="hljs-params">(String name)</span> &#123;<br>      <span class="hljs-keyword">if</span> (StringUtils.isBlank(name)) &#123;<br>        <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">IllegalArgumentException</span>(<span class="hljs-string">&quot;...&quot;</span>);<br>      &#125;<br>      <span class="hljs-built_in">this</span>.name = name;<br>      <span class="hljs-keyword">return</span> <span class="hljs-built_in">this</span>;<br>    &#125;<br><br>    <span class="hljs-keyword">public</span> Builder <span class="hljs-title function_">setMaxTotal</span><span class="hljs-params">(<span class="hljs-type">int</span> maxTotal)</span> &#123;<br>      <span class="hljs-keyword">if</span> (maxTotal &lt;= <span class="hljs-number">0</span>) &#123;<br>        <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">IllegalArgumentException</span>(<span class="hljs-string">&quot;...&quot;</span>);<br>      &#125;<br>      <span class="hljs-built_in">this</span>.maxTotal = maxTotal;<br>      <span class="hljs-keyword">return</span> <span class="hljs-built_in">this</span>;<br>    &#125;<br><br>    <span class="hljs-keyword">public</span> Builder <span class="hljs-title function_">setMaxIdle</span><span class="hljs-params">(<span class="hljs-type">int</span> maxIdle)</span> &#123;<br>      <span class="hljs-keyword">if</span> (maxIdle &lt; <span class="hljs-number">0</span>) &#123;<br>        <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">IllegalArgumentException</span>(<span class="hljs-string">&quot;...&quot;</span>);<br>      &#125;<br>      <span class="hljs-built_in">this</span>.maxIdle = maxIdle;<br>      <span class="hljs-keyword">return</span> <span class="hljs-built_in">this</span>;<br>    &#125;<br><br>    <span class="hljs-keyword">public</span> Builder <span class="hljs-title function_">setMinIdle</span><span class="hljs-params">(<span class="hljs-type">int</span> minIdle)</span> &#123;<br>      <span class="hljs-keyword">if</span> (minIdle &lt; <span class="hljs-number">0</span>) &#123;<br>        <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">IllegalArgumentException</span>(<span class="hljs-string">&quot;...&quot;</span>);<br>      &#125;<br>      <span class="hljs-built_in">this</span>.minIdle = minIdle;<br>      <span class="hljs-keyword">return</span> <span class="hljs-built_in">this</span>;<br>    &#125;<br>  &#125;<br>&#125;<br><br><span class="hljs-comment">// è¿™æ®µä»£ç ä¼šæŠ›å‡ºIllegalArgumentExceptionï¼Œå› ä¸ºminIdle&gt;maxIdle</span><br><span class="hljs-type">ResourcePoolConfig</span> <span class="hljs-variable">config</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">ResourcePoolConfig</span>.Builder()<br>        .setName(<span class="hljs-string">&quot;dbconnectionpool&quot;</span>)<br>        .setMaxTotal(<span class="hljs-number">16</span>)<br>        .setMaxIdle(<span class="hljs-number">10</span>)<br>        .setMinIdle(<span class="hljs-number">12</span>)<br>        .build();<br></code></pre></td></tr></table></figure><p>å®é™…ä¸Šï¼Œä½¿ç”¨å»ºé€ è€…æ¨¡å¼åˆ›å»ºå¯¹è±¡ï¼Œè¿˜å¯ä»¥é¿å…å¯¹è±¡å­˜åœ¨æ— æ•ˆçŠ¶æ€ã€‚æ— æ•ˆçŠ¶æ€æ˜¯æŒ‡å¯¹è±¡æ²¡æœ‰å®ä¾‹åŒ–å®Œå…¨ï¼Œå…·ä½“ä»£ç å¦‚ä¸‹ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-type">Rectangle</span> <span class="hljs-variable">r</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Rectange</span>(); <span class="hljs-comment">// r is invalid</span><br>r.setWidth(<span class="hljs-number">2</span>); <span class="hljs-comment">// r is invalid</span><br>r.setHeight(<span class="hljs-number">3</span>); <span class="hljs-comment">// r is valid</span><br></code></pre></td></tr></table></figure><ol><li>ä¸ºäº†é¿å…è¿™ç§æ— æ•ˆçŠ¶æ€çš„å­˜åœ¨ï¼Œæˆ‘ä»¬å°±éœ€è¦ä½¿ç”¨æ„é€ å‡½æ•°ä¸€æ¬¡æ€§åˆå§‹åŒ–å¥½æ‰€æœ‰çš„æˆå‘˜å˜é‡ã€‚å¦‚æœæ„é€ å‡½æ•°å‚æ•°è¿‡å¤šï¼Œæˆ‘ä»¬å°±éœ€è¦è€ƒè™‘ä½¿ç”¨å»ºé€ è€…æ¨¡å¼ï¼Œå…ˆè®¾ç½®å»ºé€ è€…çš„å˜é‡ï¼Œç„¶åå†ä¸€æ¬¡æ€§åœ°åˆ›å»ºå¯¹è±¡ï¼Œè®©å¯¹è±¡ä¸€ç›´å¤„äºæœ‰æ•ˆçŠ¶æ€ã€‚==(å»ºé€ è€…ä¸»è¦è§£å†³å‚æ•°è¿‡å¤šã€å‚æ•°æ£€éªŒã€æ§åˆ¶å¯¹è±¡åˆ›å»ºåä¸å¯å˜çš„é—®é¢˜)==</li><li>å®é™…ä¸Šï¼Œå¦‚æœæˆ‘ä»¬å¹¶ä¸æ˜¯å¾ˆå…³å¿ƒå¯¹è±¡æ˜¯å¦æœ‰çŸ­æš‚çš„æ— æ•ˆçŠ¶æ€ï¼Œä¹Ÿä¸æ˜¯å¤ªåœ¨æ„å¯¹è±¡æ˜¯å¦æ˜¯å¯å˜çš„ã€‚æ¯”å¦‚ï¼Œå¯¹è±¡åªæ˜¯ç”¨æ¥æ˜ å°„æ•°æ®åº“è¯»å‡ºæ¥çš„æ•°æ®ï¼Œé‚£æˆ‘ä»¬ç›´æ¥æš´éœ² set() æ–¹æ³•æ¥è®¾ç½®ç±»çš„æˆå‘˜å˜é‡å€¼æ˜¯å®Œå…¨æ²¡é—®é¢˜çš„ã€‚è€Œä¸”ï¼Œä½¿ç”¨å»ºé€ è€…æ¨¡å¼æ¥æ„å»ºå¯¹è±¡ï¼Œä»£ç å®é™…ä¸Šæ˜¯æœ‰ç‚¹é‡å¤çš„ï¼ŒResourcePoolConfig ç±»ä¸­çš„æˆå‘˜å˜é‡ï¼Œè¦åœ¨ Builder ç±»ä¸­é‡æ–°å†å®šä¹‰ä¸€éã€‚</li></ol><h3 id="2ã€ä¸å·¥å‚æ¨¡å¼æœ‰ä½•åŒºåˆ«ï¼Ÿ"><a href="#2ã€ä¸å·¥å‚æ¨¡å¼æœ‰ä½•åŒºåˆ«ï¼Ÿ" class="headerlink" title="2ã€ä¸å·¥å‚æ¨¡å¼æœ‰ä½•åŒºåˆ«ï¼Ÿ"></a>2ã€ä¸å·¥å‚æ¨¡å¼æœ‰ä½•åŒºåˆ«ï¼Ÿ</h3><ol><li>ä»ä¸Šé¢çš„è®²è§£ä¸­ï¼Œæˆ‘ä»¬å¯ä»¥çœ‹å‡ºï¼Œå»ºé€ è€…æ¨¡å¼æ˜¯è®©å»ºé€ è€…ç±»æ¥è´Ÿè´£å¯¹è±¡çš„åˆ›å»ºå·¥ä½œã€‚ä¸Šé¢è®²åˆ°çš„å·¥å‚æ¨¡å¼ï¼Œæ˜¯ç”±å·¥å‚ç±»æ¥è´Ÿè´£å¯¹è±¡åˆ›å»ºçš„å·¥ä½œã€‚é‚£å®ƒä»¬ä¹‹é—´æœ‰ä»€ä¹ˆåŒºåˆ«å‘¢ï¼Ÿ</li><li>å®é™…ä¸Šï¼Œå·¥å‚æ¨¡å¼æ˜¯ç”¨æ¥<code>åˆ›å»ºä¸åŒä½†æ˜¯ç›¸å…³ç±»å‹çš„å¯¹è±¡</code>ï¼ˆç»§æ‰¿åŒä¸€çˆ¶ç±»æˆ–è€…æ¥å£çš„ä¸€ç»„å­ç±»ï¼‰ï¼Œç”±ç»™å®šçš„å‚æ•°æ¥å†³å®šåˆ›å»ºå“ªç§ç±»å‹çš„å¯¹è±¡ã€‚å»ºé€ è€…æ¨¡å¼æ˜¯ç”¨æ¥åˆ›å»º<code>ä¸€ç§ç±»å‹çš„å¤æ‚å¯¹è±¡</code>ï¼Œé€šè¿‡è®¾ç½®ä¸åŒçš„å¯é€‰å‚æ•°ï¼Œâ€œå®šåˆ¶åŒ–â€åœ°åˆ›å»ºä¸åŒçš„å¯¹è±¡ã€‚</li></ol><p>ç½‘ä¸Šæœ‰ä¸€ä¸ªç»å…¸çš„ä¾‹å­å¾ˆå¥½åœ°è§£é‡Šäº†ä¸¤è€…çš„åŒºåˆ«:</p><blockquote><p>é¡¾å®¢èµ°è¿›ä¸€å®¶é¤é¦†ç‚¹é¤ï¼Œæˆ‘ä»¬åˆ©ç”¨å·¥å‚æ¨¡å¼ï¼Œæ ¹æ®ç”¨æˆ·ä¸åŒçš„é€‰æ‹©ï¼Œæ¥åˆ¶ä½œä¸åŒçš„é£Ÿç‰©ï¼Œæ¯”å¦‚æŠ«è¨ã€æ±‰å ¡ã€æ²™æ‹‰ã€‚å¯¹äºæŠ«è¨æ¥è¯´ï¼Œç”¨æˆ·åˆæœ‰å„ç§é…æ–™å¯ä»¥å®šåˆ¶ï¼Œæ¯”å¦‚å¥¶é…ªã€è¥¿çº¢æŸ¿ã€èµ·å¸ï¼Œæˆ‘ä»¬é€šè¿‡å»ºé€ è€…æ¨¡å¼æ ¹æ®ç”¨æˆ·é€‰æ‹©çš„ä¸åŒé…æ–™æ¥åˆ¶ä½œæŠ«è¨ã€‚</p></blockquote><h2 id="ä¸‰ã€åŸå‹æ¨¡å¼ã€ä¸å¸¸ç”¨ã€‘"><a href="#ä¸‰ã€åŸå‹æ¨¡å¼ã€ä¸å¸¸ç”¨ã€‘" class="headerlink" title="ä¸‰ã€åŸå‹æ¨¡å¼ã€ä¸å¸¸ç”¨ã€‘"></a>ä¸‰ã€åŸå‹æ¨¡å¼ã€ä¸å¸¸ç”¨ã€‘</h2><p>ç°æœ‰å¦‚ä¸‹éœ€æ±‚ï¼šç°åœ¨æœ‰ä¸€åªç¾Štomï¼Œå§“åä¸º: tom, å¹´é¾„ä¸ºï¼š1ï¼Œé¢œè‰²ä¸ºï¼šç™½è‰²ï¼Œè¯·ç¼–å†™ç¨‹åºåˆ›å»ºå’Œtom ç¾Š å±æ€§å®Œå…¨ç›¸åŒçš„10åªç¾Šã€‚</p><p>æ€è·¯ï¼šJavaä¸­Objectç±»æ˜¯æ‰€æœ‰ç±»çš„æ ¹ç±»ï¼ŒObjectç±»æä¾›äº†ä¸€ä¸ªclone()æ–¹æ³•ï¼Œè¯¥æ–¹æ³•å¯ä»¥ å°†ä¸€ä¸ªJavaå¯¹è±¡å¤åˆ¶ä¸€ä»½ï¼Œä½†æ˜¯éœ€è¦å®ç°cloneçš„Javaç±»å¿…é¡»è¦å®ç°ä¸€ä¸ªæ¥å£Cloneableï¼Œ è¯¥æ¥å£è¡¨ç¤ºè¯¥ç±»èƒ½å¤Ÿå¤åˆ¶ä¸”å…·æœ‰å¤åˆ¶çš„èƒ½åŠ› =&gt; åŸå‹æ¨¡å¼</p><h3 id="1ã€åŸå‹æ¨¡å¼åŸç†ä¸åº”ç”¨"><a href="#1ã€åŸå‹æ¨¡å¼åŸç†ä¸åº”ç”¨" class="headerlink" title="1ã€åŸå‹æ¨¡å¼åŸç†ä¸åº”ç”¨"></a>1ã€åŸå‹æ¨¡å¼åŸç†ä¸åº”ç”¨</h3><p>å¦‚æœå¯¹è±¡çš„åˆ›å»ºæˆæœ¬æ¯”è¾ƒå¤§ï¼Œè€ŒåŒä¸€ä¸ªç±»çš„ä¸åŒå¯¹è±¡ä¹‹é—´å·®åˆ«ä¸å¤§ï¼ˆå¤§éƒ¨åˆ†å­—æ®µéƒ½ç›¸åŒï¼‰ï¼Œåœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬å¯ä»¥åˆ©ç”¨å¯¹å·²æœ‰å¯¹è±¡ï¼ˆåŸå‹ï¼‰è¿›è¡Œå¤åˆ¶ï¼ˆæˆ–è€…å«æ‹·è´ï¼‰çš„æ–¹å¼æ¥åˆ›å»ºæ–°å¯¹è±¡ï¼Œä»¥è¾¾åˆ°èŠ‚çœåˆ›å»ºæ—¶é—´çš„ç›®çš„ã€‚è¿™ç§åŸºäºåŸå‹æ¥åˆ›å»ºå¯¹è±¡çš„æ–¹å¼å°±å«ä½œåŸå‹è®¾è®¡æ¨¡å¼ï¼ˆPrototype Design Patternï¼‰ï¼Œç®€ç§°åŸå‹æ¨¡å¼ã€‚</p><ol><li>å®é™…ä¸Šï¼Œåˆ›å»ºå¯¹è±¡åŒ…å«çš„ç”³è¯·å†…å­˜ã€ç»™æˆå‘˜å˜é‡èµ‹å€¼è¿™ä¸€è¿‡ç¨‹ï¼Œæœ¬èº«å¹¶ä¸ä¼šèŠ±è´¹å¤ªå¤šæ—¶é—´ï¼Œæˆ–è€…è¯´å¯¹äºå¤§éƒ¨åˆ†ä¸šåŠ¡ç³»ç»Ÿæ¥è¯´ï¼Œè¿™ç‚¹æ—¶é—´å®Œå…¨æ˜¯å¯ä»¥å¿½ç•¥çš„ã€‚åº”ç”¨ä¸€ä¸ªå¤æ‚çš„æ¨¡å¼ï¼Œåªå¾—åˆ°ä¸€ç‚¹ç‚¹çš„æ€§èƒ½æå‡ï¼Œè¿™å°±æ˜¯æ‰€è°“çš„è¿‡åº¦è®¾è®¡ï¼Œå¾—ä¸å¿å¤±ã€‚</li><li>ä½†æ˜¯ï¼Œå¦‚æœå¯¹è±¡ä¸­çš„æ•°æ®éœ€è¦ç»è¿‡å¤æ‚çš„è®¡ç®—æ‰èƒ½å¾—åˆ°ï¼ˆæ¯”å¦‚æ’åºã€è®¡ç®—å“ˆå¸Œå€¼ï¼‰ï¼Œæˆ–è€…éœ€è¦ä» RPCã€ç½‘ç»œã€æ•°æ®åº“ã€æ–‡ä»¶ç³»ç»Ÿç­‰éå¸¸æ…¢é€Ÿçš„ IO ä¸­è¯»å–ï¼Œè¿™ç§æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬å°±å¯ä»¥åˆ©ç”¨åŸå‹æ¨¡å¼ï¼Œä»å…¶ä»–å·²æœ‰å¯¹è±¡ä¸­ç›´æ¥æ‹·è´å¾—åˆ°ï¼Œè€Œä¸ç”¨æ¯æ¬¡åœ¨åˆ›å»ºæ–°å¯¹è±¡çš„æ—¶å€™ï¼Œéƒ½é‡å¤æ‰§è¡Œè¿™äº›è€—æ—¶çš„æ“ä½œã€‚</li></ol><blockquote><p>ä¸¾ä¸ªä¾‹å­</p></blockquote><ol><li>å‡è®¾æ•°æ®åº“ä¸­å­˜å‚¨äº†å¤§çº¦ 10 ä¸‡æ¡â€œæœç´¢å…³é”®è¯â€ä¿¡æ¯ï¼Œæ¯æ¡ä¿¡æ¯åŒ…å«å…³é”®è¯ã€å…³é”®è¯è¢«æœç´¢çš„æ¬¡æ•°ã€ä¿¡æ¯æœ€è¿‘è¢«æ›´æ–°çš„æ—¶é—´ç­‰ã€‚ç³»ç»Ÿ A åœ¨å¯åŠ¨çš„æ—¶å€™ä¼šåŠ è½½è¿™ä»½æ•°æ®åˆ°å†…å­˜ä¸­ï¼Œç”¨äºå¤„ç†æŸäº›å…¶ä»–çš„ä¸šåŠ¡éœ€æ±‚ã€‚ä¸ºäº†æ–¹ä¾¿å¿«é€Ÿåœ°æŸ¥æ‰¾æŸä¸ªå…³é”®è¯å¯¹åº”çš„ä¿¡æ¯ï¼Œæˆ‘ä»¬ç»™å…³é”®è¯å»ºç«‹ä¸€ä¸ªæ•£åˆ—è¡¨ç´¢å¼•ã€‚</li><li>å¦‚æœä½ ç†Ÿæ‚‰çš„æ˜¯ Java è¯­è¨€ï¼Œå¯ä»¥ç›´æ¥ä½¿ç”¨è¯­è¨€ä¸­æä¾›çš„ HashMap å®¹å™¨æ¥å®ç°ã€‚å…¶ä¸­ï¼ŒHashMap çš„ key ä¸ºæœç´¢å…³é”®è¯ï¼Œvalue ä¸ºå…³é”®è¯è¯¦ç»†ä¿¡æ¯ï¼ˆæ¯”å¦‚æœç´¢æ¬¡æ•°ï¼‰ã€‚æˆ‘ä»¬åªéœ€è¦å°†æ•°æ®ä»æ•°æ®åº“ä¸­è¯»å–å‡ºæ¥ï¼Œæ”¾å…¥ HashMap å°±å¯ä»¥äº†ã€‚</li><li>ä¸è¿‡ï¼Œæˆ‘ä»¬è¿˜æœ‰å¦å¤–ä¸€ä¸ªç³»ç»Ÿ Bï¼Œä¸“é—¨ç”¨æ¥åˆ†ææœç´¢æ—¥å¿—ï¼Œå®šæœŸï¼ˆæ¯”å¦‚é—´éš” 10 åˆ†é’Ÿï¼‰æ‰¹é‡åœ°æ›´æ–°æ•°æ®åº“ä¸­çš„æ•°æ®ï¼Œå¹¶ä¸”æ ‡è®°ä¸ºæ–°çš„æ•°æ®ç‰ˆæœ¬ã€‚æ¯”å¦‚ï¼Œåœ¨ä¸‹é¢çš„ç¤ºä¾‹å›¾ä¸­ï¼Œæˆ‘ä»¬å¯¹ v2 ç‰ˆæœ¬çš„æ•°æ®è¿›è¡Œæ›´æ–°ï¼Œå¾—åˆ° v3 ç‰ˆæœ¬çš„æ•°æ®ã€‚è¿™é‡Œæˆ‘ä»¬å‡è®¾åªæœ‰æ›´æ–°å’Œæ–°æ·»å…³é”®è¯ï¼Œæ²¡æœ‰åˆ é™¤å…³é”®è¯çš„è¡Œä¸ºã€‚</li></ol><p><img src="/2022/09/22/02-chuang-jian-xing-gong-han-jian-zao-zhe-yuan-xing/image-20220923164243728.png"></p><ol><li>ä¸ºäº†ä¿è¯ç³»ç»Ÿ A ä¸­æ•°æ®çš„å®æ—¶æ€§ï¼ˆä¸ä¸€å®šéå¸¸å®æ—¶ï¼Œä½†æ•°æ®ä¹Ÿä¸èƒ½å¤ªæ—§ï¼‰ï¼Œç³»ç»Ÿ A éœ€è¦å®šæœŸæ ¹æ®æ•°æ®åº“ä¸­çš„æ•°æ®ï¼Œæ›´æ–°å†…å­˜ä¸­çš„ç´¢å¼•å’Œæ•°æ®ã€‚</li><li>æˆ‘ä»¬è¯¥å¦‚ä½•å®ç°è¿™ä¸ªéœ€æ±‚å‘¢ï¼Ÿå®é™…ä¸Šï¼Œä¹Ÿä¸éš¾ã€‚æˆ‘ä»¬åªéœ€è¦åœ¨ç³»ç»Ÿ A ä¸­ï¼Œè®°å½•å½“å‰æ•°æ®çš„ç‰ˆæœ¬ Va å¯¹åº”çš„æ›´æ–°æ—¶é—´ Taï¼Œä»æ•°æ®åº“ä¸­æå‡ºæ›´æ–°æ—¶é—´å¤§äº Ta çš„æ‰€æœ‰æœç´¢å…³é”®è¯ï¼Œä¹Ÿå°±æ˜¯æ‰¾å‡º Va ç‰ˆæœ¬ä¸æœ€æ–°ç‰ˆæœ¬æ•°æ®çš„â€œå·®é›†â€ï¼Œç„¶åé’ˆå¯¹å·®é›†ä¸­çš„æ¯ä¸ªå…³é”®è¯è¿›è¡Œå¤„ç†ã€‚å¦‚æœå®ƒå·²ç»åœ¨æ•£åˆ—è¡¨ä¸­å­˜åœ¨äº†ï¼Œæˆ‘ä»¬å°±æ›´æ–°ç›¸åº”çš„æœç´¢æ¬¡æ•°ã€æ›´æ–°æ—¶é—´ç­‰ä¿¡æ¯ï¼›å¦‚æœå®ƒåœ¨æ•£åˆ—è¡¨ä¸­ä¸å­˜åœ¨ï¼Œæˆ‘ä»¬å°±å°†å®ƒæ’å…¥åˆ°æ•£åˆ—è¡¨ä¸­ã€‚</li><li>æŒ‰ç…§è¿™ä¸ªè®¾è®¡æ€è·¯ï¼Œæˆ‘ç»™å‡ºçš„ç¤ºä¾‹ä»£ç å¦‚ä¸‹æ‰€ç¤ºï¼š</li></ol><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Demo</span> &#123;<br>  <span class="hljs-keyword">private</span> ConcurrentHashMap&lt;String, SearchWord&gt; currentKeywords = <span class="hljs-keyword">new</span> <span class="hljs-title class_">ConcurrentHashMap</span>&lt;&gt;();<br>  <span class="hljs-keyword">private</span> <span class="hljs-type">long</span> <span class="hljs-variable">lastUpdateTime</span> <span class="hljs-operator">=</span> -<span class="hljs-number">1</span>;<br><br>  <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">refresh</span><span class="hljs-params">()</span> &#123;<br>    <span class="hljs-comment">// ä»æ•°æ®åº“ä¸­å–å‡ºæ›´æ–°æ—¶é—´&gt;lastUpdateTimeçš„æ•°æ®ï¼Œæ”¾å…¥åˆ°currentKeywordsä¸­</span><br>    List&lt;SearchWord&gt; toBeUpdatedSearchWords = getSearchWords(lastUpdateTime);<br>    <span class="hljs-type">long</span> <span class="hljs-variable">maxNewUpdatedTime</span> <span class="hljs-operator">=</span> lastUpdateTime;<br>    <span class="hljs-keyword">for</span> (SearchWord searchWord : toBeUpdatedSearchWords) &#123;<br>      <span class="hljs-keyword">if</span> (searchWord.getLastUpdateTime() &gt; maxNewUpdatedTime) &#123;<br>        maxNewUpdatedTime = searchWord.getLastUpdateTime();<br>      &#125;<br>      <span class="hljs-keyword">if</span> (currentKeywords.containsKey(searchWord.getKeyword())) &#123;<br>        currentKeywords.replace(searchWord.getKeyword(), searchWord);<br>      &#125; <span class="hljs-keyword">else</span> &#123;<br>        currentKeywords.put(searchWord.getKeyword(), searchWord);<br>      &#125;<br>    &#125;<br><br>    lastUpdateTime = maxNewUpdatedTime;<br>  &#125;<br><br>  <span class="hljs-keyword">private</span> List&lt;SearchWord&gt; <span class="hljs-title function_">getSearchWords</span><span class="hljs-params">(<span class="hljs-type">long</span> lastUpdateTime)</span> &#123;<br>    <span class="hljs-comment">// <span class="hljs-doctag">TODO:</span> ä»æ•°æ®åº“ä¸­å–å‡ºæ›´æ–°æ—¶é—´&gt;lastUpdateTimeçš„æ•°æ®</span><br>    <span class="hljs-keyword">return</span> <span class="hljs-literal">null</span>;<br>  &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>ä¸è¿‡ï¼Œç°åœ¨ï¼Œæˆ‘ä»¬æœ‰ä¸€ä¸ªç‰¹æ®Šçš„è¦æ±‚ï¼šä»»ä½•æ—¶åˆ»ï¼Œç³»ç»Ÿ A ä¸­çš„æ‰€æœ‰æ•°æ®éƒ½å¿…é¡»æ˜¯åŒä¸€ä¸ªç‰ˆæœ¬çš„ï¼Œè¦ä¹ˆéƒ½æ˜¯ç‰ˆæœ¬ aï¼Œè¦ä¹ˆéƒ½æ˜¯ç‰ˆæœ¬ bï¼Œä¸èƒ½æœ‰çš„æ˜¯ç‰ˆæœ¬ aï¼Œæœ‰çš„æ˜¯ç‰ˆæœ¬ bã€‚é‚£åˆšåˆšçš„æ›´æ–°æ–¹å¼å°±ä¸èƒ½æ»¡è¶³è¿™ä¸ªè¦æ±‚äº†ï¼ˆå› ä¸ºæ•°æ®å¾ˆå¤šï¼Œä¸€ä¸ªä¸€ä¸ªçš„forå¾ªç¯è‚¯å®šä¼šå‡ºç°ä¸åŒæ•°æ®ç‰ˆæœ¬çš„é—®é¢˜ï¼‰ã€‚é™¤æ­¤ä¹‹å¤–ï¼Œæˆ‘ä»¬è¿˜è¦æ±‚ï¼šåœ¨æ›´æ–°å†…å­˜æ•°æ®çš„æ—¶å€™ï¼Œç³»ç»Ÿ A ä¸èƒ½å¤„äºä¸å¯ç”¨çŠ¶æ€ï¼Œä¹Ÿå°±æ˜¯ä¸èƒ½åœæœºæ›´æ–°æ•°æ®ã€‚</p><ol><li>é‚£æˆ‘ä»¬è¯¥å¦‚ä½•å®ç°ç°åœ¨è¿™ä¸ªéœ€æ±‚å‘¢ï¼Ÿ</li><li>å®é™…ä¸Šï¼Œä¹Ÿä¸éš¾ã€‚æˆ‘ä»¬æŠŠæ­£åœ¨ä½¿ç”¨çš„æ•°æ®çš„ç‰ˆæœ¬å®šä¹‰ä¸ºâ€œæœåŠ¡ç‰ˆæœ¬â€ï¼Œå½“æˆ‘ä»¬è¦æ›´æ–°å†…å­˜ä¸­çš„æ•°æ®çš„æ—¶å€™ï¼Œæˆ‘ä»¬å¹¶ä¸æ˜¯ç›´æ¥åœ¨æœåŠ¡ç‰ˆæœ¬ï¼ˆå‡è®¾æ˜¯ç‰ˆæœ¬ a æ•°æ®ï¼‰ä¸Šæ›´æ–°ï¼Œè€Œæ˜¯é‡æ–°åˆ›å»ºå¦ä¸€ä¸ªç‰ˆæœ¬æ•°æ®ï¼ˆå‡è®¾æ˜¯ç‰ˆæœ¬ b æ•°æ®ï¼‰ï¼Œç­‰æ–°çš„ç‰ˆæœ¬æ•°æ®å»ºå¥½ä¹‹åï¼Œå†ä¸€æ¬¡æ€§åœ°å°†æœåŠ¡ç‰ˆæœ¬ä»ç‰ˆæœ¬ a åˆ‡æ¢åˆ°ç‰ˆæœ¬ bã€‚è¿™æ ·æ—¢ä¿è¯äº†æ•°æ®ä¸€ç›´å¯ç”¨ï¼Œåˆé¿å…äº†ä¸­é—´çŠ¶æ€çš„å­˜åœ¨ã€‚</li><li>æŒ‰ç…§è¿™ä¸ªè®¾è®¡æ€è·¯ï¼Œç¤ºä¾‹ä»£ç å¦‚ä¸‹æ‰€ç¤ºï¼š</li></ol><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Demo</span> &#123;<br>  <span class="hljs-keyword">private</span> HashMap&lt;String, SearchWord&gt; currentKeywords=<span class="hljs-keyword">new</span> <span class="hljs-title class_">HashMap</span>&lt;&gt;();<br><br>  <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">refresh</span><span class="hljs-params">()</span> &#123;<br>    HashMap&lt;String, SearchWord&gt; newKeywords = <span class="hljs-keyword">new</span> <span class="hljs-title class_">LinkedHashMap</span>&lt;&gt;();<br><br>    <span class="hljs-comment">// ä»æ•°æ®åº“ä¸­å–å‡ºæ‰€æœ‰çš„æ•°æ®ï¼Œæ”¾å…¥åˆ°newKeywordsä¸­</span><br>    List&lt;SearchWord&gt; toBeUpdatedSearchWords = getSearchWords();<br>    <span class="hljs-keyword">for</span> (SearchWord searchWord : toBeUpdatedSearchWords) &#123;<br>      newKeywords.put(searchWord.getKeyword(), searchWord);<br>    &#125;<br><br>    currentKeywords = newKeywords;<br>  &#125;<br><br>  <span class="hljs-keyword">private</span> List&lt;SearchWord&gt; <span class="hljs-title function_">getSearchWords</span><span class="hljs-params">()</span> &#123;<br>    <span class="hljs-comment">// <span class="hljs-doctag">TODO:</span> ä»æ•°æ®åº“ä¸­å–å‡ºæ‰€æœ‰çš„æ•°æ®</span><br>    <span class="hljs-keyword">return</span> <span class="hljs-literal">null</span>;<br>  &#125;<br>&#125;<br></code></pre></td></tr></table></figure><ol><li>ä¸è¿‡ï¼Œåœ¨ä¸Šé¢çš„ä»£ç å®ç°ä¸­ï¼ŒnewKeywords æ„å»ºçš„æˆæœ¬æ¯”è¾ƒé«˜ã€‚æˆ‘ä»¬éœ€è¦å°†è¿™ 10 ä¸‡æ¡æ•°æ®ä»æ•°æ®åº“ä¸­è¯»å‡ºï¼Œç„¶åè®¡ç®—å“ˆå¸Œå€¼ï¼Œæ„å»º newKeywordsã€‚è¿™ä¸ªè¿‡ç¨‹æ˜¾ç„¶æ˜¯æ¯”è¾ƒè€—æ—¶ã€‚ä¸ºäº†æé«˜æ•ˆç‡ï¼ŒåŸå‹æ¨¡å¼å°±æ´¾ä¸Šç”¨åœºäº†ã€‚</li><li>æˆ‘ä»¬æ‹·è´ currentKeywords æ•°æ®åˆ° newKeywords ä¸­ï¼Œç„¶åä»æ•°æ®åº“ä¸­åªæå‡ºæ–°å¢æˆ–è€…æœ‰æ›´æ–°çš„å…³é”®è¯ï¼Œæ›´æ–°åˆ° newKeywords ä¸­ã€‚è€Œç›¸å¯¹äº 10 ä¸‡æ¡æ•°æ®æ¥è¯´ï¼Œæ¯æ¬¡æ–°å¢æˆ–è€…æ›´æ–°çš„å…³é”®è¯ä¸ªæ•°æ˜¯æ¯”è¾ƒå°‘çš„ï¼Œæ‰€ä»¥ï¼Œè¿™ç§ç­–ç•¥å¤§å¤§æé«˜äº†æ•°æ®æ›´æ–°çš„æ•ˆç‡ã€‚</li><li>æŒ‰ç…§è¿™ä¸ªè®¾è®¡æ€è·¯ï¼Œæˆ‘ç»™å‡ºçš„ç¤ºä¾‹ä»£ç å¦‚ä¸‹æ‰€ç¤ºï¼š</li></ol><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Demo</span> &#123;<br>  <span class="hljs-keyword">private</span> HashMap&lt;String, SearchWord&gt; currentKeywords=<span class="hljs-keyword">new</span> <span class="hljs-title class_">HashMap</span>&lt;&gt;();<br>  <span class="hljs-keyword">private</span> <span class="hljs-type">long</span> <span class="hljs-variable">lastUpdateTime</span> <span class="hljs-operator">=</span> -<span class="hljs-number">1</span>;<br><br>  <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">refresh</span><span class="hljs-params">()</span> &#123;<br>    <span class="hljs-comment">// åŸå‹æ¨¡å¼å°±è¿™ä¹ˆç®€å•ï¼Œæ‹·è´å·²æœ‰å¯¹è±¡çš„æ•°æ®ï¼Œæ›´æ–°å°‘é‡å·®å€¼</span><br>    HashMap&lt;String, SearchWord&gt; newKeywords = (HashMap&lt;String, SearchWord&gt;) currentKeywords.clone();<br><br>    <span class="hljs-comment">// ä»æ•°æ®åº“ä¸­å–å‡ºæ›´æ–°æ—¶é—´&gt;lastUpdateTimeçš„æ•°æ®ï¼Œæ”¾å…¥åˆ°newKeywordsä¸­</span><br>    List&lt;SearchWord&gt; toBeUpdatedSearchWords = getSearchWords(lastUpdateTime);<br>    <span class="hljs-type">long</span> <span class="hljs-variable">maxNewUpdatedTime</span> <span class="hljs-operator">=</span> lastUpdateTime;<br>    <span class="hljs-keyword">for</span> (SearchWord searchWord : toBeUpdatedSearchWords) &#123;<br>      <span class="hljs-keyword">if</span> (searchWord.getLastUpdateTime() &gt; maxNewUpdatedTime) &#123;<br>        maxNewUpdatedTime = searchWord.getLastUpdateTime();<br>      &#125;<br>      <span class="hljs-keyword">if</span> (newKeywords.containsKey(searchWord.getKeyword())) &#123;<br>        <span class="hljs-type">SearchWord</span> <span class="hljs-variable">oldSearchWord</span> <span class="hljs-operator">=</span> newKeywords.get(searchWord.getKeyword());<br>        oldSearchWord.setCount(searchWord.getCount());<br>        oldSearchWord.setLastUpdateTime(searchWord.getLastUpdateTime());<br>      &#125; <span class="hljs-keyword">else</span> &#123;<br>        newKeywords.put(searchWord.getKeyword(), searchWord);<br>      &#125;<br>    &#125;<br><br>    lastUpdateTime = maxNewUpdatedTime;<br>    currentKeywords = newKeywords;<br>  &#125;<br><br>  <span class="hljs-keyword">private</span> List&lt;SearchWord&gt; <span class="hljs-title function_">getSearchWords</span><span class="hljs-params">(<span class="hljs-type">long</span> lastUpdateTime)</span> &#123;<br>    <span class="hljs-comment">// <span class="hljs-doctag">TODO:</span> ä»æ•°æ®åº“ä¸­å–å‡ºæ›´æ–°æ—¶é—´&gt;lastUpdateTimeçš„æ•°æ®</span><br>    <span class="hljs-keyword">return</span> <span class="hljs-literal">null</span>;<br>  &#125;<br>&#125;<br></code></pre></td></tr></table></figure><ol><li>è¿™é‡Œåˆ©ç”¨äº† Java ä¸­çš„ clone() è¯­æ³•æ¥å¤åˆ¶ä¸€ä¸ªå¯¹è±¡ã€‚å¦‚æœä½ ç†Ÿæ‚‰çš„è¯­è¨€æ²¡æœ‰è¿™ä¸ªè¯­æ³•ï¼Œé‚£æŠŠæ•°æ®ä» currentKeywords ä¸­ä¸€ä¸ªä¸ªå–å‡ºæ¥ï¼Œç„¶åå†é‡æ–°è®¡ç®—å“ˆå¸Œå€¼ï¼Œæ”¾å…¥åˆ° newKeywords ä¸­ä¹Ÿæ˜¯å¯ä»¥æ¥å—çš„ã€‚æ¯•ç«Ÿï¼Œæœ€è€—æ—¶çš„è¿˜æ˜¯ä»æ•°æ®åº“ä¸­å–æ•°æ®çš„æ“ä½œã€‚ç›¸å¯¹äºæ•°æ®åº“çš„ IO æ“ä½œæ¥è¯´ï¼Œå†…å­˜æ“ä½œå’Œ CPU è®¡ç®—çš„è€—æ—¶éƒ½æ˜¯å¯ä»¥å¿½ç•¥çš„ã€‚</li><li>ä¸è¿‡ï¼Œä¸çŸ¥é“ä½ æœ‰æ²¡æœ‰å‘ç°ï¼Œå®é™…ä¸Šï¼Œåˆšåˆšçš„ä»£ç å®ç°æ˜¯æœ‰é—®é¢˜çš„ã€‚è¦å¼„æ˜ç™½åˆ°åº•æœ‰ä»€ä¹ˆé—®é¢˜ï¼Œæˆ‘ä»¬éœ€è¦å…ˆäº†è§£å¦å¤–ä¸¤ä¸ªæ¦‚å¿µï¼šæ·±æ‹·è´ï¼ˆDeep Copyï¼‰å’Œæµ…æ‹·è´ï¼ˆShallow Copyï¼‰ã€‚</li></ol><h3 id="2ã€åŸå‹æ¨¡å¼çš„å®ç°æ–¹å¼ï¼šæ·±æ‹·è´ä¸æµ…æ‹·è´"><a href="#2ã€åŸå‹æ¨¡å¼çš„å®ç°æ–¹å¼ï¼šæ·±æ‹·è´ä¸æµ…æ‹·è´" class="headerlink" title="2ã€åŸå‹æ¨¡å¼çš„å®ç°æ–¹å¼ï¼šæ·±æ‹·è´ä¸æµ…æ‹·è´"></a>2ã€åŸå‹æ¨¡å¼çš„å®ç°æ–¹å¼ï¼šæ·±æ‹·è´ä¸æµ…æ‹·è´</h3><blockquote><p>æ‹·è´çš„å¼•å…¥</p></blockquote><p>1ã€å¼•ç”¨æ‹·è´</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-type">Teacher</span> <span class="hljs-variable">teacher</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Teacher</span>(<span class="hljs-string">&quot;Taylor&quot;</span>,<span class="hljs-number">26</span>);<br><span class="hljs-type">Teacher</span> <span class="hljs-variable">otherteacher</span> <span class="hljs-operator">=</span> teacher;<br>System.out.println(teacher);<br>System.out.println(otherteacher);<br></code></pre></td></tr></table></figure><p>è¾“å‡ºç»“æœï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs java">blog.Teacher@355da254<br>blog.Teacher@355da254<br></code></pre></td></tr></table></figure><p>ç”±è¾“å‡ºç»“æœå¯ä»¥çœ‹å‡ºï¼ŒäºŒè€…çš„åœ°å€å€¼æ˜¯ç›¸åŒçš„ï¼Œé‚£ä¹ˆè‚¯å®šå°±æ˜¯åŒä¸€ä¸ªå¯¹è±¡ï¼Œteacherå’Œotherteacheråªæ˜¯ä¸åŒçš„å¼•ç”¨è€Œå·²ã€‚</p><p><img src="/2022/09/22/02-chuang-jian-xing-gong-han-jian-zao-zhe-yuan-xing/image-20220923165539504.png" alt="å¼•ç”¨æ‹·è´"></p><p>2ã€å¯¹è±¡æ‹·è´</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-type">Teacher</span> <span class="hljs-variable">teacher</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Teacher</span>(<span class="hljs-string">&quot;Swift&quot;</span>,<span class="hljs-number">26</span>);<br><span class="hljs-type">Teacher</span> <span class="hljs-variable">otherteacher</span> <span class="hljs-operator">=</span> (Teacher)teacher.clone();<br>System.out.println(teacher);<br>System.out.println(otherteacher);<br></code></pre></td></tr></table></figure><p>è¾“å‡ºç»“æœï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs java">blog.Teacher@355da254<br>blog.Teacher@4dc63996<br></code></pre></td></tr></table></figure><p>ç”±ç»“æœå¯ä»¥çœ‹å‡ºï¼Œåœ°å€å€¼ä¸åŒï¼Œä¹Ÿå°±æ˜¯è¯´äºŒè€…æ˜¯ä¸åŒçš„å¯¹è±¡ï¼Œè€Œä¸æ˜¯æŠŠåŸå¯¹è±¡çš„åœ°å€èµ‹ç»™äº†ä¸€ä¸ªæ–°çš„å¼•ç”¨å˜é‡,è¿™å°±å«åšå¯¹è±¡æ‹·è´ã€‚</p><p><img src="/2022/09/22/02-chuang-jian-xing-gong-han-jian-zao-zhe-yuan-xing/image-20220923165730368.png" alt="å¯¹è±¡æ‹·è´"></p><p>==æ³¨ï¼šæ·±æ‹·è´å’Œæµ…æ‹·è´éƒ½æ˜¯å¯¹è±¡æ‹·è´==</p><blockquote><p>æµ…æ‹·è´</p></blockquote><ul><li>å¯¹äºæ•°æ®ç±»å‹æ˜¯åŸºæœ¬æ•°æ®ç±»å‹çš„æˆå‘˜å˜é‡ï¼Œæµ…æ‹·è´ä¼šç›´æ¥è¿›è¡Œå€¼æ‹·è´ï¼Œä¹Ÿå°±æ˜¯å°†è¯¥å±æ€§å€¼å¤åˆ¶ä¸€ä»½ç»™æ–°çš„å¯¹è±¡ã€‚å› ä¸ºæ˜¯ä¸¤ä»½ä¸åŒçš„æ•°æ®ï¼Œæ‰€ä»¥å¯¹å…¶ä¸­ä¸€ä¸ªå¯¹è±¡çš„è¯¥æˆå‘˜å˜é‡å€¼è¿›è¡Œä¿®æ”¹ï¼Œä¸ä¼šå½±å“å¦ä¸€ä¸ªå¯¹è±¡æ‹·è´å¾—åˆ°çš„æ•°æ®</li><li>å¯¹äºæ•°æ®ç±»å‹æ˜¯å¼•ç”¨æ•°æ®ç±»å‹çš„æˆå‘˜å˜é‡(ä¹Ÿå°±æ˜¯å­å¯¹è±¡ï¼Œæˆ–è€…æ•°ç»„å•¥çš„)ï¼Œä¹Ÿå°±æ˜¯åªæ˜¯å°†è¯¥æˆå‘˜å˜é‡çš„å¼•ç”¨å€¼ï¼ˆå¼•ç”¨æ‹·è´ã€å¹¶å‘å¼•ç”¨ä¼ é€’ï¼ŒJavaæœ¬è´¨è¿˜æ˜¯å€¼ä¼ é€’ã€‘ï¼‰å¤åˆ¶ä¸€ä»½ç»™æ–°çš„å¯¹è±¡ã€‚å› ä¸ºå®é™…ä¸Šä¸¤ä¸ªå¯¹è±¡çš„è¯¥æˆå‘˜å˜é‡éƒ½æŒ‡å‘åŒä¸€ä¸ªå®ä¾‹ã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œåœ¨ä¸€ä¸ªå¯¹è±¡ä¸­ä¿®æ”¹è¯¥æˆå‘˜å˜é‡ä¼šå½±å“åˆ°å¦ä¸€ä¸ªå¯¹è±¡çš„è¯¥æˆå‘˜å˜é‡å€¼ã€‚</li></ul><blockquote><p>æ·±æ‹·è´</p></blockquote><ul><li>å¯¹åŸºæœ¬æ•°æ®ç±»å‹è¿›è¡Œå€¼ä¼ é€’ï¼Œå¯¹å¼•ç”¨æ•°æ®ç±»å‹ï¼Œåˆ›å»ºä¸€ä¸ªæ–°çš„å¯¹è±¡ï¼Œå¹¶å¤åˆ¶å…¶å†…å®¹ï¼Œæ­¤ä¸ºæ·±æ‹·è´ã€‚</li><li>ä¹Ÿå°±æ˜¯è¯´æµ…æ‹·è´å¯¹äºå­å¯¹è±¡åªæ˜¯æ‹·è´äº†å¼•ç”¨å€¼ï¼Œå¹¶æ²¡æœ‰çœŸæ­£çš„æ‹·è´æ•´ä¸ªå¯¹è±¡ã€‚</li></ul><p>åœ¨å†…å­˜ä¸­ï¼Œç”¨æ•£åˆ—è¡¨ç»„ç»‡çš„æœç´¢å…³é”®è¯ä¿¡æ¯æ˜¯å¦‚ä½•å­˜å‚¨çš„ã€‚ä»ä¸‹å›¾ä¸­æˆ‘ä»¬å¯ä»¥å‘ç°ï¼Œæ•£åˆ—è¡¨ç´¢å¼•ä¸­ï¼Œæ¯ä¸ªç»“ç‚¹å­˜å‚¨çš„ key æ˜¯æœç´¢å…³é”®è¯ï¼Œvalue æ˜¯ SearchWord å¯¹è±¡çš„å†…å­˜åœ°å€ã€‚SearchWord å¯¹è±¡æœ¬èº«å­˜å‚¨åœ¨æ•£åˆ—è¡¨ä¹‹å¤–çš„å†…å­˜ç©ºé—´ä¸­ã€‚</p><p><img src="/2022/09/22/02-chuang-jian-xing-gong-han-jian-zao-zhe-yuan-xing/image-20220923171124069.png"></p><p>æµ…æ‹·è´å’Œæ·±æ‹·è´çš„åŒºåˆ«åœ¨äºï¼Œæµ…æ‹·è´åªä¼šå¤åˆ¶å›¾ä¸­çš„ç´¢å¼•ï¼ˆæ•£åˆ—è¡¨ï¼‰ï¼Œä¸ä¼šå¤åˆ¶æ•°æ®ï¼ˆSearchWord å¯¹è±¡ï¼‰æœ¬èº«ã€‚ç›¸åï¼Œæ·±æ‹·è´ä¸ä»…ä»…ä¼šå¤åˆ¶ç´¢å¼•ï¼Œè¿˜ä¼šå¤åˆ¶æ•°æ®æœ¬èº«ã€‚æµ…æ‹·è´å¾—åˆ°çš„å¯¹è±¡ï¼ˆnewKeywordsï¼‰è·ŸåŸå§‹å¯¹è±¡ï¼ˆcurrentKeywordsï¼‰å…±äº«æ•°æ®ï¼ˆSearchWord å¯¹è±¡ï¼‰ï¼Œè€Œæ·±æ‹·è´å¾—åˆ°çš„æ˜¯ä¸€ä»½å®Œå®Œå…¨å…¨ç‹¬ç«‹çš„å¯¹è±¡ã€‚å…·ä½“çš„å¯¹æ¯”å¦‚ä¸‹å›¾æ‰€ç¤ºï¼š</p><p><img src="/2022/09/22/02-chuang-jian-xing-gong-han-jian-zao-zhe-yuan-xing/image-20220923171203280.png" alt="æµ…æ‹·è´"></p><p><img src="/2022/09/22/02-chuang-jian-xing-gong-han-jian-zao-zhe-yuan-xing/image-20220923171227022.png" alt="æ·±æ‹·è´"></p><ol><li>åœ¨ Java è¯­è¨€ä¸­ï¼ŒObject ç±»çš„ clone() æ–¹æ³•æ‰§è¡Œçš„å°±æ˜¯æµ…æ‹·è´ã€‚å®ƒåªä¼šæ‹·è´å¯¹è±¡ä¸­çš„åŸºæœ¬æ•°æ®ç±»å‹çš„æ•°æ®ï¼ˆæ¯”å¦‚ï¼Œintã€longï¼‰ï¼Œä»¥åŠå¼•ç”¨å¯¹è±¡ï¼ˆSearchWordï¼‰çš„å†…å­˜åœ°å€ï¼Œä¸ä¼šé€’å½’åœ°æ‹·è´å¼•ç”¨å¯¹è±¡æœ¬èº«ã€‚</li><li>åœ¨ä¸Šé¢çš„ä»£ç ä¸­ï¼Œæˆ‘ä»¬é€šè¿‡è°ƒç”¨ HashMap ä¸Šçš„ clone() æµ…æ‹·è´æ–¹æ³•æ¥å®ç°åŸå‹æ¨¡å¼ã€‚å½“æˆ‘ä»¬é€šè¿‡ newKeywords æ›´æ–° SearchWord å¯¹è±¡çš„æ—¶å€™ï¼ˆæ¯”å¦‚ï¼Œæ›´æ–°â€œè®¾è®¡æ¨¡å¼â€è¿™ä¸ªæœç´¢å…³é”®è¯çš„è®¿é—®æ¬¡æ•°ï¼‰ï¼ŒnewKeywords å’Œ currentKeywords å› ä¸ºæŒ‡å‘ç›¸åŒçš„ä¸€ç»„ SearchWord å¯¹è±¡ï¼Œå°±ä¼šå¯¼è‡´ currentKeywords ä¸­æŒ‡å‘çš„ SearchWordï¼Œæœ‰çš„æ˜¯è€ç‰ˆæœ¬çš„ï¼Œæœ‰çš„æ˜¯æ–°ç‰ˆæœ¬çš„ï¼Œå°±æ²¡æ³•æ»¡è¶³æˆ‘ä»¬ä¹‹å‰çš„éœ€æ±‚ï¼šcurrentKeywords ä¸­çš„æ•°æ®åœ¨ä»»ä½•æ—¶åˆ»éƒ½æ˜¯åŒä¸€ä¸ªç‰ˆæœ¬çš„ï¼Œä¸å­˜åœ¨ä»‹äºè€ç‰ˆæœ¬ä¸æ–°ç‰ˆæœ¬ä¹‹é—´çš„ä¸­é—´çŠ¶æ€ã€‚</li></ol><p>æˆ‘ä»¬å¯ä»¥å°†æµ…æ‹·è´æ›¿æ¢ä¸ºæ·±æ‹·è´ã€‚newKeywords ä¸ä»…ä»…å¤åˆ¶ currentKeywords çš„ç´¢å¼•ï¼Œè¿˜æŠŠ SearchWord å¯¹è±¡ä¹Ÿå¤åˆ¶ä¸€ä»½å‡ºæ¥ï¼Œè¿™æ · newKeywords å’Œ currentKeywords å°±æŒ‡å‘ä¸åŒçš„ SearchWord å¯¹è±¡ï¼Œä¹Ÿå°±ä¸å­˜åœ¨æ›´æ–° newKeywords çš„æ•°æ®ä¼šå¯¼è‡´ currentKeywords çš„æ•°æ®ä¹Ÿè¢«æ›´æ–°çš„é—®é¢˜äº†ã€‚</p><p>å¦‚ä½•å®ç°æ·±æ‹·è´ï¼Œæœ‰å¦‚ä¸‹ä¸¤ç§æ–¹æ³•ï¼š</p><p>ç¬¬ä¸€ç§æ–¹æ³•ï¼š<code>é€’å½’æ‹·è´å¯¹è±¡ã€å¯¹è±¡çš„å¼•ç”¨å¯¹è±¡ä»¥åŠå¼•ç”¨å¯¹è±¡çš„å¼•ç”¨å¯¹è±¡</code>â€¦â€¦ç›´åˆ°è¦æ‹·è´çš„å¯¹è±¡åªåŒ…å«åŸºæœ¬æ•°æ®ç±»å‹æ•°æ®ï¼Œæ²¡æœ‰å¼•ç”¨å¯¹è±¡ä¸ºæ­¢ã€‚æ ¹æ®è¿™ä¸ªæ€è·¯å¯¹ä¹‹å‰çš„ä»£ç è¿›è¡Œé‡æ„ã€‚é‡æ„ä¹‹åçš„ä»£ç å¦‚ä¸‹æ‰€ç¤ºï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Demo</span> &#123;<br>  <span class="hljs-keyword">private</span> HashMap&lt;String, SearchWord&gt; currentKeywords=<span class="hljs-keyword">new</span> <span class="hljs-title class_">HashMap</span>&lt;&gt;();<br>  <span class="hljs-keyword">private</span> <span class="hljs-type">long</span> <span class="hljs-variable">lastUpdateTime</span> <span class="hljs-operator">=</span> -<span class="hljs-number">1</span>;<br><br>  <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">refresh</span><span class="hljs-params">()</span> &#123;<br>    <span class="hljs-comment">// Deep copy</span><br>    HashMap&lt;String, SearchWord&gt; newKeywords = <span class="hljs-keyword">new</span> <span class="hljs-title class_">HashMap</span>&lt;&gt;();<br>    <span class="hljs-keyword">for</span> (HashMap.Entry&lt;String, SearchWord&gt; e : currentKeywords.entrySet()) &#123;<br>      <span class="hljs-type">SearchWord</span> <span class="hljs-variable">searchWord</span> <span class="hljs-operator">=</span> e.getValue();<br>      <span class="hljs-type">SearchWord</span> <span class="hljs-variable">newSearchWord</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">SearchWord</span>(<br>              searchWord.getKeyword(), searchWord.getCount(), searchWord.getLastUpdateTime());<br>      newKeywords.put(e.getKey(), newSearchWord);<br>    &#125;<br><br>    <span class="hljs-comment">// ä»æ•°æ®åº“ä¸­å–å‡ºæ›´æ–°æ—¶é—´&gt;lastUpdateTimeçš„æ•°æ®ï¼Œæ”¾å…¥åˆ°newKeywordsä¸­</span><br>    List&lt;SearchWord&gt; toBeUpdatedSearchWords = getSearchWords(lastUpdateTime);<br>    <span class="hljs-type">long</span> <span class="hljs-variable">maxNewUpdatedTime</span> <span class="hljs-operator">=</span> lastUpdateTime;<br>    <span class="hljs-keyword">for</span> (SearchWord searchWord : toBeUpdatedSearchWords) &#123;<br>      <span class="hljs-keyword">if</span> (searchWord.getLastUpdateTime() &gt; maxNewUpdatedTime) &#123;<br>        maxNewUpdatedTime = searchWord.getLastUpdateTime();<br>      &#125;<br>      <span class="hljs-keyword">if</span> (newKeywords.containsKey(searchWord.getKeyword())) &#123;<br>        <span class="hljs-type">SearchWord</span> <span class="hljs-variable">oldSearchWord</span> <span class="hljs-operator">=</span> newKeywords.get(searchWord.getKeyword());<br>        oldSearchWord.setCount(searchWord.getCount());<br>        oldSearchWord.setLastUpdateTime(searchWord.getLastUpdateTime());<br>      &#125; <span class="hljs-keyword">else</span> &#123;<br>        newKeywords.put(searchWord.getKeyword(), searchWord);<br>      &#125;<br>    &#125;<br><br>    lastUpdateTime = maxNewUpdatedTime;<br>    currentKeywords = newKeywords;<br>  &#125;<br><br>  <span class="hljs-keyword">private</span> List&lt;SearchWord&gt; <span class="hljs-title function_">getSearchWords</span><span class="hljs-params">(<span class="hljs-type">long</span> lastUpdateTime)</span> &#123;<br>    <span class="hljs-comment">// <span class="hljs-doctag">TODO:</span> ä»æ•°æ®åº“ä¸­å–å‡ºæ›´æ–°æ—¶é—´&gt;lastUpdateTimeçš„æ•°æ®</span><br>    <span class="hljs-keyword">return</span> <span class="hljs-literal">null</span>;<br>  &#125;<br><br>&#125;<br></code></pre></td></tr></table></figure><p>ç¬¬äºŒç§æ–¹æ³•ï¼š<code>å…ˆå°†å¯¹è±¡åºåˆ—åŒ–ï¼Œç„¶åå†ååºåˆ—åŒ–æˆæ–°çš„å¯¹è±¡</code>ã€‚å…·ä½“çš„ç¤ºä¾‹ä»£ç å¦‚ä¸‹æ‰€ç¤ºï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> Object <span class="hljs-title function_">deepCopy</span><span class="hljs-params">(Object object)</span> &#123;<br>  <span class="hljs-comment">// åºåˆ—åŒ–</span><br>  <span class="hljs-type">ByteArrayOutputStream</span> <span class="hljs-variable">bo</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">ByteArrayOutputStream</span>();<br>  <span class="hljs-type">ObjectOutputStream</span> <span class="hljs-variable">oo</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">ObjectOutputStream</span>(bo);<br>  oo.writeObject(object);<br>  <br>  <span class="hljs-comment">// ååºåˆ—åŒ–</span><br>  <span class="hljs-type">ByteArrayInputStream</span> <span class="hljs-variable">bi</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">ByteArrayInputStream</span>(bo.toByteArray());<br>  <span class="hljs-type">ObjectInputStream</span> <span class="hljs-variable">oi</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">ObjectInputStream</span>(bi);<br>  <br>  <span class="hljs-keyword">return</span> oi.readObject();<br>&#125;<br></code></pre></td></tr></table></figure><ol><li>åˆšåˆšçš„ä¸¤ç§å®ç°æ–¹æ³•ï¼Œä¸ç®¡é‡‡ç”¨å“ªç§ï¼Œæ·±æ‹·è´éƒ½è¦æ¯”æµ…æ‹·è´è€—æ—¶ã€è€—å†…å­˜ç©ºé—´ã€‚é’ˆå¯¹è¿™ä¸ªåº”ç”¨åœºæ™¯ï¼Œæœ‰æ²¡æœ‰æ›´å¿«ã€æ›´çœå†…å­˜çš„å®ç°æ–¹å¼å‘¢ï¼Ÿ</li><li>å¯ä»¥å…ˆé‡‡ç”¨æµ…æ‹·è´çš„æ–¹å¼åˆ›å»º newKeywordsã€‚å¯¹äºéœ€è¦æ›´æ–°çš„ SearchWord å¯¹è±¡ï¼Œå†ä½¿ç”¨æ·±åº¦æ‹·è´çš„æ–¹å¼åˆ›å»ºä¸€ä»½æ–°çš„å¯¹è±¡ï¼Œæ›¿æ¢ newKeywords ä¸­çš„è€å¯¹è±¡ã€‚æ¯•ç«Ÿéœ€è¦æ›´æ–°çš„æ•°æ®æ˜¯å¾ˆå°‘çš„ã€‚è¿™ç§æ–¹å¼å³åˆ©ç”¨äº†æµ…æ‹·è´èŠ‚çœæ—¶é—´ã€ç©ºé—´çš„ä¼˜ç‚¹ï¼Œåˆèƒ½ä¿è¯ currentKeywords ä¸­çš„ä¸­æ•°æ®éƒ½æ˜¯è€ç‰ˆæœ¬çš„æ•°æ®ã€‚å…·ä½“çš„ä»£ç å®ç°å¦‚ä¸‹æ‰€ç¤ºã€‚è¿™ä¹Ÿæ˜¯æ ‡é¢˜ä¸­è®²åˆ°çš„ï¼Œåœ¨è¿™ä¸ªåº”ç”¨åœºæ™¯ä¸‹ï¼Œæœ€å¿«é€Ÿ clone æ•£åˆ—è¡¨çš„æ–¹å¼ã€‚</li></ol><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Demo</span> &#123;<br>  <span class="hljs-keyword">private</span> HashMap&lt;String, SearchWord&gt; currentKeywords=<span class="hljs-keyword">new</span> <span class="hljs-title class_">HashMap</span>&lt;&gt;();<br>  <span class="hljs-keyword">private</span> <span class="hljs-type">long</span> <span class="hljs-variable">lastUpdateTime</span> <span class="hljs-operator">=</span> -<span class="hljs-number">1</span>;<br><br>  <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">refresh</span><span class="hljs-params">()</span> &#123;<br>    <span class="hljs-comment">// Shallow copy</span><br>    HashMap&lt;String, SearchWord&gt; newKeywords = (HashMap&lt;String, SearchWord&gt;) currentKeywords.clone();<br><br>    <span class="hljs-comment">// ä»æ•°æ®åº“ä¸­å–å‡ºæ›´æ–°æ—¶é—´&gt;lastUpdateTimeçš„æ•°æ®ï¼Œæ”¾å…¥åˆ°newKeywordsä¸­</span><br>    List&lt;SearchWord&gt; toBeUpdatedSearchWords = getSearchWords(lastUpdateTime);<br>    <span class="hljs-type">long</span> <span class="hljs-variable">maxNewUpdatedTime</span> <span class="hljs-operator">=</span> lastUpdateTime;<br>    <span class="hljs-keyword">for</span> (SearchWord searchWord : toBeUpdatedSearchWords) &#123;<br>      <span class="hljs-keyword">if</span> (searchWord.getLastUpdateTime() &gt; maxNewUpdatedTime) &#123;<br>        maxNewUpdatedTime = searchWord.getLastUpdateTime();<br>      &#125;<br>      <span class="hljs-keyword">if</span> (newKeywords.containsKey(searchWord.getKeyword())) &#123;<br>        newKeywords.remove(searchWord.getKeyword());<br>      &#125;<br>      newKeywords.put(searchWord.getKeyword(), searchWord);<br>    &#125;<br><br>    lastUpdateTime = maxNewUpdatedTime;<br>    currentKeywords = newKeywords;<br>  &#125;<br><br>  <span class="hljs-keyword">private</span> List&lt;SearchWord&gt; <span class="hljs-title function_">getSearchWords</span><span class="hljs-params">(<span class="hljs-type">long</span> lastUpdateTime)</span> &#123;<br>    <span class="hljs-comment">// <span class="hljs-doctag">TODO:</span> ä»æ•°æ®åº“ä¸­å–å‡ºæ›´æ–°æ—¶é—´&gt;lastUpdateTimeçš„æ•°æ®</span><br>    <span class="hljs-keyword">return</span> <span class="hljs-literal">null</span>;<br>  &#125;<br>&#125;<br></code></pre></td></tr></table></figure><blockquote><p>å°Šé‡åŸåˆ›ï¼ŒåŸè‘—æ–‡ç« é“¾æ¥ï¼š <a href="https://imlql.cn/post/ba432704.html">https://imlql.cn/post/ba432704.html</a></p></blockquote>]]></content>
    
    
    <categories>
      
      <category>è®¾è®¡æ¨¡å¼</category>
      
    </categories>
    
    
    <tags>
      
      <tag>è®¾è®¡æ¨¡å¼</tag>
      
      <tag>å·¥å‚</tag>
      
      <tag>å»ºé€ è€…</tag>
      
      <tag>åŸå‹</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>01-åˆ›å»ºå‹-å•ä¾‹</title>
    <link href="/2022/09/21/01-chuang-jian-xing-dan-li/"/>
    <url>/2022/09/21/01-chuang-jian-xing-dan-li/</url>
    
    <content type="html"><![CDATA[<h2 id="ä¸€ã€å•ä¾‹è®¾è®¡æ¨¡å¼ä»‹ç»"><a href="#ä¸€ã€å•ä¾‹è®¾è®¡æ¨¡å¼ä»‹ç»" class="headerlink" title="ä¸€ã€å•ä¾‹è®¾è®¡æ¨¡å¼ä»‹ç»"></a>ä¸€ã€å•ä¾‹è®¾è®¡æ¨¡å¼ä»‹ç»</h2><p>å•ä¾‹è®¾è®¡æ¨¡å¼ï¼Œå°±æ˜¯é‡‡ç”¨ä¸€å®šçš„æ–¹æ³•ä¿è¯åœ¨æ•´ä¸ªçš„è½¯ä»¶ç³»ç»Ÿä¸­ï¼Œå¯¹æŸä¸ªç±»åªèƒ½å­˜åœ¨ä¸€ä¸ªå¯¹è±¡å®ä¾‹ï¼Œå¹¶ä¸”è¯¥ç±»åªæä¾›ä¸€ä¸ªå–å¾—å…¶å¯¹è±¡å®ä¾‹çš„æ–¹æ³•ï¼ˆé™æ€æ–¹æ³•ï¼‰ã€‚</p><p>ä¸ºä»€ä¹ˆè¦ä½¿ç”¨å•ä¾‹ï¼Ÿå•ä¾‹è§£å†³å“ªç±»é—®é¢˜ï¼Ÿ</p><p>ä»ä¸šåŠ¡æ¦‚å¿µä¸Šï¼Œå¦‚æœæœ‰äº›æ•°æ®åœ¨ç³»ç»Ÿä¸­åªåº”ä¿å­˜ä¸€ä»½ï¼Œé‚£å°±æ¯”è¾ƒé€‚åˆè®¾è®¡ä¸ºå•ä¾‹ç±»ã€‚æ¯”å¦‚ï¼Œé…ç½®ä¿¡æ¯ç±»ã€‚åœ¨ç³»ç»Ÿä¸­ï¼Œæˆ‘ä»¬åªæœ‰ä¸€ä¸ªé…ç½®æ–‡ä»¶ï¼Œå½“é…ç½®æ–‡ä»¶è¢«åŠ è½½åˆ°å†…å­˜ä¹‹åï¼Œä»¥å¯¹è±¡çš„å½¢å¼å­˜åœ¨ï¼Œä¹Ÿç†æ‰€åº”å½“åªæœ‰ä¸€ä»½ã€‚</p><p>å†æ¯”å¦‚ï¼Œå”¯ä¸€é€’å¢ ID å·ç ç”Ÿæˆå™¨ã€‚å¦‚æœç¨‹åºä¸­æœ‰ä¸¤ä¸ªå¯¹è±¡ï¼Œé‚£å°±ä¼šå­˜åœ¨ç”Ÿæˆé‡å¤ ID çš„æƒ…å†µï¼Œæ‰€ä»¥ï¼Œæˆ‘ä»¬åº”è¯¥å°† ID ç”Ÿæˆå™¨ç±»è®¾è®¡ä¸ºå•ä¾‹ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">IdGenerator</span> &#123;<br>  <span class="hljs-comment">// AtomicLongæ˜¯ä¸€ä¸ªJavaå¹¶å‘åº“ä¸­æä¾›çš„ä¸€ä¸ªåŸå­å˜é‡ç±»å‹,</span><br>  <span class="hljs-comment">// å®ƒå°†ä¸€äº›çº¿ç¨‹ä¸å®‰å…¨éœ€è¦åŠ é”çš„å¤åˆæ“ä½œå°è£…ä¸ºäº†çº¿ç¨‹å®‰å…¨çš„åŸå­æ“ä½œï¼Œ</span><br>  <span class="hljs-comment">// æ¯”å¦‚ä¸‹é¢ä¼šç”¨åˆ°çš„incrementAndGet().</span><br>  <span class="hljs-keyword">private</span> <span class="hljs-type">AtomicLong</span> <span class="hljs-variable">id</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">AtomicLong</span>(<span class="hljs-number">0</span>);<br>  <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> <span class="hljs-type">IdGenerator</span> <span class="hljs-variable">instance</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">IdGenerator</span>();<br>  <span class="hljs-keyword">private</span> <span class="hljs-title function_">IdGenerator</span><span class="hljs-params">()</span> &#123;&#125;<br>  <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> IdGenerator <span class="hljs-title function_">getInstance</span><span class="hljs-params">()</span> &#123;<br>    <span class="hljs-keyword">return</span> instance;<br>  &#125;<br>  <span class="hljs-keyword">public</span> <span class="hljs-type">long</span> <span class="hljs-title function_">getId</span><span class="hljs-params">()</span> &#123; <br>    <span class="hljs-keyword">return</span> id.incrementAndGet();<br>  &#125;<br>&#125;<br><br><span class="hljs-comment">// IdGeneratorä½¿ç”¨ä¸¾ä¾‹</span><br><span class="hljs-type">long</span> <span class="hljs-variable">id</span> <span class="hljs-operator">=</span> IdGenerator.getInstance().getId();<br></code></pre></td></tr></table></figure><h2 id="äºŒã€å®ç°å•ä¾‹"><a href="#äºŒã€å®ç°å•ä¾‹" class="headerlink" title="äºŒã€å®ç°å•ä¾‹"></a>äºŒã€å®ç°å•ä¾‹</h2><p>å®ç°å•ä¾‹çš„å…«ç§æ–¹å¼</p><h3 id="1ã€é¥¿æ±‰å¼ï¼ˆé™æ€å˜é‡ï¼‰"><a href="#1ã€é¥¿æ±‰å¼ï¼ˆé™æ€å˜é‡ï¼‰" class="headerlink" title="1ã€é¥¿æ±‰å¼ï¼ˆé™æ€å˜é‡ï¼‰"></a>1ã€<code>é¥¿æ±‰å¼ï¼ˆé™æ€å˜é‡ï¼‰</code></h3><p>é¥¿æ±‰å¼çš„å®ç°æ–¹å¼æ¯”è¾ƒç®€å•ã€‚åœ¨ç±»åŠ è½½çš„æ—¶å€™ï¼Œinstance é™æ€å®ä¾‹å°±å·²ç»åˆ›å»ºå¹¶åˆå§‹åŒ–å¥½äº†ï¼Œæ‰€ä»¥ï¼Œinstance å®ä¾‹çš„åˆ›å»ºè¿‡ç¨‹æ˜¯çº¿ç¨‹å®‰å…¨çš„ã€‚ä¸è¿‡ï¼Œè¿™æ ·çš„å®ç°æ–¹å¼ä¸æ”¯æŒå»¶è¿ŸåŠ è½½ï¼ˆåœ¨çœŸæ­£ç”¨åˆ° IdGenerator çš„æ—¶å€™ï¼Œå†åˆ›å»ºå®ä¾‹ï¼‰ï¼Œä»åå­—ä¸­æˆ‘ä»¬ä¹Ÿå¯ä»¥çœ‹å‡ºè¿™ä¸€ç‚¹ã€‚å…·ä½“çš„ä»£ç å®ç°å¦‚ä¸‹æ‰€ç¤ºï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">IdGenerator</span> &#123; <br>  <span class="hljs-keyword">private</span> <span class="hljs-type">AtomicLong</span> <span class="hljs-variable">id</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">AtomicLong</span>(<span class="hljs-number">0</span>);<br>  <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> <span class="hljs-type">IdGenerator</span> <span class="hljs-variable">instance</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">IdGenerator</span>();<br>  <span class="hljs-keyword">private</span> <span class="hljs-title function_">IdGenerator</span><span class="hljs-params">()</span> &#123;&#125;<br>  <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> IdGenerator <span class="hljs-title function_">getInstance</span><span class="hljs-params">()</span> &#123;<br>    <span class="hljs-keyword">return</span> instance;<br>  &#125;<br>  <span class="hljs-keyword">public</span> <span class="hljs-type">long</span> <span class="hljs-title function_">getId</span><span class="hljs-params">()</span> &#123; <br>    <span class="hljs-keyword">return</span> id.incrementAndGet();<br>  &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>ä¼˜ç¼ºç‚¹è¯´æ˜ï¼š</p><ol><li>ä¼˜ç‚¹ï¼šè¿™ç§å†™æ³•æ¯”è¾ƒç®€å•ï¼Œå°±æ˜¯åœ¨ç±»è£…è½½çš„æ—¶å€™å°±å®Œæˆå®ä¾‹åŒ–ã€‚é¿å…äº†çº¿ç¨‹åŒæ­¥é—®é¢˜ã€‚</li><li>ç¼ºç‚¹ï¼šåœ¨ç±»è£…è½½çš„æ—¶å€™å°±å®Œæˆå®ä¾‹åŒ–ï¼Œæ²¡æœ‰è¾¾åˆ° Lazy Loading çš„æ•ˆæœã€‚å¦‚æœä»å§‹è‡³ç»ˆä»æœªä½¿ç”¨è¿‡è¿™ä¸ªå®ä¾‹ï¼Œåˆ™ä¼šé€ æˆå†…å­˜çš„æµªè´¹</li><li>è¿™ç§æ–¹å¼åŸºäº classloder æœºåˆ¶é¿å…äº†å¤šçº¿ç¨‹çš„åŒæ­¥é—®é¢˜ï¼Œä¸è¿‡ï¼Œinstance åœ¨ç±»è£…è½½æ—¶å°±å®ä¾‹åŒ–ï¼Œåœ¨å•ä¾‹æ¨¡å¼ä¸­å¤§å¤šæ•°éƒ½æ˜¯è°ƒç”¨ getInstance æ–¹æ³•ï¼Œ ä½†æ˜¯å¯¼è‡´ç±»è£…è½½çš„åŸå› æœ‰å¾ˆå¤šç§ï¼Œå› æ­¤ä¸èƒ½ç¡®å®šæœ‰å…¶ä»–çš„æ–¹å¼ï¼ˆæˆ–è€…å…¶ä»–çš„é™æ€æ–¹æ³•ï¼‰å¯¼è‡´ç±»è£…è½½ï¼Œè¿™æ—¶å€™åˆå§‹åŒ– instance å°±æ²¡æœ‰è¾¾åˆ° lazy loading çš„æ•ˆæœ</li><li>ç»“è®ºï¼šè¿™ç§å•ä¾‹æ¨¡å¼å¯ç”¨ï¼Œå¯èƒ½é€ æˆå†…å­˜æµªè´¹</li></ol><h3 id="2ã€é¥¿æ±‰å¼ï¼ˆé™æ€ä»£ç å—ï¼‰"><a href="#2ã€é¥¿æ±‰å¼ï¼ˆé™æ€ä»£ç å—ï¼‰" class="headerlink" title="2ã€é¥¿æ±‰å¼ï¼ˆé™æ€ä»£ç å—ï¼‰"></a>2ã€<code>é¥¿æ±‰å¼ï¼ˆé™æ€ä»£ç å—ï¼‰</code></h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">class</span> <span class="hljs-title class_">Singleton</span>&#123;<br>    <span class="hljs-keyword">private</span> <span class="hljs-title function_">Singleton</span><span class="hljs-params">()</span>&#123;<br>        <br>    &#125;<br><br><span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> Singleton instance;<br><br><span class="hljs-keyword">static</span> &#123;<br>    instance = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Singleton</span>();<br>&#125;<br><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> Singleton <span class="hljs-title function_">getInstance</span><span class="hljs-params">()</span>&#123;<br>    <span class="hljs-keyword">return</span> instance;<br>&#125;<br></code></pre></td></tr></table></figure><p>ä¼˜ç¼ºç‚¹è¯´æ˜ï¼š</p><ol><li>è¿™ç§æ–¹å¼å’Œä¸Šé¢çš„æ–¹å¼å…¶å®ç±»ä¼¼ï¼Œåªä¸è¿‡å°†ç±»å®ä¾‹åŒ–çš„è¿‡ç¨‹æ”¾åœ¨äº†é™æ€ä»£ç å—ä¸­ï¼Œä¹Ÿæ˜¯åœ¨ç±»è£…è½½çš„æ—¶å€™ï¼Œå°±æ‰§è¡Œé™æ€ä»£ç å—ä¸­çš„ä»£ç ï¼Œåˆå§‹åŒ–ç±»çš„å®ä¾‹ã€‚ä¼˜ç¼ºç‚¹å’Œä¸Šé¢æ˜¯ä¸€æ ·çš„ã€‚</li><li>ç»“è®ºï¼šè¿™ç§å•ä¾‹æ¨¡å¼å¯ç”¨ï¼Œä½†æ˜¯å¯èƒ½é€ æˆå†…å­˜æµªè´¹</li></ol><h3 id="3ã€æ‡’æ±‰å¼ï¼ˆçº¿ç¨‹ä¸å®‰å…¨ï¼‰"><a href="#3ã€æ‡’æ±‰å¼ï¼ˆçº¿ç¨‹ä¸å®‰å…¨ï¼‰" class="headerlink" title="3ã€æ‡’æ±‰å¼ï¼ˆçº¿ç¨‹ä¸å®‰å…¨ï¼‰"></a>3ã€æ‡’æ±‰å¼ï¼ˆçº¿ç¨‹ä¸å®‰å…¨ï¼‰</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">IdGenerator</span> &#123; <br>  <span class="hljs-keyword">private</span> <span class="hljs-type">AtomicLong</span> <span class="hljs-variable">id</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">AtomicLong</span>(<span class="hljs-number">0</span>);<br>  <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> IdGenerator instance;<br>  <span class="hljs-keyword">private</span> <span class="hljs-title function_">IdGenerator</span><span class="hljs-params">()</span> &#123;&#125;<br>  <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">synchronized</span> IdGenerator <span class="hljs-title function_">getInstance</span><span class="hljs-params">()</span> &#123;<br>    <span class="hljs-keyword">if</span> (instance == <span class="hljs-literal">null</span>) &#123;<br>      instance = <span class="hljs-keyword">new</span> <span class="hljs-title class_">IdGenerator</span>();<br>    &#125;<br>    <span class="hljs-keyword">return</span> instance;<br>  &#125;<br>  <span class="hljs-keyword">public</span> <span class="hljs-type">long</span> <span class="hljs-title function_">getId</span><span class="hljs-params">()</span> &#123; <br>    <span class="hljs-keyword">return</span> id.incrementAndGet();<br>  &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>ä¼˜ç¼ºç‚¹è¯´æ˜ï¼š</p><ol><li>èµ·åˆ°äº† <strong>Lazy Loading</strong> çš„æ•ˆæœï¼Œä½†æ˜¯åªèƒ½åœ¨å•çº¿ç¨‹ä¸‹ä½¿ç”¨ã€‚</li><li>å¦‚æœåœ¨å¤šçº¿ç¨‹ä¸‹ï¼Œä¸€ä¸ªçº¿ç¨‹è¿›å…¥äº† **if (singleton == null)**åˆ¤æ–­è¯­å¥å—ï¼Œè¿˜æœªæ¥å¾—åŠå¾€ä¸‹æ‰§è¡Œï¼Œå¦ä¸€ä¸ªçº¿ç¨‹ä¹Ÿé€šè¿‡äº†è¿™ä¸ªåˆ¤æ–­è¯­å¥ï¼Œè¿™æ—¶ä¾¿ä¼šäº§ç”Ÿå¤šä¸ªå®ä¾‹ã€‚æ‰€ä»¥åœ¨å¤šçº¿ç¨‹ç¯å¢ƒä¸‹ä¸å¯ä½¿ç”¨è¿™ç§æ–¹å¼</li><li>ç»“è®ºï¼šåœ¨å®é™…å¼€å‘ä¸­ï¼Œä¸è¦ä½¿ç”¨è¿™ç§æ–¹å¼.</li></ol><h3 id="4ã€æ‡’æ±‰å¼ï¼ˆçº¿ç¨‹å®‰å…¨ï¼ŒåŒæ­¥æ–¹æ³•ï¼‰"><a href="#4ã€æ‡’æ±‰å¼ï¼ˆçº¿ç¨‹å®‰å…¨ï¼ŒåŒæ­¥æ–¹æ³•ï¼‰" class="headerlink" title="4ã€æ‡’æ±‰å¼ï¼ˆçº¿ç¨‹å®‰å…¨ï¼ŒåŒæ­¥æ–¹æ³•ï¼‰"></a>4ã€æ‡’æ±‰å¼ï¼ˆçº¿ç¨‹å®‰å…¨ï¼ŒåŒæ­¥æ–¹æ³•ï¼‰</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">class</span> <span class="hljs-title class_">Singleton</span>&#123;<br>    <span class="hljs-keyword">private</span> <span class="hljs-title function_">Singleton</span><span class="hljs-params">()</span>&#123;<br><br>    &#125;<br><br>    <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> Singleton instance;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">synchronized</span> Singleton <span class="hljs-title function_">getInstance</span><span class="hljs-params">()</span>&#123;<br>        <span class="hljs-keyword">if</span> (instance == <span class="hljs-literal">null</span>)&#123;<br>            instance = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Singleton</span>();<br>        &#125;<br>        <span class="hljs-keyword">return</span> instance;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>ä¼˜ç¼ºç‚¹è¯´æ˜ï¼š</p><ol><li>è§£å†³äº†çº¿ç¨‹å®‰å…¨é—®é¢˜</li><li>æ•ˆç‡å¤ªä½äº†ï¼Œæ¯ä¸ªçº¿ç¨‹åœ¨æƒ³è·å¾—ç±»çš„å®ä¾‹æ—¶å€™ï¼Œæ‰§è¡Œ getInstance()æ–¹æ³•éƒ½è¦è¿›è¡ŒåŒæ­¥ã€‚è€Œå…¶å®è¿™ä¸ªæ–¹æ³•åªæ‰§è¡Œä¸€æ¬¡å®ä¾‹åŒ–ä»£ç å°±å¤Ÿäº†ï¼Œåé¢çš„æƒ³è·å¾—è¯¥ç±»å®ä¾‹ï¼Œç›´æ¥ return å°±è¡Œäº†ã€‚æ–¹æ³•è¿›è¡ŒåŒæ­¥æ•ˆç‡å¤ªä½</li><li>ç»“è®ºï¼šåœ¨å®é™…å¼€å‘ä¸­ï¼Œä¸æ¨èä½¿ç”¨è¿™ç§æ–¹å¼</li></ol><h3 id="5ã€æ‡’æ±‰å¼ï¼ˆçº¿ç¨‹å®‰å…¨ï¼ŒåŒæ­¥ä»£ç å—ï¼‰"><a href="#5ã€æ‡’æ±‰å¼ï¼ˆçº¿ç¨‹å®‰å…¨ï¼ŒåŒæ­¥ä»£ç å—ï¼‰" class="headerlink" title="5ã€æ‡’æ±‰å¼ï¼ˆçº¿ç¨‹å®‰å…¨ï¼ŒåŒæ­¥ä»£ç å—ï¼‰"></a>5ã€æ‡’æ±‰å¼ï¼ˆçº¿ç¨‹å®‰å…¨ï¼ŒåŒæ­¥ä»£ç å—ï¼‰</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-comment">// æ‡’æ±‰å¼(çº¿ç¨‹å®‰å…¨ï¼ŒåŒæ­¥ä»£ç å—)</span><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">Singleton</span> &#123;<br>  <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> Singleton instance;<br><br>  <span class="hljs-keyword">private</span> <span class="hljs-title function_">Singleton</span><span class="hljs-params">()</span> &#123;&#125;<br><br>  <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> Singleton <span class="hljs-title function_">getInstance</span><span class="hljs-params">()</span> &#123;<br>    <span class="hljs-keyword">if</span> (instance == <span class="hljs-literal">null</span>) &#123;<br>      <span class="hljs-keyword">synchronized</span> (Singleton.class) &#123;<br>        instance = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Singleton</span>();<br>      &#125;<br>    &#125;<br>    <span class="hljs-keyword">return</span> instance;<br>  &#125;<br>&#125;<br></code></pre></td></tr></table></figure><h3 id="6ã€-åŒé‡æ£€æŸ¥"><a href="#6ã€-åŒé‡æ£€æŸ¥" class="headerlink" title="6ã€==åŒé‡æ£€æŸ¥=="></a>6ã€==åŒé‡æ£€æŸ¥==</h3><p>é¥¿æ±‰å¼ä¸æ”¯æŒå»¶è¿ŸåŠ è½½ï¼Œæ‡’æ±‰å¼æœ‰æ€§èƒ½é—®é¢˜ï¼Œä¸æ”¯æŒé«˜å¹¶å‘ã€‚é‚£æˆ‘ä»¬å†æ¥çœ‹ä¸€ç§æ—¢æ”¯æŒå»¶è¿ŸåŠ è½½ã€åˆæ”¯æŒé«˜å¹¶å‘çš„å•ä¾‹å®ç°æ–¹å¼ï¼Œä¹Ÿå°±æ˜¯åŒé‡æ£€æµ‹å®ç°æ–¹å¼ã€‚åœ¨è¿™ç§å®ç°æ–¹å¼ä¸­ï¼Œåªè¦ instance è¢«åˆ›å»ºä¹‹åï¼Œå³ä¾¿å†è°ƒç”¨ getInstance() å‡½æ•°ä¹Ÿä¸ä¼šå†è¿›å…¥åˆ°åŠ é”é€»è¾‘ä¸­äº†ã€‚æ‰€ä»¥ï¼Œè¿™ç§å®ç°æ–¹å¼è§£å†³äº†æ‡’æ±‰å¼å¹¶å‘åº¦ä½çš„é—®é¢˜ã€‚å…·ä½“çš„ä»£ç å®ç°å¦‚ä¸‹æ‰€ç¤ºï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">IdGenerator</span> &#123; <br>  <span class="hljs-keyword">private</span> <span class="hljs-type">AtomicLong</span> <span class="hljs-variable">id</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">AtomicLong</span>(<span class="hljs-number">0</span>);<br>  <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> IdGenerator instance;<br>  <span class="hljs-keyword">private</span> <span class="hljs-title function_">IdGenerator</span><span class="hljs-params">()</span> &#123;&#125;<br>  <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> IdGenerator <span class="hljs-title function_">getInstance</span><span class="hljs-params">()</span> &#123;<br>    <span class="hljs-keyword">if</span> (instance == <span class="hljs-literal">null</span>) &#123;<br>      <span class="hljs-keyword">synchronized</span>(IdGenerator.class) &#123; <span class="hljs-comment">// æ­¤å¤„ä¸ºç±»çº§åˆ«çš„é”</span><br>        <span class="hljs-keyword">if</span> (instance == <span class="hljs-literal">null</span>) &#123;<br>          instance = <span class="hljs-keyword">new</span> <span class="hljs-title class_">IdGenerator</span>();<br>        &#125;<br>      &#125;<br>    &#125;<br>    <span class="hljs-keyword">return</span> instance;<br>  &#125;<br>  <span class="hljs-keyword">public</span> <span class="hljs-type">long</span> <span class="hljs-title function_">getId</span><span class="hljs-params">()</span> &#123; <br>    <span class="hljs-keyword">return</span> id.incrementAndGet();<br>  &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>è¿™ç§å®ç°æ–¹å¼æœ‰äº›é—®é¢˜ã€‚å› ä¸ºæŒ‡ä»¤é‡æ’åºï¼Œå¯èƒ½ä¼šå¯¼è‡´ IdGenerator å¯¹è±¡è¢« new å‡ºæ¥ï¼Œå¹¶ä¸”èµ‹å€¼ç»™ instance ä¹‹åï¼Œè¿˜æ²¡æ¥å¾—åŠåˆå§‹åŒ–ï¼ˆæ‰§è¡Œæ„é€ å‡½æ•°ä¸­çš„ä»£ç é€»è¾‘ï¼‰ï¼Œå°±è¢«å¦ä¸€ä¸ªçº¿ç¨‹ä½¿ç”¨äº†ã€‚è¦è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œæˆ‘ä»¬éœ€è¦ç»™ instance æˆå‘˜å˜é‡åŠ ä¸Š volatile å…³é”®å­—ï¼Œç¦æ­¢æŒ‡ä»¤é‡æ’åºæ‰è¡Œã€‚</p><h3 id="7ã€-é™æ€å†…éƒ¨ç±»"><a href="#7ã€-é™æ€å†…éƒ¨ç±»" class="headerlink" title="7ã€==é™æ€å†…éƒ¨ç±»=="></a>7ã€==é™æ€å†…éƒ¨ç±»==</h3><p>æˆ‘ä»¬å†æ¥çœ‹ä¸€ç§æ¯”åŒé‡æ£€æµ‹æ›´åŠ ç®€å•çš„å®ç°æ–¹æ³•ï¼Œé‚£å°±æ˜¯åˆ©ç”¨ Java çš„é™æ€å†…éƒ¨ç±»ã€‚å®ƒæœ‰ç‚¹ç±»ä¼¼é¥¿æ±‰å¼ï¼Œä½†åˆèƒ½åšåˆ°äº†å»¶è¿ŸåŠ è½½ã€‚å…·ä½“æ˜¯æ€ä¹ˆåšåˆ°çš„å‘¢ï¼Ÿæˆ‘ä»¬å…ˆæ¥çœ‹å®ƒçš„ä»£ç å®ç°</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">IdGenerator</span> &#123; <br>  <span class="hljs-keyword">private</span> <span class="hljs-type">AtomicLong</span> <span class="hljs-variable">id</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">AtomicLong</span>(<span class="hljs-number">0</span>);<br>  <span class="hljs-keyword">private</span> <span class="hljs-title function_">IdGenerator</span><span class="hljs-params">()</span> &#123;&#125;<br><br>  <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">SingletonHolder</span>&#123;<br>    <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> <span class="hljs-type">IdGenerator</span> <span class="hljs-variable">instance</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">IdGenerator</span>();<br>  &#125;<br>  <br>  <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> IdGenerator <span class="hljs-title function_">getInstance</span><span class="hljs-params">()</span> &#123;<br>    <span class="hljs-keyword">return</span> SingletonHolder.instance;<br>  &#125;<br> <br>  <span class="hljs-keyword">public</span> <span class="hljs-type">long</span> <span class="hljs-title function_">getId</span><span class="hljs-params">()</span> &#123; <br>    <span class="hljs-keyword">return</span> id.incrementAndGet();<br>  &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>SingletonHolder æ˜¯ä¸€ä¸ªé™æ€å†…éƒ¨ç±»ï¼Œå½“å¤–éƒ¨ç±» IdGenerator è¢«åŠ è½½çš„æ—¶å€™ï¼Œå¹¶ä¸ä¼šåˆ›å»º SingletonHolder å®ä¾‹å¯¹è±¡ã€‚åªæœ‰å½“è°ƒç”¨ getInstance() æ–¹æ³•æ—¶ï¼ŒSingletonHolder æ‰ä¼šè¢«åŠ è½½ï¼Œè¿™ä¸ªæ—¶å€™æ‰ä¼šåˆ›å»º instanceã€‚instance çš„å”¯ä¸€æ€§ã€åˆ›å»ºè¿‡ç¨‹çš„çº¿ç¨‹å®‰å…¨æ€§ï¼Œéƒ½ç”± JVM æ¥ä¿è¯ã€‚æ‰€ä»¥ï¼Œè¿™ç§å®ç°æ–¹æ³•æ—¢ä¿è¯äº†çº¿ç¨‹å®‰å…¨ï¼Œåˆèƒ½åšåˆ°å»¶è¿ŸåŠ è½½ã€‚</p><h3 id="8ã€-æšä¸¾"><a href="#8ã€-æšä¸¾" class="headerlink" title="8ã€==æšä¸¾=="></a>8ã€==æšä¸¾==</h3><p>æœ€åï¼Œæˆ‘ä»¬ä»‹ç»ä¸€ç§æœ€ç®€å•çš„å®ç°æ–¹å¼ï¼ŒåŸºäºæšä¸¾ç±»å‹çš„å•ä¾‹å®ç°ã€‚è¿™ç§å®ç°æ–¹å¼é€šè¿‡ Java æšä¸¾ç±»å‹æœ¬èº«çš„ç‰¹æ€§ï¼Œä¿è¯äº†å®ä¾‹åˆ›å»ºçš„çº¿ç¨‹å®‰å…¨æ€§å’Œå®ä¾‹çš„å”¯ä¸€æ€§ã€‚å…·ä½“çš„ä»£ç å¦‚ä¸‹æ‰€ç¤º</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">enum</span> <span class="hljs-title class_">IdGenerator</span> &#123;<br>  INSTANCE;<br>  <span class="hljs-keyword">private</span> <span class="hljs-type">AtomicLong</span> <span class="hljs-variable">id</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">AtomicLong</span>(<span class="hljs-number">0</span>);<br> <br>  <span class="hljs-keyword">public</span> <span class="hljs-type">long</span> <span class="hljs-title function_">getId</span><span class="hljs-params">()</span> &#123; <br>    <span class="hljs-keyword">return</span> id.incrementAndGet();<br>  &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>ç»¼ä¸Šï¼Œå¯ä»¥ä½¿ç”¨ï¼šä¸¤ä¸ªé¥¿æ±‰å¼ï¼›æ¨èä½¿ç”¨ï¼šåŒé‡æ£€æŸ¥ã€é™æ€å†…éƒ¨ç±»ã€æšä¸¾</p><h2 id="ä¸‰ã€å•ä¾‹æ¨¡å¼æ³¨æ„äº‹é¡¹"><a href="#ä¸‰ã€å•ä¾‹æ¨¡å¼æ³¨æ„äº‹é¡¹" class="headerlink" title="ä¸‰ã€å•ä¾‹æ¨¡å¼æ³¨æ„äº‹é¡¹"></a>ä¸‰ã€å•ä¾‹æ¨¡å¼æ³¨æ„äº‹é¡¹</h2><ol><li>å•ä¾‹æ¨¡å¼ä¿è¯äº† ç³»ç»Ÿå†…å­˜ä¸­è¯¥ç±»åªå­˜åœ¨ä¸€ä¸ªå¯¹è±¡ï¼ŒèŠ‚çœäº†ç³»ç»Ÿèµ„æºï¼Œå¯¹äºä¸€äº›éœ€è¦é¢‘ç¹åˆ›å»ºé”€æ¯çš„å¯¹è±¡ï¼Œä½¿ç”¨å•ä¾‹æ¨¡å¼å¯ä»¥æé«˜ç³»ç»Ÿæ€§èƒ½</li><li>å½“æƒ³å®ä¾‹åŒ–ä¸€ä¸ªå•ä¾‹ç±»çš„æ—¶å€™ï¼Œå¿…é¡»è¦è®°ä½ä½¿ç”¨ç›¸åº”çš„è·å–å¯¹è±¡çš„æ–¹æ³•ï¼Œè€Œä¸æ˜¯ä½¿ç”¨ new</li><li>å•ä¾‹æ¨¡å¼ä½¿ç”¨çš„åœºæ™¯ï¼šéœ€è¦é¢‘ç¹çš„è¿›è¡Œåˆ›å»ºå’Œé”€æ¯çš„å¯¹è±¡ã€åˆ›å»ºå¯¹è±¡æ—¶è€—æ—¶è¿‡å¤šæˆ–è€—è´¹èµ„æºè¿‡å¤š(å³ï¼šé‡é‡çº§å¯¹è±¡)ï¼Œä½†åˆç»å¸¸ç”¨åˆ°çš„å¯¹è±¡ã€å·¥å…·ç±»å¯¹è±¡ã€é¢‘ç¹è®¿é—®æ•°æ®åº“æˆ–æ–‡ä»¶çš„å¯¹è±¡(æ¯”å¦‚æ•°æ®æºã€<em><strong>session</strong></em> å·¥å‚ç­‰)</li></ol>]]></content>
    
    
    <categories>
      
      <category>è®¾è®¡æ¨¡å¼</category>
      
    </categories>
    
    
    <tags>
      
      <tag>è®¾è®¡æ¨¡å¼</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>è®¾è®¡æ¨¡å¼æ¦‚è¿°</title>
    <link href="/2022/09/21/she-ji-mo-shi-gai-shu/"/>
    <url>/2022/09/21/she-ji-mo-shi-gai-shu/</url>
    
    <content type="html"><![CDATA[<h2 id="ä¸€ã€è®¾è®¡æ¨¡å¼å®šä¹‰"><a href="#ä¸€ã€è®¾è®¡æ¨¡å¼å®šä¹‰" class="headerlink" title="ä¸€ã€è®¾è®¡æ¨¡å¼å®šä¹‰"></a>ä¸€ã€è®¾è®¡æ¨¡å¼å®šä¹‰</h2><p>è®¾è®¡æ¨¡å¼æ˜¯åœ¨ç‰¹å®šç¯å¢ƒä¸‹ä¸ºè§£å†³æŸä¸€é€šç”¨è½¯ä»¶è®¾è®¡é—®é¢˜æä¾›çš„ä¸€å¥—å®šåˆ¶çš„è§£å†³æ–¹æ¡ˆï¼Œè¯¥æ–¹æ¡ˆæè¿°äº†å¯¹è±¡å’Œç±»ä¹‹é—´çš„ç›¸äº’ä½œç”¨ã€‚</p><p>è®¾è®¡æ¨¡å¼ä¸€èˆ¬åŒ…å«æ¨¡å¼åç§°ã€é—®é¢˜ã€ç›®çš„ã€è§£å†³æ–¹æ¡ˆã€æ•ˆæœã€å®ä¾‹ä»£ç å’Œç›¸å…³è®¾è®¡æ¨¡å¼ï¼Œå…³é”®å…ƒç´ ä¸ºï¼šæ¨¡å¼åç§°ã€é—®é¢˜ã€è§£å†³æ–¹æ¡ˆã€æ•ˆæœã€‚</p><h2 id="äºŒã€è®¾è®¡æ¨¡å¼çš„åˆ†ç±»"><a href="#äºŒã€è®¾è®¡æ¨¡å¼çš„åˆ†ç±»" class="headerlink" title="äºŒã€è®¾è®¡æ¨¡å¼çš„åˆ†ç±»"></a>äºŒã€è®¾è®¡æ¨¡å¼çš„åˆ†ç±»</h2><p>æ ¹æ®ç›®çš„åˆ†ç±»ï¼Œå¯åˆ†ä¸ºï¼š</p><ol><li>åˆ›å»ºå‹</li><li>ç»“æ„å‹</li><li>è¡Œä¸ºå‹</li></ol><p>æ ¹æ®èŒƒå›´åˆ†ç±»ï¼Œå¯åˆ†ä¸ºï¼š</p><ol><li>ç±»æ¨¡å¼</li><li>å¯¹è±¡æ¨¡å¼</li></ol><h2 id="ä¸‰ã€GoFè®¾è®¡æ¨¡å¼ç®€ä»‹"><a href="#ä¸‰ã€GoFè®¾è®¡æ¨¡å¼ç®€ä»‹" class="headerlink" title="ä¸‰ã€GoFè®¾è®¡æ¨¡å¼ç®€ä»‹"></a>ä¸‰ã€GoFè®¾è®¡æ¨¡å¼ç®€ä»‹</h2><p>åœ¨GoFçš„ç»å…¸è‘—ä½œä¸­ä¸€å…±æè¿°äº†23ç§è®¾è®¡æ¨¡å¼ã€‚</p><p>æŒ‰ç›®çš„åˆ†ç±»ï¼š</p><blockquote><p>åˆ›å»ºå‹æ¨¡å¼</p></blockquote><p>1ã€å·¥å‚æ¨¡å¼</p><p>å·¥å‚æ¨¡å¼ï¼ˆFactory Patternï¼‰æ˜¯Javaä¸­æœ€å¸¸ç”¨çš„è®¾è®¡æ¨¡å¼ä¹‹ä¸€ã€‚</p><p>åœ¨å·¥å‚æ¨¡å¼ä¸­ï¼Œæˆ‘ä»¬åœ¨åˆ›å»ºå¯¹è±¡æ—¶ä¸ä¼šå¯¹å®¢æˆ·ç«¯æš´éœ²åˆ›å»ºé€»è¾‘ï¼Œå¹¶ä¸”æ˜¯é€šè¿‡ä½¿ç”¨ä¸€ä¸ªå…±åŒçš„æ¥å£æ¥æŒ‡å‘æ–°åˆ›å»ºçš„å¯¹è±¡ã€‚</p><p>å®šä¹‰ä¸€ä¸ªåˆ›å»ºå¯¹è±¡çš„æ¥å£ï¼Œè®©å…¶å­ç±»è‡ªå·±å†³å®šå®ä¾‹åŒ–å“ªä¸€ä¸ªå·¥å‚ç±»ï¼Œå·¥å‚æ¨¡å¼ä½¿å…¶åˆ›å»ºè¿‡ç¨‹å»¶è¿Ÿåˆ°å­ç±»è¿›è¡Œã€‚</p><p>2ã€æŠ½è±¡å·¥å‚æ¨¡å¼</p><p>æŠ½è±¡å·¥å‚æ¨¡å¼ï¼ˆAbstract Factory Patternï¼‰æ˜¯å›´ç»•ä¸€ä¸ªè¶…çº§å·¥å‚åˆ›å»ºå…¶ä»–å·¥å‚ã€‚è¯¥è¶…çº§å·¥å‚åˆç§°ä¸ºå…¶ä»–å·¥å‚çš„å·¥å‚ã€‚</p><p>åœ¨æŠ½è±¡å·¥å‚æ¨¡å¼ä¸­ï¼Œæ¥å£æ˜¯è´Ÿè´£åˆ›å»ºä¸€ä¸ªç›¸å…³å¯¹è±¡çš„å·¥å‚ï¼Œä¸éœ€è¦æ˜¾å¼æŒ‡å®šå®ƒä»¬çš„ç±»ã€‚æ¯ä¸ªç”Ÿæˆçš„å·¥å‚éƒ½èƒ½æŒ‰ç…§å·¥å‚æ¨¡å¼æä¾›å¯¹è±¡ã€‚</p><p>æä¾›ä¸€ä¸ªåˆ›å»ºä¸€ç³»åˆ—ç›¸å…³æˆ–ç›¸äº’ä¾èµ–å¯¹è±¡çš„æ¥å£ï¼Œè€Œæ— éœ€æŒ‡å®šå®ƒä»¬å…·ä½“çš„ç±»ã€‚</p><p>3ã€å•ä¾‹æ¨¡å¼</p><p>å•ä¾‹æ¨¡å¼ï¼ˆSingleton Patternï¼‰æ˜¯Javaä¸­æœ€ç®€å•çš„è®¾è®¡æ¨¡å¼ä¹‹ä¸€ã€‚</p><p>è¿™ç§æ¨¡å¼æ¶‰åŠåˆ°ä¸€ä¸ªå•ä¸€çš„ç±»ï¼Œè¯¥ç±»è´Ÿè´£åˆ›å»ºè‡ªå·±çš„å¯¹è±¡ï¼ŒåŒæ—¶ç¡®ä¿åªæœ‰å•ä¸ªå¯¹è±¡è¢«åˆ›å»ºã€‚è¿™ä¸ªç±»æä¾›äº†ä¸€ç§è®¿é—®å…¶å”¯ä¸€çš„å¯¹è±¡çš„æ–¹å¼ï¼Œå¯ä»¥ç›´æ¥è®¿é—®ï¼Œä¸éœ€è¦å®ä¾‹åŒ–è¯¥ç±»çš„å¯¹è±¡ã€‚</p><p>ä¿è¯ä¸€ä¸ªç±»ä»…æœ‰ä¸€ä¸ªå®ä¾‹ï¼Œå¹¶æä¾›ä¸€ä¸ªè®¿é—®å®ƒçš„å…¨å±€è®¿é—®ç‚¹ã€‚</p><p>4ã€å»ºé€ è€…ï¼ˆæ„å»ºè€…ï¼‰æ¨¡å¼</p><p>å»ºé€ è€…æ¨¡å¼ï¼ˆBuilder Patternï¼‰ä½¿ç”¨å¤šä¸ªç®€å•çš„å¯¹è±¡ä¸€æ­¥ä¸€æ­¥æ„å»ºæˆä¸€ä¸ªå¤æ‚çš„å¯¹è±¡ã€‚</p><p>ä¸€ä¸ªBuilderç±»ä¼šä¸€æ­¥ä¸€æ­¥æ„é€ æœ€ç»ˆçš„å¯¹è±¡ã€‚è¯¥Builderç±»æ˜¯ç‹¬ç«‹äºå…¶ä»–å¯¹è±¡çš„ã€‚</p><p>å°†ä¸€ä¸ªå¤æ‚çš„æ„å»ºä¸å…¶è¡¨ç¤ºç›¸åˆ†ç¦»ï¼Œä½¿å¾—åŒæ ·çš„æ„å»ºè¿‡ç¨‹å¯ä»¥åˆ›å»ºä¸åŒçš„è¡¨ç¤ºã€‚</p><p>5ã€åŸå‹æ¨¡å¼</p><p>åŸå‹æ¨¡å¼ï¼ˆPrototype Patternï¼‰æ˜¯ç”¨äºåˆ›å»ºé‡å¤çš„å¯¹è±¡ï¼ŒåŒæ—¶åˆèƒ½ä¿è¯æ€§èƒ½ã€‚</p><p>è¿™ç§æ¨¡å¼æ˜¯å®ç°äº†ä¸€ä¸ªåŸå‹æ¥å£ï¼Œè¯¥æ¥å£ç”¨äºåˆ›å»ºå½“å‰å¯¹è±¡çš„å…‹éš†ã€‚å½“ç›´æ¥åˆ›å»ºå¯¹è±¡çš„ä»£ä»·æ¯”è¾ƒå¤§æ—¶ï¼Œåˆ™é‡‡ç”¨è¿™ç§æ¨¡å¼ã€‚ä¾‹å¦‚ï¼Œä¸€ä¸ªå¯¹è±¡éœ€è¦åœ¨ä¸€ä¸ªé«˜ä»£ä»·çš„æ•°æ®åº“æ“ä½œä¹‹åè¢«åˆ›å»ºã€‚æˆ‘ä»¬å¯ä»¥ç¼“å­˜è¯¥å¯¹è±¡ï¼Œåœ¨ä¸‹ä¸€ä¸ªè¯·æ±‚æ—¶è¿”å›å®ƒçš„å…‹éš†ï¼Œåœ¨éœ€è¦çš„æ—¶å€™æ›´æ–°æ•°æ®åº“ï¼Œä»¥æ­¤æ¥å‡å°‘æ•°æ®åº“è°ƒç”¨ã€‚</p><p>ç”¨åŸå‹å®ä¾‹æŒ‡å®šåˆ›å»ºå¯¹è±¡çš„ç§ç±»ï¼Œå¹¶ä¸”é€šè¿‡æ‹·è´è¿™äº›åŸå‹åˆ›å»ºæ–°çš„å¯¹è±¡ã€‚</p><blockquote><p>ç»“æ„å‹æ¨¡å¼</p></blockquote><p>6ã€é€‚é…å™¨æ¨¡å¼</p><p>é€‚é…å™¨æ¨¡å¼ï¼ˆAdapter Patternï¼‰æ˜¯ä½œä¸ºä¸¤ä¸ªä¸å…¼å®¹çš„æ¥å£ä¹‹é—´çš„æ¡¥æ¢ã€‚</p><p>è¿™ç§æ¨¡å¼æ¶‰åŠåˆ°ä¸€ä¸ªå•ä¸€çš„ç±»ï¼Œè¯¥ç±»è´Ÿè´£åŠ å…¥ç‹¬ç«‹çš„æˆ–ä¸å…¼å®¹çš„æ¥å£åŠŸèƒ½ã€‚</p><p>å°†ä¸€ä¸ªç±»çš„æ¥å£è½¬æ¢æˆå®¢æˆ·å¸Œæœ›çš„å¦å¤–ä¸€ä¸ªæ¥å£ã€‚é€‚é…å™¨æ¨¡å¼ä½¿å¾—åŸæœ¬ç”±äºæ¥å£ä¸å…¼å®¹è€Œä¸èƒ½ä¸€èµ·å·¥ä½œçš„é‚£äº›ç±»å¯ä»¥ä¸€èµ·å·¥ä½œã€‚</p><p>7ã€è£…é¥°å™¨æ¨¡å¼</p><p>è£…é¥°å™¨æ¨¡å¼ï¼ˆDecorator Patternï¼‰å…è®¸å‘ä¸€ä¸ªç°æœ‰çš„å¯¹è±¡æ·»åŠ æ–°çš„åŠŸèƒ½ï¼ŒåŒæ—¶åˆä¸æ”¹å˜å…¶ç»“æ„ã€‚</p><p>è¿™ç§æ¨¡å¼åˆ›å»ºäº†ä¸€ä¸ªè£…é¥°ç±»ï¼Œç”¨æ¥åŒ…è£…åŸæœ‰çš„ç±»ï¼Œå¹¶åœ¨ä¿æŒç±»æ–¹æ³•ç­¾åå®Œæ•´æ€§çš„å‰æä¸‹ï¼Œæä¾›äº†é¢å¤–çš„åŠŸèƒ½ã€‚</p><p>åŠ¨æ€åœ°ç»™ä¸€ä¸ªå¯¹è±¡æ·»åŠ ä¸€äº›é¢å¤–çš„èŒè´£ã€‚å°±å¢åŠ åŠŸèƒ½æ¥è¯´ï¼Œè£…é¥°å™¨æ¨¡å¼ç›¸æ¯”ç”Ÿæˆå­ç±»æ›´ä¸ºçµæ´»ã€‚</p><p>8ã€ä»£ç†æ¨¡å¼</p><p>åœ¨ä»£ç†æ¨¡å¼ï¼ˆProxy Patternï¼‰ä¸­ï¼Œä¸€ä¸ªç±»ä»£è¡¨å¦ä¸€ä¸ªç±»çš„åŠŸèƒ½ã€‚</p><p>åœ¨ä»£ç†æ¨¡å¼ä¸­ï¼Œæˆ‘ä»¬åˆ›å»ºå…·æœ‰ç°æœ‰å¯¹è±¡çš„å¯¹è±¡ï¼Œä»¥ä¾¿å‘å¤–ç•Œæä¾›åŠŸèƒ½æ¥å£ã€‚</p><p>ä¸ºå…¶ä»–å¯¹è±¡æä¾›ä¸€ç§ä»£ç†ä»¥æ§åˆ¶å¯¹è¿™ä¸ªå¯¹è±¡çš„è®¿é—®ã€‚</p><p>9ã€å¤–è§‚æ¨¡å¼</p><p>å¤–è§‚æ¨¡å¼ï¼ˆFacade Patternï¼‰éšè—ç³»ç»Ÿçš„å¤æ‚æ€§ï¼Œå¹¶å‘å®¢æˆ·ç«¯æä¾›äº†ä¸€ä¸ªå®¢æˆ·ç«¯å¯ä»¥è®¿é—®ç³»ç»Ÿçš„æ¥å£ã€‚</p><p>è¿™ç§æ¨¡å¼æ¶‰åŠåˆ°ä¸€ä¸ªå•ä¸€çš„ç±»ï¼Œè¯¥ç±»æä¾›äº†å®¢æˆ·ç«¯è¯·æ±‚çš„ç®€åŒ–æ–¹æ³•å’Œå¯¹ç°æœ‰ç³»ç»Ÿç±»æ–¹æ³•çš„å§”æ‰˜è°ƒç”¨ã€‚</p><p>ä¸ºå­ç³»ç»Ÿä¸­çš„ä¸€ç»„æ¥å£æä¾›ä¸€ä¸ªä¸€è‡´çš„ç•Œé¢ï¼Œå¤–è§‚æ¨¡å¼å®šä¹‰äº†ä¸€ä¸ªé«˜å±‚æ¥å£ï¼Œè¿™ä¸ªæ¥å£ä½¿å¾—è¿™ä¸€å­ç³»ç»Ÿæ›´åŠ å®¹æ˜“ä½¿ç”¨ã€‚</p><p>10ã€æ¡¥æ¥æ¨¡å¼</p><p>æ¡¥æ¥æ¨¡å¼ï¼ˆBridge Patternï¼‰æ˜¯ç”¨äºæŠŠæŠ½è±¡åŒ–ä¸å®ç°åŒ–è§£è€¦ï¼Œä½¿å¾—äºŒè€…å¯ä»¥ç‹¬ç«‹å˜åŒ–ã€‚å®ƒé€šè¿‡æä¾›æŠ½è±¡åŒ–å’Œå®ç°åŒ–ä¹‹é—´çš„æ¡¥æ¥ç»“æ„ï¼Œæ¥å®ç°äºŒè€…çš„è§£è€¦ã€‚</p><p>è¿™ç§æ¨¡å¼æ¶‰åŠåˆ°ä¸€ä¸ªä½œä¸ºæ¡¥æ¥çš„æ¥å£ï¼Œä½¿å¾—å®ä½“ç±»çš„åŠŸèƒ½ç‹¬ç«‹äºæ¥å£å®ç°ç±»ã€‚è¿™ä¸¤ç§ç±»å‹çš„ç±»å¯è¢«ç»“æ„åŒ–æ”¹å˜è€Œäº’ä¸å½±å“ã€‚</p><p>å°†æŠ½è±¡éƒ¨åˆ†ä¸å®ç°éƒ¨åˆ†åˆ†ç¦»ï¼Œä½¿å®ƒä»¬éƒ½å¯ä»¥ç‹¬ç«‹çš„å˜åŒ–ã€‚</p><p>åˆç§°ä¸ºæŸ„ä½“ï¼ˆHandle and Bodyï¼‰æ¨¡å¼æˆ–æ¥å£ï¼ˆInterfaceï¼‰æ¨¡å¼ã€‚</p><p>11ã€ç»„åˆæ¨¡å¼</p><p>ç»„åˆæ¨¡å¼ï¼ˆComposite Patternï¼‰ï¼Œåˆå«éƒ¨åˆ†æ•´ä½“æ¨¡å¼ï¼Œæ˜¯ç”¨äºæŠŠä¸€ç»„ç›¸ä¼¼çš„å¯¹è±¡å½“ä½œä¸€ä¸ªå•ä¸€çš„å¯¹è±¡ã€‚ç»„åˆæ¨¡å¼ä¾æ®æ ‘å½¢ç»“æ„æ¥ç»„åˆå¯¹è±¡ï¼Œç”¨æ¥è¡¨ç¤ºéƒ¨åˆ†ä»¥åŠæ•´ä½“å±‚æ¬¡ã€‚è¿™ç§ç±»å‹çš„è®¾è®¡æ¨¡å¼å±äºç»“æ„å‹æ¨¡å¼ï¼Œå®ƒåˆ›å»ºäº†<strong>å¯¹è±¡ç»„çš„æ ‘å½¢ç»“æ„</strong>ã€‚</p><p>è¿™ç§æ¨¡å¼åˆ›å»ºäº†ä¸€ä¸ªåŒ…å«è‡ªå·±å¯¹è±¡ç»„çš„ç±»ã€‚è¯¥ç±»æä¾›äº†ä¿®æ”¹ç›¸åŒå¯¹è±¡ç»„çš„æ–¹å¼ã€‚</p><p>å°†å¯¹è±¡ç»„åˆæˆæ ‘å½¢ç»“æ„ä»¥è¡¨ç¤ºâ€éƒ¨åˆ†-æ•´ä½“â€çš„å±‚æ¬¡ç»“æ„ã€‚ç»„åˆæ¨¡å¼ä½¿å¾—ç”¨æˆ·å¯¹å•ä¸ªå¯¹è±¡å’Œç»„åˆå¯¹è±¡çš„ä½¿ç”¨å…·æœ‰ä¸€è‡´æ€§ã€‚</p><p>12ã€äº«å…ƒæ¨¡å¼</p><p>äº«å…ƒæ¨¡å¼ï¼ˆFlyweight Patternï¼‰ä¸»è¦ç”¨äºå‡å°‘åˆ›å»ºå¯¹è±¡çš„æ•°é‡ï¼Œä»¥å‡å°‘å†…å­˜å ç”¨å’Œæé«˜æ€§èƒ½ã€‚è¿™ç§ç±»å‹çš„è®¾è®¡æ¨¡å¼å±äºç»“æ„å‹æ¨¡å¼ï¼Œå®ƒæä¾›äº†å‡å°‘å¯¹è±¡æ•°é‡ä»è€Œæ”¹å–„åº”ç”¨æ‰€éœ€çš„å¯¹è±¡ç»“æ„çš„æ–¹å¼ã€‚</p><p>äº«å…ƒæ¨¡å¼å°è¯•é‡ç”¨ç°æœ‰çš„åŒç±»å¯¹è±¡ï¼Œå¦‚æœæœªæ‰¾åˆ°åŒ¹é…çš„å¯¹è±¡ï¼Œåˆ™åˆ›å»ºæ–°å¯¹è±¡ã€‚</p><p>è¿ç”¨å…±äº«æŠ€æœ¯æœ‰æ•ˆåœ°æ”¯æŒå¤§é‡ç»†ç²’åº¦çš„å¯¹è±¡ã€‚</p><blockquote><p>è¡Œä¸ºå‹æ¨¡å¼</p></blockquote><p>13ã€ç­–ç•¥æ¨¡å¼</p><p>åœ¨ç­–ç•¥æ¨¡å¼ï¼ˆStrategy Patternï¼‰ä¸­ï¼Œä¸€ä¸ªç±»çš„è¡Œä¸ºæˆ–å…¶ç®—æ³•å¯ä»¥åœ¨è¿è¡Œæ—¶æ›´æ”¹ã€‚</p><p>åœ¨ç­–ç•¥æ¨¡å¼ä¸­ï¼Œæˆ‘ä»¬åˆ›å»ºè¡¨ç¤ºå„ç§ç­–ç•¥çš„å¯¹è±¡å’Œä¸€ä¸ªè¡Œä¸ºéšç€ç­–ç•¥å¯¹è±¡æ”¹å˜è€Œæ”¹å˜çš„contextå¯¹è±¡ã€‚ç­–ç•¥å¯¹è±¡æ”¹å˜contextå¯¹è±¡çš„æ‰§è¡Œç®—æ³•ã€‚</p><p>å®šä¹‰ä¸€ç³»åˆ—çš„ç®—æ³•ï¼ŒæŠŠå®ƒä»¬ä¸€ä¸ªä¸ªå°è£…èµ·æ¥ï¼Œå¹¶ä¸”ä½¿å®ƒä»¬å¯ç›¸äº’æ›¿æ¢ã€‚</p><p>14ã€æ¨¡æ¿æ¨¡å¼</p><p>åœ¨æ¨¡æ¿æ¨¡å¼ï¼ˆTemplate Patternï¼‰ä¸­ï¼Œä¸€ä¸ªæŠ½è±¡ç±»å…¬å¼€å®šä¹‰äº†æ‰§è¡Œå®ƒçš„æ–¹æ³•çš„æ–¹å¼/æ¨¡æ¿ã€‚å®ƒçš„å­ç±»å¯ä»¥æŒ‰éœ€è¦é‡å†™æ–¹æ³•å®ç°ï¼Œä½†è°ƒç”¨å°†ä»¥æŠ½è±¡ç±»ä¸­å®šä¹‰çš„æ–¹å¼è¿›è¡Œã€‚</p><p>å®šä¹‰ä¸€ä¸ªæ“ä½œä¸­çš„ç®—æ³•çš„éª¨æ¶ï¼Œè€Œå°†ä¸€äº›æ­¥éª¤å»¶è¿Ÿåˆ°å­ç±»ä¸­ã€‚æ¨¡æ¿æ–¹æ³•ä½¿å¾—å­ç±»å¯ä»¥ä¸æ”¹å˜ä¸€ä¸ªç®—æ³•çš„ç»“æ„å³å¯é‡å®šä¹‰è¯¥ç®—æ³•çš„æŸäº›ç‰¹å®šæ­¥éª¤ã€‚</p><p>15ã€è§‚å¯Ÿè€…æ¨¡å¼</p><p>å½“å¯¹è±¡é—´å­˜åœ¨ä¸€å¯¹å¤šå…³ç³»æ—¶ï¼Œåˆ™ä½¿ç”¨è§‚å¯Ÿè€…æ¨¡å¼ï¼ˆObserverPatternï¼‰ã€‚æ¯”å¦‚ï¼Œå½“ä¸€ä¸ªå¯¹è±¡è¢«ä¿®æ”¹æ—¶ï¼Œåˆ™ä¼šè‡ªåŠ¨é€šçŸ¥å®ƒçš„ä¾èµ–å¯¹è±¡ã€‚</p><p>å®šä¹‰å¯¹è±¡é—´çš„ä¸€ç§ä¸€å¯¹å¤šçš„ä¾èµ–å…³ç³»ï¼Œå½“ä¸€ä¸ªå¯¹è±¡çš„çŠ¶æ€å‘ç”Ÿæ”¹å˜æ—¶ï¼Œæ‰€æœ‰ä¾èµ–äºå®ƒçš„å¯¹è±¡éƒ½å¾—åˆ°é€šçŸ¥å¹¶è¢«è‡ªåŠ¨æ›´æ–°ã€‚</p><p>16ã€è¿­ä»£å™¨æ¨¡å¼</p><p>è¿­ä»£å™¨æ¨¡å¼ï¼ˆIterator Patternï¼‰æ˜¯Javaå’Œ.Netç¼–ç¨‹ç¯å¢ƒä¸­éå¸¸å¸¸ç”¨çš„è®¾è®¡æ¨¡å¼ã€‚è¿™ç§æ¨¡å¼ç”¨äºé¡ºåºè®¿é—®é›†åˆå¯¹è±¡çš„å…ƒç´ ï¼Œä¸éœ€è¦çŸ¥é“é›†åˆå¯¹è±¡çš„åº•å±‚è¡¨ç¤ºã€‚</p><p>è¿­ä»£å™¨æ¨¡å¼å±äºè¡Œä¸ºå‹æ¨¡å¼ã€‚</p><p>æä¾›ä¸€ç§æ–¹æ³•é¡ºåºè®¿é—®ä¸€ä¸ªèšåˆå¯¹è±¡ä¸­å„ä¸ªå…ƒç´ ï¼Œè€Œåˆæ— é¡»æš´éœ²è¯¥å¯¹è±¡çš„å†…éƒ¨è¡¨ç¤ºã€‚</p><p>17ã€è´£ä»»é“¾æ¨¡å¼</p><p>é¡¾åæ€ä¹‰ï¼Œè´£ä»»é“¾æ¨¡å¼ï¼ˆChain of Responsibility Patternï¼‰ä¸ºè¯·æ±‚åˆ›å»ºäº†ä¸€ä¸ªæ¥æ”¶è€…å¯¹è±¡çš„é“¾ã€‚è¿™ç§æ¨¡å¼ç»™äºˆè¯·æ±‚çš„ç±»å‹ï¼Œå¯¹è¯·æ±‚çš„å‘é€è€…å’Œæ¥æ”¶è€…è¿›è¡Œè§£è€¦ã€‚</p><p>åœ¨è¿™ç§æ¨¡å¼ä¸­ï¼Œé€šå¸¸æ¯ä¸ªæ¥æ”¶è€…éƒ½åŒ…å«å¯¹å¦ä¸€ä¸ªæ¥æ”¶è€…çš„å¼•ç”¨ã€‚å¦‚æœä¸€ä¸ªå¯¹è±¡ä¸èƒ½å¤„ç†è¯¥è¯·æ±‚ï¼Œé‚£ä¹ˆå®ƒä¼šæŠŠç›¸åŒçš„è¯·æ±‚ä¼ ç»™ä¸‹ä¸€ä¸ªæ¥æ”¶è€…ï¼Œä¾æ­¤ç±»æ¨ã€‚</p><p>é¿å…è¯·æ±‚å‘é€è€…ä¸æ¥æ”¶è€…è€¦åˆåœ¨ä¸€èµ·ï¼Œè®©å¤šä¸ªå¯¹è±¡éƒ½æœ‰å¯èƒ½æ¥æ”¶è¯·æ±‚ï¼Œå°†è¿™äº›å¯¹è±¡è¿æ¥æˆä¸€æ¡é“¾ï¼Œå¹¶ä¸”æ²¿ç€è¿™æ¡é“¾ä¼ é€’è¯·æ±‚ï¼Œç›´åˆ°æœ‰å¯¹è±¡å¤„ç†å®ƒä¸ºæ­¢ã€‚</p><p>18ã€å‘½ä»¤æ¨¡å¼</p><p>å‘½ä»¤æ¨¡å¼ï¼ˆCommand Patternï¼‰æ˜¯ä¸€ç§æ•°æ®é©±åŠ¨çš„è®¾è®¡æ¨¡å¼ã€‚è¯·æ±‚ä»¥å‘½ä»¤çš„å½¢å¼åŒ…è£¹åœ¨å¯¹è±¡ä¸­ï¼Œå¹¶ä¼ ç»™è°ƒç”¨å¯¹è±¡ã€‚è°ƒç”¨å¯¹è±¡å¯»æ‰¾å¯ä»¥å¤„ç†è¯¥å‘½ä»¤çš„åˆé€‚çš„å¯¹è±¡ï¼Œå¹¶æŠŠè¯¥å‘½ä»¤ä¼ ç»™ç›¸åº”çš„å¯¹è±¡ï¼Œè¯¥å¯¹è±¡æ‰§è¡Œå‘½ä»¤ã€‚</p><p>å°†ä¸€ä¸ªè¯·æ±‚å°è£…æˆä¸€ä¸ªå¯¹è±¡ï¼Œä»è€Œä½¿æ‚¨å¯ä»¥ç”¨ä¸åŒçš„è¯·æ±‚å¯¹å®¢æˆ·è¿›è¡Œå‚æ•°åŒ–ã€‚</p><p>19ã€å¤‡å¿˜å½•æ¨¡å¼</p><p>å¤‡å¿˜å½•æ¨¡å¼ï¼ˆMemento Patternï¼‰ä¿å­˜ä¸€ä¸ªå¯¹è±¡çš„æŸä¸ªçŠ¶æ€ï¼Œä»¥ä¾¿åœ¨é€‚å½“çš„æ—¶å€™æ¢å¤å¯¹è±¡ã€‚</p><p>åœ¨ä¸ç ´åå°è£…æ€§çš„å‰æä¸‹ï¼Œæ•è·ä¸€ä¸ªå¯¹è±¡çš„å†…éƒ¨çŠ¶æ€ï¼Œå¹¶åœ¨è¯¥å¯¹è±¡ä¹‹å¤–ä¿å­˜è¿™ä¸ªçŠ¶æ€ã€‚</p><p>20ã€çŠ¶æ€æ¨¡å¼</p><p>åœ¨çŠ¶æ€æ¨¡å¼ï¼ˆState Patternï¼‰ä¸­ï¼Œç±»çš„è¡Œä¸ºæ˜¯åŸºäºå®ƒçš„çŠ¶æ€æ”¹å˜çš„ã€‚</p><p>åœ¨çŠ¶æ€æ¨¡å¼ä¸­ï¼Œæˆ‘ä»¬åˆ›å»ºè¡¨ç¤ºå„ç§çŠ¶æ€çš„å¯¹è±¡å’Œä¸€ä¸ªè¡Œä¸ºéšç€çŠ¶æ€å¯¹è±¡æ”¹å˜è€Œæ”¹å˜çš„contextå¯¹è±¡ã€‚</p><p>å…è®¸å¯¹è±¡åœ¨å†…éƒ¨çŠ¶æ€å‘ç”Ÿæ”¹å˜æ—¶æ”¹å˜å®ƒçš„è¡Œä¸ºï¼Œå¯¹è±¡çœ‹èµ·æ¥å¥½åƒä¿®æ”¹äº†å®ƒçš„ç±»ã€‚</p><p>21ã€è®¿é—®è€…æ¨¡å¼</p><p>åœ¨è®¿é—®è€…æ¨¡å¼ï¼ˆVisitor Patternï¼‰ä¸­ï¼Œæˆ‘ä»¬ä½¿ç”¨äº†ä¸€ä¸ªè®¿é—®è€…ç±»ï¼Œå®ƒæ”¹å˜äº†å…ƒç´ ç±»çš„æ‰§è¡Œç®—æ³•ã€‚é€šè¿‡è¿™ç§æ–¹å¼ï¼Œå…ƒç´ çš„æ‰§è¡Œç®—æ³•å¯ä»¥éšç€è®¿é—®è€…æ”¹å˜è€Œæ”¹å˜ã€‚æ ¹æ®æ¨¡å¼ï¼Œå…ƒç´ å¯¹è±¡å·²æ¥å—è®¿é—®è€…å¯¹è±¡ï¼Œè¿™æ ·è®¿é—®è€…å¯¹è±¡å°±å¯ä»¥å¤„ç†å…ƒç´ å¯¹è±¡ä¸Šçš„æ“ä½œã€‚</p><p>ä¸»è¦å°†æ•°æ®ç»“æ„ä¸æ•°æ®æ“ä½œåˆ†ç¦»ã€‚</p><p>ä¸»è¦è§£å†³ï¼šç¨³å®šçš„æ•°æ®ç»“æ„å’Œæ˜“å˜çš„æ“ä½œè€¦åˆé—®é¢˜ã€‚</p><p>22ã€ä¸­ä»‹è€…æ¨¡å¼</p><p>ä¸­ä»‹è€…æ¨¡å¼ï¼ˆMediator Patternï¼‰æ˜¯ç”¨æ¥é™ä½å¤šä¸ªå¯¹è±¡å’Œç±»ä¹‹é—´çš„é€šä¿¡å¤æ‚æ€§ã€‚è¿™ç§æ¨¡å¼æä¾›äº†ä¸€ä¸ªä¸­ä»‹ç±»ï¼Œè¯¥ç±»é€šå¸¸å¤„ç†ä¸åŒç±»ä¹‹é—´çš„é€šä¿¡ï¼Œå¹¶æ”¯æŒæ¾è€¦åˆï¼Œä½¿ä»£ç æ˜“äºç»´æŠ¤ã€‚</p><p>ç”¨ä¸€ä¸ªä¸­ä»‹å¯¹è±¡æ¥å°è£…ä¸€ç³»åˆ—çš„å¯¹è±¡äº¤äº’ï¼Œä¸­ä»‹è€…ä½¿å„å¯¹è±¡ä¸éœ€è¦æ˜¾å¼åœ°ç›¸äº’å¼•ç”¨ï¼Œä»è€Œä½¿å…¶è€¦åˆæ¾æ•£ï¼Œè€Œä¸”å¯ä»¥ç‹¬ç«‹åœ°æ”¹å˜å®ƒä»¬ä¹‹é—´çš„äº¤äº’ã€‚</p><p>23ã€è§£é‡Šå™¨æ¨¡å¼</p><p>è§£é‡Šå™¨æ¨¡å¼ï¼ˆInterpreter Patternï¼‰æä¾›äº†è¯„ä¼°è¯­è¨€çš„è¯­æ³•æˆ–è¡¨è¾¾å¼çš„æ–¹å¼ã€‚è¿™ç§æ¨¡å¼å®ç°äº†ä¸€ä¸ªè¡¨è¾¾å¼æ¥å£ï¼Œè¯¥æ¥å£è§£é‡Šä¸€ä¸ªç‰¹å®šçš„ä¸Šä¸‹æ–‡ã€‚è¿™ç§æ¨¡å¼è¢«ç”¨åœ¨SQLè§£æã€ç¬¦å·å¤„ç†å¼•æ“ç­‰ã€‚</p><p>ç»™å®šä¸€ä¸ªè¯­è¨€ï¼Œå®šä¹‰å®ƒçš„æ–‡æ³•è¡¨ç¤ºï¼Œå¹¶å®šä¹‰ä¸€ä¸ªè§£é‡Šå™¨ï¼Œè¿™ä¸ªè§£é‡Šå™¨ä½¿ç”¨è¯¥æ ‡è¯†æ¥è§£é‡Šè¯­è¨€ä¸­çš„å¥å­ã€‚</p><h2 id="å››ã€é¢å‘å¯¹è±¡è®¾è®¡åŸåˆ™"><a href="#å››ã€é¢å‘å¯¹è±¡è®¾è®¡åŸåˆ™" class="headerlink" title="å››ã€é¢å‘å¯¹è±¡è®¾è®¡åŸåˆ™"></a>å››ã€é¢å‘å¯¹è±¡è®¾è®¡åŸåˆ™</h2><h3 id="1ã€å•ä¸€èŒè´£åŸåˆ™"><a href="#1ã€å•ä¸€èŒè´£åŸåˆ™" class="headerlink" title="1ã€å•ä¸€èŒè´£åŸåˆ™"></a>1ã€å•ä¸€èŒè´£åŸåˆ™</h3><p>ä¸è¦å­˜åœ¨å¤šäºä¸€ä¸ªå¯¼è‡´ç±»å˜æ›´çš„åŸå› ï¼Œä¹Ÿå°±æ˜¯è¯´æ¯ä¸ªç±»åº”è¯¥å®ç°å•ä¸€çš„èŒè´£ï¼Œå¦åˆ™å°±åº”è¯¥æŠŠç±»æ‹†åˆ†ã€‚</p><h3 id="2ã€é‡Œæ°æ›¿æ¢åŸåˆ™"><a href="#2ã€é‡Œæ°æ›¿æ¢åŸåˆ™" class="headerlink" title="2ã€é‡Œæ°æ›¿æ¢åŸåˆ™"></a>2ã€é‡Œæ°æ›¿æ¢åŸåˆ™</h3><p>æ‰€æœ‰å¼•ç”¨åŸºç±»çš„åœ°æ–¹å¿…é¡»èƒ½é€æ˜åœ°ä½¿ç”¨å…¶å­ç±»çš„å¯¹è±¡ã€‚</p><h3 id="3ã€ä¾èµ–å€’ç½®åŸåˆ™"><a href="#3ã€ä¾èµ–å€’ç½®åŸåˆ™" class="headerlink" title="3ã€ä¾èµ–å€’ç½®åŸåˆ™"></a>3ã€ä¾èµ–å€’ç½®åŸåˆ™</h3><ol><li>ä¸Šå±‚æ¨¡å—ä¸åº”è¯¥ä¾èµ–åº•å±‚æ¨¡å—ï¼Œå®ƒä»¬éƒ½åº”è¯¥ä¾èµ–äºæŠ½è±¡ã€‚</li><li>æŠ½è±¡ä¸åº”è¯¥ä¾èµ–äºç»†èŠ‚ï¼Œç»†èŠ‚åº”è¯¥ä¾èµ–äºæŠ½è±¡ã€‚</li></ol><h3 id="4ã€æ¥å£éš”ç¦»åŸåˆ™"><a href="#4ã€æ¥å£éš”ç¦»åŸåˆ™" class="headerlink" title="4ã€æ¥å£éš”ç¦»åŸåˆ™"></a>4ã€æ¥å£éš”ç¦»åŸåˆ™</h3><p>æ¯ä¸ªæ¥å£ä¸­ä¸å­˜åœ¨å­ç±»ç”¨ä¸åˆ°å´å¿…é¡»å®ç°çš„æ–¹æ³•ï¼Œå¦‚æœä¸ç„¶ï¼Œå°±è¦å°†æ¥å£æ‹†åˆ†ã€‚ä½¿ç”¨å¤šä¸ªéš”ç¦»çš„æ¥å£ï¼Œæ¯”ä½¿ç”¨å•ä¸ªæ¥å£ï¼ˆå¤šä¸ªæ¥å£æ–¹æ³•é›†åˆåˆ°ä¸€ä¸ªçš„æ¥å£ï¼‰è¦å¥½ã€‚</p><h3 id="5ã€è¿ªç±³ç‰¹æ³•åˆ™ï¼ˆæœ€å°‘çŸ¥é“åŸåˆ™ï¼‰"><a href="#5ã€è¿ªç±³ç‰¹æ³•åˆ™ï¼ˆæœ€å°‘çŸ¥é“åŸåˆ™ï¼‰" class="headerlink" title="5ã€è¿ªç±³ç‰¹æ³•åˆ™ï¼ˆæœ€å°‘çŸ¥é“åŸåˆ™ï¼‰"></a>5ã€è¿ªç±³ç‰¹æ³•åˆ™ï¼ˆæœ€å°‘çŸ¥é“åŸåˆ™ï¼‰</h3><p>ä¸€ä¸ªç±»å¯¹è‡ªå·±ä¾èµ–çš„ç±»çŸ¥é“çš„è¶Šå°‘è¶Šå¥½ã€‚æ— è®ºè¢«ä¾èµ–çš„ç±»å¤šä¹ˆå¤æ‚ï¼Œéƒ½åº”è¯¥å°†é€»è¾‘å°è£…åœ¨æ–¹æ³•çš„å†…éƒ¨ï¼Œé€šè¿‡publicæ–¹æ³•æä¾›ç»™å¤–éƒ¨ã€‚è¿™æ ·å½“è¢«ä¾èµ–çš„ç±»å˜åŒ–æ—¶ï¼Œæ‰èƒ½æœ€å°çš„å½±å“è¯¥ç±»ã€‚</p><h3 id="6ã€åˆæˆå¤ç”¨åŸåˆ™"><a href="#6ã€åˆæˆå¤ç”¨åŸåˆ™" class="headerlink" title="6ã€åˆæˆå¤ç”¨åŸåˆ™"></a>6ã€åˆæˆå¤ç”¨åŸåˆ™</h3><p>å°½é‡ä½¿ç”¨å¯¹è±¡ç»„åˆ/èšåˆï¼Œè€Œä¸æ˜¯ç»§æ‰¿å…³ç³»è¾¾åˆ°è½¯ä»¶å¤ç”¨çš„ç›®çš„ã€‚</p><h3 id="7ã€å¼€é—­åŸåˆ™"><a href="#7ã€å¼€é—­åŸåˆ™" class="headerlink" title="7ã€å¼€é—­åŸåˆ™"></a>7ã€å¼€é—­åŸåˆ™</h3><p>è½¯ä»¶å®ä½“åº”è¯¥å¯¹æ‰©å±•å¼€æ”¾ï¼Œå¯¹ä¿®æ”¹å…³é—­</p>]]></content>
    
    
    <categories>
      
      <category>è®¾è®¡æ¨¡å¼</category>
      
    </categories>
    
    
    <tags>
      
      <tag>è®¾è®¡æ¨¡å¼</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>é“¾è¡¨</title>
    <link href="/2022/09/21/lian-biao/"/>
    <url>/2022/09/21/lian-biao/</url>
    
    <content type="html"><![CDATA[<h1>ä¸€ã€ç†è®º</h1><h2 id="1ã€é“¾è¡¨ç±»å‹">1ã€é“¾è¡¨ç±»å‹</h2><h3 id="1ã€å•é“¾è¡¨">1ã€å•é“¾è¡¨</h3><p><img src="/2022/09/21/lian-biao/image-20221011101058417.png" alt></p><h3 id="2ã€åŒé“¾è¡¨">2ã€åŒé“¾è¡¨</h3><p><img src="/2022/09/21/lian-biao/image-20221011101124093.png" alt></p><h3 id="3ã€å¾ªç¯é“¾è¡¨">3ã€å¾ªç¯é“¾è¡¨</h3><p>å¾ªç¯é“¾è¡¨å¯ä»¥ç”¨æ¥è§£å†³<code>çº¦ç‘Ÿå¤«ç¯</code>é—®é¢˜</p><p><img src="/2022/09/21/lian-biao/image-20221011101149273.png" alt></p><h2 id="2ã€é“¾è¡¨å­˜å‚¨æ–¹å¼">2ã€é“¾è¡¨å­˜å‚¨æ–¹å¼</h2><p>æ•°ç»„åœ¨å†…å­˜ä¸­æ˜¯è¿ç»­åˆ†å¸ƒçš„ï¼Œä½†é“¾è¡¨åœ¨å†…å­˜ä¸­ä¸æ˜¯è¿ç»­åˆ†å¸ƒçš„ã€‚</p><p>é“¾è¡¨æ˜¯é€šè¿‡æŒ‡é’ˆåŸŸçš„æŒ‡é’ˆæ¥è¿æ¥å„ä¸ªèŠ‚ç‚¹ã€‚æ‰€ä»¥é“¾è¡¨çš„åˆ†é…æœºåˆ¶å–å†³äºæ“ä½œç³»ç»Ÿçš„å†…å­˜ç®¡ç†ã€‚</p><h2 id="3ã€é“¾è¡¨çš„å®šä¹‰">3ã€é“¾è¡¨çš„å®šä¹‰</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">ListNode</span> &#123;<br>    <span class="hljs-comment">// ç»“ç‚¹çš„å€¼</span><br>    <span class="hljs-type">int</span> val;<br><br>    <span class="hljs-comment">// ä¸‹ä¸€ä¸ªç»“ç‚¹</span><br>    ListNode next;<br><br>    <span class="hljs-comment">// èŠ‚ç‚¹çš„æ„é€ å‡½æ•°(æ— å‚)</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-title function_">ListNode</span><span class="hljs-params">()</span> &#123;<br>    &#125;<br><br>    <span class="hljs-comment">// èŠ‚ç‚¹çš„æ„é€ å‡½æ•°(æœ‰ä¸€ä¸ªå‚æ•°)</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-title function_">ListNode</span><span class="hljs-params">(<span class="hljs-type">int</span> val)</span> &#123;<br>        <span class="hljs-built_in">this</span>.val = val;<br>    &#125;<br><br>    <span class="hljs-comment">// èŠ‚ç‚¹çš„æ„é€ å‡½æ•°(æœ‰ä¸¤ä¸ªå‚æ•°)</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-title function_">ListNode</span><span class="hljs-params">(<span class="hljs-type">int</span> val, ListNode next)</span> &#123;<br>        <span class="hljs-built_in">this</span>.val = val;<br>        <span class="hljs-built_in">this</span>.next = next;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><h2 id="4ã€é“¾è¡¨çš„åŸºæœ¬æ“ä½œ">4ã€é“¾è¡¨çš„åŸºæœ¬æ“ä½œ</h2><h3 id="1ã€åˆ é™¤èŠ‚ç‚¹">1ã€åˆ é™¤èŠ‚ç‚¹</h3><p><img src="/2022/09/21/lian-biao/image-20221011101632656.png" alt></p><p>åˆ é™¤DèŠ‚ç‚¹ï¼Œç›´æ¥å°†CèŠ‚ç‚¹çš„nextèŠ‚ç‚¹æŒ‡å‘Eå³å¯ã€‚javaæœ‰è‡ªå·±çš„å†…å­˜å›æ”¶æœºåˆ¶ï¼Œä¸ç”¨è‡ªå·±æ‰‹åŠ¨é‡Šæ”¾ã€‚</p><h3 id="2ã€æ·»åŠ èŠ‚ç‚¹">2ã€æ·»åŠ èŠ‚ç‚¹</h3><p><img src="/2022/09/21/lian-biao/image-20221011101738080.png" alt></p><p>å¢åŠ FèŠ‚ç‚¹ï¼Œå…ˆå°†FèŠ‚ç‚¹çš„nextæŒ‡å‘Dï¼Œå†å°†CèŠ‚ç‚¹çš„nextæŒ‡å‘Fã€‚</p><p>ä½†æ˜¯æœ‰ä¸€ç‚¹éœ€è¦æ³¨æ„ï¼Œåœ¨Cåå¢åŠ èŠ‚ç‚¹ï¼Œé¦–å…ˆå¾—æ‰¾åˆ°CèŠ‚ç‚¹ï¼Œæ‰¾èŠ‚ç‚¹çš„å¤æ‚åº¦æ˜¯O(n)</p><h2 id="5ã€é“¾è¡¨ä¸æ•°ç»„çš„æ€§èƒ½å¯¹æ¯”">5ã€é“¾è¡¨ä¸æ•°ç»„çš„æ€§èƒ½å¯¹æ¯”</h2><p><img src="/2022/09/21/lian-biao/image-20221011102001636.png" alt></p><h1>äºŒã€ç¿»è½¬é“¾è¡¨</h1><h2 id="1ã€ç¿»è½¬æ•´ä¸ªé“¾è¡¨">1ã€ç¿»è½¬æ•´ä¸ªé“¾è¡¨</h2><p>å…ˆä¸Š<code>æœ¬æ¬¡</code>çš„é“¾è¡¨å®šä¹‰</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Node</span> &#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-type">int</span> value;<br>    <span class="hljs-keyword">public</span> Node next;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-title function_">Node</span><span class="hljs-params">(<span class="hljs-type">int</span> data)</span> &#123;<br>        <span class="hljs-built_in">this</span>.value = data;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>1ã€åŒæŒ‡é’ˆæ³•</p><p>åªéœ€è¦æ”¹å˜é“¾è¡¨çš„nextæŒ‡å‘å³å¯</p><p><img src="/2022/09/21/lian-biao/image-20220921114419429.png" alt></p><p>é¦–å…ˆå®šä¹‰curèŠ‚ç‚¹ï¼ŒæŒ‡å‘headï¼›å†å®šä¹‰preæŒ‡å‘nullã€‚</p><p>preèŠ‚ç‚¹æ˜¯curèŠ‚ç‚¹çš„å‰åºèŠ‚ç‚¹</p><p>å…ˆå°†cur.nextèŠ‚ç‚¹ä¿å­˜åœ¨tempé‡Œï¼Œå†è¿›è¡Œç¿»è½¬ã€‚ä¿å­˜åœ¨tempæ˜¯ä¸ºäº†é˜²æ­¢ä¸‹ä¸€ä¸ªèŠ‚ç‚¹ä¸¢å¤±ã€‚</p><p>åˆ°æœ€åcurä¸ºnullæ—¶ï¼Œpreä¸ºæœ€åä¸€ä¸ªèŠ‚ç‚¹ï¼Œæ­¤æ—¶è¿”å›preå³å¯ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> Node <span class="hljs-title function_">reverse</span><span class="hljs-params">(Node head)</span> &#123;<br>    <span class="hljs-type">Node</span> <span class="hljs-variable">pre</span> <span class="hljs-operator">=</span> <span class="hljs-literal">null</span>;<br>    <span class="hljs-type">Node</span> <span class="hljs-variable">cur</span> <span class="hljs-operator">=</span> head;<br>    <span class="hljs-type">Node</span> <span class="hljs-variable">temp</span> <span class="hljs-operator">=</span> <span class="hljs-literal">null</span>;<br>    <span class="hljs-keyword">while</span> (cur != <span class="hljs-literal">null</span>) &#123;   <span class="hljs-comment">// ä»¥ä¸‹æ³¨é‡Šä»¥1 2ä¸ºä¾‹</span><br>        temp = cur.next;   <span class="hljs-comment">// tempæŒ‡å‘2</span><br>        cur.next = pre;    <span class="hljs-comment">// 1 å’Œ 2 ä¹‹é—´å·²ç»æ–­é“¾ï¼Œ 1 å·²ç»æŒ‡å‘äº†preï¼Œä¹Ÿå°±æ˜¯ç©º</span><br><br>        pre = cur;     <span class="hljs-comment">//  åŒæ—¶å‘åç§»</span><br>        cur = temp;<br>    &#125;<br>    <span class="hljs-keyword">return</span> pre;<br>&#125;<br></code></pre></td></tr></table></figure><p>2ã€é€’å½’æ³•</p><p>é€’å½’æ³•å…¶å®è·ŸåŒæŒ‡é’ˆæ³•ç±»ä¼¼ï¼Œæ¯ä¸€æ­¥ç¿»è½¬éƒ½æœ‰ä¸‰ä¸ªè¿‡ç¨‹ï¼š</p><ol><li>è®°å½•ä¸‹ä¸€ä¸ªèŠ‚ç‚¹</li><li>ç¿»è½¬</li><li>åŒæ—¶å¾€åç§»</li></ol><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span> &#123;<br>    <span class="hljs-comment">//  å…¶ä»–ä»£ç </span><br>    <span class="hljs-type">Node</span> <span class="hljs-variable">res</span> <span class="hljs-operator">=</span> reverse(<span class="hljs-literal">null</span>, node1);    <span class="hljs-comment">// node1 ä¸ºå·²å®šä¹‰å¥½çš„é“¾è¡¨çš„å¤´ç»“ç‚¹</span><br>    <span class="hljs-keyword">while</span> (res != <span class="hljs-literal">null</span>) &#123;<br>        System.out.print(res.value + <span class="hljs-string">&quot; &quot;</span>);<br>        res = res.next;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> Node <span class="hljs-title function_">reverse</span><span class="hljs-params">(Node pre, Node cur)</span> &#123;<br>    <span class="hljs-keyword">if</span> (cur == <span class="hljs-literal">null</span>) &#123;<br>        <span class="hljs-keyword">return</span> pre;<br>    &#125;<br>    <span class="hljs-type">Node</span> <span class="hljs-variable">temp</span> <span class="hljs-operator">=</span> cur.next;  <span class="hljs-comment">//è®°å½•ä¸‹ä¸€ä¸ªèŠ‚ç‚¹</span><br>    cur.next = pre;     <span class="hljs-comment">// ç¿»è½¬</span><br><br>    <span class="hljs-keyword">return</span> reverse(cur, temp);   <span class="hljs-comment">//å‘åç§»</span><br>&#125;<br></code></pre></td></tr></table></figure><h2 id="2ã€ç¿»è½¬éƒ¨åˆ†é“¾è¡¨">2ã€ç¿»è½¬éƒ¨åˆ†é“¾è¡¨</h2><p>ç»™å®šä¸€ä¸ªé“¾è¡¨çš„å¤´ç»“ç‚¹ï¼Œç»™å®šmå’Œnï¼Œè¦æ±‚ç¿»è½¬måˆ°nä¹‹é—´çš„é“¾è¡¨</p><p>æ€è·¯ï¼šä½¿ç”¨å¤´æ’æ³•</p><ol><li>é¦–å…ˆæ‰¾åˆ°mèŠ‚ç‚¹çš„å‰ä¸€ä¸ªèŠ‚ç‚¹ï¼Œå®šä¹‰ä¸ºpreï¼Œè¿™ä¸ªpreå°±ç›¸å½“äºå¤´æ’æ³•çš„å¤´ç»“ç‚¹çš„å‰åºèŠ‚ç‚¹</li><li>ç”¨ä¸€ä¸ªforå¾ªç¯ï¼Œéå†ä»måˆ°nï¼Œè¿›è¡Œé“¾è¡¨çš„å¤´æ’</li><li>æœ€åè¿”å›å¤´ç»“ç‚¹å³å¯</li></ol><p>ä»£ç å¦‚ä¸‹ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> ListNode <span class="hljs-title function_">reverseBetween</span> <span class="hljs-params">(ListNode head, <span class="hljs-type">int</span> m, <span class="hljs-type">int</span> n)</span> &#123;<br>        <span class="hljs-comment">// write code here</span><br>        <span class="hljs-type">ListNode</span> <span class="hljs-variable">res</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">ListNode</span>(-<span class="hljs-number">1</span>);<br>        res.next = head;<br>        <span class="hljs-type">ListNode</span> <span class="hljs-variable">cur</span> <span class="hljs-operator">=</span> head;<br>        <span class="hljs-type">ListNode</span> <span class="hljs-variable">pre</span> <span class="hljs-operator">=</span> res;<br>        <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> <span class="hljs-variable">i</span> <span class="hljs-operator">=</span> <span class="hljs-number">1</span>; i &lt; m; i++) &#123;<br>            pre = cur;<br>            cur = cur.next;<br>        &#125;<br>        <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> <span class="hljs-variable">i</span> <span class="hljs-operator">=</span> m; i &lt; n; i++) &#123;<br>            <span class="hljs-type">ListNode</span> <span class="hljs-variable">temp</span> <span class="hljs-operator">=</span> cur.next;<br>            cur.next = temp.next;<br><br>            temp.next = pre.next;<br>            pre.next = temp;<br>        &#125;<br>        <span class="hljs-keyword">return</span> res.next;<br>    &#125;<br></code></pre></td></tr></table></figure><blockquote><p>ä¹‹æ‰€ä»¥å®šä¹‰resèŠ‚ç‚¹ï¼Œæ˜¯ä¸ºäº†æ–¹ä¾¿æ“ä½œå¤´ç»“ç‚¹ï¼Œå³å½“mä¸º1æ—¶ä¸ç”¨å¯¹å¤´ç»“ç‚¹è¿›è¡Œç‰¹æ®Šå¤„ç†</p></blockquote><h1>ä¸‰ã€ç¯å½¢é“¾è¡¨</h1><p>ç¯å½¢é“¾è¡¨ä¸€å…±æœ‰ä¸¤ä¸ªé—®é¢˜ï¼Œç¬¬ä¸€ä¸ªé—®é¢˜æ˜¯éªŒè¯ä¸€ä¸ªé“¾è¡¨æ˜¯å¦æœ‰ç¯ï¼Œç¬¬äºŒä¸ªé—®é¢˜æ˜¯æ‰¾åˆ°ç¯å½¢é“¾è¡¨çš„å…¥å£ã€‚</p><p>å…ˆæ¥çœ‹ç¬¬ä¸€ä¸ªé—®é¢˜</p><h2 id="1ã€éªŒè¯é“¾è¡¨æ˜¯å¦æœ‰ç¯">1ã€éªŒè¯é“¾è¡¨æ˜¯å¦æœ‰ç¯</h2><p>åˆ¤æ–­é“¾è¡¨æ˜¯å¦æœ‰ç¯ï¼Œå¯ä»¥ä½¿ç”¨å¿«æ…¢æŒ‡é’ˆæ³•ï¼Œå®šä¹‰ä¸€ä¸ªfastï¼Œä»¥åŠä¸€ä¸ªslowï¼Œslowæ¯èµ°ä¸€æ­¥ï¼Œfastå°±èµ°ä¸¤æ­¥ï¼Œè‹¥æ˜¯æœ‰ç¯çš„è¯ï¼Œé‚£ä¹ˆæœ€ç»ˆä¸€å®šä¼šç›¸é‡ã€‚</p><p>ä¸ºä»€ä¹ˆï¼Ÿ</p><p>é¦–å…ˆè‚¯å®šæ˜¯fastå…ˆè¿›ç¯ï¼Œå½“slowè¿›ç¯æ—¶ï¼Œslowèµ°ä¸€æ­¥fastèµ°ä¸¤æ­¥ï¼Œæ•´ä½“æ¥çœ‹å°±æ˜¯faståœ¨è¿½èµ¶slowä¸€æ­¥ï¼Œé‚£ä¹ˆåªè¦æœ‰ç¯ï¼Œæœ€ç»ˆfastå°±ä¸€å®šä¼šè¿½ä¸Šslowã€‚</p><h2 id="2ã€è‹¥æœ‰ç¯ï¼Œå¦‚ä½•æ‰¾åˆ°å…¥å£ï¼Ÿ">2ã€è‹¥æœ‰ç¯ï¼Œå¦‚ä½•æ‰¾åˆ°å…¥å£ï¼Ÿ</h2><p>ç”¨å…¬å¼æ¥è¡¨ç¤ºä¸€ä¸‹ã€‚</p><p>å‡è®¾ä»å¤´ç»“ç‚¹åˆ°ç¯å½¢å…¥å£èŠ‚ç‚¹ çš„èŠ‚ç‚¹æ•°ä¸ºxã€‚ ç¯å½¢å…¥å£èŠ‚ç‚¹åˆ° fastæŒ‡é’ˆä¸slowæŒ‡é’ˆç›¸é‡èŠ‚ç‚¹ èŠ‚ç‚¹æ•°ä¸ºyã€‚ ä»ç›¸é‡èŠ‚ç‚¹ å†åˆ°ç¯å½¢å…¥å£èŠ‚ç‚¹èŠ‚ç‚¹æ•°ä¸º zã€‚ å¦‚å›¾æ‰€ç¤ºï¼š</p><p><img src="/2022/09/21/lian-biao/image-20221013094802419.png" alt></p><p>é‚£ä¹ˆåœ¨ç›¸é‡æ—¶ï¼Œslowèµ°äº†ï¼ˆx + yï¼‰ï¼Œfastèµ°äº†(x + y + n * (y + z))ã€‚fastæœ‰å¯èƒ½åœ¨ç¯å†…èµ°äº†nåœˆã€‚æ ¹æ®æ­¥é•¿ï¼Œå¯ä»¥çœ‹å‡ºfastèµ°çš„è·ç¦»æ˜¯slowçš„äºŒå€ï¼Œå³ï¼š</p><p>2 * (x + y) = x + y + n * (y + z)</p><p>ä¸¤è¾¹æ¶ˆå»ä¸€ä¸ª x + yï¼š</p><p>x + y = n * (y + z)</p><p>è¦æ‰¾åˆ°å…¥å£ï¼Œé‚£å°±æ˜¯è¦æ±‚xçš„è·ç¦»ï¼Œå°†xæ”¾åœ¨ä¸€è¾¹ï¼š</p><p>x = n * (y + z) - y</p><p>æ•´ç†ä¹‹åå°±æ˜¯ï¼š</p><p>x = (n - 1) * (y + z) + z</p><p>å‡è®¾n = 1æ—¶ï¼Œn = 1æ„å‘³ç€faståœ¨ç¯å†…èµ°äº†ä¸€åœˆå°±ç¢°è§slowäº†ï¼Œè¿™æ—¶å€™è®¡ç®—å…¥å£æ—¶(x = z)ï¼Œ<code>åªéœ€è¦åœ¨ä»–ä»¬ç›¸é‡çš„èŠ‚ç‚¹å¤„å®šä¹‰ä¸€ä¸ªindex1ï¼Œåœ¨å¤´ç»“ç‚¹å¤„å®šä¹‰ä¸€ä¸ªindex2ï¼Œä»¤ä»–ä»¬æ¯æ¬¡èµ°ä¸€æ­¥ï¼Œç›¸é‡å³ä¸ºå…¥å£èŠ‚ç‚¹</code>ã€‚</p><p>è‹¥æ˜¯n &gt; 1æ—¶ï¼ŒfastæŒ‡é’ˆåœ¨ç¯å½¢è½¬nåœˆä¹‹åæ‰é‡åˆ° slowæŒ‡é’ˆã€‚è¯¥é—®é¢˜ä¹Ÿå¯ç®€åŒ–ä¸ºn = 1ï¼Œå…¶å®æœ¬è´¨ä¸Šéƒ½ä¸€æ ·ï¼Œåªä¸è¿‡index1åœ¨ç¯å†…å¤šè½¬äº†å‡ åœˆï¼Œç„¶åç¢°åˆ°index2ã€‚</p><blockquote><p>æœ‰ä¸ªç–‘é—®ï¼šé‚£ä¸ºä»€ä¹ˆåœ¨ç¯ä¸­ç›¸é‡æ—¶ï¼Œslowèµ°è¿‡çš„è·ç¦»ä¸€å®šæ˜¯x + yï¼Œè€Œä¸æ˜¯ x + è‹¥å¹²ç¯çš„è·ç¦» + y å‘¢ï¼Ÿ</p></blockquote><p>å› ä¸ºå½“slowè¿›ç¯æ—¶ï¼Œfastä¸€å®šåœ¨ç¯å†…ï¼Œè€Œfastå’Œslowæ¯èµ°ä¸€æ¬¡å°±ç›¸å½“äºfaståœ¨é è¿‘slowä¸€æ­¥ï¼Œæ‰€ä»¥å½“slowè¿˜æ²¡è¿›å…¥åˆ°ä¸‹ä¸€æ¬¡å¾ªç¯çš„æ—¶å€™ï¼Œå°±ä¼šè¢«fastè¿½ä¸Šã€‚</p><h1>å››ã€ç»å…¸é¢˜ç›®</h1><h2 id="1ã€åˆå¹¶kä¸ªå·²æ’åºçš„é“¾è¡¨">1ã€åˆå¹¶kä¸ªå·²æ’åºçš„é“¾è¡¨</h2><p>åŸé¢˜é“¾æ¥ï¼š<a href="https://www.nowcoder.com/practice/65cfde9e5b9b4cf2b6bafa5f3ef33fa6?tpId=295&amp;tqId=724&amp;ru=/exam/oj&amp;qru=/ta/format-top101/question-ranking&amp;sourceUrl=%2Fexam%2Foj">BM5 åˆå¹¶kä¸ªå·²æ’åºçš„é“¾è¡¨</a></p><p>ä¸‰ç§æ–¹æ³•</p><h3 id="1ã€æ–¹æ³•ä¸€ï¼šå€Ÿç”¨è¾…åŠ©ç©ºé—´">1ã€æ–¹æ³•ä¸€ï¼šå€Ÿç”¨è¾…åŠ©ç©ºé—´</h3><p>æ€è·¯ï¼šæ—¢ç„¶è¦åˆå¹¶kä¸ªé“¾è¡¨ï¼Œé‚£ä¹ˆå…ˆå®šä¹‰ä¸€ä¸ªlistï¼Œå°†è¿™äº›é“¾è¡¨çš„å€¼éƒ½å­˜å…¥è¿›listï¼Œæœ€åå¯¹listè¿›è¡Œæ’åºï¼Œç„¶åä¸€ä¸€å–å‡ºå¹¶å°†å…¶ç»„æˆé“¾è¡¨å³å¯</p><p>ä»£ç å¦‚ä¸‹ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> ListNode <span class="hljs-title function_">mergeKLists</span><span class="hljs-params">(ArrayList&lt;ListNode&gt; lists)</span> &#123;<br>    <span class="hljs-comment">// å®šä¹‰è™šæ‹Ÿå¤´ç»“ç‚¹</span><br>        <span class="hljs-type">ListNode</span> <span class="hljs-variable">dummy</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">ListNode</span>(-<span class="hljs-number">1</span>);<br>        <span class="hljs-type">ListNode</span> <span class="hljs-variable">cur</span> <span class="hljs-operator">=</span> dummy;<br>        ArrayList&lt;Integer&gt; array = <span class="hljs-keyword">new</span> <span class="hljs-title class_">ArrayList</span>&lt;&gt;();<br>        <span class="hljs-type">int</span> <span class="hljs-variable">n</span> <span class="hljs-operator">=</span> lists.size();<br>        <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> <span class="hljs-variable">i</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>; i &lt; n; i++) &#123;<br>            <span class="hljs-type">ListNode</span> <span class="hljs-variable">node</span> <span class="hljs-operator">=</span> lists.get(i);<br>            <span class="hljs-keyword">while</span> (node != <span class="hljs-literal">null</span>) &#123;<br>                array.add(node.val);<br>                node = node.next;<br>            &#125;<br>        &#125;<br>        Collections.sort(array);<br>        <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> <span class="hljs-variable">i</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>; i &lt; array.size(); i++) &#123;<br>            <span class="hljs-type">ListNode</span> <span class="hljs-variable">ccc</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">ListNode</span>(array.get(i));<br>            cur.next = ccc;<br>            cur = cur.next;<br>        &#125;<br>    <span class="hljs-comment">// æœ€åè¿”å›è™šæ‹Ÿå¤´ç»“ç‚¹çš„ä¸‹ä¸€ä¸ªèŠ‚ç‚¹</span><br>        <span class="hljs-keyword">return</span> dummy.next;<br>    &#125;<br></code></pre></td></tr></table></figure><p>å½“ç„¶æ—¶é—´å¤æ‚åº¦æ˜¯æ¯”è¾ƒé«˜çš„ï¼Œæ’åºå°±éœ€è¦O(n * log2n)</p><h3 id="2ã€æ–¹æ³•äºŒï¼šä¼˜å…ˆé˜Ÿåˆ—">2ã€æ–¹æ³•äºŒï¼šä¼˜å…ˆé˜Ÿåˆ—</h3><p>ä¼˜å…ˆé˜Ÿåˆ—æ–¹æ³•ç±»ä¼¼äºåŒæŒ‡é’ˆï¼Œéƒ½æ˜¯ä»å‡ ä¸ªä¸­é€‰å‡ºæœ€å°çš„ã€‚ä¼˜å…ˆé˜Ÿåˆ—æ˜¯ä¸€ç§å†…ç½®çš„åŸºäºå †æ’åºçš„å®¹å™¨ï¼Œåˆ†ä¸ºå¤§é¡¶å †å’Œå°é¡¶å †ï¼Œå°é¡¶å †å°±æ˜¯å †é¡¶ä¸ºæœ€å°çš„å…ƒç´ ã€‚æœ¬é¢˜é‡‡ç”¨å°é¡¶å †ã€‚</p><p>ä½¿ç”¨ä¼˜å…ˆé˜Ÿåˆ—æ—¶ï¼Œå¿…é¡»è¦æ‰‹åŠ¨<code>é‡è½½æ¯”è¾ƒæ–¹æ³•</code>ã€‚å› ä¸ºå®¹å™¨å†…éƒ¨çš„æ¬¡åºåŸºäºå †æ’åºï¼Œå› æ­¤æ¯æ¬¡æ’å…¥å…ƒç´ æ—¶é—´å¤æ‚åº¦éƒ½æ˜¯O(log2n)ï¼Œè€Œæ¯æ¬¡å–å‡ºå †é¡¶å…ƒç´ éƒ½æ˜¯ç›´æ¥å–å‡ºã€‚</p><p>æ€è·¯ï¼š</p><ol><li>éå†kä¸ªé“¾è¡¨å¤´ï¼Œå°†ä¸æ˜¯ç©ºèŠ‚ç‚¹çš„èŠ‚ç‚¹æ”¾è¿›ä¼˜å…ˆé˜Ÿåˆ—</li><li>ä¼˜å…ˆé˜Ÿåˆ—å¼¹å‡ºæœ€å°å€¼ï¼Œå¹¶ä¸”è‹¥å¼¹å‡ºçš„èŠ‚ç‚¹çš„ä¸‹ä¸€ä¸ªèŠ‚ç‚¹ä¸ä¸ºç©ºï¼Œå°±å°†ä¸‹ä¸€ä¸ªèŠ‚ç‚¹æ”¾è¿›ä¼˜å…ˆé˜Ÿåˆ—</li></ol><p>å…·ä½“ä»£ç å¦‚ä¸‹ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> ListNode <span class="hljs-title function_">mergeKLists</span><span class="hljs-params">(ArrayList&lt;ListNode&gt; lists)</span> &#123;<br>        <span class="hljs-comment">//å°é¡¶å †</span><br>        Queue&lt;ListNode&gt; pq = <span class="hljs-keyword">new</span> <span class="hljs-title class_">PriorityQueue</span>&lt;&gt;((v1, v2) -&gt; v1.val - v2.val);<br>        <span class="hljs-comment">//éå†æ‰€æœ‰é“¾è¡¨ç¬¬ä¸€ä¸ªå…ƒç´ </span><br>        <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> <span class="hljs-variable">i</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>; i &lt; lists.size(); i++)&#123;<br>            <span class="hljs-comment">//ä¸ä¸ºç©ºåˆ™åŠ å…¥å°é¡¶å †</span><br>            <span class="hljs-keyword">if</span>(lists.get(i) != <span class="hljs-literal">null</span>)<br>                pq.add(lists.get(i));<br>        &#125;<br>        <span class="hljs-comment">//åŠ ä¸€ä¸ªè¡¨å¤´</span><br>        <span class="hljs-type">ListNode</span> <span class="hljs-variable">dummy</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">ListNode</span>(-<span class="hljs-number">1</span>);<br>        <span class="hljs-type">ListNode</span> <span class="hljs-variable">head</span> <span class="hljs-operator">=</span> dummy;<br>        <span class="hljs-comment">//ç›´åˆ°å°é¡¶å †ä¸ºç©º</span><br>        <span class="hljs-keyword">while</span>(!pq.isEmpty())&#123;<br>            <span class="hljs-comment">//å–å‡ºæœ€å°çš„å…ƒç´ </span><br>            <span class="hljs-type">ListNode</span> <span class="hljs-variable">temp</span> <span class="hljs-operator">=</span> pq.poll();<br>            <span class="hljs-comment">//è¿æ¥</span><br>            head.next = temp;<br>            head = head.next;<br>            <span class="hljs-comment">//æ¯æ¬¡å–å‡ºé“¾è¡¨çš„åä¸€ä¸ªå…ƒç´ åŠ å…¥å°é¡¶å †</span><br>            <span class="hljs-keyword">if</span>(temp.next != <span class="hljs-literal">null</span>)<br>                pq.add(temp.next);<br>        &#125;<br>        <span class="hljs-comment">//å»æ‰è¡¨å¤´</span><br>        <span class="hljs-keyword">return</span> dummy.next;<br>    &#125;<br></code></pre></td></tr></table></figure><p>æ—¶é—´å¤æ‚åº¦ï¼šO(n * log 2 * k)ï¼Œæ¯æ¬¡åŠ å…¥ä¼˜å…ˆé˜Ÿåˆ—æ’åºéœ€è¦O(log2k)</p><h3 id="3ã€æ–¹æ³•ä¸‰ï¼šå½’å¹¶æ’åºæ€æƒ³ã€æ¨èã€‘">3ã€æ–¹æ³•ä¸‰ï¼šå½’å¹¶æ’åºæ€æƒ³ã€æ¨èã€‘</h3><p>é¦–å…ˆéœ€è¦æ˜ç¡®ä¸¤ä¸ªæ¦‚å¿µã€‚</p><p>1ã€åŒæŒ‡é’ˆ</p><p>åŒæŒ‡é’ˆæŒ‡çš„æ˜¯åœ¨éå†å¯¹è±¡çš„è¿‡ç¨‹ä¸­ï¼Œä¸æ˜¯æ™®é€šçš„ä½¿ç”¨å•ä¸ªæŒ‡é’ˆè¿›è¡Œè®¿é—®ï¼Œè€Œæ˜¯ä½¿ç”¨ä¸¤ä¸ªæŒ‡é’ˆï¼ˆç‰¹æ®Šæƒ…å†µç”šè‡³å¯ä»¥å¤šä¸ªï¼‰ï¼Œä¸¤ä¸ªæŒ‡é’ˆæˆ–æ˜¯åŒæ–¹å‘è®¿é—®ä¸¤ä¸ªé“¾è¡¨ã€æˆ–æ˜¯åŒæ–¹å‘è®¿é—®ä¸€ä¸ªé“¾è¡¨ï¼ˆå¿«æ…¢æŒ‡é’ˆï¼‰ã€æˆ–æ˜¯ç›¸åæ–¹å‘æ‰«æï¼ˆå¯¹æ’æŒ‡é’ˆï¼‰ï¼Œä»è€Œè¾¾åˆ°æˆ‘ä»¬éœ€è¦çš„ç›®çš„ã€‚</p><p>2ã€åˆ†æ²»</p><p>åˆ†æ²»åˆ†æ²»ï¼Œåˆ†è€Œæ²»ä¹‹ã€‚â€œåˆ†â€æŒ‡çš„æ˜¯å°†ä¸€ä¸ªå¤§è€Œå¤æ‚çš„é—®é¢˜åˆ’åˆ†æˆå¤šä¸ªæ€§è´¨ç›¸åŒä½†æ˜¯è§„æ¨¡æ›´å°çš„å­é—®é¢˜ï¼Œå­é—®é¢˜ç»§ç»­æŒ‰ç…§è¿™æ ·åˆ’åˆ†ï¼Œç›´åˆ°é—®é¢˜å¯ä»¥è¢«è½»æ˜“è§£å†³ï¼›â€œæ²»â€æŒ‡çš„æ˜¯å°†å­é—®é¢˜å•ç‹¬è¿›è¡Œå¤„ç†ã€‚ç»è¿‡åˆ†æ²»åçš„å­é—®é¢˜ï¼Œéœ€è¦å°†è§£è¿›è¡Œåˆå¹¶æ‰èƒ½å¾—åˆ°åŸé—®é¢˜çš„è§£ï¼Œå› æ­¤æ•´ä¸ªåˆ†æ²»è¿‡ç¨‹ç»å¸¸ç”¨é€’å½’æ¥å®ç°ã€‚</p><p>å…¶å®è¿™é“é¢˜ä¹Ÿå¯ä»¥ä¸¤ä¸¤æ¯”è¾ƒï¼Œåªè¦éå†é“¾è¡¨æ•°ç»„ï¼Œå–å‡ºå¼€å¤´çš„ä¸¤ä¸ªé“¾è¡¨ï¼ŒæŒ‰ç…§ä¸Šè¿°æ€è·¯åˆå¹¶ï¼Œç„¶åæ–°é“¾è¡¨å†ä¸åä¸€ä¸ªç»§ç»­åˆå¹¶ï¼Œå¦‚æ­¤å¾ªç¯ï¼ŒçŸ¥é“å…¨éƒ¨åˆå¹¶å®Œæˆã€‚ä½†æ˜¯ï¼Œå¤ªæµªè´¹æ—¶é—´ã€‚</p><p>å¯ä¸å¯ä»¥ç›´æ¥å½’å¹¶çš„åˆ†æ²»æ¥åšï¼Œè€Œä¸æ˜¯é¡ºåºéå†åˆå¹¶é“¾è¡¨å‘¢ï¼Ÿå¯ä»¥ï¼</p><p>å½’å¹¶æ’åºç®€å•æ¥è¯´å°±æ˜¯å°†ä¸€ä¸ªæ•°ç»„æ¯æ¬¡åˆ’åˆ†æˆç­‰é•¿çš„ä¸¤éƒ¨åˆ†ï¼Œå¯¹ä¸¤éƒ¨åˆ†è¿›è¡Œæ’åºå³æ˜¯å­é—®é¢˜ã€‚å¯¹å­é—®é¢˜ç»§ç»­åˆ’åˆ†ï¼Œç›´åˆ°å­é—®é¢˜åªæœ‰1ä¸ªå…ƒç´ ã€‚è¿˜åŸçš„æ—¶å€™å‘¢ï¼Œå°†æ¯ä¸ªå­é—®é¢˜å’Œå®ƒç›¸é‚»çš„å¦ä¸€ä¸ªå­é—®é¢˜åˆ©ç”¨ä¸Šè¿°åŒæŒ‡é’ˆçš„æ–¹å¼ï¼Œ1ä¸ªä¸1ä¸ªåˆå¹¶æˆ2ä¸ªï¼Œ2ä¸ªä¸2ä¸ªåˆå¹¶æˆ4ä¸ªï¼Œå› ä¸ºè¿™æ¯ä¸ªå•ç‹¬çš„å­é—®é¢˜åˆå¹¶å¥½çš„éƒ½æ˜¯æœ‰åºçš„ï¼Œç›´åˆ°åˆå¹¶æˆåŸæœ¬é•¿åº¦çš„æ•°ç»„ã€‚</p><p>å¯¹äºè¿™kä¸ªé“¾è¡¨ï¼Œå°±ç›¸å½“äºä¸Šè¿°åˆå¹¶é˜¶æ®µçš„kä¸ªå­é—®é¢˜ï¼Œéœ€è¦åˆ’åˆ†ä¸ºé“¾è¡¨æ•°é‡æ›´å°‘çš„å­é—®é¢˜ï¼Œç›´åˆ°æ¯ä¸€ç»„åˆå¹¶æ—¶æ˜¯ä¸¤ä¸¤åˆå¹¶ï¼Œç„¶åç»§ç»­å¾€ä¸Šåˆå¹¶ï¼Œè¿™ä¸ªè¿‡ç¨‹åŸºäºé€’å½’ï¼š</p><ul><li><strong>ç»ˆæ­¢æ¡ä»¶ï¼š</strong> åˆ’åˆ†çš„æ—¶å€™ç›´åˆ°å·¦å³åŒºé—´ç›¸ç­‰æˆ–å·¦è¾¹å¤§äºå³è¾¹ã€‚</li><li><strong>è¿”å›å€¼ï¼š</strong> æ¯çº§è¿”å›å·²ç»åˆå¹¶å¥½çš„å­é—®é¢˜é“¾è¡¨ã€‚</li><li><strong>æœ¬çº§ä»»åŠ¡ï¼š</strong> å¯¹åŠåˆ’åˆ†ï¼Œå°†åˆ’åˆ†åçš„å­é—®é¢˜åˆå¹¶æˆæ–°çš„é“¾è¡¨ã€‚</li></ul><p>ç®€å•ç”»ä¸ªå›¾æ¥å¸®åŠ©ç†è§£ä¸€ä¸‹ï¼š</p><p><img src="/2022/09/21/lian-biao/image-20221027112036683.png" alt></p><p>è‹¥æ˜¯æœ‰äº”ä¸ªé“¾è¡¨éœ€è¦åˆå¹¶ï¼Œåˆ†æ²»å°±æ˜¯å³è¾¹çš„æƒ…å†µ</p><p>å…·ä½“ä»£ç å¦‚ä¸‹ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-comment">//ä¸¤ä¸ªé“¾è¡¨åˆå¹¶å‡½æ•°</span><br>   <span class="hljs-keyword">public</span> ListNode <span class="hljs-title function_">Merge</span><span class="hljs-params">(ListNode list1, ListNode list2)</span> &#123;<br>       <span class="hljs-comment">//ä¸€ä¸ªå·²ç»ä¸ºç©ºäº†ï¼Œç›´æ¥è¿”å›å¦ä¸€ä¸ª</span><br>       <span class="hljs-keyword">if</span>(list1 == <span class="hljs-literal">null</span>)<br>           <span class="hljs-keyword">return</span> list2;<br>       <span class="hljs-keyword">if</span>(list2 == <span class="hljs-literal">null</span>)<br>           <span class="hljs-keyword">return</span> list1;<br>       <span class="hljs-comment">//åŠ ä¸€ä¸ªè¡¨å¤´</span><br>       <span class="hljs-type">ListNode</span> <span class="hljs-variable">dummy</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">ListNode</span>(<span class="hljs-number">0</span>);<br>       <span class="hljs-type">ListNode</span> <span class="hljs-variable">cur</span> <span class="hljs-operator">=</span> dummy;<br>       <span class="hljs-comment">//ä¸¤ä¸ªé“¾è¡¨éƒ½è¦ä¸ä¸ºç©º</span><br>       <span class="hljs-keyword">while</span>(list1 != <span class="hljs-literal">null</span> &amp;&amp; list2 != <span class="hljs-literal">null</span>)&#123;<br>           <span class="hljs-comment">//å–è¾ƒå°å€¼çš„èŠ‚ç‚¹</span><br>           <span class="hljs-keyword">if</span>(list1.val &lt;= list2.val)&#123;<br>               cur.next = list1;<br>               <span class="hljs-comment">//åªç§»åŠ¨å–å€¼çš„æŒ‡é’ˆ</span><br>               list1 = list1.next;<br>           &#125;<span class="hljs-keyword">else</span>&#123;<br>               cur.next = list2;<br>               <span class="hljs-comment">//åªç§»åŠ¨å–å€¼çš„æŒ‡é’ˆ</span><br>               list2 = list2.next;<br>           &#125;<br>           <span class="hljs-comment">//æŒ‡é’ˆåç§»</span><br>           cur = cur.next;<br>       &#125;<br>       <span class="hljs-comment">//å“ªä¸ªé“¾è¡¨è¿˜æœ‰å‰©ï¼Œç›´æ¥è¿åœ¨åé¢</span><br>       <span class="hljs-keyword">if</span>(list1 != <span class="hljs-literal">null</span>)<br>           cur.next = list1;<br>       <span class="hljs-keyword">else</span><br>           cur.next = list2;<br>       <span class="hljs-comment">//è¿”å›å€¼å»æ‰è¡¨å¤´</span><br>       <span class="hljs-keyword">return</span> dummy.next;<br>   &#125;<br>    <br>   <span class="hljs-comment">//åˆ’åˆ†åˆå¹¶åŒºé—´å‡½æ•°</span><br>   ListNode <span class="hljs-title function_">divideMerge</span><span class="hljs-params">(ArrayList&lt;ListNode&gt; lists, <span class="hljs-type">int</span> left, <span class="hljs-type">int</span> right)</span>&#123;<br>       <span class="hljs-keyword">if</span>(left &gt; right)<br>           <span class="hljs-keyword">return</span> <span class="hljs-literal">null</span>;<br>       <span class="hljs-comment">//ä¸­é—´ä¸€ä¸ªçš„æƒ…å†µ</span><br>       <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span>(left == right)<br>           <span class="hljs-keyword">return</span> lists.get(left);<br>       <span class="hljs-comment">//ä»ä¸­é—´åˆ†æˆä¸¤æ®µï¼Œå†å°†åˆå¹¶å¥½çš„ä¸¤æ®µåˆå¹¶</span><br>       <span class="hljs-type">int</span> <span class="hljs-variable">mid</span> <span class="hljs-operator">=</span> (left + right) / <span class="hljs-number">2</span>;<br>       <span class="hljs-keyword">return</span> Merge(divideMerge(lists, left, mid), divideMerge(lists, mid + <span class="hljs-number">1</span>, right));<br>   &#125;<br>    <br>   <span class="hljs-keyword">public</span> ListNode <span class="hljs-title function_">mergeKLists</span><span class="hljs-params">(ArrayList&lt;ListNode&gt; lists)</span> &#123;<br>       <span class="hljs-comment">//kä¸ªé“¾è¡¨å½’å¹¶æ’åº</span><br>       <span class="hljs-keyword">return</span> divideMerge(lists, <span class="hljs-number">0</span>, lists.size() - <span class="hljs-number">1</span>);<br>   &#125;<br></code></pre></td></tr></table></figure><ul><li>æ—¶é—´å¤æ‚åº¦ï¼šO(nlog2k)</li><li>ç©ºé—´å¤æ‚åº¦ï¼šO(log2k)</li></ul><p>ä¸Šè¿°ä»£ç ä¸­çš„Merge()æ–¹æ³•ï¼Œå¯ä»¥ç›´æ¥ç”¨æ¥å¯¹ä¸¤ä¸ªæœ‰åºé“¾è¡¨è¿›è¡Œåˆå¹¶ã€‚</p>]]></content>
    
    
    <categories>
      
      <category>ç®—æ³•</category>
      
    </categories>
    
    
    <tags>
      
      <tag>java</tag>
      
      <tag>é“¾è¡¨</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>å¸¸è§æ¶æ„æ¨¡å¼</title>
    <link href="/2022/09/20/chang-jian-jia-gou-mo-shi/"/>
    <url>/2022/09/20/chang-jian-jia-gou-mo-shi/</url>
    
    <content type="html"><![CDATA[<p>æ‰«ç›²ï¼</p><p>å‡ ç§å¸¸è§çš„æ¶æ„æ¨¡å¼ï¼š<strong>Client-Serverã€Peer to Peerã€MVCã€Layeredã€Distribute-Clusterã€Micro-Serviceã€Even-Sourceã€Hexagonal</strong></p><p>å‡ ç§æ¶æ„æ¨¡å¼ï¼š</p><h3 id="1ã€Client-Server"><a href="#1ã€Client-Server" class="headerlink" title="1ã€Client-Server"></a>1ã€Client-Server</h3><p><img src="/2022/09/20/chang-jian-jia-gou-mo-shi/image-20220920190951638.png" alt="cs"></p><p>client-server æ¨¡å¼ä»¥è¯·æ±‚-å“åº”æ–¹å¼å·¥ä½œï¼Œå®¢æˆ·ç«¯å‘é€è¯·æ±‚ä¿¡æ¯ï¼ŒæœåŠ¡ç«¯æ¥å—è¯·æ±‚ï¼Œä½œå‡ºç›¸åº”å¤„ç†ï¼Œç„¶åå‘å›å“åº”ä¿¡æ¯ã€‚æ‰€æœ‰æˆ‘ä»¬è®¿é—®çš„äº’è”ç½‘ç½‘ç«™éƒ½æ˜¯è¿™ç§æ¶æ„ã€‚åœ¨æ¡Œé¢ç¨‹åºæµè¡Œçš„æ—¶ä»£ï¼Œäº’è”ç½‘è¿˜æ²¡æœ‰å½“å‰è¿™ä¹ˆå‘è¾¾çš„æ—¶ä»£ã€‚Client-Server è¿˜åªä»£è¡¨ Desktop Client-Server æ¨¡å¼ï¼Œä½¿ç”¨æµè§ˆå™¨çš„æ–¹å¼ç§°ä¹‹ä¸º B-S æ¨¡å¼ï¼Œå³ Browser-Server æ¨¡å¼ã€‚å¦‚ä»Š Browserã€Desktop Applicationã€Mobile Applicationã€Mobile Web ç­‰ç»Ÿç§°ä¸º Clientã€‚</p><h3 id="2ã€Peer-to-Peer"><a href="#2ã€Peer-to-Peer" class="headerlink" title="2ã€Peer to Peer"></a>2ã€Peer to Peer</h3><p><img src="/2022/09/20/chang-jian-jia-gou-mo-shi/image-20220920191053669.png" alt="p2p"></p><p>ç«¯å¯¹ç«¯æœåŠ¡æ¨¡å¼ï¼ˆPeer to Peerï¼Œç®€ç§° P2Pï¼‰ï¼Œäº¦ç§°ä¸ºâ€œç‚¹å¯¹ç‚¹æ¨¡å¼â€ï¼Œæ˜¯æŒ‡é€šè¿‡äº’è”ç½‘å°†ä¸ªäººä¸ä¸ªäººè¿æ¥èµ·æ¥ï¼Œç»•å¼€ä¸­å¿ƒå¹³å°è€Œç›´æ¥æä¾›æœåŠ¡ã€å®Œæˆäº¤æ˜“çš„æ¨¡å¼ã€‚P2P çš„æ—©æœŸå«æ„æ˜¯è®¡ç®—æœºé€šä¿¡é¢†åŸŸä¸­çš„â€œå¯¹ç­‰ç½‘ç»œåè®®â€ï¼Œå®ƒæ‰“ç ´äº†ä¼ ç»Ÿçš„ Client/Server(C/S)æ¨¡å¼ï¼Œä½¿å¾—æˆåƒä¸Šä¸‡å°å½¼æ­¤è¿æ¥çš„è®¡ç®—æœºéƒ½å¤„äºå¯¹ç­‰åœ°ä½ï¼Œç½‘ç»œçš„å‚ä¸è€…ç›´æ¥å…±äº«ä»–ä»¬æ‰€æ‹¥æœ‰çš„ä¸€éƒ¨åˆ†ç¡¬ä»¶èµ„æºï¼ˆåŒ…æ‹¬å¤„ç†èƒ½åŠ›ã€å­˜å‚¨èƒ½åŠ›ã€ç½‘ç»œè¿æ¥èƒ½åŠ›ã€æ‰“å°æœºç­‰ï¼‰ï¼Œè¿™äº›å…±äº«èµ„æºé€šè¿‡äº’è”ç½‘ï¼Œèƒ½è¢«å…¶å®ƒå¯¹ç­‰èŠ‚ç‚¹(Peer)ç›´æ¥è®¿é—®è€Œæ— éœ€ç»è¿‡ç»Ÿä¸€çš„ä¸­é—´ä½“ã€‚</p><p>P2P æ¨¡å¼æµè¡Œäºæ–‡ä»¶åˆ†äº«ä¸ä¸‹è½½ã€è®¡ç®—ä¸å­˜å‚¨ã€å³æ—¶é€šä¿¡å’ŒååŒå…±äº«ç­‰é¢†åŸŸã€‚</p><h3 id="3ã€MVC"><a href="#3ã€MVC" class="headerlink" title="3ã€MVC"></a>3ã€MVC</h3><p><img src="/2022/09/20/chang-jian-jia-gou-mo-shi/image-20220920191214418.png" alt="mvc"></p><p>Model-View-Controllerï¼ŒMVC æ¶æ„æ˜¯é¢å‘å¯¹è±¡ç¼–ç¨‹çš„ä¸€å¤§è¿›æ­¥ã€‚æœåŠ¡å°†é€»è¾‘åˆ’åˆ†ä¸ºä¸‰ä¸ªä¸åŒçš„ç»„å»ºï¼šModelâ€”â€”æ¨¡å‹ï¼Œå³æ•°æ®ï¼Œé€šå¸¸å­˜å‚¨åœ¨æ•°æ®åº“ä¸­ï¼Œåœ¨å†…å­˜ä¸­è¿›è¡Œé€»è¾‘æ“ä½œã€‚Viewâ€”â€”ç”¨æˆ·å¯è§çš„ç»„å»ºï¼Œç”¨äºç”¨æˆ·äº¤äº’å’Œæ•°æ®å±•ç¤ºï¼Œå¦‚ Web GUIã€‚Controllerâ€”â€”é€»è¾‘æ“ä½œï¼Œè¿æ¥ Model å’Œ View çš„ç»„ä»¶ï¼Œæ“ä½œ Model é€»è¾‘å’Œ View äº¤äº’å±•ç¤ºé€»è¾‘ã€‚</p><h3 id="4ã€Layered"><a href="#4ã€Layered" class="headerlink" title="4ã€Layered"></a>4ã€Layered</h3><p>è¯´èµ·åˆ†å±‚æ¶æ„ï¼Œæœ€è®©äººç†ŸçŸ¥çš„å°±æ˜¯ç»å…¸çš„ä¸‰å±‚æ¶æ„ã€‚ç»å…¸ä¸‰å±‚æ¶æ„è‡ªé¡¶å‘ä¸‹ç”±ç”¨æˆ·ç•Œé¢å±‚ï¼ˆUser Interface Layerï¼‰ã€ä¸šåŠ¡é€»è¾‘å±‚ï¼ˆBusiness Logic Layerï¼‰ä¸æ•°æ®è®¿é—®å±‚ï¼ˆData Access Layerï¼‰ç»„æˆã€‚ä¸‰å±‚æ¶æ„æ˜¯ç®€å• Client-Server æ¶æ„çš„å‡çº§ã€‚</p><p><img src="/2022/09/20/chang-jian-jia-gou-mo-shi/image-20220920191630251.png" alt="there layer"></p><h3 id="5ã€Distribute-Cluster"><a href="#5ã€Distribute-Cluster" class="headerlink" title="5ã€Distribute-Cluster"></a>5ã€Distribute-Cluster</h3><p>ä¹‹ä¸Šæ‰€æçš„æ¶æ„éƒ½æ˜¯åœ¨å•ä½“æ¶æ„ä¹‹ä¸‹ã€‚å•ä½“æ¶æ„å’Œå¤šæœåŠ¡æ¶æ„æ˜¯ä»æœåŠ¡çš„éƒ¨ç½²æ¨¡å¼ã€è¿è¡Œæ¨¡å¼æ¥è€ƒè™‘ã€‚</p><p>å•ä½“æ¶æ„æœ‰å¦‚ä¸‹ä¼˜åŠ¿ï¼š</p><ul><li>æ˜“äºå¼€å‘ï¼šå€ŸåŠ©äºå¼€å‘æ¡†æ¶ï¼Œå•ä½“åº”ç”¨çš„å¼€å‘åŠå…¶ç®€å•ï¼Œå¼€å‘äººå‘˜ä¹Ÿå¾ˆå°‘éœ€è¦è€ƒè™‘ç³»ç»Ÿã€éƒ¨ç½²ã€ç½‘ç»œç­‰å±‚æ¬¡çš„é—®é¢˜ã€‚</li><li>æ˜“äºæµ‹è¯•ï¼šå•ä½“åº”ç”¨éƒ¨ç½²åœ¨ä¸€ä¸ªè¿›ç¨‹ä¸­ï¼Œç¯å¢ƒç®€å•ã€‚åªè¦æœåŠ¡å¯åŠ¨å°±å¯ä»¥æµ‹è¯•æ‰€æœ‰çš„åŠŸèƒ½ã€‚</li><li>æ˜“äºéƒ¨ç½²ï¼šå¾€å¾€åªéœ€è¦å°†åº”ç”¨æ‰“åŒ…æˆä¸€ä¸ªç®€å•çš„åŒ…å°±å¯ã€‚</li><li>æ˜“äºæ°´å¹³æ‰©å±•ï¼šåªéœ€è¦å°†ç¨‹åºåŒ…éƒ¨ç½²å¤šä¸ªæœåŠ¡å³å¯ã€‚</li></ul><p>å•ä½“åº”ç”¨çš„åŠ£åŠ¿ï¼š</p><ul><li>ç»´æŠ¤æˆæœ¬å¢åŠ ï¼šéšç€éœ€æ±‚çš„å¢å¤šï¼Œå•ä½“ç³»ç»Ÿå°†è¶Šæ¥è¶Šè‡ƒè‚¿ï¼Œç»´æŠ¤çš„å¤æ‚æ€§ä¹Ÿå°†è¶Šæ¥è¶Šå¤§ã€‚</li><li>æŒç»­äº¤äº’å‘¨æœŸé•¿ï¼šä¸€æ–¹é¢ç»´æŠ¤å›°éš¾ï¼Œå¦ä¸€æ–¹é¢å•ä½“åº”ç”¨åœ¨å¹¶è¡Œå¼€å‘ï¼Œå¹¶è¡Œæµ‹è¯•ä¸Šå°†ååˆ†å›°éš¾ï¼Œå•ä½“åº”ç”¨ååˆ†ä¸é€‚åˆå¿«é€Ÿè¿­ä»£çš„æ•æ·å¼€å‘ã€‚</li><li>æ‰©å±•æ€§å·®ï¼šç”±äºè‡ƒè‚¿çš„ç³»ç»Ÿï¼Œå°†å¯¼è‡´ç³»ç»Ÿæ‰©å±•æ€§å˜éš¾ã€‚ç³»ç»Ÿçš„å‡çº§ä¹Ÿéœ€è¦ååˆ†è°¨æ…ã€‚</li><li>å¯¹æ–°äººä¸å‹å¥½ã€‚</li></ul><p>åˆ†å¸ƒå¼ç³»ç»Ÿæ‹†åˆ†ï¼š</p><p><img src="/2022/09/20/chang-jian-jia-gou-mo-shi/image-20220920191745648.png" alt="service scale"></p><h3 id="6ã€Micro-Service"><a href="#6ã€Micro-Service" class="headerlink" title="6ã€Micro-Service"></a>6ã€Micro-Service</h3><p>å¾®æœåŠ¡æ¶æ„æ˜¯ä¸€ç§æ¶æ„æ¨¡å¼ï¼Œå®ƒæå€¡å°†å•ä¸€åº”ç”¨ç¨‹åºåˆ’åˆ†æˆä¸€ç»„å°çš„æœåŠ¡ï¼ŒæœåŠ¡ä¹‹é—´ç›¸äº’åè°ƒã€ç›¸äº’é…åˆï¼Œä¸ºç”¨æˆ·æä¾›æœ€ç»ˆä»·å€¼ã€‚æ¯ä¸ªæœåŠ¡è¿è¡Œåœ¨å…¶ç‹¬ç«‹çš„è¿›ç¨‹ä¸­ï¼ŒæœåŠ¡ä¸æœåŠ¡é—´é‡‡ç”¨è½»é‡çº§çš„é€šä¿¡æœºåˆ¶äº’ç›¸æ²Ÿé€šï¼ˆé€šå¸¸åŸºäº HTTP çš„ RESTful APIï¼‰ã€‚æ¯ä¸ªæœåŠ¡éƒ½å›´ç»•ç€å…·ä½“ä¸šåŠ¡è¿›è¡Œæ„å»ºï¼Œå¹¶ä¸”èƒ½å¤Ÿè¢«ç‹¬ç«‹åœ°éƒ¨ç½²åˆ°ç”Ÿäº§ç¯å¢ƒã€‚</p><p>Spring Cloud æŠ€æœ¯æ ˆ:</p><ul><li>SpringBootï¼šå•ä½“æœåŠ¡ï¼Œå¿«é€Ÿåˆ›å»ºé¡¹ç›®ï¼Œå¿«é€Ÿé›†æˆå„ç§æ¡†æ¶ï¼Œæ˜“äºæµ‹è¯•ï¼Œæ˜“äºéƒ¨ç½²ã€‚</li><li>Feignï¼šå¾®æœåŠ¡ç‹¬ç«‹éƒ¨ç½²ï¼Œé€šè¿‡ç›¸å…³åè®®é€šä¿¡ã€‚Feign å°±æ˜¯ä¸€ä¸ªç®€å•çš„ç”³æ˜å¼é€šä¿¡æ¡†æ¶ï¼ŒåŸºäº HTTP restfulã€‚</li><li>Eurekaï¼šç‹¬ç«‹æœåŠ¡è¶Šæ¥è¶Šå¤šï¼ŒæœåŠ¡å®ä¾‹ä¹Ÿè¶Šæ¥è¶Šå¤šã€‚æœåŠ¡æ²»ç†ä¾¿æ˜¯å¿…é¡»çš„ï¼ŒEureka æä¾›é«˜å¯ç”¨çš„æœåŠ¡æ³¨å†Œå’ŒæœåŠ¡å‘ç°åŠŸèƒ½ã€‚</li><li>Ribbonï¼šFeign åªè´Ÿè´£é€šä¿¡ï¼ŒRibbon æä¾›å®¢æˆ·ç«¯è´Ÿè½½å‡è¡¡ï¼Œæ˜¯ç³»ç»Ÿä¼˜åŒ–çš„éƒ¨åˆ†ã€‚</li><li>Hystrixï¼šå¾®æœåŠ¡å°†å¸¦æ¥æœåŠ¡é—´å¤æ‚çš„ä¾èµ–å…³ç³»ï¼Œåˆ†å¸ƒå¼å’Œé›†ç¾¤çš„å¤æ‚åº¦ä¹Ÿå°†å¸¦æ¥è®¸å¤šéš¾ä»¥é¢„æ–™çš„é—®é¢˜ã€‚ä¸ºé˜²æ­¢å¤æ‚ç½‘ç»œå’Œå¤æ‚ç³»ç»ŸæŸä¸€ç‚¹çš„é—®é¢˜å¯¼è‡´æ•´ä¸ªç³»ç»Ÿçš„é›ªå´©çŠ¶æ€ï¼Œä¾¿æœ‰äº† Hystrixï¼ŒHystrix æ˜¯ Spring Cloud ä½“ç³»ä¸­ä¼˜ç§€çš„æ–­è·¯å™¨ï¼Œå¯ä»¥åœ¨ç³»ç»Ÿå‘ç”Ÿé—®é¢˜æ—¶è¿›è¡ŒæœåŠ¡é™çº§ï¼Œé˜²æ­¢æ•´ä½“ç³»ç»Ÿå´©æºƒã€‚</li><li>Zuulï¼šç»Ÿä¸€ç½‘å…³ï¼Œç»Ÿä¸€ç½‘å…³æ˜¯ä»¥ Facade æ¨¡å¼ï¼Œå¯¹å¤–æä¾›å‹å¥½çš„æ¥å£ï¼Œå¾®æœåŠ¡åŒ–ä¹‹åï¼ŒæœåŠ¡å°†è¶Šæ¥è¶Šå¤šï¼Œè¶Šæ¥è¶Šå¤æ‚ï¼Œä¸ºäº†é™ä½å¤–éƒ¨ç³»ç»Ÿè°ƒç”¨çš„å¤æ‚åº¦ï¼Œç»Ÿä¸€ç½‘å…³å°±æ˜¯å¸¸ç”¨è§£å†³æ–¹æ¡ˆã€‚</li><li>Configï¼šæœåŠ¡åˆ’åˆ†è¶Šå¤šï¼Œé…ç½®å°†è¶Šå¤šï¼ŒSpring cloud config æä¾›ç»Ÿä¸€çš„é…ç½®ç®¡ç†ã€‚</li><li>Sleuthï¼šæœåŠ¡ç›‘æ§å’Œæ²»ç†ã€‚ç›‘æ§æ˜¯å¤æ‚ç³»ç»Ÿå¿…éœ€çš„åŸºç¡€è®¾æ–½ã€‚ç³»ç»Ÿæ„ŸçŸ¥ã€é—®é¢˜å‘ç°ã€æ€§èƒ½å®šä½éƒ½éœ€è¦ç›‘æ§çš„åŠ æŒã€‚</li></ul><p><img src="/2022/09/20/chang-jian-jia-gou-mo-shi/image-20220920191927004.png" alt="micro service"></p><h3 id="7ã€Even-Source"><a href="#7ã€Even-Source" class="headerlink" title="7ã€Even-Source"></a>7ã€Even-Source</h3><p>äº‹ä»¶æº¯æºæ˜¯æœ€æ–°æµè¡Œä¸€ç§åº”ç”¨ç¨‹åºä½“ç³»ç»“æ„æ¨¡å¼ã€‚äº‹ä»¶æºå°†åº”ç”¨ç¨‹åºè¿›è¡Œçš„çŠ¶æ€æ›´æ”¹å»ºæ¨¡ä¸ºäº‹ä»¶çš„ä¸å¯å˜åºåˆ—æˆ–â€œæ—¥å¿—â€ã€‚äº‹ä»¶æºä¸æ˜¯åœ¨ç°åœºä¿®æ”¹åº”ç”¨ç¨‹åºçš„çŠ¶æ€ï¼Œè€Œæ˜¯å°†è§¦å‘çŠ¶æ€æ›´æ”¹çš„äº‹ä»¶å­˜å‚¨åœ¨ä¸å¯å˜çš„æ—¥å¿—ä¸­ï¼Œå¹¶å°†çŠ¶æ€æ›´æ”¹å»ºæ¨¡ä¸ºå¯¹æ—¥å¿—ä¸­äº‹ä»¶çš„å“åº”ã€‚</p><p><img src="/2022/09/20/chang-jian-jia-gou-mo-shi/image-20221021153056824.png"></p><p>CQRS æ¨¡å¼é€šå¸¸åŸºäº‹ä»¶æº¯æºæ¨¡å¼ã€‚åœ¨ä¼ ç»Ÿçš„ä½“ç³»ç»“æ„ä¸­ï¼Œä½¿ç”¨åŒä¸€æ•°æ®æ¨¡å‹æŸ¥è¯¢å’Œæ›´æ–°æ•°æ®åº“ã€‚è¿™ååˆ†ç®€å•ï¼Œéå¸¸é€‚ç”¨äºåŸºæœ¬çš„ CRUD æ“ä½œã€‚ä½†æ˜¯ï¼Œåœ¨æ›´å¤æ‚çš„åº”ç”¨ç¨‹åºä¸­ï¼Œæ­¤æ–¹æ³•ä¼šå˜å¾—éš¾ä»¥æ“ä½œã€‚ä¾‹å¦‚ï¼Œåœ¨è¯»å–æ–¹é¢ï¼Œåº”ç”¨ç¨‹åºå¯èƒ½æ‰§è¡Œå¤§é‡ä¸åŒçš„æŸ¥è¯¢ï¼Œè¿”å›å…·æœ‰ä¸åŒå½¢çŠ¶çš„æ•°æ®ä¼ è¾“å¯¹è±¡ (DTO)ã€‚å¯¹è±¡æ˜ å°„å¯èƒ½ä¼šå˜å¾—å¤æ‚ã€‚åœ¨å†™å…¥æ–¹é¢ï¼Œæ¨¡å‹å¯èƒ½å®æ–½å¤æ‚éªŒè¯å’Œä¸šåŠ¡é€»è¾‘ã€‚ç»“æœï¼Œæ¨¡å‹æ‰§è¡Œå¤ªå¤šæ“ä½œï¼Œè¿‡åº¦å¤æ‚ã€‚</p><p>CQRSï¼ˆå‘½ä»¤æŸ¥è¯¢çš„è´£ä»»åˆ†ç¦» Command Query Responsibility Segregation ï¼‰å°†è¯»å–å’Œå†™å…¥æ“ä½œåˆ†æˆä¸åŒçš„æ¨¡å‹ï¼Œä½¿ç”¨ <strong>å‘½ä»¤</strong> æ›´æ–°æ•°æ®ï¼Œå¹¶ä½¿ç”¨ <strong>æŸ¥è¯¢</strong> æ¥è¯»å–æ•°æ®ã€‚</p><h3 id="8ã€Hexagonal"><a href="#8ã€Hexagonal" class="headerlink" title="8ã€Hexagonal"></a>8ã€Hexagonal</h3><p><img src="/2022/09/20/chang-jian-jia-gou-mo-shi/image-20221021153305168.png"></p><p>å…­è¾¹å½¢æ¶æ„åˆç§°â€œç«¯å£å’Œé€‚é…å™¨æ¨¡å¼â€ï¼Œæ˜¯ Alistair Cockburn æå‡ºçš„ä¸€ç§å…·æœ‰å¯¹ç§°æ€§ç‰¹å¾çš„æ¶æ„é£æ ¼ã€‚åœ¨è¿™ç§æ¶æ„ä¸­ï¼Œç³»ç»Ÿé€šè¿‡é€‚é…å™¨çš„æ–¹å¼ä¸å¤–éƒ¨äº¤äº’ï¼Œå°†åº”ç”¨æœåŠ¡ä¸é¢†åŸŸæœåŠ¡å°è£…åœ¨ç³»ç»Ÿå†…éƒ¨ã€‚</p><p>å…­è¾¹å½¢æ¶æ„ç”±ä»¥ä¸‹ä¸‰ä¸ªç»„ä»¶ç»„æˆï¼š</p><ul><li>Portsï¼šåˆå¯ä»¥åˆ†ä¸ºè¾“å…¥ç«¯å’Œè¾“å‡ºç«¯ï¼Œæ˜¯ç³»ç»Ÿä¸å…¶ä»–ç³»ç»Ÿäº¤äº’çš„æ¥å£ã€‚</li><li>Adaptersï¼šä¸å…¶ä»–ç³»ç»Ÿçš„é€‚é…å±‚ï¼Œä¸€æ–¹é¢é˜²æ­¢æ ¸å¿ƒç³»ç»Ÿå’Œé¢†åŸŸè¢«å¤–éƒ¨å½±å“ï¼Œå³é˜²è…;å¦ä¸€æ–¹é¢æ–¹ä¾¿ api ä½¿ç”¨ã€‚</li><li>Domainï¼šåº”ç”¨å’Œæ¨¡å‹æ˜¯ç¨‹åºçš„æ ¸å¿ƒã€‚</li></ul><p>å…­è¾¹å½¢æ¶æ„çš„æ ¸å¿ƒç†å¿µæ˜¯ï¼šåº”ç”¨é€šè¿‡â€ç«¯å£â€è·Ÿå¤–éƒ¨è¿›è¡Œäº¤äº’ã€‚åœ¨ä¼ ç»Ÿçš„åˆ†å±‚æ¶æ„ä¸­å¾ˆå®¹æ˜“è·¨è¶Šå±‚é—´çš„è¾¹ç•Œï¼ŒæŠŠä¸šåŠ¡é€»è¾‘æ¸—é€åˆ°å…¶å®ƒå±‚ä¸­å»ã€‚å…­è¾¹å½¢æ¶æ„é‡è¦çš„å°±æ˜¯â€œè¾¹ç•Œâ€å’Œâ€œé¢†åŸŸâ€ã€‚å…­è¾¹å½¢æ¶æ„çš„åˆè¡·æ˜¯ä¸ºäº†è§£å†³æŠ€æœ¯ä¸ä¸šåŠ¡ç³»ç»Ÿçš„è§£è€¦åˆé—®é¢˜ï¼Œä»¥åŠæŠ€æœ¯ä¸æŠ€æœ¯é—´çš„è§£è€¦åˆé—®é¢˜ï¼Œè¿™ä¸€æ¶æ„ä»è®¾è®¡æ¨¡å¼ä¸­æ¥ï¼Œä»ä¸šåŠ¡çš„å®ä½“æœåŠ¡å‡ºå‘ï¼Œå°†é¢å‘æ¥å£çš„è®¾è®¡å…·ä½“åŒ–çš„ç«¯å£åè®®å’Œé€‚é…å™¨å®ç°ï¼ŒæœåŠ¡è‡ªèº«å®ç°ç‹¬ç«‹æ€§å’Œå®Œå¤‡æ€§ã€‚</p><p>å‚è€ƒï¼š<a href="https://mp.weixin.qq.com/s/NJFJ5UrzGk0cMGL1oZe0Bg">æ‰«ä¸ªç›²å…ˆï¼Ÿå¹ä¸€å¹ä¼ä¸šå¸¸ç”¨çš„è½¯ä»¶æ¶æ„ï¼</a></p>]]></content>
    
    
    <categories>
      
      <category>åç«¯</category>
      
    </categories>
    
    
    <tags>
      
      <tag>å¾®æœåŠ¡</tag>
      
      <tag>æ¶æ„</tag>
      
      <tag>åˆ†å¸ƒå¼/å¾®æœåŠ¡</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Second Test</title>
    <link href="/2022/09/20/second-test/"/>
    <url>/2022/09/20/second-test/</url>
    
    <content type="html"><![CDATA[<p>ç¬¬äºŒæ¬¡æµ‹è¯•</p><p>æ‰˜æ‹‰æ‹½ï¼š</p><p><img src="/2022/09/20/second-test/image-20220920171706059.png" alt="ä¸æ„§æ˜¯æˆ‘"></p>]]></content>
    
    
    <categories>
      
      <category>æµ‹è¯•</category>
      
    </categories>
    
    
    <tags>
      
      <tag>æµ‹è¯•</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Test</title>
    <link href="/2022/09/20/test/"/>
    <url>/2022/09/20/test/</url>
    
    <content type="html"><![CDATA[<p><img src="/2022/09/20/test/%E5%90%89%E4%BB%964.jpg" alt="å›¾ç‰‡æµ‹è¯•"></p>]]></content>
    
    
    <categories>
      
      <category>æµ‹è¯•</category>
      
    </categories>
    
    
    <tags>
      
      <tag>æµ‹è¯•</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Dockerå­¦ä¹ ç¬”è®°</title>
    <link href="/2022/09/19/docker-xue-xi/"/>
    <url>/2022/09/19/docker-xue-xi/</url>
    
    <content type="html"><![CDATA[<h2 id="ä¸€ã€ä¸ºä½•è¦ç”¨Docker"><a href="#ä¸€ã€ä¸ºä½•è¦ç”¨Docker" class="headerlink" title="ä¸€ã€ä¸ºä½•è¦ç”¨Docker?"></a>ä¸€ã€ä¸ºä½•è¦ç”¨Docker?</h2><h3 id="1ã€ä»€ä¹ˆæ˜¯Docker"><a href="#1ã€ä»€ä¹ˆæ˜¯Docker" class="headerlink" title="1ã€ä»€ä¹ˆæ˜¯Docker?"></a>1ã€ä»€ä¹ˆæ˜¯Docker?</h3><p>Docker ä½¿ç”¨ Google å…¬å¸æ¨å‡ºçš„ Go è¯­è¨€  è¿›è¡Œå¼€å‘å®ç°ï¼ŒåŸºäº Linux å†…æ ¸ çš„cgroupï¼Œnamespaceï¼Œä»¥åŠ AUFS ç±»çš„ UnionFS ç­‰æŠ€æœ¯ï¼Œå¯¹è¿›ç¨‹è¿›è¡Œå°è£…éš”ç¦»ï¼Œå±äºæ“ä½œç³»ç»Ÿå±‚é¢çš„è™šæ‹ŸåŒ–æŠ€æœ¯ã€‚ ç”±äºéš”ç¦»çš„è¿›ç¨‹ç‹¬ç«‹äºå®¿ä¸»å’Œå…¶å®ƒçš„éš”ç¦»çš„è¿› ç¨‹ï¼Œå› æ­¤ä¹Ÿç§°å…¶ä¸ºå®¹å™¨ã€‚Docker æœ€åˆå®ç°æ˜¯åŸºäº LXC.</p><p>Docker èƒ½å¤Ÿè‡ªåŠ¨æ‰§è¡Œé‡å¤æ€§ä»»åŠ¡ï¼Œä¾‹å¦‚æ­å»ºå’Œé…ç½®å¼€å‘ç¯å¢ƒï¼Œä»è€Œè§£æ”¾äº†å¼€å‘äººå‘˜ä»¥ä¾¿ä»–ä»¬ä¸“æ³¨åœ¨çœŸæ­£é‡è¦çš„äº‹æƒ…ä¸Šï¼Œæ„å»ºæ°å‡ºçš„è½¯ä»¶ã€‚</p><p>ç”¨æˆ·å¯ä»¥æ–¹ä¾¿åœ°åˆ›å»ºå’Œä½¿ç”¨å®¹å™¨ï¼ŒæŠŠè‡ªå·±çš„åº”ç”¨æ”¾å…¥å®¹å™¨ã€‚å®¹å™¨è¿˜å¯ä»¥è¿›è¡Œç‰ˆæœ¬ç®¡ç†ã€å¤åˆ¶ã€åˆ†äº«ã€ä¿®æ”¹ï¼Œå°±åƒç®¡ç†æ™®é€šçš„ä»£ç ä¸€æ ·ã€‚</p><h3 id="2ã€Dockerçš„ä¼˜ç‚¹ï¼š"><a href="#2ã€Dockerçš„ä¼˜ç‚¹ï¼š" class="headerlink" title="2ã€Dockerçš„ä¼˜ç‚¹ï¼š"></a>2ã€Dockerçš„ä¼˜ç‚¹ï¼š</h3><ul><li><p>ç¯å¢ƒéš”ç¦»(â€˜<strong>éš”ç¦»ï¼Œå®‰å…¨</strong>â€˜)</p><p>Docker å®ç°äº†èµ„æºéš”ç¦»ï¼Œä¸€å°æœºå™¨è¿è¡Œå¤šä¸ªå®¹å™¨äº’æ— å½±å“ã€‚</p></li><li><p>æ›´é«˜æ•ˆçš„èµ„æºåˆ©ç”¨(<strong>èŠ‚çº¦æˆæœ¬</strong>)</p><p>Docker å®¹å™¨çš„è¿è¡Œä¸éœ€è¦é¢å¤–çš„è™šæ‹ŸåŒ–ç®¡ç†ç¨‹åºçš„æ”¯æŒï¼Œå®ƒæ˜¯å†…æ ¸çº§çš„è™šæ‹ŸåŒ–ï¼Œå¯ä»¥å®ç°æ›´é«˜çš„æ€§èƒ½ï¼ŒåŒæ—¶å¯¹èµ„æºçš„é¢å¤–éœ€æ±‚å¾ˆä½ã€‚</p></li><li><p>æ›´å¿«é€Ÿçš„äº¤ä»˜éƒ¨ç½²(<strong>æ•æ·</strong>)</p><p>ä½¿ç”¨ Dockerï¼Œå¼€å‘äººå‘˜å¯ä»¥åˆ©ç”¨é•œåƒå¿«é€Ÿæ„å»ºä¸€å¥—æ ‡å‡†çš„ç ”å‘ç¯å¢ƒï¼Œå¼€å‘å®Œæˆåï¼Œæµ‹è¯•å’Œè¿ç»´äººå‘˜å¯ä»¥ç›´æ¥é€šè¿‡ä½¿ç”¨ç›¸åŒçš„ç¯å¢ƒæ¥éƒ¨ç½²ä»£ç ã€‚</p></li><li><p>æ›´æ˜“è¿ç§»æ‰©å±•(<strong>å¯ç§»æ¤æ€§</strong>)</p><p>Docker å®¹å™¨å‡ ä¹å¯ä»¥åœ¨ä»»æ„çš„å¹³å°ä¸Šè¿è¡Œï¼ŒåŒ…æ‹¬è™šæ‹Ÿæœºã€å…¬æœ‰äº‘ã€ç§æœ‰äº‘ã€ä¸ªäººç”µè„‘ã€æœåŠ¡å™¨ç­‰ï¼Œè¿™ç§å…¼å®¹æ€§è®©ç”¨æˆ·å¯ä»¥åœ¨ä¸åŒå¹³å°ä¹‹é—´è½»æ¾çš„è¿ç§»åº”ç”¨ã€‚</p></li><li><p>æ›´ç®€å•çš„æ›´æ–°ç®¡ç†(<strong>é«˜æ•ˆ</strong>)</p><p>ä½¿ç”¨ Dockerfileï¼Œåªéœ€è¦å¾ˆå°‘çš„é…ç½®ä¿®æ”¹ï¼Œå°±å¯ä»¥æ›¿ä»£ä»¥å¾€å¤§é‡çš„æ›´æ–°å·¥ä½œã€‚å¹¶ä¸”æ‰€æœ‰ä¿®æ”¹éƒ½æ˜¯ä»¥å¢é‡çš„æ–¹å¼è¿›è¡Œåˆ†å‘å’Œæ›´æ–°ï¼Œä»è€Œå®ç°è‡ªåŠ¨åŒ–å’Œé«˜æ•ˆçš„å®¹å™¨ç®¡ç†ã€‚</p></li></ul><h3 id="3ã€Docker-çš„åŸºæœ¬ç»„æˆæ¶æ„"><a href="#3ã€Docker-çš„åŸºæœ¬ç»„æˆæ¶æ„" class="headerlink" title="3ã€Docker çš„åŸºæœ¬ç»„æˆæ¶æ„"></a>3ã€Docker çš„åŸºæœ¬ç»„æˆæ¶æ„</h3><p>å…·ä½“å‚è€ƒ<a href="https://juejin.cn/post/6844904035053486087#heading-2">Dockeræ­å»ºä½ çš„ç¬¬ä¸€ä¸ª Node é¡¹ç›®åˆ°æœåŠ¡å™¨(å®Œæ•´ç‰ˆ)</a></p><h4 id="Registry"><a href="#Registry" class="headerlink" title="Registry"></a>Registry</h4><p>é•œåƒä»“åº“ï¼Œå­˜å‚¨å¤§é‡é•œåƒï¼Œå¯ä»¥ä»é•œåƒä»“åº“æ‹‰å–å’Œæ¨é€é•œåƒã€‚</p><h4 id="Docker-é•œåƒ"><a href="#Docker-é•œåƒ" class="headerlink" title="Docker é•œåƒ"></a>Docker é•œåƒ</h4><p>ç±»ä¼¼è™šæ‹Ÿæœºå¿«ç…§ï¼Œä»ä»“åº“æ‹‰å–ï¼Œæˆ–è€…åœ¨ç°æœ‰å·¥å…·é•œåƒä¸Šåˆ›å»ºæ–°é•œåƒã€‚é€šè¿‡é•œåƒå¯ä»¥å¯åŠ¨å®¹å™¨ã€‚</p><h4 id="Docker-å®¹å™¨"><a href="#Docker-å®¹å™¨" class="headerlink" title="Docker å®¹å™¨"></a>Docker å®¹å™¨</h4><p>ä»é•œåƒä¸­åˆ›å»ºåº”ç”¨ç¯å¢ƒï¼Œä»¥å•è¿›ç¨‹çš„æ–¹å¼è¿è¡Œã€‚å¯¹å¤–å…¬å¼€æœåŠ¡ã€‚æ˜¯ä¸€ç§çŸ­æš‚çš„å’Œä¸€æ¬¡æ€§çš„ç¯å¢ƒã€‚</p><h4 id="Docker-æ•°æ®å·"><a href="#Docker-æ•°æ®å·" class="headerlink" title="Docker æ•°æ®å·"></a>Docker æ•°æ®å·</h4><p>æ•°æ®å·å¯ä»¥å®Œæˆæ•°æ®æŒä¹…åŒ–ï¼Œæ•°æ®å·æ˜¯ä¸€ä¸ªå¯ä¾›ä¸€ä¸ªæˆ–å¤šä¸ªå®¹å™¨ä½¿ç”¨çš„ç‰¹æ®Šç›®å½•ï¼Œå®ƒç»•è¿‡ UFSï¼Œå¯ä»¥æä¾›å¾ˆå¤šæœ‰ç”¨çš„ç‰¹æ€§ï¼š</p><ul><li>æ•°æ®å·å¯ä»¥åœ¨å®¹å™¨ä¹‹é—´å…±äº«å’Œé‡ç”¨</li><li>å¯¹æ•°æ®å·çš„ä¿®æ”¹ä¼šç«‹é©¬ç”Ÿæ•ˆ</li><li>å¯¹æ•°æ®å·çš„æ›´æ–°ï¼Œä¸ä¼šå½±å“é•œåƒ</li><li>å·ä¼šä¸€ç›´å­˜åœ¨ï¼Œç›´åˆ°æ²¡æœ‰å®¹å™¨ä½¿ç”¨</li></ul><h4 id="Docker-ç½‘ç»œ"><a href="#Docker-ç½‘ç»œ" class="headerlink" title="Docker ç½‘ç»œ"></a>Docker ç½‘ç»œ</h4><p>Docker å®¹å™¨ä¹‹é—´çš„ç½‘ç»œäº¤äº’ï¼Œå¯ä»¥ä½¿ç”¨<code>ç«¯å£æ˜ å°„</code>çš„æ–¹å¼ï¼Œå…¶ä»–å®¹å™¨å¯ä»¥ç›´æ¥é€šè¿‡ç«¯å£å®ç°ã€‚é™¤è¯¥æ–¹å¼å¤–è¿˜æœ‰ä¸€ä¸ª<code>å®¹å™¨è¿æ¥ï¼ˆlinkingï¼‰ç³»ç»Ÿ</code>ä¹Ÿå¯ä»¥è¾¾åˆ°å®¹å™¨äº¤äº’ã€‚ï¼ˆæœ¬æ–‡ä¸­ node è¿æ¥ mongodb ä½¿ç”¨çš„æ˜¯ç«¯å£æ˜ å°„çš„æ–¹å¼ï¼‰</p><p>å…³äºDocker ç½‘ç»œæ¨¡å—ï¼Œå®¹å™¨è¿æ¥è¯¦æƒ…æ¨èè¿™ç¯‡æ–‡ç« : <a href="https://juejin.cn/post/6844903756920782855">Dockerçš„ç½‘ç»œæ¨¡å¼è¯¦è§£</a></p><h3 id="4ã€Dockerçš„å¸¸ç”¨å‘½ä»¤ï¼ˆå¸¸ç”¨ï¼‰"><a href="#4ã€Dockerçš„å¸¸ç”¨å‘½ä»¤ï¼ˆå¸¸ç”¨ï¼‰" class="headerlink" title="4ã€Dockerçš„å¸¸ç”¨å‘½ä»¤ï¼ˆå¸¸ç”¨ï¼‰"></a>4ã€Dockerçš„å¸¸ç”¨å‘½ä»¤ï¼ˆå¸¸ç”¨ï¼‰</h3><h4 id="é•œåƒå¸¸ç”¨å‘½ä»¤"><a href="#é•œåƒå¸¸ç”¨å‘½ä»¤" class="headerlink" title="é•œåƒå¸¸ç”¨å‘½ä»¤"></a>é•œåƒå¸¸ç”¨å‘½ä»¤</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs bash">docker pull [é•œåƒåç§°:ç‰ˆæœ¬] æ‹‰å–é•œåƒ<br>docker images  é•œåƒåˆ—è¡¨<br>docker rmi [é•œåƒåç§°:ç‰ˆæœ¬] åˆ é™¤é•œåƒ<br>docker <span class="hljs-built_in">history</span> [é•œåƒåç§°] é•œåƒæ“ä½œè®°å½•<br>docker tag [é•œåƒåç§°:ç‰ˆæœ¬][æ–°é•œåƒåç§°:æ–°ç‰ˆæœ¬]<br>docker inspect [é•œåƒåç§°:ç‰ˆæœ¬] æŸ¥çœ‹é•œåƒè¯¦ç»†<br>docker search [å…³é”®å­—] æœç´¢é•œåƒ<br>docker login é•œåƒç™»é™†<br></code></pre></td></tr></table></figure><h4 id="å®¹å™¨å¸¸ç”¨å‘½ä»¤"><a href="#å®¹å™¨å¸¸ç”¨å‘½ä»¤" class="headerlink" title="å®¹å™¨å¸¸ç”¨å‘½ä»¤"></a>å®¹å™¨å¸¸ç”¨å‘½ä»¤</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs bash">docker ps -a å®¹å™¨åˆ—è¡¨(æ‰€æœ‰å®¹å™¨)<br>docker ps  æŸ¥çœ‹æ‰€æœ‰(è¿è¡Œçš„)å®¹å™¨<br>docker <span class="hljs-built_in">exec</span> -ti &lt;<span class="hljs-built_in">id</span>&gt; bash  ä»¥ bash å‘½ä»¤è¿›å…¥å®¹å™¨å†…<br>docker run -ti --name [å®¹å™¨åç§°][é•œåƒåç§°:ç‰ˆæœ¬] bash å¯åŠ¨å®¹å™¨å¹¶è¿›å…¥<br>docker logs æŸ¥çœ‹å®¹å™¨æ—¥å¿—<br>docker top &lt;container_id&gt; æŸ¥çœ‹å®¹å™¨æœ€è¿‘çš„ä¸€ä¸ªè¿›ç¨‹<br>docker run -ti --name [å®¹å™¨åç§°] -p 8080:80 [é•œåƒåç§°:ç‰ˆæœ¬] bash  ç«¯å£æ˜ å°„<br>docker <span class="hljs-built_in">rm</span> &lt;container_id&gt; åˆ é™¤å®¹å™¨<br>docker stop &lt;container_id&gt; åœæ­¢å®¹å™¨<br>docker start &lt;container_id&gt; å¼€å¯å®¹å™¨<br>docker restart &lt;container_id&gt; é‡å¯å®¹å™¨<br>docker inspect &lt;container_id&gt; æŸ¥çœ‹å®¹å™¨è¯¦æƒ…<br>docker commit [å®¹å™¨åç§°] my_image:v1.0  å®¹å™¨æäº¤ä¸ºæ–°çš„é•œåƒ<br></code></pre></td></tr></table></figure><h4 id="DockerFileå¸¸ç”¨å‘½ä»¤"><a href="#DockerFileå¸¸ç”¨å‘½ä»¤" class="headerlink" title="DockerFileå¸¸ç”¨å‘½ä»¤"></a>DockerFileå¸¸ç”¨å‘½ä»¤</h4><p>è§ç¬¬å…­èŠ‚</p><h2 id="äºŒã€CentOs-7-ä¸ŠDockerå®‰è£…éƒ¨ç½²"><a href="#äºŒã€CentOs-7-ä¸ŠDockerå®‰è£…éƒ¨ç½²" class="headerlink" title="äºŒã€CentOs 7 ä¸ŠDockerå®‰è£…éƒ¨ç½²"></a>äºŒã€CentOs 7 ä¸ŠDockerå®‰è£…éƒ¨ç½²</h2><h3 id="1ã€è‹¥æ˜¯ä»¥å‰å®‰è£…è¿‡dockerï¼Œå…ˆæ‰§è¡Œä»¥ä¸‹æ­¥éª¤"><a href="#1ã€è‹¥æ˜¯ä»¥å‰å®‰è£…è¿‡dockerï¼Œå…ˆæ‰§è¡Œä»¥ä¸‹æ­¥éª¤" class="headerlink" title="1ã€è‹¥æ˜¯ä»¥å‰å®‰è£…è¿‡dockerï¼Œå…ˆæ‰§è¡Œä»¥ä¸‹æ­¥éª¤"></a>1ã€è‹¥æ˜¯ä»¥å‰å®‰è£…è¿‡dockerï¼Œå…ˆæ‰§è¡Œä»¥ä¸‹æ­¥éª¤</h3><ol><li><p>æ›´æ–°yumåŒ…ï¼ˆç”Ÿäº§ç¯å¢ƒä¸­æ…é‡ï¼‰</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">yum -y update<br></code></pre></td></tr></table></figure><p>æ­¤å‘½ä»¤ä¸æ˜¯å¿…é¡»ï¼Œæœ‰æœåŠ¡å™¨é‡å¯ä¸€ä¸‹æœåŠ¡å™¨</p></li><li><p>å¸è½½æ—§ç‰ˆæœ¬</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">yum remove docker  docker-common docker-selinux docker-engine<br></code></pre></td></tr></table></figure></li></ol><h3 id="2ã€å®‰è£…dockerçš„è¯¦ç»†æ­¥éª¤"><a href="#2ã€å®‰è£…dockerçš„è¯¦ç»†æ­¥éª¤" class="headerlink" title="2ã€å®‰è£…dockerçš„è¯¦ç»†æ­¥éª¤"></a>2ã€å®‰è£…dockerçš„è¯¦ç»†æ­¥éª¤</h3><ol><li><p>é¦–å…ˆå®‰è£…éœ€è¦çš„è½¯ä»¶åŒ…</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">yum install -y yum-utils device-mapper-persistent-data lvm2<br></code></pre></td></tr></table></figure></li><li><p>è®¾ç½®yumæºï¼Œæˆ‘ä½¿ç”¨çš„æ˜¯é˜¿é‡Œä»“åº“</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">yum-config-manager --add-repo http://mirrors.aliyun.com/docker-ce/linux/centos/docker-ce.repo<br></code></pre></td></tr></table></figure></li><li><p>é€‰æ‹©dockerç‰ˆæœ¬å¹¶å®‰è£…<br>æŸ¥çœ‹å¯ç”¨çš„ç‰ˆæœ¬ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">yum list docker-ce --showduplicates | <span class="hljs-built_in">sort</span> -r                 <br></code></pre></td></tr></table></figure><p>é€‰æ‹©ä¸€ä¸ªç‰ˆæœ¬å¹¶å®‰è£…ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">yum install docker-ce-ç‰ˆæœ¬å·<br></code></pre></td></tr></table></figure><p>æˆ‘å®‰è£…çš„æ˜¯:</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">yum -y install docker-ce-18.03.1.ce<br></code></pre></td></tr></table></figure></li><li><p>å¯åŠ¨dockerå¹¶è®¾ç½®å¼€æœºè‡ªå¯</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs bash">systemctl start docker<br>systemctl <span class="hljs-built_in">enable</span> docker<br></code></pre></td></tr></table></figure></li></ol><h2 id="ä¸‰ã€imageæ–‡ä»¶"><a href="#ä¸‰ã€imageæ–‡ä»¶" class="headerlink" title="ä¸‰ã€imageæ–‡ä»¶"></a>ä¸‰ã€imageæ–‡ä»¶</h2><p><strong>Docker æŠŠåº”ç”¨ç¨‹åºåŠå…¶ä¾èµ–ï¼Œæ‰“åŒ…åœ¨ image æ–‡ä»¶é‡Œé¢ã€‚</strong>åªæœ‰é€šè¿‡è¿™ä¸ªæ–‡ä»¶ï¼Œæ‰èƒ½ç”Ÿæˆ Docker å®¹å™¨ã€‚image æ–‡ä»¶å¯ä»¥çœ‹ä½œæ˜¯å®¹å™¨çš„æ¨¡æ¿ã€‚Docker æ ¹æ® image æ–‡ä»¶ç”Ÿæˆå®¹å™¨çš„å®ä¾‹ã€‚åŒä¸€ä¸ª image æ–‡ä»¶ï¼Œå¯ä»¥ç”Ÿæˆå¤šä¸ªåŒæ—¶è¿è¡Œçš„å®¹å™¨å®ä¾‹ã€‚</p><p>image æ˜¯äºŒè¿›åˆ¶æ–‡ä»¶ã€‚å®é™…å¼€å‘ä¸­ï¼Œä¸€ä¸ª image æ–‡ä»¶å¾€å¾€é€šè¿‡ç»§æ‰¿å¦ä¸€ä¸ª image æ–‡ä»¶ï¼ŒåŠ ä¸Šä¸€äº›ä¸ªæ€§åŒ–è®¾ç½®è€Œç”Ÿæˆã€‚ä¸¾ä¾‹æ¥è¯´ï¼Œä½ å¯ä»¥åœ¨ Ubuntu çš„ image åŸºç¡€ä¸Šï¼Œå¾€é‡Œé¢åŠ å…¥ Apache æœåŠ¡å™¨ï¼Œå½¢æˆä½ çš„ imageã€‚</p><blockquote><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-comment"># åˆ—å‡ºæœ¬æœºçš„æ‰€æœ‰ image æ–‡ä»¶ã€‚</span><br>docker image <span class="hljs-built_in">ls</span><br><br><span class="hljs-comment"># åˆ é™¤ image æ–‡ä»¶</span><br>docker image <span class="hljs-built_in">rm</span> [imageName]<br></code></pre></td></tr></table></figure></blockquote><p>image æ–‡ä»¶æ˜¯é€šç”¨çš„ï¼Œä¸€å°æœºå™¨çš„ image æ–‡ä»¶æ‹·è´åˆ°å¦ä¸€å°æœºå™¨ï¼Œç…§æ ·å¯ä»¥ä½¿ç”¨ã€‚ä¸€èˆ¬æ¥è¯´ï¼Œä¸ºäº†èŠ‚çœæ—¶é—´ï¼Œæˆ‘ä»¬åº”è¯¥å°½é‡ä½¿ç”¨åˆ«äººåˆ¶ä½œå¥½çš„ image æ–‡ä»¶ï¼Œè€Œä¸æ˜¯è‡ªå·±åˆ¶ä½œã€‚å³ä½¿è¦å®šåˆ¶ï¼Œä¹Ÿåº”è¯¥åŸºäºåˆ«äººçš„ image æ–‡ä»¶è¿›è¡ŒåŠ å·¥ï¼Œè€Œä¸æ˜¯ä»é›¶å¼€å§‹åˆ¶ä½œã€‚</p><p>ä¸ºäº†æ–¹ä¾¿å…±äº«ï¼Œimage æ–‡ä»¶åˆ¶ä½œå®Œæˆåï¼Œå¯ä»¥ä¸Šä¼ åˆ°ç½‘ä¸Šçš„ä»“åº“ã€‚Docker çš„å®˜æ–¹ä»“åº“ <a href="https://hub.docker.com/">Docker Hub</a> æ˜¯æœ€é‡è¦ã€æœ€å¸¸ç”¨çš„ image ä»“åº“ã€‚</p><h2 id="å››ã€å®ä¾‹ï¼šâ€œHello-worldâ€"><a href="#å››ã€å®ä¾‹ï¼šâ€œHello-worldâ€" class="headerlink" title="å››ã€å®ä¾‹ï¼šâ€œHello worldâ€"></a>å››ã€å®ä¾‹ï¼šâ€œHello worldâ€</h2><p>é€šè¿‡æœ€ç®€å•çš„â€œHello worldâ€å®ä¾‹æ„Ÿå—ä¸€ä¸‹imageæ–‡ä»¶</p><p>é¦–å…ˆï¼Œè¿è¡Œä¸‹é¢çš„å‘½ä»¤ï¼Œå°† image æ–‡ä»¶ä»ä»“åº“æŠ“å–åˆ°æœ¬åœ°ã€‚</p><blockquote><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">$ docker image pull library/hello-world<br></code></pre></td></tr></table></figure></blockquote><p>ä¸Šé¢ä»£ç ä¸­ï¼Œ<code>docker image pull</code>æ˜¯æŠ“å– image æ–‡ä»¶çš„å‘½ä»¤ã€‚<code>library/hello-world</code>æ˜¯ image æ–‡ä»¶åœ¨ä»“åº“é‡Œé¢çš„ä½ç½®ï¼Œå…¶ä¸­<code>library</code>æ˜¯ image æ–‡ä»¶æ‰€åœ¨çš„ç»„ï¼Œ<code>hello-world</code>æ˜¯ image æ–‡ä»¶çš„åå­—ã€‚</p><p>ç”±äº Docker å®˜æ–¹æä¾›çš„ image æ–‡ä»¶ï¼Œéƒ½æ”¾åœ¨<a href="https://hub.docker.com/r/library/"><code>library</code></a>ç»„é‡Œé¢ï¼Œæ‰€ä»¥å®ƒçš„æ˜¯é»˜è®¤ç»„ï¼Œå¯ä»¥çœç•¥ã€‚å› æ­¤ï¼Œä¸Šé¢çš„å‘½ä»¤å¯ä»¥å†™æˆä¸‹é¢è¿™æ ·ã€‚</p><blockquote><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">$ docker image pull hello-world<br></code></pre></td></tr></table></figure></blockquote><p>æŠ“å–æˆåŠŸä»¥åï¼Œå°±å¯ä»¥åœ¨æœ¬æœºçœ‹åˆ°è¿™ä¸ª image æ–‡ä»¶äº†ã€‚</p><blockquote><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">$ docker image <span class="hljs-built_in">ls</span><br></code></pre></td></tr></table></figure></blockquote><p>ç°åœ¨ï¼Œè¿è¡Œè¿™ä¸ª image æ–‡ä»¶ã€‚</p><blockquote><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">$ docker container run hello-world<br></code></pre></td></tr></table></figure></blockquote><p><code>docker container run</code>å‘½ä»¤ä¼šä» image æ–‡ä»¶ï¼Œç”Ÿæˆä¸€ä¸ªæ­£åœ¨è¿è¡Œçš„å®¹å™¨å®ä¾‹ã€‚</p><p>æ³¨æ„ï¼Œ<code>docker container run</code>å‘½ä»¤å…·æœ‰è‡ªåŠ¨æŠ“å– image æ–‡ä»¶çš„åŠŸèƒ½ã€‚å¦‚æœå‘ç°æœ¬åœ°æ²¡æœ‰æŒ‡å®šçš„ image æ–‡ä»¶ï¼Œå°±ä¼šä»ä»“åº“è‡ªåŠ¨æŠ“å–ã€‚å› æ­¤ï¼Œå‰é¢çš„<code>docker image pull</code>å‘½ä»¤å¹¶ä¸æ˜¯å¿…éœ€çš„æ­¥éª¤ã€‚</p><p>å¦‚æœè¿è¡ŒæˆåŠŸï¼Œä½ ä¼šåœ¨å±å¹•ä¸Šè¯»åˆ°ä¸‹é¢çš„è¾“å‡ºã€‚</p><blockquote><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs bash">$ docker container run hello-world<br><br>Hello from Docker!<br>This message shows that your installation appears to be working correctly.<br><br>... ...<br></code></pre></td></tr></table></figure></blockquote><p>è¾“å‡ºè¿™æ®µæç¤ºä»¥åï¼Œ<code>hello world</code>å°±ä¼šåœæ­¢è¿è¡Œï¼Œå®¹å™¨è‡ªåŠ¨ç»ˆæ­¢ã€‚</p><p>æœ‰äº›å®¹å™¨ä¸ä¼šè‡ªåŠ¨ç»ˆæ­¢ï¼Œå› ä¸ºæä¾›çš„æ˜¯æœåŠ¡ã€‚æ¯”å¦‚ï¼Œå®‰è£…è¿è¡Œ Ubuntu çš„ imageï¼Œå°±å¯ä»¥åœ¨å‘½ä»¤è¡Œä½“éªŒ Ubuntu ç³»ç»Ÿã€‚</p><blockquote><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">$ docker container run -it ubuntu bash<br></code></pre></td></tr></table></figure></blockquote><p>å¯¹äºé‚£äº›ä¸ä¼šè‡ªåŠ¨ç»ˆæ­¢çš„å®¹å™¨ï¼Œå¿…é¡»ä½¿ç”¨<a href="https://docs.docker.com/engine/reference/commandline/container_kill/"><code>docker container kill</code></a> å‘½ä»¤æ‰‹åŠ¨ç»ˆæ­¢ã€‚</p><blockquote><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">$ docker container <span class="hljs-built_in">kill</span> [containID]<br></code></pre></td></tr></table></figure></blockquote><h2 id="äº”ã€å®¹å™¨æ–‡ä»¶"><a href="#äº”ã€å®¹å™¨æ–‡ä»¶" class="headerlink" title="äº”ã€å®¹å™¨æ–‡ä»¶"></a>äº”ã€å®¹å™¨æ–‡ä»¶</h2><p><strong>image æ–‡ä»¶ç”Ÿæˆçš„å®¹å™¨å®ä¾‹ï¼Œæœ¬èº«ä¹Ÿæ˜¯ä¸€ä¸ªæ–‡ä»¶ï¼Œç§°ä¸ºå®¹å™¨æ–‡ä»¶ã€‚</strong>ä¹Ÿå°±æ˜¯è¯´ï¼Œä¸€æ—¦å®¹å™¨ç”Ÿæˆï¼Œå°±ä¼šåŒæ—¶å­˜åœ¨ä¸¤ä¸ªæ–‡ä»¶ï¼š image æ–‡ä»¶å’Œå®¹å™¨æ–‡ä»¶ã€‚è€Œä¸”å…³é—­å®¹å™¨å¹¶ä¸ä¼šåˆ é™¤å®¹å™¨æ–‡ä»¶ï¼Œåªæ˜¯å®¹å™¨åœæ­¢è¿è¡Œè€Œå·²ã€‚</p><blockquote><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-comment"># åˆ—å‡ºæœ¬æœºæ­£åœ¨è¿è¡Œçš„å®¹å™¨</span><br>$ docker container <span class="hljs-built_in">ls</span><br><br><span class="hljs-comment"># åˆ—å‡ºæœ¬æœºæ‰€æœ‰å®¹å™¨ï¼ŒåŒ…æ‹¬ç»ˆæ­¢è¿è¡Œçš„å®¹å™¨</span><br>$ docker container <span class="hljs-built_in">ls</span> --all<br></code></pre></td></tr></table></figure></blockquote><p>ä¸Šé¢å‘½ä»¤çš„è¾“å‡ºç»“æœä¹‹ä¸­ï¼ŒåŒ…æ‹¬å®¹å™¨çš„ IDã€‚å¾ˆå¤šåœ°æ–¹éƒ½éœ€è¦æä¾›è¿™ä¸ª IDï¼Œæ¯”å¦‚ä¸Šä¸€èŠ‚ç»ˆæ­¢å®¹å™¨è¿è¡Œçš„<code>docker container kill</code>å‘½ä»¤ã€‚</p><p>ç»ˆæ­¢è¿è¡Œçš„å®¹å™¨æ–‡ä»¶ï¼Œä¾ç„¶ä¼šå æ®ç¡¬ç›˜ç©ºé—´ï¼Œå¯ä»¥ä½¿ç”¨<a href="https://docs.docker.com/engine/reference/commandline/container_rm/"><code>docker container rm</code></a>å‘½ä»¤åˆ é™¤ã€‚</p><blockquote><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">$ docker container <span class="hljs-built_in">rm</span> [containerID]<br></code></pre></td></tr></table></figure></blockquote><p>è¿è¡Œä¸Šé¢çš„å‘½ä»¤ä¹‹åï¼Œå†ä½¿ç”¨<code>docker container ls --all</code>å‘½ä»¤ï¼Œå°±ä¼šå‘ç°è¢«åˆ é™¤çš„å®¹å™¨æ–‡ä»¶å·²ç»æ¶ˆå¤±äº†ã€‚</p><h2 id="å…­ã€Dockerfileéƒ¨ç½²Spring-Boot-é¡¹ç›®"><a href="#å…­ã€Dockerfileéƒ¨ç½²Spring-Boot-é¡¹ç›®" class="headerlink" title="å…­ã€Dockerfileéƒ¨ç½²Spring Boot é¡¹ç›®"></a>å…­ã€Dockerfileéƒ¨ç½²Spring Boot é¡¹ç›®</h2><h3 id="1ã€å°†å·²æœ‰çš„spring-boot-é¡¹ç›®æ‰“åŒ…"><a href="#1ã€å°†å·²æœ‰çš„spring-boot-é¡¹ç›®æ‰“åŒ…" class="headerlink" title="1ã€å°†å·²æœ‰çš„spring boot é¡¹ç›®æ‰“åŒ…"></a>1ã€å°†å·²æœ‰çš„spring boot é¡¹ç›®æ‰“åŒ…</h3><h3 id="2ã€åœ¨linuxä¸­åˆ›å»ºä¸€ä¸ªæ–‡ä»¶å¤¹ï¼Œä¾‹å¦‚æˆ‘åˆ›å»ºä¸º-root-docker-test-jar01"><a href="#2ã€åœ¨linuxä¸­åˆ›å»ºä¸€ä¸ªæ–‡ä»¶å¤¹ï¼Œä¾‹å¦‚æˆ‘åˆ›å»ºä¸º-root-docker-test-jar01" class="headerlink" title="2ã€åœ¨linuxä¸­åˆ›å»ºä¸€ä¸ªæ–‡ä»¶å¤¹ï¼Œä¾‹å¦‚æˆ‘åˆ›å»ºä¸º /root/docker_test/jar01"></a>2ã€åœ¨linuxä¸­åˆ›å»ºä¸€ä¸ªæ–‡ä»¶å¤¹ï¼Œä¾‹å¦‚æˆ‘åˆ›å»ºä¸º /root/docker_test/jar01</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-built_in">mkdir</span> /root/docker_test/jar01<br></code></pre></td></tr></table></figure><h3 id="3ã€å°†jaråŒ…ä¸Šä¼ åˆ°linuxæ–‡ä»¶å¤¹ä¸­"><a href="#3ã€å°†jaråŒ…ä¸Šä¼ åˆ°linuxæ–‡ä»¶å¤¹ä¸­" class="headerlink" title="3ã€å°†jaråŒ…ä¸Šä¼ åˆ°linuxæ–‡ä»¶å¤¹ä¸­"></a>3ã€å°†jaråŒ…ä¸Šä¼ åˆ°linuxæ–‡ä»¶å¤¹ä¸­</h3><p>åˆ©ç”¨MobaxTermå°†jaråŒ…ä¸Šä¼ åˆ°jar01ä¸­</p><h3 id="4ã€ç¼–å†™DockerFileæ–‡ä»¶"><a href="#4ã€ç¼–å†™DockerFileæ–‡ä»¶" class="headerlink" title="4ã€ç¼–å†™DockerFileæ–‡ä»¶"></a>4ã€ç¼–å†™DockerFileæ–‡ä»¶</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-comment"># åŸºäºjavaé•œåƒåˆ›å»ºæ–°é•œåƒ</span><br>FROM openjdk:11<br><span class="hljs-comment"># ä½œè€…</span><br>MAINTAINER zbiao<br><span class="hljs-comment"># å°†jaråŒ…æ·»åŠ åˆ°å®¹å™¨ä¸­å¹¶æ›´åä¸ºapp.jar</span><br>ADD  demo-helloworld.jar app.jar<br><span class="hljs-comment"># è¿è¡ŒjaråŒ…</span><br>ENTRYPOINT [<span class="hljs-string">&quot;java&quot;</span>,<span class="hljs-string">&quot;-jar&quot;</span>,<span class="hljs-string">&quot;app.jar&quot;</span>]<br></code></pre></td></tr></table></figure><p>ADD åé¢æ˜¯æºæ–‡ä»¶ï¼Œå†åé¢æ‰æ˜¯ç›®æ ‡æ–‡ä»¶</p><blockquote><p>æ³¨æ„ï¼šADDã€COPY æŒ‡ä»¤ç”¨æ³•ä¸€æ ·ï¼Œå”¯ä¸€ä¸åŒçš„æ˜¯ ADD æ”¯æŒå°†å½’æ¡£æ–‡ä»¶ï¼ˆtar, gzip, bzip2, etcï¼‰åšæå–å’Œè§£å‹æ“ä½œã€‚è¿˜æœ‰éœ€è¦æ³¨æ„çš„æ˜¯ï¼ŒCOPY æŒ‡ä»¤éœ€è¦å¤åˆ¶çš„ç›®å½•ä¸€å®šè¦æ”¾åœ¨ Dockerfile æ–‡ä»¶çš„åŒçº§ç›®å½•ä¸‹ã€‚</p></blockquote><p>å‚è€ƒï¼š<a href="http://lpxz.work/2022/07/04/Docker%20%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/#%E5%B8%B8%E7%94%A8%E8%BD%AF%E4%BB%B6-%E6%9C%8D%E5%8A%A1%E5%AE%89%E8%A3%85%E9%83%A8%E7%BD%B2-updating%E2%80%A6">LPxzçš„ä¸ªäººåšå®¢</a></p><h3 id="5ã€åˆ¶ä½œé•œåƒ"><a href="#5ã€åˆ¶ä½œé•œåƒ" class="headerlink" title="5ã€åˆ¶ä½œé•œåƒ"></a>5ã€åˆ¶ä½œé•œåƒ</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">docker build -t zbdemo .<br></code></pre></td></tr></table></figure><p>æ³¨æ„æ˜¯åœ¨jar01ç›®å½•ä¸‹</p><h3 id="6ã€å¯åŠ¨å®¹å™¨"><a href="#6ã€å¯åŠ¨å®¹å™¨" class="headerlink" title="6ã€å¯åŠ¨å®¹å™¨"></a>6ã€å¯åŠ¨å®¹å™¨</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">docker run -d -p 8080:8080 --name zbdemo03 zbdemo:latest<br></code></pre></td></tr></table></figure><p>å‘½ä»¤å‚æ•°ï¼š</p><ul><li>-dï¼šåå°è¿è¡Œ</li><li>-pï¼šå…¬å¼€æŒ‡å®šç«¯å£å·</li><li>-nameï¼šå®¹å™¨å‘½å</li></ul><p>å¯åŠ¨åå¯é€šè¿‡ <code>docker ps</code> æŸ¥çœ‹æ­£åœ¨è¿è¡Œçš„å®¹å™¨ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs bash">[root@VM-8-10-centos jar01]<span class="hljs-comment"># docker ps</span><br>CONTAINER ID        IMAGE               COMMAND               CREATED             STATUS              PORTS                    NAMES<br>618cf8b1a0a8        zbdemo:latest       <span class="hljs-string">&quot;java -jar app.jar&quot;</span>   14 minutes ago      Up 13 minutes       0.0.0.0:8080-&gt;8080/tcp   zbdemo04<br>45d6deb5444a        zbdemo:latest       <span class="hljs-string">&quot;java -jar app.jar&quot;</span>   16 minutes ago      Up 16 minutes       0.0.0.0:8082-&gt;8082/tcp   zbdemo03<br></code></pre></td></tr></table></figure><h3 id="7ã€æŸ¥çœ‹å¯åŠ¨æ—¥å¿—"><a href="#7ã€æŸ¥çœ‹å¯åŠ¨æ—¥å¿—" class="headerlink" title="7ã€æŸ¥çœ‹å¯åŠ¨æ—¥å¿—"></a>7ã€æŸ¥çœ‹å¯åŠ¨æ—¥å¿—</h3><p>æˆ‘ä»¬å¯ä»¥é€šè¿‡ <code>docker logs name</code> æŸ¥çœ‹æŒ‡å®šå®¹å™¨çš„æ—¥å¿—ï¼Œåé¢nameä¸ºå®¹å™¨åï¼Œå¦‚zbdemo03</p><h3 id="8ã€DockerFileé…ç½®å‚æ•°"><a href="#8ã€DockerFileé…ç½®å‚æ•°" class="headerlink" title="8ã€DockerFileé…ç½®å‚æ•°"></a>8ã€DockerFileé…ç½®å‚æ•°</h3><p>FROMï¼šFROM æ˜¯æ„å»ºé•œåƒçš„åŸºç¡€æºé•œåƒï¼Œè¯¥ Image æ–‡ä»¶ç»§æ‰¿å®˜æ–¹çš„ node imageã€‚</p><p>è¯¦ç»†è¯´æ˜ï¼šDockerfile ä¸­ FROM æ˜¯å¿…å¤‡çš„æŒ‡ä»¤ï¼Œå¹¶ä¸”å¿…é¡»æ˜¯ç¬¬ä¸€æ¡æŒ‡ä»¤ï¼ å®ƒå¼•å…¥ä¸€ä¸ªé•œåƒä½œä¸ºæˆ‘ä»¬è¦æ„å»ºé•œåƒçš„åŸºç¡€å±‚ï¼Œå°±å¥½åƒæˆ‘ä»¬é¦–å…ˆè¦å®‰è£…å¥½æ“ä½œç³»ç»Ÿï¼Œæ‰å¯ä»¥åœ¨æ“ä½œç³»ç»Ÿä¸Šé¢å®‰è£…è½¯ä»¶ä¸€æ ·ã€‚</p><p>RUNï¼šåé¢è·Ÿçš„æ˜¯åœ¨å®¹å™¨ä¸­è¦æ‰§è¡Œçš„å‘½ä»¤ã€‚</p><p>è¯¦ç»†è¯´æ˜ï¼šæ¯ä¸€ä¸ª <code>RUN</code> æŒ‡ä»¤éƒ½ä¼šæ–°å»ºç«‹ä¸€å±‚ï¼Œåœ¨å…¶ä¸Šæ‰§è¡Œè¿™äº›å‘½ä»¤ï¼Œæˆ‘ä»¬é¢‘ç¹ä½¿ç”¨ <code>RUN</code> æŒ‡ä»¤ä¼šåˆ›å»ºå¤§é‡é•œåƒå±‚ï¼Œç„¶è€Œ <code>Union FS</code> æ˜¯æœ‰æœ€å¤§å±‚æ•°é™åˆ¶çš„ï¼Œä¸èƒ½è¶…è¿‡ <code>127</code> å±‚ï¼Œè€Œä¸”æˆ‘ä»¬åº”è¯¥æŠŠæ¯ä¸€å±‚ä¸­æˆ‘ç”¨æ–‡ä»¶æ¸…é™¤ï¼Œæ¯”å¦‚ä¸€äº›æ²¡ç”¨çš„ä¾èµ–ï¼Œæ¥é˜²æ­¢é•œåƒè‡ƒè‚¿ã€‚</p><p>WORKDIRï¼šå®¹å™¨çš„å·¥ä½œç›®å½•</p><p>COPYï¼šæ‹·è´æ–‡ä»¶è‡³å®¹å™¨çš„å·¥ä½œç›®å½•ä¸‹ï¼Œ.dockerignore æŒ‡å®šçš„æ–‡ä»¶ä¸ä¼šæ‹·è´</p><p>EXPOSEï¼šå°†å®¹å™¨å†…çš„æŸä¸ªç«¯å£å¯¼å‡ºä¾›å¤–éƒ¨è®¿é—®</p><p>CMDï¼šDockerfile æ‰§è¡Œå†™ä¸€ä¸ª CMD å¦åˆ™åé¢çš„ä¼šè¢«è¦†ç›–ï¼ŒCMD åé¢çš„å‘½ä»¤æ˜¯å®¹å™¨æ¯æ¬¡å¯åŠ¨æ‰§è¡Œçš„å‘½ä»¤ï¼Œå¤šä¸ªå‘½ä»¤ä¹‹é—´å¯ä»¥ä½¿ç”¨ &amp;&amp; é“¾æ¥ï¼Œä¾‹å¦‚ CMD git pull &amp;&amp; npm start</p><p>è¯¦ç»†è¯´æ˜:<code>CMD</code> æŒ‡ä»¤ç”¨æ¥åœ¨å¯åŠ¨å®¹å™¨çš„æ—¶å€™ï¼ŒæŒ‡å®šé»˜è®¤çš„å®¹å™¨ä¸»è¿›ç¨‹çš„å¯åŠ¨å‘½ä»¤å’Œå‚æ•°ã€‚ </p>]]></content>
    
    
    <categories>
      
      <category>Linux</category>
      
    </categories>
    
    
    <tags>
      
      <tag>docker</tag>
      
      <tag>image</tag>
      
      <tag>dockerfile</tag>
      
      <tag>Linux</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>è´ªå¿ƒç®—æ³•</title>
    <link href="/2022/09/16/tan-xin-suan-fa/"/>
    <url>/2022/09/16/tan-xin-suan-fa/</url>
    
    <content type="html"><![CDATA[<h1 id="è´ªå¿ƒç®—æ³•"><a href="#è´ªå¿ƒç®—æ³•" class="headerlink" title="è´ªå¿ƒç®—æ³•"></a>è´ªå¿ƒç®—æ³•</h1><h2 id="è´ªå¿ƒç®—æ³•åŸºç¡€çŸ¥è¯†"><a href="#è´ªå¿ƒç®—æ³•åŸºç¡€çŸ¥è¯†" class="headerlink" title="è´ªå¿ƒç®—æ³•åŸºç¡€çŸ¥è¯†"></a>è´ªå¿ƒç®—æ³•åŸºç¡€çŸ¥è¯†</h2><p>æ— å¥—è·¯</p><p>å¤§ä½“æ€è·¯ï¼š æ±‚å±€éƒ¨æœ€ä¼˜ï¼Œè¿›è€Œæ±‚å…¨å±€æœ€ä¼˜</p><p>è´ªå¿ƒç®—æ³•ä¸€èˆ¬åˆ†ä¸ºå¦‚ä¸‹å››æ­¥ï¼š</p><ul><li>å°†é—®é¢˜åˆ†è§£ä¸ºè‹¥å¹²ä¸ªå­é—®é¢˜</li><li>æ‰¾å‡ºé€‚åˆçš„è´ªå¿ƒç­–ç•¥</li><li>æ±‚è§£æ¯ä¸€ä¸ªå­é—®é¢˜çš„æœ€ä¼˜è§£</li><li>å°†å±€éƒ¨æœ€ä¼˜è§£å †å æˆå…¨å±€æœ€ä¼˜è§£</li></ul><h2 id="åˆ†å‘é¥¼å¹²"><a href="#åˆ†å‘é¥¼å¹²" class="headerlink" title="åˆ†å‘é¥¼å¹²"></a>åˆ†å‘é¥¼å¹²</h2><p>ä¸ªäººæ€è·¯ï¼šå°†ä¸¤ä¸ªæ•°ç»„æ’åºï¼Œç„¶åé¥¼å¹²é‚£ä¸ªä¸€ä¸€å¯¹åº”å­©å­çš„èƒƒå£ï¼Œè‹¥æ˜¯é¥¼å¹²å°äº†ï¼Œç›´æ¥é¥¼å¹²åç§»ï¼Œè‹¥æ˜¯å­©å­å°äº†ï¼Œä»ç„¶ç›´æ¥ç»™å‡ºï¼Œcount+1</p><hr><p>ä½†è¿˜æœ‰ç§åå‘æ“ä½œï¼Œå…ˆç»™å¤§çš„ï¼Œåç»™å°çš„ï¼›å°½å¯èƒ½å¤šçš„æ»¡è¶³å­©å­çš„èƒƒå£ã€‚</p><p>å¥¥ï¼Œå¡å“¥è·Ÿæˆ‘æƒ³çš„ä¸€æ ·ï¼Œéƒ½æ˜¯ç”¨ä¸€ä¸ªindexæ¥é¿å…äºŒæ¬¡éå†ï¼Œè¿™é“é¢˜å…ˆæ»¡è¶³èƒƒå£å°çš„å’Œå…ˆæ»¡è¶³èƒƒå£å¤§çš„éƒ½ä¸€æ ·</p><h2 id="æ‘†åŠ¨åºåˆ—"><a href="#æ‘†åŠ¨åºåˆ—" class="headerlink" title="æ‘†åŠ¨åºåˆ—"></a>æ‘†åŠ¨åºåˆ—</h2><p>åºåˆ—è¿˜å¯ä»¥åˆ é™¤ï¼Œä¸€å®šè¦æ³¨æ„è¿™ä¸€ç‚¹</p><p>æ‘†åŠ¨åºåˆ—å¯ä»¥è½¬åŒ–ä¸ºæ±‚å³°å€¼å’Œè°·åº•ï¼Œæ±‚å‡ºä¸€ä¸ªå³°å€¼æˆ–è°·åº•ç»“æœå°±åŠ ä¸€</p><p>resultåˆå§‹åŒ–ä¸º1ï¼Œæ˜¯å› ä¸ºå¦‚æœåˆå§‹åŒ–0çš„è¯ï¼Œå°±æ²¡æœ‰è€ƒè™‘åˆ°è¾¹ç•Œï¼Œåˆå§‹åŒ–ä¸º1å°±ä½“ç°äº†å·²ç»å¤„ç†å·¦è¾¹ç•Œ</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">if</span> ((curDiff &gt; <span class="hljs-number">0</span> &amp;&amp; preDiff &lt;= <span class="hljs-number">0</span>) || (curDiff &lt; <span class="hljs-number">0</span> &amp;&amp; preDiff &gt;= <span class="hljs-number">0</span>)) &#123;<br>count++;<br>preDiff = curDiff;<br>&#125;<br></code></pre></td></tr></table></figure><p>preå¤„å†™&lt;=   ã€ &gt;=  æ˜¯å› ä¸ºè¦è€ƒè™‘åˆå§‹åŒ–æƒ…å†µï¼Œå› ä¸ºpreåˆå§‹åŒ–ä¸º0ï¼Œæ‰€ä»¥ä¸ç®¡å½“å‰å¤§äºè¿˜æ˜¯å°äºï¼Œéƒ½ç¬¦åˆ</p><p>åŒæ—¶åºåˆ—è¿˜å¯ä»¥åˆ é™¤ï¼Œè¿™ä¸€ç‚¹ä½“ç°åœ¨pre = curçš„æ”¾ç½®ä½ç½®ï¼Œæ”¾åœ¨ifé‡Œé¢ï¼Œæ„æ€æ˜¯åªæ‰¾å³°å€¼æˆ–è°·åº•ï¼Œè€Œä¸å»ç®¡è¾¹ç•Œï¼›è‹¥æ˜¯æ”¾åˆ°ifå¤–é¢ï¼Œæ„æ€æ˜¯æ¯æ¬¡éƒ½è¦è¿›è¡Œå¤„ç†ï¼Œå¾ˆæ˜æ˜¾ï¼Œæœ¬é¢˜æˆ‘ä»¬è¦é€‰æ‹©æ”¾åœ¨ifé‡Œé¢</p><p>å¦ä¸€ç§è§£æ³•æ˜¯DP,ä»¥åå†è¯´</p><h2 id="æœ€å¤§å­æ•°ç»„å’Œ"><a href="#æœ€å¤§å­æ•°ç»„å’Œ" class="headerlink" title="æœ€å¤§å­æ•°ç»„å’Œ"></a>æœ€å¤§å­æ•°ç»„å’Œ</h2><p>è‹¥å…¨æ˜¯è´Ÿæ•°ï¼Ÿ</p><p>æƒ³æ³•ï¼šè·Ÿä¸Šé¢˜ç±»ä¼¼ï¼Œå®šä¹‰preå’Œcurï¼Œå†å®šä¹‰ä¸€ä¸ªæœ€å¤§å€¼ï¼Œæœ€å¤§å€¼ä¸€å®šæ˜¯ä»æ­£æ•°å¼€å§‹ï¼Œä½†æ˜¯è‹¥å…¨æ˜¯è´Ÿæ•°ï¼Ÿï¼Ÿ</p><p>è¡Œä¸é€šï¼Œå¦</p><ol><li>æ€è·¯ä¸€ï¼šæš´åŠ›æ³•ï¼Œä¸¤å±‚forå¾ªç¯ï¼Œå¤–å±‚éå†ï¼Œå†…å±‚ä»å¤–å±‚å¼€å§‹ï¼Œæ‰¾å‡ºæœ€å¤§è¿ç»­å’Œï¼›è¿™æ ·å°±æŠŠæ¯ä¸ªè¿ç»­å’Œæ±‚å‡ºæ¥äº†ï¼Œç›´æ¥è¿”å›æœ€å¤§</li><li>æ€è·¯äºŒï¼šè´ªå¿ƒæ³•ï¼Œé‡ç‚¹åœ¨äºæƒ³å±€éƒ¨æœ€ä¼˜ï¼Œå±€éƒ¨æœ€ä¼˜æ˜¯ï¼šä¸€æ—¦åŠ åˆ°äº†è´Ÿæ•°ï¼Œåˆ™ç›´æ¥ä»ä¸‹ä¸€ä¸ªå¼€å§‹ï¼›åŒæ—¶ç”¨resultè®°å½•æœ€å¤§å€¼ï¼Œç”±æ­¤æ¥ç¡®å®šç»ˆæ­¢åŒºé—´ã€‚</li><li>æ€è·¯ä¸‰ï¼šåŠ¨æ€è§„åˆ’ï¼Œç›®å‰ä¸æ¶‰åŠ</li></ol><p>æ€è·¯äºŒè´ªå¿ƒçš„å®ç°ï¼Œæœ‰ä¸€ä¸ªé—®é¢˜ï¼Œè‹¥æ˜¯å…¨æ˜¯è´Ÿæ•°å‘¢ï¼Ÿåˆå›åˆ°äº†æˆ‘æœ€åˆçš„æƒ³æ³•ï¼Œè‹¥å…¨æ˜¯è´Ÿæ•°çš„è¯ï¼Œé‚£å°±åº”è¯¥æŠŠresultåˆå§‹åŒ–ä¸ºIntegerçš„æœ€å°å€¼ï¼Œç„¶åå…ˆåŠ åˆ°sumé‡Œï¼Œå†åˆ¤æ–­resultå’Œsumå¤§å°ï¼Œæœ€åå†åˆ¤æ–­sumæ˜¯å¦å¤§äº0ï¼Œè¿™æ ·å°±å®Œç¾è§£å†³äº†å…¨æ˜¯è´Ÿæ•°çš„é—®é¢˜ã€‚</p><p>æˆ‘æœ€åˆæ˜¯å…ˆåˆ¤æ–­sumæ˜¯å¦å¤§äº0ï¼Œè‹¥ä¸æ˜¯åˆ™ç›´æ¥continueï¼Œè¿™æ ·å¯¼è‡´å‡ºç°å…¨æ˜¯è´Ÿæ•°çš„æ—¶å€™å°±æ— æ³•è§£å†³ã€‚</p><p>å¡å“¥å‰å®³ï¼</p><h2 id="ä¹°è‚¡ç¥¨çš„æœ€ä½³æ—¶æœºII"><a href="#ä¹°è‚¡ç¥¨çš„æœ€ä½³æ—¶æœºII" class="headerlink" title="ä¹°è‚¡ç¥¨çš„æœ€ä½³æ—¶æœºII"></a>ä¹°è‚¡ç¥¨çš„æœ€ä½³æ—¶æœºII</h2><p>çœŸè ¢å•Šï¼</p><p>æˆ‘åœ¨æƒ³ï¼šæ˜¯å¦å¯ä»¥åƒä»¥å‰é‚£æ ·ï¼Œå®šä¹‰ä¸€ä¸ªcurï¼Œä¸€ä¸ªpreï¼›æ‰¾è°·å³°å’Œè°·åº•ï¼Œä½†è¿™æ ·æéš¾å®ç°ï¼Œæˆ–è€…è¯´å°±ä¸å¯ä»¥å®ç°</p><p>å¡å“¥æ˜¯é€šè¿‡è®¡ç®—ä¸¤å¤©ä¹‹é—´çš„å·®å€¼ï¼Œåªè®°å½•æ­£å€¼å³å¯ï¼Œå¹¶ç›¸åŠ ï¼›</p><p>è¿˜æœ‰ä¸€ç§çš„DP,æš‚æ—¶ä¸è€ƒè™‘</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> <span class="hljs-variable">i</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>; i &lt; prices.length - <span class="hljs-number">1</span>; i++) &#123;<br>            <span class="hljs-keyword">if</span> (prices[i + <span class="hljs-number">1</span>] - prices[i] &gt; <span class="hljs-number">0</span>) &#123;<br>                sum += prices[i + <span class="hljs-number">1</span>] - prices[i];<br>            &#125;<br>        &#125;<br></code></pre></td></tr></table></figure><p>æˆ‘è¢«ç§€ä¸€è„¸</p><h2 id="è·³è·ƒæ¸¸æˆ"><a href="#è·³è·ƒæ¸¸æˆ" class="headerlink" title="è·³è·ƒæ¸¸æˆ"></a>è·³è·ƒæ¸¸æˆ</h2><p>å›æº¯ï¼Ÿ</p><p>çœ‹èµ·æ¥åƒæ˜¯å›æº¯</p><p>æœ¬äººæƒ³æ³•ï¼šå±€éƒ¨æœ€ä¼˜ï¼šè·³åˆ°ä¸€ä¸ªæ–¹å—ï¼Œç„¶åæ‰¾è¿™ä¸ªæ–¹å—èƒ½è·³åˆ°çš„èŒƒå›´å†…çš„æ•°å€¼æœ€å¤§çš„ï¼Œå¹¶ä¸”å¦‚æœæœ€å¤§èŒƒå›´è¶…è¿‡äº†æ•°ç»„ï¼Œåˆ™è¯æ˜å¯ä»¥è·³åˆ°ï¼Œåä¹‹ä¸è¡Œ</p><hr><p>æˆ‘çš„æƒ³æ³•æ˜¯ä¸æ­£ç¡®çš„ï¼Œå¡å“¥çš„æ€è·¯ï¼šå±€éƒ¨æœ€ä¼˜ï¼šæ‰¾æœ€å¤§è¦†ç›–èŒƒå›´ï¼Œæ¯ä¸ªéƒ½å¾—éå†ï¼Œè‹¥æ˜¯æ‰¾åˆ°äº†æŸä¸ªå…ƒç´ è¦†ç›–èŒƒå›´è¦†ç›–äº†æ•°ç»„çš„é•¿åº¦ï¼Œåˆ™å¯ä»¥ï¼Œåä¹‹è‹¥æ˜¯éå†å®Œè¿˜æ˜¯æ²¡æœ‰è¿”å›trueï¼Œé‚£è¯´æ˜ä¸è¡Œäº†ã€‚</p><blockquote><p>ä¹Ÿå¯ä»¥è¿™æ ·éå†æ•°ç»„ï¼š</p></blockquote><p>â€‹    éå†çš„æ˜¯coverMaxï¼Œè€Œä¸æ˜¯æ•´ä¸ªæ•°ç»„ï¼Œæ•°ç»„çš„éå†åœ¨forå¾ªç¯é‡Œé¢ï¼Œçœ‹ä¼¼æ²¡éå†æ•°ç»„ï¼Œå®åˆ™æ˜¯å¯¹æ•°ç»„çš„æ¯ä¸€ä¸ªå…ƒç´ éƒ½éå†äº†ã€‚</p><h2 id="è·³è·ƒæ¸¸æˆII"><a href="#è·³è·ƒæ¸¸æˆII" class="headerlink" title="==è·³è·ƒæ¸¸æˆII=="></a>==è·³è·ƒæ¸¸æˆII==</h2><p>è¿™ä¸‹è¯¥æ‰¾æœ€å¤§äº†å§</p><p>è¿˜æ˜¯ä¸èƒ½æ‰¾æœ€å¤§ï¼Œä½†æ˜¯è®²é“ç†ï¼Œå¯è¡Œï¼Œä½†æ˜¯å°±æ˜¯è·‘ä¸é€š</p><p>å¡å“¥æ€è·¯ï¼šä¾ç„¶æ˜¯æ‰¾æœ€å¤§è¦†ç›–èŒƒå›´ï¼Œå®šä¹‰å½“å‰æœ€å¤§èŒƒå›´å’Œå…¨ä½“æœ€å¤§èŒƒå›´ï¼Œå½“èµ°åˆ°å½“å‰æœ€å¤§èŒƒå›´æ—¶ï¼Œåˆ¤æ–­å…¨ä½“æœ€å¤§èŒƒå›´æ˜¯å¦å¤§äºæ•°ç»„é•¿åº¦ï¼Œè‹¥å¤§äºçš„è¯ï¼Œç›´æ¥+1å¹¶ä¸”break;è‹¥æ˜¯ä¸å¤§äºï¼Œå°±æ›´æ–°å½“å‰æœ€å¤§èŒƒå›´åˆ°å…¨ä½“æœ€å¤§èŒƒå›´</p><blockquote><p>æ–°æ€è·¯ï¼šæœ€å¤§èŒƒå›´</p></blockquote><h2 id="Kæ¬¡å–ååæœ€å¤§åŒ–çš„æ•°ç»„å’Œ"><a href="#Kæ¬¡å–ååæœ€å¤§åŒ–çš„æ•°ç»„å’Œ" class="headerlink" title="Kæ¬¡å–ååæœ€å¤§åŒ–çš„æ•°ç»„å’Œ"></a>Kæ¬¡å–ååæœ€å¤§åŒ–çš„æ•°ç»„å’Œ</h2><p>æƒ³æ³•ï¼šå…¶å®åªåˆ†å¥‡æ•°æ¬¡å’Œå¶æ•°æ¬¡ã€‚éœ€è¦åˆ¤æ–­è´Ÿæ•°çš„æ•°é‡ï¼Œè‹¥æ˜¯è´Ÿæ•°æ€»æ•°å°äºkï¼Œåˆ™å…ˆå°†è´Ÿæ•°å…¨éƒ¨è½¬æ­£ï¼Œç„¶åå†å‡äºŒï¼Œç›´åˆ°kä¸º0æˆ–1ï¼Œæ˜¯0çš„è¯ä¸ç”¨è¯´äº†ï¼Œæ˜¯1çš„è¯å°†æœ€å°çš„ç¿»è½¬ï¼›è‹¥è´Ÿæ•°æ€»æ•°å¤§äºkï¼Œé‚£ä¹ˆæ›´å¥½åŠäº†ï¼Œç›´æ¥ç¿»è½¬ã€‚</p><p>å½“ç„¶æ’åºä¼šæ›´å®¹æ˜“å¤„ç†ä¸€äº›ã€‚</p><p>Yesï¼Œè·Ÿå¡å“¥æƒ³çš„ä¸€æ ·ï¼Œä¸è¿‡æ’åºæ˜¯æŒ‰ç»å¯¹å€¼å¤§å°è¿›è¡Œæ’åºï¼Œä½†æ˜¯æˆ‘è§‰å¾—ä¹Ÿå¯ä»¥ç›´æ¥æ’åº</p><p>æœ€é‡è¦çš„æ˜¯ï¼ŒæŒ‰è´ªå¿ƒçš„æ€è·¯æ¥æƒ³ï¼Œå±€éƒ¨æœ€ä¼˜ï¼Œå…¨å±€æœ€ä¼˜ã€‚</p><p>å±€éƒ¨æœ€ä¼˜æ˜¯ï¼šæ¯æ¬¡ç¿»è½¬æœ€å°çš„æ•´æ•°</p><p>å…¨å±€æœ€ä¼˜æ˜¯ï¼šæ•´ä¸ªæ•°å€¼è¾¾åˆ°æœ€å¤§</p><p>ç¡®å®è¦æŒ‰ç»å¯¹å€¼æ’åºï¼è€Œä¸”æ˜¯ç»å¯¹å€¼ä»å¤§åˆ°å°ï¼åˆ°æœ€åç¿»è½¬æœ€åä¸€ä¸ªæ•°å³å¯ï¼›åä¹‹ç»å¯¹å€¼ä»å°åˆ°å¤§äº¦å¯ã€‚</p><h2 id="åŠ æ²¹ç«™"><a href="#åŠ æ²¹ç«™" class="headerlink" title="åŠ æ²¹ç«™"></a>åŠ æ²¹ç«™</h2><p>æ— ä»ä¸‹æ‰‹</p><p>è´ªå¿ƒæ³•ä¸€ï¼š</p><p>è¿›è¡Œå…¨å±€è´ªå¿ƒ</p><ul><li>æƒ…å†µä¸€ï¼šå¦‚æœgasçš„æ€»å’Œå°äºcostæ€»å’Œï¼Œé‚£ä¹ˆæ— è®ºä»å“ªé‡Œå‡ºå‘ï¼Œä¸€å®šæ˜¯è·‘ä¸äº†ä¸€åœˆçš„</li><li>æƒ…å†µäºŒï¼šrest[i] = gas[i]-cost[i]ä¸ºä¸€å¤©å‰©ä¸‹çš„æ²¹ï¼Œiä»0å¼€å§‹è®¡ç®—ç´¯åŠ åˆ°æœ€åä¸€ç«™ï¼Œå¦‚æœç´¯åŠ æ²¡æœ‰å‡ºç°è´Ÿæ•°ï¼Œè¯´æ˜ä»0å‡ºå‘ï¼Œæ²¹å°±æ²¡æœ‰æ–­è¿‡ï¼Œé‚£ä¹ˆ0å°±æ˜¯èµ·ç‚¹ã€‚</li><li>æƒ…å†µä¸‰ï¼šå¦‚æœç´¯åŠ çš„æœ€å°å€¼æ˜¯è´Ÿæ•°ï¼Œæ±½è½¦å°±è¦ä»é0èŠ‚ç‚¹å‡ºå‘ï¼Œä»åå‘å‰ï¼Œçœ‹å“ªä¸ªèŠ‚ç‚¹èƒ½è¿™ä¸ªè´Ÿæ•°å¡«å¹³ï¼Œèƒ½æŠŠè¿™ä¸ªè´Ÿæ•°å¡«å¹³çš„èŠ‚ç‚¹å°±æ˜¯å‡ºå‘èŠ‚ç‚¹ã€‚</li></ul><p>è´ªå¿ƒæ³•äºŒï¼š</p><p>æ¯ä¸ªåŠ æ²¹ç«™çš„å‰©ä½™é‡rest[i]ä¸ºgas[i] - cost[i]ã€‚</p><p>iä»0å¼€å§‹ç´¯åŠ rest[i]ï¼Œå’Œè®°ä¸ºcurSumï¼Œä¸€æ—¦curSumå°äºé›¶ï¼Œè¯´æ˜[0, i]åŒºé—´éƒ½ä¸èƒ½ä½œä¸ºèµ·å§‹ä½ç½®ï¼Œèµ·å§‹ä½ç½®ä»i+1ç®—èµ·ï¼Œå†ä»0è®¡ç®—curSumã€‚</p><p><strong>å±€éƒ¨æœ€ä¼˜ï¼šå½“å‰ç´¯åŠ rest[j]çš„å’ŒcurSumä¸€æ—¦å°äº0ï¼Œèµ·å§‹ä½ç½®è‡³å°‘è¦æ˜¯j+1ï¼Œå› ä¸ºä»jå¼€å§‹ä¸€å®šä¸è¡Œã€‚å…¨å±€æœ€ä¼˜ï¼šæ‰¾åˆ°å¯ä»¥è·‘ä¸€åœˆçš„èµ·å§‹ä½ç½®</strong>ã€‚</p><p>æ°´</p><h2 id="åˆ†å‘ç³–æœ"><a href="#åˆ†å‘ç³–æœ" class="headerlink" title="åˆ†å‘ç³–æœ"></a>åˆ†å‘ç³–æœ</h2><p>æ±‚å³°å€¼ï¼Œæˆ–è€…è¯´æ˜¯é™„è¿‘ä½ç½®æœ€å¤§å€¼è¿™ç§ï¼Œä¸€èˆ¬éƒ½éœ€è¦ä»å·¦åˆ°å³å†ä»å³åˆ°å·¦ä¸¤æ¬¡éå†ç¡®å®š</p><p>ç¬¬ä¸€æ¬¡ä»å·¦åˆ°å³ï¼Œåˆ¤æ–­å³è¾¹æ¯”å·¦è¾¹å¤§ï¼Œåˆ™å³è¾¹+1ï¼›</p><p>ç¬¬äºŒæ¬¡ä»å³åˆ°å·¦ï¼Œåˆ¤æ–­å·¦è¾¹æ¯”å³è¾¹å¤§ï¼Œåˆ™å–åŸæ¥çš„å’Œå³è¾¹+1äºŒè€…æœ€å¤§å€¼</p><p>æ³¨æ„ï¼šåŸæ•°ç»„è¿›è¡Œæ¯”è¾ƒï¼Œè€Œä¸æ˜¯candyæ•°ç»„è¿›è¡Œæ¯”è¾ƒï¼›åœ¨è¿™çº ç»“äº†èµ·ç åäº”åˆ†é’Ÿï¼</p><h2 id="æŸ æª¬æ°´æ‰¾é›¶"><a href="#æŸ æª¬æ°´æ‰¾é›¶" class="headerlink" title="æŸ æª¬æ°´æ‰¾é›¶"></a>æŸ æª¬æ°´æ‰¾é›¶</h2><p>åˆæ­¥æ€è·¯ï¼šç»´æŒä¸€ä¸ªæ•°ç»„ï¼Œåªä¿å­˜5å’Œ10çš„ä¸ªæ•°ï¼Œè¿˜å¯ä»¥æ±‚ä¸€ä¸ªsumï¼›å±€éƒ¨æœ€ä¼˜ï¼šæ¯æ¬¡å…ˆæŒ‘æœ€å¤§çš„æ•°ï¼Œä¹Ÿå³10ï¼Œå†æŒ‘5,ï¼›å…¨å±€æœ€ä¼˜ï¼šæ‰€æœ‰äººéƒ½å¯ä»¥æ‰¾é›¶</p><p>Yesã€‚æ€è·¯ä¸€æ ·ï¼Œåªä¸è¿‡å¡å“¥å®ç°æ˜¯ç”¨ä¸¤ä¸ªintå‹ï¼Œæˆ‘ç”¨æ•°ç»„ï¼Œå…¶å®ç”¨intæ›´å¥½ä¸€ç‚¹ã€‚å¡å“¥æ˜¯é‡åˆ°ç›´æ¥å‡ï¼Œä¸ç®¡æ˜¯å¦å¤§äºé›¶è¿˜æ˜¯å°äºé›¶ï¼Œåˆ°æœ€ååˆ¤æ–­è¿™ä¸¤ä¸ªæ˜¯å¦éƒ½å¤§äºç­‰äºé›¶å³å¯ï¼›æˆ‘æ˜¯è‹¥æ˜¯å‡äº†å¤§äº0ï¼Œåˆ™å‡ã€‚</p><p>å¡å“¥ä»£ç æ›´æ˜“å®ç°</p><h2 id="æ ¹æ®èº«é«˜é‡å»ºé˜Ÿåˆ—"><a href="#æ ¹æ®èº«é«˜é‡å»ºé˜Ÿåˆ—" class="headerlink" title="æ ¹æ®èº«é«˜é‡å»ºé˜Ÿåˆ—"></a>æ ¹æ®èº«é«˜é‡å»ºé˜Ÿåˆ—</h2><p>åˆæ­¥æ€è·¯ï¼šå…ˆæ‰¾ki == 0 çš„äººï¼Œç„¶åä»å°æ‰“åˆ°å†æ’åˆ—ï¼Œå…ˆæ”¾å°çš„ï¼›ç„¶åå†æ‰¾ki == 1çš„ï¼Œå†ä»å°å¼€å§‹æ”¾ï¼›ç„¶åæ‰¾ki == 2çš„ï¼Œä»¥æ­¤ç±»æ¨ã€‚</p><p>å®ç°ï¼šæœ‰ä¸€ç§æƒ³æ³•æ˜¯å»ºä¸¤ä¸ªæ•°ç»„ï¼Œä¸€ä¸ªå­˜hiï¼Œä¸€ä¸ªå­˜kiï¼Œå®šä¹‰ä¸€ä¸ªå‡½æ•°ï¼ŒåŠŸèƒ½æ˜¯äº¤æ¢æ•°ç»„æŸä¸¤ä¸ªä½ç½®çš„å…ƒç´ ã€‚</p><p>æ€è·¯ä¸å¯è¡Œã€‚æˆ‘çš„æ€è·¯ç›¸å½“äºæŒ‰kæ’åºï¼Œä½†æ˜¯è¿™ç§ä¼šå‡ºç°ä¸€ä¸ªé—®é¢˜ï¼Œ[5,2],[7,1]åˆ°åº•è°å…ˆå‘¢ï¼Ÿå‡ºç°ä¸ç¡®å®šæ€§ã€‚</p><p>å¡å“¥ï¼šè¿™ç§ä¸¤ç§ç»´åº¦çš„é¢˜ä¸€å®šè¦å…ˆç¡®å®šä¸€ä¸ªç»´åº¦ï¼Œè‹¥æ˜¯ä¸¤ä¸ªç»´åº¦éƒ½æƒ³å…¼é¡¾åˆ°çš„è¯å°±ä¼šé¡¾æ­¤å¤±å½¼ã€‚</p><p>å®ç°ï¼šçœ‹äº†å¡å“¥çš„ï¼ŒçœŸæ˜¯å‰å®³ï¼ä½¿ç”¨è‡ªå®šä¹‰å‡½æ•°Arrays.sort()è¿›è¡Œæ’åºï¼Œä¹‹åä½¿ç”¨listæ¥éå†</p><blockquote><p>æ³¨æ„ï¼šä»å°åˆ°å¤§ï¼šo1 - o2;ä»å¤§åˆ°å°ï¼šo2 - o1</p></blockquote><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs java">Arrays.sort(people, (a, b) -&gt; &#123;<br>            <span class="hljs-keyword">if</span> (a[<span class="hljs-number">0</span>] == b[<span class="hljs-number">0</span>])<br>                <span class="hljs-keyword">return</span> a[<span class="hljs-number">1</span>] - b[<span class="hljs-number">1</span>];   <span class="hljs-comment">//ä»å°åˆ°å¤§</span><br>            <span class="hljs-keyword">else</span><br>                <span class="hljs-keyword">return</span> b[<span class="hljs-number">0</span>] - a[<span class="hljs-number">0</span>];   <span class="hljs-comment">//ä»å¤§åˆ°å°</span><br>        &#125;);<br></code></pre></td></tr></table></figure><p>==æ’å…¥æ“ä½œ==</p><p>ä½¿ç”¨LinkedList.add(index, value)æ–¹æ³•è¿›è¡Œæ’å…¥ï¼Œç¬¬ä¸€ä¸ªå‚æ•°æ˜¯æ’å…¥ä½ç½®</p><p>æœ€åä½¿ç”¨toArrayæ–¹æ³•è¿›è¡Œæ•°ç»„è½¬æ¢ã€‚</p><p>å¡å“¥æ–¹æ³•ä½¿ç”¨åˆ°ä½ï¼å‰å®³</p><h2 id="ç”¨æœ€å°‘æ•°é‡çš„ç®­å¼•çˆ†æ°”çƒ"><a href="#ç”¨æœ€å°‘æ•°é‡çš„ç®­å¼•çˆ†æ°”çƒ" class="headerlink" title="ç”¨æœ€å°‘æ•°é‡çš„ç®­å¼•çˆ†æ°”çƒ"></a>ç”¨æœ€å°‘æ•°é‡çš„ç®­å¼•çˆ†æ°”çƒ</h2><p>æ•°ç»„ç¬¬ä¸€ä¸ªæ•°ç»„è¿›è¡Œæ’åºï¼Œä»å°åˆ°å¤§ï¼›ä»ç»“å°¾å‡ºåˆ¤æ–­ï¼Œè‹¥ä¸‹é¢æœ‰æœ‰æ•°ç»„åœ¨è¿™ä¸ªåŒºé—´ï¼Œåˆ™å°†è¿™ä¸ªåŒºé—´ä¸€åŒåˆ å»ï¼ˆæˆ–è€…è¯´å¾€åéå†ï¼‰</p><p>æ€è·¯è·Ÿå¡å“¥ä¸€æ ·ï¼Œåªæ˜¯å®ç°æ˜¯ä¸ªé—®é¢˜</p><p>é¦–å…ˆæ˜¯æ’åºï¼ŒäºŒç»´æ•°ç»„ç»å…¸æ’åºï¼ˆä»å°åˆ°å¤§ï¼‰ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs java">Arrays.sort(points, (o1, o2) -&gt; Integer.compare(o1[<span class="hljs-number">0</span>], o2[<span class="hljs-number">0</span>]));<br></code></pre></td></tr></table></figure><p>å®ç°ï¼šä»1å¤„å¼€å§‹éå†ï¼Œåˆ¤æ–­ä¸Šä¸€ä¸ªçš„ç»“å°¾å’Œä¸‹ä¸€ä¸ªçš„å¼€å¤´æ˜¯å¦æœ‰äº¤é›†ï¼Œè‹¥æ— äº¤é›†ï¼Œç›´æ¥count++;è‹¥æœ‰äº¤é›†ï¼Œåˆ™æ›´æ–°ä¸‹ä¸€ä¸ªçš„å³è¾¹ç•Œï¼Œæ›´æ–°ä¸ºä¸Šä¸€ä¸ªå’Œä¸‹ä¸€ä¸ªçš„æœ€å°å€¼ï¼Œæœ€åè¿”å›ã€‚</p><h2 id="æ— é‡å åŒºé—´"><a href="#æ— é‡å åŒºé—´" class="headerlink" title="æ— é‡å åŒºé—´"></a>æ— é‡å åŒºé—´</h2><p>åˆæ­¥æ€è·¯ï¼šä»ç„¶æ˜¯æ’åºï¼Œä»å°åˆ°å¤§æ’åºï¼Œè‹¥æ˜¯å¼€ç«¯ç›¸åŒï¼Œåˆ™é»˜è®¤åˆ æ‰ç»“å°¾é•¿çš„é‚£ä¸ªæ•°ç»„ï¼›ç•™ä¸‹æ¥æ˜¯ä¸‹ä¸€ä¸ªçš„å¼€ç«¯å¤§äºç­‰äºä¸Šä¸€ä¸ªçš„ç»“å°¾ï¼›è‹¥æ˜¯ä¸‹ä¸€ä¸ªå¼€ç«¯å°äºä¸Šä¸€ä¸ªç»“å°¾ï¼Œè¯´æ˜æœ‰é‡å ï¼Œåˆ™ç›´æ¥æ›´æ–°ä¸‹ä¸€ä¸ªç»“å°¾ã€‚</p><p>è¯•äº†ä¸€ä¸‹ï¼Œæœç„¶æˆåŠŸäº†ã€‚</p><p>å¡å“¥æ€è·¯æ›´ç®€å•ï¼Œä¹Ÿæ›´åŠ å…¨é¢ã€‚åˆ†æŒ‰å·¦åŒºé—´æ’åºå’Œå³åŒºé—´æ’åºï¼›æˆ‘ä¸Šé¢çš„æ€è·¯å°±æ˜¯æŒ‰å·¦åŒºé—´è¿›è¡Œæ’åºçš„ï¼Œå¡å“¥ç”¨äº†ä¸€ä¸ªint preæ¥è®°å½•ä¸Šä¸€æ¬¡ç»“å°¾çš„æœ€å°å€¼ï¼Œæ¯æ¬¡éƒ½æ›´æ–°pre</p><h2 id="åˆ’åˆ†å­—æ¯åŒºé—´"><a href="#åˆ’åˆ†å­—æ¯åŒºé—´" class="headerlink" title="åˆ’åˆ†å­—æ¯åŒºé—´"></a>åˆ’åˆ†å­—æ¯åŒºé—´</h2><p>è‡ªå·±æ²¡æœ‰æ€è·¯ã€‚ã€‚</p><p>å¡å“¥æ€è·¯ï¼šæ€»å…±26ä¸ªå­—æ¯ï¼Œå…ˆæŠŠè¿™äº›å­—æ¯æœ€åå‡ºç°å­—æ¯å†™è¿›æ•°ç»„ï¼Œç„¶åå†éå†ä¸€æ¬¡å­—ç¬¦ä¸²ï¼Œæ¯æ¬¡æ›´æ–°æœ€å¤§å³è¾¹ç•Œï¼Œè‹¥å½“å‰ä½ç½®ç­‰äºå½“å‰å‡ºç°æœ€å¤§å€¼ï¼Œè¯´æ˜å·²ç»åˆ°äº†è¯¥åˆ’åˆ†çš„æ—¶å€™</p><p>è´ªå¿ƒï¼Œå¹¶æ²¡æœ‰ä½“ç°ï¼Œè‡³å°‘æˆ‘æƒ³è±¡ä¸å‡ºã€‚</p><p>å¼€æ‹“è§†é‡å§ã€‚ä½†æ˜¯å¾ˆç²¾å½©</p><h2 id="åˆå¹¶åŒºé—´"><a href="#åˆå¹¶åŒºé—´" class="headerlink" title="åˆå¹¶åŒºé—´"></a>åˆå¹¶åŒºé—´</h2><p>è²Œä¼¼ä¸éš¾</p><p>åˆæ­¥æ€è·¯ï¼šå¯¹å·¦è¾¹ç•Œè¿›è¡Œæ’åºï¼Œåªéœ€è¦åˆ¤æ–­å³è¾¹ç•Œæ˜¯å¦å¤§äºå·¦è¾¹ç•Œå³å¯</p><p>==é‡è¦ï¼š==</p><p>å®šä¹‰äºŒç»´æ•°ç»„ï¼š</p><p>List&lt;int[]&gt; res = new ArrayList&lt;&gt;();</p><p>listæ·»åŠ äºŒç»´æ•°ç»„ï¼š</p><p>res.add(new int[]{start, intervals[i - 1] [1]});</p><p>listè½¬äºŒç»´æ•°ç»„ï¼š</p><p>res.toArray(new int[res.size()] []);</p><blockquote><p>æ³¨æ„</p></blockquote><p>å¤„ç†çš„æ°¸è¿œæ˜¯ä¸Šä¸€å±‚çš„æœ«å°¾ï¼Œæ‰€ä»¥æœ€åè¦å•ç‹¬å¤„ç†ä¸€ä¸‹æœ€åä¸€å±‚</p><h2 id="å•è°ƒé€’å¢çš„æ•°å­—"><a href="#å•è°ƒé€’å¢çš„æ•°å­—" class="headerlink" title="å•è°ƒé€’å¢çš„æ•°å­—"></a>å•è°ƒé€’å¢çš„æ•°å­—</h2><p>æš´åŠ›è§£æ³•ï¼šå†™ä¸€ä¸ªåˆ¤æ–­æ˜¯å¦å•è°ƒé€’å¢çš„å‡½æ•°ï¼Œä»è¿™ä¸ªæ•°å¼€å§‹å¾€ä¸‹éå†ï¼Œæ‰¾åˆ°ä¸€ä¸ªç¬¦åˆçš„ç«‹åˆ»è¿”å›</p><p>ç»“æœè‡ªç„¶æ˜¯è¶…æ—¶ã€‚å“ˆå“ˆå“ˆå“ˆ</p><p>è´ªå¿ƒè§£æ³•ï¼šå±€éƒ¨æœ€ä¼˜ï¼šé¦–å…ˆè‹¥æ˜¯str[i - 1] &gt;  str[i]çš„è¯ï¼Œè¯æ˜å‰ä¸€ä½æ•°å¤§ï¼Œåˆ™å°†str[i-1]â€“,å¹¶è®©str[i] = 9ï¼Œè¿™æ ·å°±å¯ä¿è¯å±€éƒ¨æœ€å¤§ï¼›å…¨å±€æœ€ä¼˜ï¼šéå†ï¼Œå³å¯è¾¾åˆ°å…¨å±€æœ€ä¼˜ã€‚</p><p>é—®é¢˜åœ¨äºï¼Œæ˜¯ä»å‰å¾€åéå†è¿˜æ˜¯ä»åå¾€å‰éå†ã€‚å½“ç„¶æ˜¯ä»åå¾€å‰éå†ï¼Œå› ä¸ºä»å‰å¾€åéå†çš„æ—¶å€™ï¼Œæ¯”å¦‚332ï¼Œ  332 -&gt; 329ï¼ŒOutã€‚ä»åå¾€å‰éå†ï¼Œ332 -&gt; 329 -&gt; 299</p><p>æœ¬é¢˜ç”¨åˆ°çš„javaæ–¹æ³•</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-comment">// æ•´å½¢è½¬string</span><br><span class="hljs-type">String</span> <span class="hljs-variable">s</span> <span class="hljs-operator">=</span> String.valueOf(n);<br><span class="hljs-comment">// å­—ç¬¦ä¸²è½¬å­—ç¬¦æ•°ç»„</span><br><span class="hljs-type">char</span>[] chars = s.toCharArray();<br><span class="hljs-comment">// å…ˆè½¬å­—ç¬¦ä¸²å†è½¬æ•´å½¢</span><br>Integer.parseInt(String.valueOf(chars));<br></code></pre></td></tr></table></figure><p>ä»¥ä¸‹éƒ½å¯è½¬string</p><p><img src="/2022/09/16/tan-xin-suan-fa/Typoraæ–‡ä»¶\Typoraå›¾ç‰‡\image-20220621143453592.png" alt="image-20220621143453592"></p><h2 id="ä¹°å–è‚¡ç¥¨çš„æœ€ä½³æ—¶æœºï¼ˆå«æ‰‹ç»­è´¹ï¼‰"><a href="#ä¹°å–è‚¡ç¥¨çš„æœ€ä½³æ—¶æœºï¼ˆå«æ‰‹ç»­è´¹ï¼‰" class="headerlink" title="ä¹°å–è‚¡ç¥¨çš„æœ€ä½³æ—¶æœºï¼ˆå«æ‰‹ç»­è´¹ï¼‰"></a>ä¹°å–è‚¡ç¥¨çš„æœ€ä½³æ—¶æœºï¼ˆå«æ‰‹ç»­è´¹ï¼‰</h2><p>åˆæ­¥æ€è·¯ï¼šé‡åˆ°æå°å€¼çš„å°±ä¹°å…¥ï¼Œé‡åˆ°æå¤§å€¼å°±å–å‡º</p><p>å½“ç„¶ä¹Ÿå¯èƒ½æœ‰é—®é¢˜</p><p>å¡å“¥æ€è·¯ï¼šä¸éœ€è¦è®¡ç®—å…·ä½“æ—¶é—´ï¼Œåªéœ€è¦è®¡ç®—è¿ç»­æ”¶è·åˆ©æ¶¦å³å¯</p><p>è®¡ç®—æ”¶è·åˆ©æ¶¦æ—¶ï¼š</p><ol><li>æ”¶è·åˆ©æ¶¦è¿™ä¸€å¤©å¹¶ä¸æ˜¯æœ€ç»ˆæ”¶è·åˆ©æ¶¦çš„é‚£ä¸€å¤©</li><li>å‰ä¸€å¤©æ˜¯æœ€ç»ˆæ”¶è·åˆ©æ¶¦é‚£ä¸€å¤©ï¼Œä»Šå¤©é‡æ–°è®¡ç®—</li><li>ä¸ä½œæ“ä½œï¼Œä¸ä¹°ä¸å–</li></ol><p>å¾ˆå·§å¦™</p><p>æ¯æ¬¡æ‰§è¡Œæ“ä½œæ—¶éƒ½åŠ ä¸Šfeeï¼Œåˆå§‹åŒ–ä¸€ä¸ªbuyï¼Œéå†æ•°ç»„ï¼Œè‹¥æ˜¯é‡åˆ°p + fee &lt; buyçš„ï¼Œå¦buyé‡ç½®ä¸ºp + feeï¼Œè¯´æ˜éœ€è¦ä¹°å…¥ï¼›è‹¥æ˜¯é‡åˆ°p &gt; buyçš„ï¼Œè¯´æ˜æœ‰åˆ©æ¶¦ï¼Œç›´æ¥åŠ åˆ°sumé‡Œï¼Œå¹¶é‡ç½®buy = pï¼›å…¶ä»–çš„æƒ…å†µå¯ä»¥ä¸ç®¡ã€‚</p><p>ä½†å…¶å®æœ¬é¢˜ç”¨åŠ¨æ€è§„åˆ’æ›´å¥½ä¸€ç‚¹</p><h2 id="ç›‘æ§äºŒå‰æ ‘"><a href="#ç›‘æ§äºŒå‰æ ‘" class="headerlink" title="ç›‘æ§äºŒå‰æ ‘"></a>ç›‘æ§äºŒå‰æ ‘</h2><p>ä¸ªäººæƒ³æ³•ï¼šå¯ä»¥å‘ç°ï¼Œæ¯ä¸‰å±‚å¿…æœ‰ä¸€ä¸ªç›‘æ§ï¼Œåœ¨ç¬¬äºŒå±‚è®¾ç½®ç›‘æ§å³å¯ã€‚å¦å¤–å†è®¾ç½®ä¸€ä¸ªæ•°ç»„ï¼Œç”¨æ¥æ ‡è®°æ˜¯å¦å·²ç»ç›‘æ§ï¼Œè¿ç»­ä¸¤å±‚å¿…æœ‰ç›‘æ§ã€‚</p><p>ç»†èŠ‚ï¼šä½†æ˜¯è®¾ç½®æ ‡è®°æ•°ç»„çš„è¯ï¼Œéœ€è¦çŸ¥é“æ ‘çš„å…¨éƒ¨å­èŠ‚ç‚¹ï¼Œä¸æ˜“å®ç°ã€‚</p><p>å¡å“¥æ€è·¯ï¼šä»ä¸‹åˆ°ä¸Šï¼Œä»æœ€ä¸‹é¢çš„å¶å­ç»“ç‚¹å¼€å§‹ï¼Œå¯¹å¶å­ç»“ç‚¹çš„çˆ¶èŠ‚ç‚¹è®¾ç½®ç›‘æ§ã€‚å±€éƒ¨æœ€ä¼˜ï¼šä»å¶èŠ‚ç‚¹çš„çˆ¶èŠ‚ç‚¹å¼€å§‹è®¾ç½®ç›‘æ§ï¼›å…¨å±€æœ€ä¼˜ï¼šä½¿ç”¨çš„æ‘„åƒå¤´æœ€å°‘</p><p>éš¾ç‚¹ï¼š</p><p>å¦‚ä½•éå†æ ‘</p><p>å¦‚ä½•éš”ä¸¤ä¸ªèŠ‚ç‚¹æ”¾ç½®ç›‘æ§</p><ol><li><p>å¦‚ä½•éå†æ ‘<br>ä½¿ç”¨ååºéå†</p></li><li><p>å¦‚ä½•éš”ä¸¤ä¸ªèŠ‚ç‚¹æ”¾ç½®ç›‘æ§<br>æ¯ä¸ªèŠ‚ç‚¹ä¸‰ä¸ªçŠ¶æ€ï¼š</p><ul><li>0   æ— è¦†ç›–</li><li>1   æœ‰æ‘„åƒå¤´</li><li>2   æœ‰è¦†ç›–</li></ul><p>å•å±‚å¤„ç†é€»è¾‘å››ç§æƒ…å†µï¼š</p><ul><li>å·¦å³å­©å­éƒ½æœ‰è¦†ç›–<br>åˆ™ä¸­é—´èŠ‚ç‚¹è‚¯å®šæ— è¦†ç›–</li><li>å·¦å³å­©å­è‡³å°‘æœ‰ä¸€ä¸ªæ— è¦†ç›–<br>ä¸­é—´èŠ‚ç‚¹åº”æ”¾ç½®æ‘„åƒå¤´</li><li>å·¦å³èŠ‚ç‚¹è‡³å°‘æœ‰ä¸€ä¸ªæ‘„åƒå¤´</li><li>å¤„ç†å¤´ç»“ç‚¹</li></ul></li></ol><p>æ€»çš„æ¥è¯´ï¼Œä¸€å…±å°±é‚£å‡ ç§æƒ…å†µã€‚</p><p>å…ˆåˆ¤æ–­å·¦å³å­©å­æ˜¯å¦è‡³å°‘æœ‰ä¸€ä¸ªæ— è¦†ç›–ï¼Œæœ‰åˆ™ç›´æ¥æ”¾ç½®ä¸€ä¸ªæ‘„åƒå¤´ï¼›å†åˆ¤æ–­å·¦å³å­©å­æ˜¯å¦éƒ½æ˜¯æœ‰è¦†ç›–ï¼Œè‹¥å…¨éƒ½æœ‰è¦†ç›–ï¼Œåˆ™ä¸­é—´èŠ‚ç‚¹å¿…å®šæ˜¯æ— è¦†ç›–ï¼›å‰©ä¸‹æƒ…å†µç›´æ¥è¿”å›æœ‰è¦†ç›–ã€‚</p><p>è¿™æ˜¯ä¸€é“Hardé¢˜ï¼Œ==ä»”ç»†æ£æ‘©==ã€‚</p>]]></content>
    
    
    <categories>
      
      <category>ç®—æ³•</category>
      
    </categories>
    
    
    <tags>
      
      <tag>java</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>å›æº¯ç®—æ³•</title>
    <link href="/2022/09/16/hui-su-suan-fa/"/>
    <url>/2022/09/16/hui-su-suan-fa/</url>
    
    <content type="html"><![CDATA[<h1 id="å›æº¯ç®—æ³•"><a href="#å›æº¯ç®—æ³•" class="headerlink" title="å›æº¯ç®—æ³•"></a>å›æº¯ç®—æ³•</h1><p>å›æº¯é€šå¸¸éšè—åœ¨é€’å½’å‡½æ•°çš„ä¸‹é¢</p><p>==forå¾ªç¯æ¨ªå‘éå†ï¼Œé€’å½’çºµå‘éå†==</p><p>å›æº¯æ³•æ˜¯ä¸€ä¸ªçº¯æš´åŠ›æœç´¢ï¼Œå¹¶ä¸æ˜¯é«˜æ•ˆçš„ç®—æ³•</p><p>é€‚ç”¨äºï¼š</p><ol><li>ç»„åˆé—®é¢˜</li><li>åˆ‡å‰²é—®é¢˜</li><li>å­é›†é—®é¢˜</li><li>æ’åˆ—é—®é¢˜</li><li>æ£‹ç›˜é—®é¢˜</li></ol><p>å›æº¯æ³•å¯ä»¥æŠ½è±¡ä¸ºä¸€ä¸ªæ ‘å½¢ç»“æ„ï¼ˆnå‰æ ‘ï¼‰</p><h2 id="å›æº¯æ³•æ¨¡æ¿"><a href="#å›æº¯æ³•æ¨¡æ¿" class="headerlink" title="å›æº¯æ³•æ¨¡æ¿"></a>å›æº¯æ³•æ¨¡æ¿</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">void</span> <span class="hljs-title function_">backtracking</span><span class="hljs-params">(å‚æ•°)</span> &#123;<br>    <span class="hljs-keyword">if</span> (ç»ˆæ­¢æ¡ä»¶) &#123;<br>        å­˜æ”¾ç»“æœ;<br>        <span class="hljs-keyword">return</span>;<br>    &#125;<br>    <br>    <span class="hljs-keyword">for</span> (é€‰æ‹©ï¼šæœ¬å±‚é›†åˆä¸­å…ƒç´ (æ ‘ä¸­ç»“ç‚¹å­©å­çš„æ•°é‡å°±æ˜¯é›†åˆçš„å¤§å°)) &#123;<br>        å¤„ç†ç»“ç‚¹;<br>        backtracking(è·¯å¾„ï¼Œ é€‰æ‹©åˆ—è¡¨);   <span class="hljs-comment">// é€’å½’</span><br>        å›æº¯ï¼Œæ’¤é”€å¤„ç†ç»“æœ<br>    &#125;<br>        <br>&#125;<br></code></pre></td></tr></table></figure><h2 id="ç»„åˆ"><a href="#ç»„åˆ" class="headerlink" title="ç»„åˆ"></a>ç»„åˆ</h2><p><img src="/2022/09/16/hui-su-suan-fa/Typoraæ–‡ä»¶\Typoraå›¾ç‰‡\image-20220607093535686.png" alt="image-20220607093535686"></p><h2 id="ç»„åˆæ€»æ•°III"><a href="#ç»„åˆæ€»æ•°III" class="headerlink" title="ç»„åˆæ€»æ•°III"></a>ç»„åˆæ€»æ•°III</h2><ol><li>ä¸¤ä¸ªå…¨å±€å˜é‡<br>List&lt;&gt; path;    List&lt;List&lt;&gt;&gt; res;<br>å››ä¸ªå‚æ•°<br>n, k, index, sum</li><li>ç»ˆæ­¢æ¡ä»¶<br>å€¼æ€»å’Œç›¸ç­‰</li><li>å•å±‚å¤„ç†é€»è¾‘<br>å›æº¯</li></ol><p>å‰ªææ“ä½œï¼š</p><ol><li>å·²ç»é€‰æ‹©çš„å…ƒç´ ä¸ªæ•°ï¼špath.size();</li><li>è¿˜éœ€è¦çš„å…ƒç´ ä¸ªæ•°ä¸º: k - path.size();</li><li>åœ¨é›†åˆnä¸­è‡³å¤šè¦ä»è¯¥èµ·å§‹ä½ç½® : n - (k - path.size()) + 1ï¼Œå¼€å§‹éå†</li></ol><h2 id="ç”µè¯å·ç çš„å­—æ¯ç»„åˆ"><a href="#ç”µè¯å·ç çš„å­—æ¯ç»„åˆ" class="headerlink" title="ç”µè¯å·ç çš„å­—æ¯ç»„åˆ"></a>ç”µè¯å·ç çš„å­—æ¯ç»„åˆ</h2><p>æœ¬é¢˜çš„éš¾ç‚¹åœ¨äºï¼šå¦‚ä½•å°†æ•°å­—ä¸å­—æ¯ç›¸å¯¹åº”ï¼Ÿ</p><p>å¯ä»¥ç”¨ä¸€ä¸ªäºŒç»´æ•°ç»„ï¼Œå°†æ•°å­—ä¸å­—æ¯ä½ç½®å†™æ­»ï¼Œéœ€è¦æ—¶å¯ç›´æ¥å–å‡ºæ¥ï¼›</p><p>è¿˜æ˜¯é€’å½’è€ä¸‰éƒ¨ï¼š</p><ol><li>ç¡®å®šé€’å½’å‚æ•°</li><li>ç¡®å®šç»ˆæ­¢æ¡ä»¶</li><li>ç¡®å®šå•å±‚å¤„ç†é€»è¾‘</li></ol><p>æœ¬é¢˜è²Œä¼¼æ— æ³•å‰ªæã€‚</p><p>è¦è¿›è¡Œå­—ç¬¦ä¸²çš„å¢åŠ æˆ–è€…åˆ é™¤æ—¶ï¼Œå¯ä»¥ä½¿ç”¨StringBuilderï¼Œå…¶ä¸­å¢åŠ ç”¨appendï¼Œåˆ é™¤ç”¨deleteCharAt()ï¼Œæœ€åè½¬ä¸ºString å¯ä»¥ç”¨sb.toString()ã€‚</p><h2 id="ç»„åˆæ€»å’Œ"><a href="#ç»„åˆæ€»å’Œ" class="headerlink" title="ç»„åˆæ€»å’Œ"></a>ç»„åˆæ€»å’Œ</h2><p>ä¾ç„¶æ˜¯é€’å½’ä¸‰éƒ¨æ›²</p><p>åªæ˜¯è¿™é“é¢˜ä¸ä¹‹å‰çš„å‡ é“é¢˜çš„åŒºåˆ«åœ¨äºï¼Œè¿™é“é¢˜å¯ä»¥é‡å¤ä½¿ç”¨æ•°å­—ï¼Œå¹¶ä¸”æ²¡æœ‰é™å®šæœ‰å‡ ä¸ªæ•°ï¼›</p><p>é¦–å…ˆå¯¹æ•°ç»„å…ƒç´ è¿›è¡Œæ’åºï¼›è§£å†³é‡å¤ä½¿ç”¨æ•°å­—ï¼Œä½¿ç”¨ä¸€ä¸ªindexï¼Œindexç”¨æ¥å®šä½ï¼Œä»¥å‰çš„ä¸å¯é‡å¤é€’å½’çš„æ—¶å€™æ˜¯index+1ï¼Œå¯é‡å¤çš„è¯å°±æ˜¯indexï¼›è§£å†³æ²¡æœ‰é™å®šå‡ ä¸ªæ•°ï¼Œå¯ä»¥ç”¨sumæ˜¯å¦å¤§äºtargetæ¥åˆ¤æ–­</p><h2 id="ç»„åˆæ€»å’ŒII"><a href="#ç»„åˆæ€»å’ŒII" class="headerlink" title="ç»„åˆæ€»å’ŒII"></a>ç»„åˆæ€»å’ŒII</h2><p>éš¾ç‚¹åœ¨äºï¼Œæ¯ä¸ªæ•°å­—åœ¨ç»„åˆä¸­åªèƒ½ä½¿ç”¨ä¸€æ¬¡ï¼Œ==ä½†æ˜¯==ï¼Œä¼šå‡ºç°é‡å¤çš„ã€‚</p><p>æ¯”å¦‚[1,1,2],target = 3,       å¤„ç†ä¸å¥½çš„è¯[1,2],[1,2]ä¼šå‡ºç°ä¸¤æ¬¡ï¼Œå°±éœ€è¦å»é‡ã€‚å›æº¯å»é‡æœ‰ä¸¤ç§å»é‡ï¼Œä¸€ç§æ˜¯æ ‘æå»é‡ï¼Œå¦ä¸€ç§æ˜¯æ ‘å±‚å»é‡ã€‚</p><p>å¯¹äºæœ¬é¢˜æ¥è¯´ï¼Œæ ‘ææ˜¯å¯ä»¥é‡å¤çš„ï¼Œå› ä¸ºäººå®¶æœ¬æ¥å°±æœ‰é‡å¤çš„å…ƒç´ ï¼›æ ‘å±‚æ˜¯ä¸å¯ä»¥é‡å¤çš„ã€‚</p><p>æœ‰å¦‚ä¸‹==ä¸¤ç§åŠæ³•å»é‡==ï¼š</p><ol><li><p>ä½¿ç”¨æ•°ç»„æ ‡è®°<br>å…ˆåˆ¤æ–­ï¼Œè‹¥i &gt; 0å¹¶ä¸”æœ¬æ¬¡éå†å…ƒç´ ä¸ä¸Šä¸€ä¸ªå…ƒç´ ç›¸åŒï¼ŒåŒæ—¶æ ‡è®°æ•°ç»„ä¸ºfalseï¼Œåˆ™è¡¨æ˜ä¸ºæ ‘å±‚é‡å¤ï¼Œåº”è¯¥å»æ‰ï¼Œç›´æ¥continueï¼›<br>è§£é‡Šä¸€ä¸‹æ ‡è®°æ•°ç»„ï¼Œè‹¥å·²ç»ä½¿ç”¨è¿‡ï¼Œåˆ™å°†æ ‡è®°æ•°ç»„ç½®ä¸º1ï¼Œstatus[i - 1] == 0ä»£è¡¨i-1ä¸ªå…ƒç´ æ²¡æœ‰ä½¿ç”¨è¿‡<br>é‚£ä¹ˆè‚¯å®šï¼Œè‹¥i-1æ²¡æœ‰ä½¿ç”¨è¿‡ï¼Œåˆ™æœ¬æ¬¡é‡å¤ä¸ºæ ‘å±‚é‡å¤ï¼›è‹¥i-1å·²ä½¿ç”¨è¿‡ï¼Œåˆ™ä»£è¡¨å·²ç»ä½¿ç”¨è¿‡ï¼Œä¸ºæ ‘æé‡å¤</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">if</span> (i &gt; <span class="hljs-number">0</span> &amp;&amp; candidates[i] == candidates[i - <span class="hljs-number">1</span>] &amp;&amp; status[i - <span class="hljs-number">1</span>] == <span class="hljs-number">0</span>)       <br><span class="hljs-keyword">continue</span>;<br></code></pre></td></tr></table></figure></li><li><p>ä¸ä½¿ç”¨æ•°ç»„æ ‡è®°<br>å¾ˆç®€å•ï¼Œè‹¥æ˜¯æœ¬æ¬¡ä¸ä¸Šä¸€ä¸ªç›¸ç­‰ï¼Œåˆ™å°±æ˜¯æ ‘å±‚é‡å¤</p></li></ol>   <figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">if</span> ( i &gt; start &amp;&amp; candidates[i] == candidates[i - <span class="hljs-number">1</span>] ) &#123;<br><span class="hljs-keyword">continue</span>;<br>&#125;<br></code></pre></td></tr></table></figure><h2 id="åˆ†å‰²å›æ–‡ä¸²"><a href="#åˆ†å‰²å›æ–‡ä¸²" class="headerlink" title="åˆ†å‰²å›æ–‡ä¸²"></a>åˆ†å‰²å›æ–‡ä¸²</h2><ul><li>ç»„åˆé—®é¢˜ï¼šé€‰å–ä¸€ä¸ªaä¹‹åï¼Œåœ¨bcdefä¸­å†å»é€‰å–ç¬¬äºŒä¸ªï¼Œé€‰å–bä¹‹ååœ¨cdefä¸­åœ¨é€‰ç»„ç¬¬ä¸‰ä¸ªâ€¦..ã€‚</li><li>åˆ‡å‰²é—®é¢˜ï¼šåˆ‡å‰²ä¸€ä¸ªaä¹‹åï¼Œåœ¨bcdefä¸­å†å»åˆ‡å‰²ç¬¬äºŒæ®µï¼Œåˆ‡å‰²bä¹‹ååœ¨cdefä¸­åœ¨åˆ‡å‰²ç¬¬ä¸‰æ®µâ€¦..ã€‚</li></ul><p>äº¦å¯ä»¥æŠ½è±¡ä¸ºä¸€é¢—æ ‘å½¢ç»“æ„</p><p><img src="/2022/09/16/hui-su-suan-fa/Typoraæ–‡ä»¶\Typoraå›¾ç‰‡\image-20220610103125075.png" alt="image-20220610103125075"></p><p>éš¾ç‚¹ï¼š</p><ul><li>åˆ‡å‰²é—®é¢˜å¯ä»¥æŠ½è±¡ä¸ºç»„åˆé—®é¢˜</li><li>å¦‚ä½•æ¨¡æ‹Ÿé‚£äº›åˆ‡å‰²çº¿<br>ç”¨indexæ¥å®šä½</li><li>åˆ‡å‰²é—®é¢˜ä¸­é€’å½’å¦‚ä½•ç»ˆæ­¢<br>è‹¥indexå¤§äºs.length()ï¼Œåˆ™åŠ å…¥ç»“æœå¹¶è¿”å›</li><li>åœ¨é€’å½’å¾ªç¯ä¸­å¦‚ä½•æˆªå–å­ä¸²<br>ç”¨s.substring()</li><li>å¦‚ä½•åˆ¤æ–­å›æ–‡<br>å›æ–‡å¥½è§£å†³ï¼Œç”¨åŒæŒ‡é’ˆè§£å†³</li></ul><h2 id="å¤åŸIPåœ°å€"><a href="#å¤åŸIPåœ°å€" class="headerlink" title="å¤åŸIPåœ°å€"></a>å¤åŸIPåœ°å€</h2><p>substring() å‰é—­åå¼€</p><p>==åšè¿™ç±»å‹é¢˜ï¼Œä¸€å®šæ³¨æ„åŒºé—´æ˜¯å¼€è¿˜æ˜¯é—­ï¼ï¼ï¼==</p><p>æ€è·¯ä¸€ï¼š</p><p>æœ¬é¢˜å¯ç›´æ¥å¯¹åŸå­—ç¬¦ä¸²sè¿›è¡Œæ“ä½œï¼Œå› ä¸ºåç»­ä¼šæœ‰å›æº¯æ“ä½œ</p><p>éœ€è¦å†™ä¸€ä¸ªåˆ¤æ–­æ˜¯å¦æœ‰æ•ˆçš„å‡½æ•°ï¼Œæ€è·¯ä¸ºï¼šå®šä¹‰ä¸€ä¸ªsum,ä»¤sum = sum * 10 + s.charAt(i) - â€˜0â€™;å³å¯æ±‚å‡ºæ•°å€¼ï¼Œç„¶ååˆ¤æ–­æ˜¯å¦å¤§äº255å³å¯</p><p>è¿˜æœ‰ä¸€ä¸ªå‘ï¼šå› ä¸ºè¦è¾“å‡ºipçš„æ—¶å€™ipåœ°å€ä¸­é—´æœ‰â€™.â€™ï¼Œæ‰€ä»¥è¿›è¡Œé€’å½’çš„æ—¶å€™ç›´æ¥i + 2,ä¾‹å¦‚ï¼šbacktracking(s, i + 2, pointsum);</p><p>åŒæ—¶ï¼Œæœ¬é¢˜ä¸å…¶ä»–çš„å›æº¯ä¸åŒçš„æ˜¯ï¼Œæœ¬é¢˜å¤„ç†å•å±‚é€»è¾‘æ—¶ï¼Œè‹¥æ˜¯å‘ç°æ•°å­—ä¸æ˜¯æœ‰æ•ˆæ•°å­—ï¼Œåˆ™ç›´æ¥è·³å‡ºï¼Œè€Œä¸æ˜¯continueï¼›</p><p>æ€è·¯äºŒ:</p><p>å‰ªææ“ä½œï¼Œå›æº¯å‡½æ•°å‚æ•°é™„å¸¦ä¸€ä¸ªindexï¼Œä»¥åŠä¸€ä¸ªnumberï¼Œä»£è¡¨å½“å‰çš„ipæ®µï¼Œä¸€å…±æœ‰å››æ®µ</p><p>ç»ˆæ­¢æ¡ä»¶ï¼šå¦‚æœindex == å­—ç¬¦ä¸²é•¿åº¦ï¼Œ å¹¶ä¸”number == 4ï¼Œ åˆ™æ˜¯æ­£ç¡®çš„ï¼Œæ·»åŠ è¿›reså¹¶è¿”å›ï¼Œå¦åˆ™ç›´æ¥è¿”å›</p><p>å•å±‚æ“ä½œï¼šé‡ç‚¹åœ¨forå¾ªç¯çš„ç¬¬äºŒä¸ªæ¡ä»¶ï¼Œåœ¨ç¬¬äºŒä¸ªæ¡ä»¶é‡Œå°±åˆ¤æ–­æ˜¯å¦æœ‰æ•ˆï¼Œè€Œä¸åƒæ€è·¯ä¸€é‚£æ ·å¦å†™ä¸€ä¸ªæ–¹æ³•</p><p>==Integer.parseInt(s.substring(start, i + 1)) &gt;= 0 &amp;&amp; Integer.parseInt(s.substring(start, i + 1)) &lt;= 255ï¼›==</p><p>ï¼ˆè‹¥æ˜¯é¢è¯•åä¸ºé¸¿è’™çš„æ—¶å€™çŸ¥é“è¿™ä¸ªï¼Œè¯´ä¸å®šå†™å‡ºæ¥äº†å‘¢ï¼Ÿï¼‰</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> <span class="hljs-variable">i</span> <span class="hljs-operator">=</span> start; i &lt; s.length() &amp;&amp; i - start &lt; <span class="hljs-number">3</span> &amp;&amp; Integer.parseInt(s.substring(start, i + <span class="hljs-number">1</span>)) &gt;= <span class="hljs-number">0</span><br>&amp;&amp; Integer.parseInt(s.substring(start, i + <span class="hljs-number">1</span>)) &lt;= <span class="hljs-number">255</span>; i++) &#123;<br><span class="hljs-comment">// å¦‚æœipæ®µçš„é•¿åº¦å¤§äº1ï¼Œå¹¶ä¸”ç¬¬ä¸€ä½ä¸º0çš„è¯ï¼Œcontinue</span><br>    <span class="hljs-comment">// ä¹Ÿå°±æ˜¯è¯´ï¼Œ0åœ¨ç¬¬äºŒä½æˆ–è€…ç¬¬ä¸‰ä½ï¼Œåæ­£ä¸åœ¨ç¬¬ä¸€ä½ï¼Œåˆ™ä»¤i++</span><br><span class="hljs-keyword">if</span> (i + <span class="hljs-number">1</span> - start &gt; <span class="hljs-number">1</span> &amp;&amp; s.charAt(start) - <span class="hljs-string">&#x27;0&#x27;</span> == <span class="hljs-number">0</span>) &#123;<br><span class="hljs-keyword">continue</span>;<br>&#125;<br>stringBuilder.append(s.substring(start, i + <span class="hljs-number">1</span>));<br><span class="hljs-comment">// å½“stringBuilderé‡Œçš„ç½‘æ®µæ•°é‡å°äº3æ—¶ï¼Œæ‰ä¼šåŠ ç‚¹ï¼›å¦‚æœç­‰äº3ï¼Œè¯´æ˜å·²ç»æœ‰3æ®µäº†ï¼Œæœ€åä¸€æ®µä¸éœ€è¦å†åŠ ç‚¹</span><br><span class="hljs-keyword">if</span> (number &lt; <span class="hljs-number">3</span>) &#123;<br>stringBuilder.append(<span class="hljs-string">&quot;.&quot;</span>);<br>&#125;<br>number++;<br>restoreIpAddressesHandler(s, i + <span class="hljs-number">1</span>, number);<br>number--;<br><span class="hljs-comment">// åˆ é™¤å½“å‰stringBuilderæœ€åä¸€ä¸ªç½‘æ®µï¼Œæ³¨æ„è€ƒè™‘ç‚¹çš„æ•°é‡çš„é—®é¢˜</span><br>stringBuilder.delete(start + number, i + number + <span class="hljs-number">2</span>);<br>&#125;<br></code></pre></td></tr></table></figure><h2 id="å­é›†"><a href="#å­é›†" class="headerlink" title="å­é›†"></a>å­é›†</h2><p>éš¾ç‚¹åœ¨äºï¼šæ ‘æä¸Šçš„å­èŠ‚ç‚¹éšæ—¶å¯ä»¥åœä¸‹</p><p>ä¸ªäººæ€è·¯ï¼šéå†ä¸€ä¸ªï¼Œå°±æŠŠè¿™ä¸ªåŠ å…¥è¿›å»ï¼Œç¢°åˆ°æœ€å¤§æ•°å³è¿”å›ï¼›æ‰€ä»¥å¯èƒ½è¦æ’åºï¼Ÿ</p><p>ï¼Ÿï¼Ÿï¼Ÿç«Ÿç„¶é€šè¿‡äº†ï¼Œç¥å¥‡ï¼ç»†èŠ‚æˆ‘è¿˜æ²¡æœ‰æ‰£</p><hr><p>æ­£ç¡®è§£æ³•ï¼š</p><p><img src="/2022/09/16/hui-su-suan-fa/Typoraæ–‡ä»¶\Typoraå›¾ç‰‡\image-20220610151529520.png" alt="image-20220610151529520"></p><p>ç‰›ï¼</p><p>æœ¬é¢˜çš„res.add()ä½ç½®å°±ç›¸å½“æœ‰è®²ç©¶äº†</p><p>åº”è¯¥æ”¾åœ¨å›æº¯çš„å¼€å¤´ï¼Œä¸ºä½•ï¼Ÿå› ä¸ºæ”¾åœ¨å¼€å¤´ä¼šæœ‰[]ç©ºè¿™ä¸ªå­é›†ï¼Œå¦åˆ™å°±å°‘äº†ä¸€ä¸ªå­é›†</p><p>ä½†æ˜¯ä¸ºä»€ä¹ˆä¸éœ€è¦æ’åºï¼Ÿæ˜¯å› ä¸ºnums[i]å°±å·²ç»ç¡®å®šç›¸å¯¹ä½ç½®äº†ï¼Œforå¾ªç¯ä»0å¼€å§‹ï¼Œè€Œnum[]ä¸å˜ï¼Œå°±ç›¸å½“äºä¸€ç›´å¾€åéå†ã€‚è¿™å—æœ‰ç‚¹ç»•ï¼Œä½†ç²¾å½©</p><h2 id="å­é›†II"><a href="#å­é›†II" class="headerlink" title="å­é›†II"></a>å­é›†II</h2><p>è¿™ä¸ªæ€»è¦æ’åºäº†å§ï¼Ÿ</p><p>è¿™ä¸ªè¦ä¸æ’åºçš„è¯ï¼Œé‚£ä¹ˆé‡å¤å…ƒç´ æ€ä¹ˆè§£å†³ã€‚</p><p><em>å€’æ˜¯æœ‰ä¸€ç§è§£å†³åŠæ³•ï¼Œè‹¥è¿™ä¸ªå…ƒç´ ä¸ä¸Šä¸ªå…ƒç´ ç›¸ç­‰ï¼Œåˆ™continueï¼›</em>      ==è§£å†³ä¸äº†==    å¿…é¡»è¦æ’åºï¼Œè¦ä¹ˆæ’åºï¼Œè¦ä¹ˆæ–°å»ºä¸€ä¸ªusedæ•°ç»„</p><p>çœ‹äº†ä¸€çœ¼ï¼Œæœç„¶ï¼Œæ˜¯æ ‘å±‚å»é‡</p><p>Yes!!!!!!!                                   å‰å®³å‰å®³</p><h2 id="é€’å¢å­åºåˆ—"><a href="#é€’å¢å­åºåˆ—" class="headerlink" title="é€’å¢å­åºåˆ—"></a>é€’å¢å­åºåˆ—</h2><p>æœ¬é¢˜å»é‡</p><p><img src="/2022/09/16/hui-su-suan-fa/Typoraæ–‡ä»¶\Typoraå›¾ç‰‡\image-20220613104412019.png" alt="image-20220613104412019"></p><p>æ˜è¿‡äº† å¤´ï¼Œæ‰§è¡Œä»£ç ä¸€ç›´æ˜¾ç¤ºè¶…å‡ºæ—¶é—´é™åˆ¶ï¼ŒåŸå› æ˜¯å› ä¸ºç²—å¿ƒå¤§æ„è€Œå†™äº†ä¸ªæ­»å¾ªç¯</p><p>map.getOrDefault(nums[i], 0)    å‰å®³ï¼ˆæˆ‘åªä¼šè¯´å‰å®³å—?ï¼‰</p><p>è¯ç©·</p><h2 id="å…¨æ’åˆ—"><a href="#å…¨æ’åˆ—" class="headerlink" title="å…¨æ’åˆ—"></a>å…¨æ’åˆ—</h2><p>æ’åˆ—é—®é¢˜ä¸ç»„åˆé—®é¢˜ä¸åŒï¼Œç»„åˆé—®é¢˜éœ€è¦ä¸€ä¸ªindexæ¥ç¡®å®šéå†çš„ä½ç½®ï¼Œè€Œæ’åˆ—ä¸åŒï¼Œå› ä¸º[2,1]å’Œ[1,2]æ˜¯ä¸åŒçš„ï¼Œæ— æ³•ä½¿ç”¨indexï¼Œä½†æ˜¯è¦ä½¿ç”¨ä¸€ä¸ªusedæ•°ç»„ï¼Œæˆ–è€…å…¶ä»–çš„mapç­‰ï¼Œç”¨æ¥è®°å½•æ˜¯å¦å·²ä½¿ç”¨è¿‡</p><p>è¿˜æ˜¯é€’å½’ä¸‰éƒ¨æ›²</p><p>å‚æ•°ä¸åŒï¼Œä¸éœ€è¦indexï¼ŒåŒæ—¶å¯ä»¥å®šä¹‰ä¸€ä¸ªå…¨å±€å˜é‡ï¼Œè¿™æ ·å°±ä¸éœ€è¦ä¼ å‚äº†ã€‚</p><h2 id="å…¨æ’åˆ—II"><a href="#å…¨æ’åˆ—II" class="headerlink" title="å…¨æ’åˆ—II"></a>å…¨æ’åˆ—II</h2><p>å»é‡çš„æ—¶å€™ï¼Œæˆ–è€…å‰ªæçš„æ—¶å€™</p><p>éå¸¸é‡è¦ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-comment">// used[i - 1] == trueï¼Œè¯´æ˜åŒä¸€æ ‘ænums[i - 1]ä½¿ç”¨è¿‡</span><br><span class="hljs-comment">// used[i - 1] == falseï¼Œè¯´æ˜åŒä¸€æ ‘å±‚nums[i - 1]ä½¿ç”¨è¿‡</span><br></code></pre></td></tr></table></figure><p>æ ‘æå»é‡å’Œæ ‘å±‚å»é‡ï¼›ä¸ºä»€ä¹ˆä¸åˆ¤æ–­user[i]è€Œè¦åˆ¤æ–­user[i - 1]å‘¢ï¼Œå› ä¸ºå·²ç»åˆ°äº†iè¿™ä¸€å±‚ï¼Œé‚£ä¹ˆi-1å°±ä¸€å®šå·²ç»å¤„ç†è¿‡äº†</p><p>å…¶ä½™è¿˜æ˜¯é€’å½’ä¸‰éƒ¨æ›²</p><h2 id="é‡æ–°å®‰æ’è¡Œç¨‹ï¼ˆé‡è¦ï¼‰"><a href="#é‡æ–°å®‰æ’è¡Œç¨‹ï¼ˆé‡è¦ï¼‰" class="headerlink" title="é‡æ–°å®‰æ’è¡Œç¨‹ï¼ˆé‡è¦ï¼‰"></a>é‡æ–°å®‰æ’è¡Œç¨‹ï¼ˆé‡è¦ï¼‰</h2><p>æ€è·¯ï¼š</p><p>é€’å½’ä¸‰éƒ¨æ›²</p><p>å¯ä»¥å‘ç°ï¼Œæœ€ç»ˆè¡Œç¨‹æ•° = æœºåœºæ•° + 1ï¼Œç”±æ­¤ç¡®å®šç»ˆæ­¢æ¡ä»¶</p><p>å›æº¯æ–¹æ³•åªè€ƒè™‘é€»è¾‘å¤„ç†ï¼Œè€Œä¸è€ƒè™‘æ•°æ®çš„è¾“å…¥ï¼Œæ•°æ®çš„è¾“å…¥åœ¨ä¸»å‡½æ•°å®Œæˆ</p><p>æœ€é‡è¦çš„æ˜¯å„ç§é›†åˆçš„ä½¿ç”¨ï¼š</p><ul><li><p>é›†åˆçš„éå†ï¼š</p><ul><li><p>ä½¿ç”¨entryéå†</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs java">Map&lt;Integer, Integer&gt; map = <span class="hljs-keyword">new</span> <span class="hljs-title class_">HashMap</span>&lt;Integer, Integer&gt;();<br> <br><span class="hljs-keyword">for</span> (Map.Entry&lt;Integer, Integer&gt; entry : map.entrySet()) &#123;<br> <br>    System.out.println(<span class="hljs-string">&quot;Key = &quot;</span> + entry.getKey() + <span class="hljs-string">&quot;, Value = &quot;</span> + entry.getValue());<br> <br>&#125;<br></code></pre></td></tr></table></figure></li><li><p>éå†keyæˆ–value</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs java">Map&lt;Integer, Integer&gt; map = <span class="hljs-keyword">new</span> <span class="hljs-title class_">HashMap</span>&lt;Integer, Integer&gt;();<br> <br><span class="hljs-comment">//éå†mapä¸­çš„é”®</span><br> <br><span class="hljs-keyword">for</span> (Integer key : map.keySet()) &#123;<br> <br>    System.out.println(<span class="hljs-string">&quot;Key = &quot;</span> + key);<br> <br>&#125;<br> <br><span class="hljs-comment">//éå†mapä¸­çš„å€¼</span><br> <br><span class="hljs-keyword">for</span> (Integer value : map.values()) &#123;<br> <br>    System.out.println(<span class="hljs-string">&quot;Value = &quot;</span> + value);<br> <br>&#125;<br></code></pre></td></tr></table></figure></li></ul></li><li><p>TreeMapçš„ä½¿ç”¨<br>ä¼šå¯¹keyè¿›è¡Œæ’åº</p></li></ul><p>ä½¿ç”¨TreeMapï¼Œå°±å¾ˆå¥½çš„è§£å†³äº†é¢˜ç›®è¦æ±‚çš„æŒ‰å­—æ¯å¤§å°æ’åºçš„è¦æ±‚</p><blockquote><p>åœ¨è¿›è¡Œæ’å…¥çš„æ—¶å€™ï¼Œé€»è¾‘æ˜¯ï¼š1ã€åˆ¤æ–­æ˜¯å¦å­˜åœ¨è¿™ä¸ªkeyï¼Œå¦‚æœå­˜åœ¨ï¼Œé‚£ä¹ˆå…ˆå–å‡ºåŸæ¥çš„å€¼ï¼Œå†èµ‹å€¼æœ€æ–°çš„å€¼ï¼›è‹¥ä¸å­˜åœ¨ï¼Œåˆ™å»ºç«‹ä¸€ä¸ªTreeMapï¼Œå†èµ‹å€¼æœ€æ–°çš„å€¼ã€‚</p></blockquote><p>==éå†çš„æ—¶å€™æ€»æ˜¯å¤šè¿›ä¸€å±‚==</p><blockquote><p>æœ¬é¢˜è¿˜æœ‰å¦å¤–ä¸€ä¸ªæ³¨æ„äº‹é¡¹ï¼Œå°±æ˜¯æœ¬é¢˜çš„å›æº¯æ–¹æ³•è¿”å›å€¼æ˜¯booleanï¼Œä¸ºä»€ä¹ˆå‘¢ï¼Ÿ</p></blockquote><p>å› ä¸ºæˆ‘ä»¬åªéœ€è¦æ‰¾å‡ºä¸€ä¸ªè¡Œç¨‹å³å¯ï¼Œè‹¥æ˜¯æ‰¾åˆ°è¡Œç¨‹ï¼Œä¸€è·¯è¿”å›trueï¼›åŒæ—¶æ‰¾è¡Œç¨‹çš„è¿‡ç¨‹ä¸­ä½¿ç”¨TreeMapï¼Œå°±å¯ä»¥ä¿è¯è¿”å›çš„è¡Œç¨‹æ˜¯æŒ‰å­—æ¯è¡¨é¡ºåºæ¥çš„</p><h2 id="Nçš‡å"><a href="#Nçš‡å" class="headerlink" title="Nçš‡å"></a>Nçš‡å</h2><p>å›æº¯æ³•çš„ç»å…¸é¢˜ç›®</p><p>å¯ä»¥å†™ä¸ªå‡½æ•°ï¼Œæ¥åˆ¤æ–­è¯¥ä½ç½®æ˜¯å¦èƒ½æ”¾çš‡åï¼Œ      ==é”™è¯¯==ï¼š<em>æ–œå¯¹è§’çš„ä½ç½®åˆ¤æ–­ï¼šæ•°åŠ èµ·æ¥ç­‰äºä¸€ä¸ªå®šå€¼ï¼Œå°±è¯´æ˜è¯¥æ–œå¯¹è§’çº¿å·²ç»æœ‰çš‡åäº†ï¼Œå¦‚res[1] [2] å’Œres[0] [3],å°±å±äºåŒä¸€æ¡æ–œçº¿</em></p><p>ä¾ç„¶æ˜¯é€’å½’ä¸‰éƒ¨æ›²</p><p>å‚æ•°å¯ä»¥åŠ ä¸€ä¸ªrowï¼Œç”¨æ¥éå†å½“å‰æ˜¯ç¬¬å‡ å±‚ï¼ŒåŒæ—¶è‹¥æ˜¯åˆ°äº†æœ€åº•å±‚ï¼Œåˆ™å°±è¿”å›ï¼›è¿™æ˜¯ç»ˆæ­¢æ¡ä»¶</p><p>â”—|ï½€Oâ€²|â”› å—·~~ï¼ŒçŸ¥é“äº†ï¼Œåˆ¤æ–­æ˜¯å¦æœ‰æ•ˆä¸èƒ½ç®€å•çš„é‚£ä¹ˆåˆ¤æ–­ï¼Œå› ä¸ºä¸Šè¿°æ²¡æœ‰è€ƒè™‘åˆ°å¦ä¸€æ¡æ–œå¯¹è§’çº¿ï¼Œæ‰€ä»¥åˆ¤æ–­æ˜¯å¦æœ‰æ•ˆè¦åˆ†åˆ—ï¼Œ45Â°ï¼Œ135Â°ä¸‰ç§æƒ…å†µ</p><blockquote><p>ä¸ç†Ÿæ‚‰çš„æ–¹æ³•ï¼š</p><ol><li>Arrays.fillï¼ˆ a1, value ï¼‰;    å…¶ä¸­a1æ˜¯æ•°ç»„ï¼Œåé¢valueæ˜¯å€¼ï¼Œæ•°ç»„èµ‹å€¼</li><li>String.copyValueOf(c)ï¼›    å…¶ä¸­cæ˜¯ä¸€ä¸ªä¸€ç»´æ•°ç»„ï¼Œchar[] cï¼Œ è¡¨ç¤ºå°†cè½¬åŒ–ä¸ºä¸€ä¸ªStringç±»å‹<br>String.copyValueOf(char[] data, int offset, int count);  ç¬¬äºŒä¸ªå‚æ•°è¡¨ç¤ºå­æ•°ç»„çš„åˆå§‹åç§»é‡ï¼›countè¡¨ç¤ºå­æ•°ç»„çš„é•¿åº¦</li></ol></blockquote><blockquote><p>æ–°æ€è·¯ï¼ˆæ–°æ“ä½œï¼‰ï¼š</p><ul><li>å°†æ•°ç»„å…¨éƒ¨ç½®ä¸ºâ€™.â€™ï¼Œæ»¡è¶³è¦æ±‚å†å°†æ•°ç»„ç½®ä¸ºâ€™Qâ€™</li><li>æœ‰äº›æ—¶å€™å›æº¯ç®—æ³•å¤„ç†å•å±‚é€»è¾‘æ—¶åªè€ƒè™‘æˆåŠŸçš„æƒ…å†µï¼Œå¦‚   if () {} </li></ul></blockquote><h2 id="è§£æ•°ç‹¬"><a href="#è§£æ•°ç‹¬" class="headerlink" title="è§£æ•°ç‹¬"></a>è§£æ•°ç‹¬</h2><p>æœ¬é¢˜ä¸ä»¥ä¸Šçš„å›æº¯æ³•ä¸åŒä¹‹å¤„åœ¨äºï¼Œæœ¬é¢˜æ˜¯äºŒé‡å¾ªç¯æ¥è¿›è¡Œéå†</p><p>æ€»è§‰å¾—æ—¶é—´å¤æ‚åº¦ä¼šæé«˜</p><p>åŒæ ·ï¼Œæœ¬é¢˜ä¹Ÿéœ€è¦å•ç‹¬å†™ä¸€ä¸ªåˆ¤æ–­æœ‰æ•ˆå‡½æ•°ï¼Œæœ‰æ•ˆå‡½æ•°è¡Œå’Œåˆ—å¥½åˆ¤æ–­ï¼Œé—®é¢˜åœ¨äºä¹å®«æ ¼çš„åˆ¤æ–­ï¼›å¯ä»¥å‘ç°ï¼Œæœ¬é¢˜æ•°ç»„ä¸‹æ ‡æ˜¯ä»0å¼€å§‹çš„ï¼Œä¹Ÿå°±æ˜¯è¯´ 012     345  678ï¼Œç”±æ­¤å¯ä»¥æƒ³åˆ°ï¼Œvalé™¤ä»¥3ï¼Œå¾—åˆ°startï¼Œç„¶åå†*ä¸‰ï¼Œå°±å¾—åˆ°ä¹å®«æ ¼</p><blockquote><p>è¿”å›å€¼</p></blockquote><p>å›æº¯å‡½æ•°è¿”å›å€¼æ˜¯booleanï¼Œç›®çš„æ˜¯æ‰¾åˆ°ä¸€ä¸ªæ­£ç¡®çš„è§£ï¼Œä¸€æ—¦æ‰¾åˆ°æ­£ç¡®çš„è§£å°±è¿”å›ï¼›åœ¨ä¸¤å±‚forå¾ªç¯ä¹‹åï¼Œè‹¥æ˜¯è¿˜æ‰¾ä¸åˆ°æ­£ç¡®çš„è§£ï¼Œå°±è¿”å›falseï¼Œæ‰€ä»¥ä¸éœ€è¦ç»ˆæ­¢æ¡ä»¶ï¼</p><blockquote><p>åŸåˆ›æ•°å­—</p></blockquote><p>å¦‚æœä¸æ³¨æ„ï¼Œå°±ä¼šæŠŠäººå®¶çš„åŸåˆ›æ•°å­—æ¯æ‰ï¼Œè¿™æ—¶å°±éœ€è¦ç”¨continueæ¥è·³è¿‡åŸåˆ›æ•°å­—</p><blockquote><p>å•å±‚å¤„ç†é€»è¾‘</p></blockquote><p>åœ¨è¿›è¡Œå•å±‚å¤„ç†æ—¶ï¼Œå¯ä»¥åšå¦‚ä¸‹æ“ä½œï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs java">board[i][j] = m;<br><span class="hljs-keyword">if</span> (tracking(board))<br><span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;<br>board[i][j] = <span class="hljs-string">&#x27;.&#x27;</span>;<br></code></pre></td></tr></table></figure><p>2-3è¡Œä¸ºä»€ä¹ˆè¦ç”¨ifå‘¢ï¼Œå¿…é¡»çš„ï¼è‹¥æ˜¯æ‰¾åˆ°äº†è§£ï¼Œåˆ™ç›´æ¥è¿”å›trueï¼›</p><blockquote><p>é€’å½’ä½“ç°åœ¨å“ªé‡Œï¼Ÿ</p></blockquote><p>ä¸Šè¿°æœ‰ä¸ªcontinueæ“ä½œï¼Œé‡åˆ°æ•°å­—å°±è·³è¿‡ï¼Œå› ä¸ºä¸Šä¸€å±‚ä¸­å·²ç»æ–°è®¾å®šäº†æ•°å­—ï¼Œæ‰€ä»¥è¿™ä¸€å±‚å°±ä¸ä¼šåŠ¨ä¸Šä¸€å±‚çš„æ•°å­—ï¼Œä»è€Œè¾¾åˆ°å›æº¯æ•ˆæœ</p><h2 id="å›æº¯æ³•æ€»ç»“"><a href="#å›æº¯æ³•æ€»ç»“" class="headerlink" title="å›æº¯æ³•æ€»ç»“"></a>å›æº¯æ³•æ€»ç»“</h2><p>å¯ä»¥è§£å†³å¦‚ä¸‹é—®é¢˜ï¼š</p><ul><li>ç»„åˆé—®é¢˜ï¼šNä¸ªæ•°é‡Œé¢æŒ‰ä¸€å®šè§„åˆ™æ‰¾å‡ºkä¸ªæ•°çš„é›†åˆ</li><li>æ’åˆ—é—®é¢˜ï¼šNä¸ªæ•°æŒ‰ä¸€å®šè§„åˆ™å…¨æ’åˆ—ï¼Œæœ‰å‡ ç§æ’åˆ—æ–¹å¼</li><li>åˆ‡å‰²é—®é¢˜ï¼šä¸€ä¸ªå­—ç¬¦ä¸²æŒ‰ä¸€å®šè§„åˆ™æœ‰å‡ ç§åˆ‡å‰²æ–¹å¼</li><li>å­é›†é—®é¢˜ï¼šä¸€ä¸ªNä¸ªæ•°çš„é›†åˆé‡Œæœ‰å¤šå°‘ç¬¦åˆæ¡ä»¶çš„å­é›†</li><li>æ£‹ç›˜é—®é¢˜ï¼šNçš‡åï¼Œè§£æ•°ç‹¬ç­‰ç­‰</li></ul><p>å­é›†é—®é¢˜åˆ†æï¼š</p><ul><li>æ—¶é—´å¤æ‚åº¦ï¼šO(2^n)ï¼Œå› ä¸ºæ¯ä¸€ä¸ªå…ƒç´ çš„çŠ¶æ€æ— å¤–ä¹å–ä¸ä¸å–ï¼Œæ‰€ä»¥æ—¶é—´å¤æ‚åº¦ä¸ºO(2^n)</li><li>ç©ºé—´å¤æ‚åº¦ï¼šO(n)ï¼Œé€’å½’æ·±åº¦ä¸ºnï¼Œæ‰€ä»¥ç³»ç»Ÿæ ˆæ‰€ç”¨ç©ºé—´ä¸ºO(n)ï¼Œæ¯ä¸€å±‚é€’å½’æ‰€ç”¨çš„ç©ºé—´éƒ½æ˜¯å¸¸æ•°çº§åˆ«ï¼Œæ³¨æ„ä»£ç é‡Œçš„resultå’Œpathéƒ½æ˜¯å…¨å±€å˜é‡ï¼Œå°±ç®—æ˜¯æ”¾åœ¨å‚æ•°é‡Œï¼Œä¼ çš„ä¹Ÿæ˜¯å¼•ç”¨ï¼Œå¹¶ä¸ä¼šæ–°ç”³è¯·å†…å­˜ç©ºé—´ï¼Œæœ€ç»ˆç©ºé—´å¤æ‚åº¦ä¸ºO(n)</li></ul><p>æ’åˆ—é—®é¢˜åˆ†æï¼š</p><ul><li>æ—¶é—´å¤æ‚åº¦ï¼šO(n!)ï¼Œè¿™ä¸ªå¯ä»¥ä»æ’åˆ—çš„æ ‘å½¢å›¾ä¸­å¾ˆæ˜æ˜¾å‘ç°ï¼Œæ¯ä¸€å±‚èŠ‚ç‚¹ä¸ºnï¼Œç¬¬äºŒå±‚æ¯ä¸€ä¸ªåˆ†æ”¯éƒ½å»¶ä¼¸äº†n-1ä¸ªåˆ†æ”¯ï¼Œå†å¾€ä¸‹åˆæ˜¯n-2ä¸ªåˆ†æ”¯ï¼Œæ‰€ä»¥ä¸€ç›´åˆ°å¶å­èŠ‚ç‚¹ä¸€å…±å°±æ˜¯ n * n-1 * n-2 * â€¦.. 1 = n!ã€‚</li><li>ç©ºé—´å¤æ‚åº¦ï¼šO(n)ï¼Œå’Œå­é›†é—®é¢˜åŒç†ã€‚</li></ul><p>ç»„åˆé—®é¢˜åˆ†æï¼š</p><ul><li>æ—¶é—´å¤æ‚åº¦ï¼šO(2^n)ï¼Œç»„åˆé—®é¢˜å…¶å®å°±æ˜¯ä¸€ç§å­é›†çš„é—®é¢˜ï¼Œæ‰€ä»¥ç»„åˆé—®é¢˜æœ€åçš„æƒ…å†µï¼Œä¹Ÿä¸ä¼šè¶…è¿‡å­é›†é—®é¢˜çš„æ—¶é—´å¤æ‚åº¦ã€‚</li><li>ç©ºé—´å¤æ‚åº¦ï¼šO(n)ï¼Œå’Œå­é›†é—®é¢˜åŒç†ã€‚</li></ul><p>Nçš‡åé—®é¢˜åˆ†æï¼š</p><ul><li>æ—¶é—´å¤æ‚åº¦ï¼šO(n!) ï¼Œå…¶å®å¦‚æœçœ‹æ ‘å½¢å›¾çš„è¯ï¼Œç›´è§‰ä¸Šæ˜¯O(n^n)ï¼Œä½†çš‡åä¹‹é—´ä¸èƒ½è§é¢æ‰€ä»¥åœ¨æœç´¢çš„è¿‡ç¨‹ä¸­æ˜¯æœ‰å‰ªæçš„ï¼Œæœ€å·®ä¹Ÿå°±æ˜¯Oï¼ˆn!ï¼‰ï¼Œn!è¡¨ç¤ºn * (n-1) * â€¦. * 1ã€‚</li><li>ç©ºé—´å¤æ‚åº¦ï¼šO(n)ï¼Œå’Œå­é›†é—®é¢˜åŒç†ã€‚</li></ul><p>è§£æ•°ç‹¬é—®é¢˜åˆ†æï¼š</p><ul><li>æ—¶é—´å¤æ‚åº¦ï¼šO(9^m) , mæ˜¯â€™.â€™çš„æ•°ç›®ã€‚</li><li>ç©ºé—´å¤æ‚åº¦ï¼šO(n^2)ï¼Œé€’å½’çš„æ·±åº¦æ˜¯n^2</li></ul><p><strong>ä¸€èˆ¬è¯´é“å›æº¯ç®—æ³•çš„å¤æ‚åº¦ï¼Œéƒ½è¯´æ˜¯æŒ‡æ•°çº§åˆ«çš„æ—¶é—´å¤æ‚åº¦ï¼Œè¿™ä¹Ÿç®—æ˜¯ä¸€ä¸ªæ¦‚æ‹¬å§ï¼</strong></p>]]></content>
    
    
    <categories>
      
      <category>ç®—æ³•</category>
      
    </categories>
    
    
    <tags>
      
      <tag>java</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>äºŒå‰æ ‘</title>
    <link href="/2022/09/16/er-cha-shu/"/>
    <url>/2022/09/16/er-cha-shu/</url>
    
    <content type="html"><![CDATA[<h1 id="äºŒå‰æ ‘"><a href="#äºŒå‰æ ‘" class="headerlink" title="äºŒå‰æ ‘"></a>äºŒå‰æ ‘</h1><h2 id="äºŒå‰æ ‘æœ€è¿‘å…¬å…±ç¥–å…ˆ"><a href="#äºŒå‰æ ‘æœ€è¿‘å…¬å…±ç¥–å…ˆ" class="headerlink" title="äºŒå‰æ ‘æœ€è¿‘å…¬å…±ç¥–å…ˆ"></a>äºŒå‰æ ‘æœ€è¿‘å…¬å…±ç¥–å…ˆ</h2><p>æ€è·¯ï¼š</p><p>æ‰¾p,q;å¿…é¡»è¦éå†æ•´æ£µæ ‘ï¼Œè‡ªåº•å‘ä¸Šéå†ï¼Œé‡‡ç”¨ååºéå†</p><p>æ‰¾åˆ°pæˆ–qå°±è¿”å›qæˆ–qçš„ç»“ç‚¹ï¼Œæ‰¾ä¸åˆ°åˆ™è¿”å›ç©ºï¼›è‹¥æ˜¯å‘ç°å·¦å­æ ‘å’Œå³å­æ ‘éƒ½ä¸ä¸ºç©ºï¼Œé‚£å°±è¯´æ˜ï¼Œå½“å‰ç»“ç‚¹rootå°±æ˜¯æœ€è¿‘çš„å…¬å…±ç¥–å…ˆï¼›è‹¥æ˜¯å‘ç°å·¦å­æ ‘ä¸ºç©ºï¼Œå³å­æ ‘ä¸ä¸ºç©ºï¼Œåˆ™è¯´æ˜æ˜¯é€šè¿‡å³å­æ ‘è¿”å›çš„ï¼Œè¿”å›å³å­æ ‘å³å¯</p><p>æ‰€ä»¥é€»è¾‘å°±å¾ˆæ¸…æ¥šäº†ï¼š</p><ol><li>å…ˆåˆ¤æ–­rootæ˜¯å¦ä¸ºp q null è¿™å‡ ç§æƒ…å†µ </li><li>left = é€’å½’æ–¹æ³•ï¼›</li><li>right = é€’å½’æ–¹æ³•ï¼›</li><li>å†åˆ¤æ–­å·¦å³å­æ ‘æ˜¯å¦ä¸ºç©ºçš„æƒ…å†µï¼Œæ®æ­¤æ¥è¿”å›äºŒå‰æ ‘æœ€è¿‘å…¬å…±ç¥–å…ˆ</li></ol><h2 id="äºŒå‰æ ‘æœç´¢æœ€è¿‘å…¬å…±ç¥–å…ˆ"><a href="#äºŒå‰æ ‘æœç´¢æœ€è¿‘å…¬å…±ç¥–å…ˆ" class="headerlink" title="äºŒå‰æ ‘æœç´¢æœ€è¿‘å…¬å…±ç¥–å…ˆ"></a>äºŒå‰æ ‘æœç´¢æœ€è¿‘å…¬å…±ç¥–å…ˆ</h2><p>ä¸€ç§æ€è·¯æ˜¯ä¸Šè¿°çš„äºŒå‰æ ‘æœ€è¿‘å…¬å…±ç¥–å…ˆ</p><p>å¦ä¸€ç§æ€è·¯å°±æ˜¯åˆ©ç”¨äºŒå‰æœç´¢æ ‘çš„æ€§è´¨</p><p>æ€è·¯ï¼š</p><p>å¦‚æœå½“å‰ç»“ç‚¹åŒæ—¶å¤§äºpã€qï¼Œé‚£ä¹ˆå°±è¯´æ˜åº”è¯¥åœ¨å·¦å­æ ‘æ‰¾ï¼›åä¹‹ï¼Œåœ¨å³å­æ ‘æ‰¾ï¼›å¦‚æœå‘ç°ä¸€è¾¹å¤§ä¸€è¾¹å°ï¼Œé‚£ä¹ˆç›´æ¥è¿”å›å½“å‰ç»“ç‚¹ï¼Œå½“å‰ç»“ç‚¹å°±æ˜¯æœ€è¿‘å…¬å…±ç¥–å…ˆ</p><p>ç¬¬ä¸‰ç§æ€è·¯ï¼Œè¿­ä»£æ³•</p><p>è¿­ä»£æ³•ï¼š</p><p>ç”¨ä¸€ä¸ªwhileå¾ªç¯ï¼Œè‹¥å½“å‰ç»“ç‚¹åŒæ—¶å¤§äºpã€qï¼Œå¾€å·¦å­æ ‘èµ°ï¼›åä¹‹ï¼Œå¾€å³å­æ ‘èµ°ï¼›å¦åˆ™ï¼Œç›´æ¥è¿”å›</p><p><strong>ç§’ï¼ï¼ï¼</strong></p><h2 id="äºŒå‰æœç´¢æ ‘çš„æ’å…¥æ“ä½œ"><a href="#äºŒå‰æœç´¢æ ‘çš„æ’å…¥æ“ä½œ" class="headerlink" title="äºŒå‰æœç´¢æ ‘çš„æ’å…¥æ“ä½œ"></a>äºŒå‰æœç´¢æ ‘çš„æ’å…¥æ“ä½œ</h2><p>æˆ‘çš„æƒ³æ³•æ˜¯ï¼Œé¦–å…ˆå¤‡ä»½rootç»“ç‚¹ï¼ˆé€šè¿‡åˆ›å»ºä¸€ä¸ªæ–°èŠ‚ç‚¹ï¼‰ï¼Œç„¶åwhileå†™ä¸€ä¸ªæ­»å¾ªç¯ï¼Œè‹¥æ‰¾åˆ°æ’å…¥ä½ç½®ï¼Œåˆ™breakï¼Œæœ€åè¿”å›å³å¯ã€‚</p><p>ä¸Šè¿°ä¸ºè¿­ä»£æ³•</p><p>ä¸‹é¢æ˜¯é€’å½’æ³•ï¼š</p><p>è‹¥rootä¸ºç©ºï¼Œåˆ™åˆ›å»ºä¸€ä¸ªæ–°ç»“ç‚¹ï¼Œè¯´æ˜æ‰¾åˆ°ä½ç½®äº†</p><p>è‹¥rootå¤§äºå½“å‰ç»“ç‚¹ï¼Œåˆ™é€’å½’å·¦å­æ ‘è°ƒç”¨æ–¹æ³•</p><p>è‹¥rootå°äºå½“å‰ç»“ç‚¹ï¼Œåˆ™é€’å½’å³å­æ ‘è°ƒç”¨æ–¹æ³•</p><h2 id="åˆ é™¤äºŒå‰æœç´¢æ ‘ä¸­çš„ç»“ç‚¹"><a href="#åˆ é™¤äºŒå‰æœç´¢æ ‘ä¸­çš„ç»“ç‚¹" class="headerlink" title="åˆ é™¤äºŒå‰æœç´¢æ ‘ä¸­çš„ç»“ç‚¹"></a>åˆ é™¤äºŒå‰æœç´¢æ ‘ä¸­çš„ç»“ç‚¹</h2><p>é€’å½’ä¸‰éƒ¨æ›²</p><ul><li>ç¡®å®šé€’å½’å‡½æ•°ä»¥åŠè¿”å›å€¼</li><li>ç¡®å®šç»ˆæ­¢æ¡ä»¶</li><li>ç¡®å®šå•å±‚é€’å½’çš„é€»è¾‘</li></ul><p>æ€è·¯ï¼š</p><p>ä¸€å…±æœ‰äº”ç§æƒ…å†µï¼š</p><ol><li>æ ¹èŠ‚ç‚¹ä¸ºç©ºï¼Œåˆ™è¿”å›rootï¼Œè¯´æ˜é€’å½’ç»“æŸï¼ˆæ²¡æ‰¾åˆ°ï¼‰ï¼›</li><li>æ ¹èŠ‚ç‚¹å·¦å³å­æ ‘éƒ½ä¸ºç©ºï¼Œåˆ™è¿”å›nullï¼Œè¯´æ˜æ˜¯å¶å­ç»“ç‚¹ï¼Œç›´æ¥åˆ æ‰ï¼›</li><li>æ ¹èŠ‚ç‚¹å·¦å­æ ‘ä¸ºç©ºå³å­æ ‘ä¸ä¸ºç©ºï¼Œè¿”å›å³å­æ ‘ï¼›</li><li>æ ¹èŠ‚ç‚¹å·¦å­æ ‘ä¸ä¸ºç©ºå³å­æ ‘ä¸ºç©ºï¼Œè¿”å›å·¦å­æ ‘ï¼›</li><li>æ ¹èŠ‚ç‚¹å·¦å³å­æ ‘éƒ½ä¸ä¸ºç©ºï¼Œåˆ™å°†å·¦å­æ ‘æ”¾åˆ°å³å­æ ‘çš„æœ€å·¦å­æ ‘å¤„ï¼Œè¿”å›å³å­æ ‘ã€‚</li></ol><h2 id="ä¿®å‰ªäºŒå‰æœç´¢æ ‘"><a href="#ä¿®å‰ªäºŒå‰æœç´¢æ ‘" class="headerlink" title="ä¿®å‰ªäºŒå‰æœç´¢æ ‘"></a>ä¿®å‰ªäºŒå‰æœç´¢æ ‘</h2><p>å‰ªææ“ä½œ</p><p>ç»™å®šèŒƒå›´(low, high)</p><p>è‹¥æ ¹èŠ‚ç‚¹å°äºlowï¼Œç›´æ¥å»æ“ä½œå³å­æ ‘ï¼Œå·¦å­æ ‘å·²ç„¶å…¨éƒ¨æŒ‚</p><p>åŒç†ï¼Œè‹¥æ ¹èŠ‚ç‚¹å¤§äºhighï¼Œç›´æ¥å»æ“ä½œå·¦å­æ ‘</p><p>è‹¥rootåœ¨åˆç†èŒƒå›´å†…ï¼Œåˆ™é€’å½’æ“ä½œå·¦å³å­æ ‘</p><h2 id="å°†æœ‰åºæ•°ç»„è½¬ä¸ºäºŒå‰æœç´¢æ ‘"><a href="#å°†æœ‰åºæ•°ç»„è½¬ä¸ºäºŒå‰æœç´¢æ ‘" class="headerlink" title="å°†æœ‰åºæ•°ç»„è½¬ä¸ºäºŒå‰æœç´¢æ ‘"></a>å°†æœ‰åºæ•°ç»„è½¬ä¸ºäºŒå‰æœç´¢æ ‘</h2><p>æ³¨æ„æ•°ç»„è¶Šç•Œï¼Œåœ¨äºŒåˆ†æ³•æ—¶è¦æ³¨æ„ï¼š int mid = left + ((right - left) / 2);</p><p>æ€è·¯:</p><p>å› ä¸ºæ˜¯æœ‰åºï¼Œæ‰€ä»¥ç›´æ¥æŒ‰åŒºé—´åˆ’åˆ†ï¼Œæ¯æ¬¡å°†ä¸­é—´ç»“ç‚¹èµ‹å€¼ç»™rootç»“ç‚¹ï¼Œç„¶åé€’å½’çš„åˆ’åˆ†åŒºé—´</p><h2 id="æŠŠäºŒå‰æœç´¢æ ‘è½¬åŒ–ä¸ºç´¯åŠ æ ‘"><a href="#æŠŠäºŒå‰æœç´¢æ ‘è½¬åŒ–ä¸ºç´¯åŠ æ ‘" class="headerlink" title="æŠŠäºŒå‰æœç´¢æ ‘è½¬åŒ–ä¸ºç´¯åŠ æ ‘"></a>æŠŠäºŒå‰æœç´¢æ ‘è½¬åŒ–ä¸ºç´¯åŠ æ ‘</h2><p>å› ä¸ºæ˜¯äºŒå‰æœç´¢æ ‘ï¼Œæ‰€ä»¥ä¸­åºéå†å°±æ˜¯å‡åºã€‚</p><p>å› ä¸ºæœ¬é¢˜è¦ç´¯åŠ ï¼Œå¦‚æœä»æœ€å°çš„å¼€å§‹åŠ çš„è¯ï¼Œæ— æ³•çŸ¥é“åç»­å¤§äºæœ€å°çš„æ•°çš„ç´¯åŠ ï¼›æ‰€ä»¥åªèƒ½ä»æœ€å¤§çš„å¼€å§‹ï¼Œä»æœ€å¤§çš„å¼€å§‹çš„è¯ï¼Œé‚£ç›´æ¥å¯¹ä¸­åºéå†åšä¸€ä¸ªå³ä¸­å·¦çš„å¤„ç†ï¼Œå³å¯è¾¾åˆ°é€†åºè¾“å‡ºï¼›</p><p>å¤„ç†ç»“ç‚¹æ˜¯å…ˆåˆ›å»ºä¸€ä¸ªpreï¼Œæ¥ä¿å­˜å…ˆå‰çš„æ•°ï¼Œè€Œåä¸€ç›´åŠ ä¸‹å»</p><h2 id="äºŒå‰æ ‘æ€»ç»“"><a href="#äºŒå‰æ ‘æ€»ç»“" class="headerlink" title="äºŒå‰æ ‘æ€»ç»“"></a>äºŒå‰æ ‘æ€»ç»“</h2><h3 id="1ã€äºŒå‰æ ‘çš„ç†è®ºåŸºç¡€"><a href="#1ã€äºŒå‰æ ‘çš„ç†è®ºåŸºç¡€" class="headerlink" title="1ã€äºŒå‰æ ‘çš„ç†è®ºåŸºç¡€"></a>1ã€äºŒå‰æ ‘çš„ç†è®ºåŸºç¡€</h3><ul><li><a href="https://programmercarl.com/%E4%BA%8C%E5%8F%89%E6%A0%91%E7%90%86%E8%AE%BA%E5%9F%BA%E7%A1%80.html">å…³äºäºŒå‰æ ‘ï¼Œä½ è¯¥äº†è§£è¿™äº›ï¼ (opens new window)</a>ï¼šäºŒå‰æ ‘çš„ç§ç±»ã€å­˜å‚¨æ–¹å¼ã€éå†æ–¹å¼ã€å®šä¹‰æ–¹å¼</li></ul><h3 id="2ã€äºŒå‰æ ‘çš„éå†æ–¹å¼"><a href="#2ã€äºŒå‰æ ‘çš„éå†æ–¹å¼" class="headerlink" title="2ã€äºŒå‰æ ‘çš„éå†æ–¹å¼"></a>2ã€äºŒå‰æ ‘çš„éå†æ–¹å¼</h3><ul><li>æ·±åº¦ä¼˜å…ˆéå†<ul><li><a href="https://programmercarl.com/%E4%BA%8C%E5%8F%89%E6%A0%91%E7%9A%84%E9%80%92%E5%BD%92%E9%81%8D%E5%8E%86.html">äºŒå‰æ ‘ï¼šå‰ä¸­ååºé€’å½’æ³• (opens new window)</a>ï¼šé€’å½’ä¸‰éƒ¨æ›²åˆæ¬¡äº®ç›¸</li><li><a href="https://programmercarl.com/%E4%BA%8C%E5%8F%89%E6%A0%91%E7%9A%84%E8%BF%AD%E4%BB%A3%E9%81%8D%E5%8E%86.html">äºŒå‰æ ‘ï¼šå‰ä¸­ååºè¿­ä»£æ³•ï¼ˆä¸€ï¼‰ (opens new window)</a>ï¼šé€šè¿‡æ ˆæ¨¡æ‹Ÿé€’å½’</li><li><a href="https://programmercarl.com/%E4%BA%8C%E5%8F%89%E6%A0%91%E7%9A%84%E7%BB%9F%E4%B8%80%E8%BF%AD%E4%BB%A3%E6%B3%95.html">äºŒå‰æ ‘ï¼šå‰ä¸­ååºè¿­ä»£æ³•ï¼ˆäºŒï¼‰ç»Ÿä¸€é£æ ¼(opens new window)</a></li></ul></li><li>å¹¿åº¦ä¼˜å…ˆéå†<ul><li><a href="https://programmercarl.com/0102.%E4%BA%8C%E5%8F%89%E6%A0%91%E7%9A%84%E5%B1%82%E5%BA%8F%E9%81%8D%E5%8E%86.html">äºŒå‰æ ‘çš„å±‚åºéå† (opens new window)</a>ï¼šé€šè¿‡é˜Ÿåˆ—æ¨¡æ‹Ÿ</li></ul></li></ul><h3 id="3ã€æ±‚äºŒå‰æ ‘çš„å±æ€§"><a href="#3ã€æ±‚äºŒå‰æ ‘çš„å±æ€§" class="headerlink" title="3ã€æ±‚äºŒå‰æ ‘çš„å±æ€§"></a>3ã€æ±‚äºŒå‰æ ‘çš„å±æ€§</h3><ul><li>äºŒå‰æ ‘ï¼šæ˜¯å¦å¯¹ç§°(opens new window)<ul><li>é€’å½’ï¼šååºï¼Œæ¯”è¾ƒçš„æ˜¯æ ¹èŠ‚ç‚¹çš„å·¦å­æ ‘ä¸å³å­æ ‘æ˜¯ä¸æ˜¯ç›¸äº’ç¿»è½¬</li><li>è¿­ä»£ï¼šä½¿ç”¨é˜Ÿåˆ—/æ ˆå°†ä¸¤ä¸ªèŠ‚ç‚¹é¡ºåºæ”¾å…¥å®¹å™¨ä¸­è¿›è¡Œæ¯”è¾ƒ</li></ul></li><li>äºŒå‰æ ‘ï¼šæ±‚æœ€å¤§æ·±åº¦(opens new window)<ul><li>é€’å½’ï¼šååºï¼Œæ±‚æ ¹èŠ‚ç‚¹æœ€å¤§é«˜åº¦å°±æ˜¯æœ€å¤§æ·±åº¦ï¼Œé€šè¿‡é€’å½’å‡½æ•°çš„è¿”å›å€¼åšè®¡ç®—æ ‘çš„é«˜åº¦</li><li>è¿­ä»£ï¼šå±‚åºéå†</li></ul></li><li>äºŒå‰æ ‘ï¼šæ±‚æœ€å°æ·±åº¦(opens new window)<ul><li>é€’å½’ï¼šååºï¼Œæ±‚æ ¹èŠ‚ç‚¹æœ€å°é«˜åº¦å°±æ˜¯æœ€å°æ·±åº¦ï¼Œæ³¨æ„æœ€å°æ·±åº¦çš„å®šä¹‰</li><li>è¿­ä»£ï¼šå±‚åºéå†</li></ul></li><li>äºŒå‰æ ‘ï¼šæ±‚æœ‰å¤šå°‘ä¸ªèŠ‚ç‚¹(opens new window)<ul><li>é€’å½’ï¼šååºï¼Œé€šè¿‡é€’å½’å‡½æ•°çš„è¿”å›å€¼è®¡ç®—èŠ‚ç‚¹æ•°é‡</li><li>è¿­ä»£ï¼šå±‚åºéå†</li></ul></li><li>äºŒå‰æ ‘ï¼šæ˜¯å¦å¹³è¡¡(opens new window)<ul><li>é€’å½’ï¼šååºï¼Œæ³¨æ„ååºæ±‚é«˜åº¦å’Œå‰åºæ±‚æ·±åº¦ï¼Œé€’å½’è¿‡ç¨‹åˆ¤æ–­é«˜åº¦å·®</li><li>è¿­ä»£ï¼šæ•ˆç‡å¾ˆä½ï¼Œä¸æ¨è</li></ul></li><li>äºŒå‰æ ‘ï¼šæ‰¾æ‰€æœ‰è·¯å¾„(opens new window)<ul><li>é€’å½’ï¼šå‰åºï¼Œæ–¹ä¾¿è®©çˆ¶èŠ‚ç‚¹æŒ‡å‘å­èŠ‚ç‚¹ï¼Œæ¶‰åŠå›æº¯å¤„ç†æ ¹èŠ‚ç‚¹åˆ°å¶å­çš„æ‰€æœ‰è·¯å¾„</li><li>è¿­ä»£ï¼šä¸€ä¸ªæ ˆæ¨¡æ‹Ÿé€’å½’ï¼Œä¸€ä¸ªæ ˆæ¥å­˜æ”¾å¯¹åº”çš„éå†è·¯å¾„</li></ul></li><li>äºŒå‰æ ‘ï¼šé€’å½’ä¸­å¦‚ä½•éšè—ç€å›æº¯(opens new window)<ul><li>è¯¦è§£<a href="https://programmercarl.com/0257.%E4%BA%8C%E5%8F%89%E6%A0%91%E7%9A%84%E6%89%80%E6%9C%89%E8%B7%AF%E5%BE%84.html">äºŒå‰æ ‘ï¼šæ‰¾æ‰€æœ‰è·¯å¾„ (opens new window)</a>ä¸­é€’å½’å¦‚ä½•éšè—ç€å›æº¯</li></ul></li><li>äºŒå‰æ ‘ï¼šæ±‚å·¦å¶å­ä¹‹å’Œ(opens new window)<ul><li>é€’å½’ï¼šååºï¼Œå¿…é¡»ä¸‰å±‚çº¦æŸæ¡ä»¶ï¼Œæ‰èƒ½åˆ¤æ–­æ˜¯å¦æ˜¯å·¦å¶å­ã€‚</li><li>è¿­ä»£ï¼šç›´æ¥æ¨¡æ‹Ÿååºéå†</li></ul></li><li>äºŒå‰æ ‘ï¼šæ±‚å·¦ä¸‹è§’çš„å€¼(opens new window)<ul><li>é€’å½’ï¼šé¡ºåºæ— æ‰€è°“ï¼Œä¼˜å…ˆå·¦å­©å­æœç´¢ï¼ŒåŒæ—¶æ‰¾æ·±åº¦æœ€å¤§çš„å¶å­èŠ‚ç‚¹ã€‚</li><li>è¿­ä»£ï¼šå±‚åºéå†æ‰¾æœ€åä¸€è¡Œæœ€å·¦è¾¹</li></ul></li><li>äºŒå‰æ ‘ï¼šæ±‚è·¯å¾„æ€»å’Œ(opens new window)<ul><li>é€’å½’ï¼šé¡ºåºæ— æ‰€è°“ï¼Œé€’å½’å‡½æ•°è¿”å›å€¼ä¸ºboolç±»å‹æ˜¯ä¸ºäº†æœç´¢ä¸€æ¡è¾¹ï¼Œæ²¡æœ‰è¿”å›å€¼æ˜¯æœç´¢æ•´æ£µæ ‘ã€‚</li><li>è¿­ä»£ï¼šæ ˆé‡Œå…ƒç´ ä¸ä»…è¦è®°å½•èŠ‚ç‚¹æŒ‡é’ˆï¼Œè¿˜è¦è®°å½•ä»å¤´ç»“ç‚¹åˆ°è¯¥èŠ‚ç‚¹çš„è·¯å¾„æ•°å€¼æ€»å’Œ</li></ul></li></ul><h3 id="4ã€äºŒå‰æ ‘çš„ä¿®æ”¹ä¸æ„é€ "><a href="#4ã€äºŒå‰æ ‘çš„ä¿®æ”¹ä¸æ„é€ " class="headerlink" title="4ã€äºŒå‰æ ‘çš„ä¿®æ”¹ä¸æ„é€ "></a>4ã€äºŒå‰æ ‘çš„ä¿®æ”¹ä¸æ„é€ </h3><ul><li>ç¿»è½¬äºŒå‰æ ‘(opens new window)<ul><li>é€’å½’ï¼šå‰åºï¼Œäº¤æ¢å·¦å³å­©å­</li><li>è¿­ä»£ï¼šç›´æ¥æ¨¡æ‹Ÿå‰åºéå†</li></ul></li><li>æ„é€ äºŒå‰æ ‘(opens new window)<ul><li>é€’å½’ï¼šå‰åºï¼Œé‡ç‚¹åœ¨äºæ‰¾åˆ†å‰²ç‚¹ï¼Œåˆ†å·¦å³åŒºé—´æ„é€ </li><li>è¿­ä»£ï¼šæ¯”è¾ƒå¤æ‚ï¼Œæ„ä¹‰ä¸å¤§</li></ul></li><li>æ„é€ æœ€å¤§çš„äºŒå‰æ ‘(opens new window)<ul><li>é€’å½’ï¼šå‰åºï¼Œåˆ†å‰²ç‚¹ä¸ºæ•°ç»„æœ€å¤§å€¼ï¼Œåˆ†å·¦å³åŒºé—´æ„é€ </li><li>è¿­ä»£ï¼šæ¯”è¾ƒå¤æ‚ï¼Œæ„ä¹‰ä¸å¤§</li></ul></li><li>åˆå¹¶ä¸¤ä¸ªäºŒå‰æ ‘(opens new window)<ul><li>é€’å½’ï¼šå‰åºï¼ŒåŒæ—¶æ“ä½œä¸¤ä¸ªæ ‘çš„èŠ‚ç‚¹ï¼Œæ³¨æ„åˆå¹¶çš„è§„åˆ™</li><li>è¿­ä»£ï¼šä½¿ç”¨é˜Ÿåˆ—ï¼Œç±»ä¼¼å±‚åºéå†</li></ul></li></ul><h3 id="5ã€æ±‚äºŒå‰æœç´¢æ ‘çš„å±æ€§"><a href="#5ã€æ±‚äºŒå‰æœç´¢æ ‘çš„å±æ€§" class="headerlink" title="5ã€æ±‚äºŒå‰æœç´¢æ ‘çš„å±æ€§"></a>5ã€æ±‚äºŒå‰æœç´¢æ ‘çš„å±æ€§</h3><ul><li><a href="https://programmercarl.com/0700.%E4%BA%8C%E5%8F%89%E6%90%9C%E7%B4%A2%E6%A0%91%E4%B8%AD%E7%9A%84%E6%90%9C%E7%B4%A2.html">äºŒå‰æœç´¢æ ‘ä¸­çš„æœç´¢(opens new window)</a><ul><li>é€’å½’ï¼šäºŒå‰æœç´¢æ ‘çš„é€’å½’æ˜¯æœ‰æ–¹å‘çš„</li><li>è¿­ä»£ï¼šå› ä¸ºæœ‰æ–¹å‘ï¼Œæ‰€ä»¥è¿­ä»£æ³•å¾ˆç®€å•</li></ul></li><li><a href="https://programmercarl.com/0098.%E9%AA%8C%E8%AF%81%E4%BA%8C%E5%8F%89%E6%90%9C%E7%B4%A2%E6%A0%91.html">æ˜¯ä¸æ˜¯äºŒå‰æœç´¢æ ‘(opens new window)</a><ul><li>é€’å½’ï¼šä¸­åºï¼Œç›¸å½“äºå˜æˆäº†åˆ¤æ–­ä¸€ä¸ªåºåˆ—æ˜¯ä¸æ˜¯é€’å¢çš„</li><li>è¿­ä»£ï¼šæ¨¡æ‹Ÿä¸­åºï¼Œé€»è¾‘ç›¸åŒ</li></ul></li><li><a href="https://programmercarl.com/0530.%E4%BA%8C%E5%8F%89%E6%90%9C%E7%B4%A2%E6%A0%91%E7%9A%84%E6%9C%80%E5%B0%8F%E7%BB%9D%E5%AF%B9%E5%B7%AE.html">æ±‚äºŒå‰æœç´¢æ ‘çš„æœ€å°ç»å¯¹å·®(opens new window)</a><ul><li>é€’å½’ï¼šä¸­åºï¼ŒåŒæŒ‡é’ˆæ“ä½œ</li><li>è¿­ä»£ï¼šæ¨¡æ‹Ÿä¸­åºï¼Œé€»è¾‘ç›¸åŒ</li></ul></li><li><a href="https://programmercarl.com/0501.%E4%BA%8C%E5%8F%89%E6%90%9C%E7%B4%A2%E6%A0%91%E4%B8%AD%E7%9A%84%E4%BC%97%E6%95%B0.html">æ±‚äºŒå‰æœç´¢æ ‘çš„ä¼—æ•°(opens new window)</a><ul><li>é€’å½’ï¼šä¸­åºï¼Œæ¸…ç©ºç»“æœé›†çš„æŠ€å·§ï¼Œéå†ä¸€éä¾¿å¯æ±‚ä¼—æ•°é›†åˆ</li><li><a href="https://programmercarl.com/0538.%E6%8A%8A%E4%BA%8C%E5%8F%89%E6%90%9C%E7%B4%A2%E6%A0%91%E8%BD%AC%E6%8D%A2%E4%B8%BA%E7%B4%AF%E5%8A%A0%E6%A0%91.html">äºŒå‰æœç´¢æ ‘è½¬æˆç´¯åŠ æ ‘(opens new window)</a></li><li>é€’å½’ï¼šä¸­åºï¼ŒåŒæŒ‡é’ˆæ“ä½œç´¯åŠ </li><li>è¿­ä»£ï¼šæ¨¡æ‹Ÿä¸­åºï¼Œé€»è¾‘ç›¸åŒ</li></ul></li></ul><h3 id="6ã€äºŒå‰æ ‘å…¬å…±ç¥–å…ˆé—®é¢˜"><a href="#6ã€äºŒå‰æ ‘å…¬å…±ç¥–å…ˆé—®é¢˜" class="headerlink" title="6ã€äºŒå‰æ ‘å…¬å…±ç¥–å…ˆé—®é¢˜"></a>6ã€äºŒå‰æ ‘å…¬å…±ç¥–å…ˆé—®é¢˜</h3><ul><li>äºŒå‰æ ‘çš„å…¬å…±ç¥–å…ˆé—®é¢˜(opens new window)<ul><li>é€’å½’ï¼šååºï¼Œå›æº¯ï¼Œæ‰¾åˆ°å·¦å­æ ‘å‡ºç°ç›®æ ‡å€¼ï¼Œå³å­æ ‘èŠ‚ç‚¹ç›®æ ‡å€¼çš„èŠ‚ç‚¹ã€‚</li><li>è¿­ä»£ï¼šä¸é€‚åˆæ¨¡æ‹Ÿå›æº¯</li></ul></li><li>äºŒå‰æœç´¢æ ‘çš„å…¬å…±ç¥–å…ˆé—®é¢˜(opens new window)<ul><li>é€’å½’ï¼šé¡ºåºæ— æ‰€è°“ï¼Œå¦‚æœèŠ‚ç‚¹çš„æ•°å€¼åœ¨ç›®æ ‡åŒºé—´å°±æ˜¯æœ€è¿‘å…¬å…±ç¥–å…ˆ</li><li>è¿­ä»£ï¼šæŒ‰åºéå†</li></ul></li></ul><h3 id="7ã€äºŒå‰æœç´¢æ ‘çš„ä¿®æ”¹ä¸æ„é€ "><a href="#7ã€äºŒå‰æœç´¢æ ‘çš„ä¿®æ”¹ä¸æ„é€ " class="headerlink" title="7ã€äºŒå‰æœç´¢æ ‘çš„ä¿®æ”¹ä¸æ„é€ "></a>7ã€äºŒå‰æœç´¢æ ‘çš„ä¿®æ”¹ä¸æ„é€ </h3><ul><li>äºŒå‰æœç´¢æ ‘ä¸­çš„æ’å…¥æ“ä½œ(opens new window)<ul><li>é€’å½’ï¼šé¡ºåºæ— æ‰€è°“ï¼Œé€šè¿‡é€’å½’å‡½æ•°è¿”å›å€¼æ·»åŠ èŠ‚ç‚¹</li><li>è¿­ä»£ï¼šæŒ‰åºéå†ï¼Œéœ€è¦è®°å½•æ’å…¥çˆ¶èŠ‚ç‚¹ï¼Œè¿™æ ·æ‰èƒ½åšæ’å…¥æ“ä½œ</li></ul></li><li>äºŒå‰æœç´¢æ ‘ä¸­çš„åˆ é™¤æ“ä½œ(opens new window)<ul><li>é€’å½’ï¼šå‰åºï¼Œæƒ³æ¸…æ¥šåˆ é™¤éå¶å­èŠ‚ç‚¹çš„æƒ…å†µ</li><li>è¿­ä»£ï¼šæœ‰åºéå†ï¼Œè¾ƒå¤æ‚</li></ul></li><li>ä¿®å‰ªäºŒå‰æœç´¢æ ‘(opens new window)<ul><li>é€’å½’ï¼šå‰åºï¼Œé€šè¿‡é€’å½’å‡½æ•°è¿”å›å€¼åˆ é™¤èŠ‚ç‚¹</li><li>è¿­ä»£ï¼šæœ‰åºéå†ï¼Œè¾ƒå¤æ‚</li></ul></li><li>æ„é€ äºŒå‰æœç´¢æ ‘(opens new window)<ul><li>é€’å½’ï¼šå‰åºï¼Œæ•°ç»„ä¸­é—´èŠ‚ç‚¹åˆ†å‰²</li><li>è¿­ä»£ï¼šè¾ƒå¤æ‚ï¼Œé€šè¿‡ä¸‰ä¸ªé˜Ÿåˆ—æ¥æ¨¡æ‹Ÿ</li></ul></li></ul><h3 id="8ã€é˜¶æ®µæ€»ç»“"><a href="#8ã€é˜¶æ®µæ€»ç»“" class="headerlink" title="8ã€é˜¶æ®µæ€»ç»“"></a>8ã€é˜¶æ®µæ€»ç»“</h3><p>å¤§å®¶ä»¥ä¸Šé¢˜ç›®éƒ½åšè¿‡äº†ï¼Œä¹Ÿä¸€å®šè¦çœ‹å¦‚ä¸‹é˜¶æ®µå°ç»“ã€‚</p><p><strong>æ¯å‘¨å°ç»“éƒ½ä¼šå¯¹å¤§å®¶çš„ç–‘é—®åšç»Ÿä¸€è§£ç­”ï¼Œå¹¶ä¸”å¯¹æ¯å‘¨çš„å†…å®¹è¿›è¡Œæ‹“å±•å’Œè¡¥å……ï¼Œæ‰€ä»¥ä¸€å®šè¦çœ‹ï¼Œå°†ç»†ç¢çŸ¥è¯†ç‚¹ä¸€ç½‘æ‰“å°½ï¼</strong></p><ul><li><a href="https://programmercarl.com/%E5%91%A8%E6%80%BB%E7%BB%93/20200927%E4%BA%8C%E5%8F%89%E6%A0%91%E5%91%A8%E6%9C%AB%E6%80%BB%E7%BB%93.html">æœ¬å‘¨å°ç»“ï¼ï¼ˆäºŒå‰æ ‘ç³»åˆ—ä¸€ï¼‰(opens new window)</a></li><li><a href="https://programmercarl.com/%E5%91%A8%E6%80%BB%E7%BB%93/20201003%E4%BA%8C%E5%8F%89%E6%A0%91%E5%91%A8%E6%9C%AB%E6%80%BB%E7%BB%93.html">æœ¬å‘¨å°ç»“ï¼ï¼ˆäºŒå‰æ ‘ç³»åˆ—äºŒï¼‰(opens new window)</a></li><li><a href="https://programmercarl.com/%E5%91%A8%E6%80%BB%E7%BB%93/20201010%E4%BA%8C%E5%8F%89%E6%A0%91%E5%91%A8%E6%9C%AB%E6%80%BB%E7%BB%93.html">æœ¬å‘¨å°ç»“ï¼ï¼ˆäºŒå‰æ ‘ç³»åˆ—ä¸‰ï¼‰(opens new window)</a></li><li><a href="https://programmercarl.com/%E5%91%A8%E6%80%BB%E7%BB%93/20201017%E4%BA%8C%E5%8F%89%E6%A0%91%E5%91%A8%E6%9C%AB%E6%80%BB%E7%BB%93.html">æœ¬å‘¨å°ç»“ï¼ï¼ˆäºŒå‰æ ‘ç³»åˆ—å››ï¼‰(opens new window)</a></li></ul><h3 id="9ã€æœ€åæ€»ç»“"><a href="#9ã€æœ€åæ€»ç»“" class="headerlink" title="9ã€æœ€åæ€»ç»“"></a>9ã€æœ€åæ€»ç»“</h3><p><strong>åœ¨äºŒå‰æ ‘é¢˜ç›®é€‰æ‹©ä»€ä¹ˆéå†é¡ºåºæ˜¯ä¸å°‘åŒå­¦å¤´ç–¼çš„äº‹æƒ…ï¼Œæˆ‘ä»¬åšäº†è¿™ä¹ˆå¤šäºŒå‰æ ‘çš„é¢˜ç›®äº†ï¼ŒCarlç»™å¤§å®¶å¤§ä½“åˆ†åˆ†ç±»</strong>ã€‚</p><ul><li>æ¶‰åŠåˆ°äºŒå‰æ ‘çš„æ„é€ ï¼Œæ— è®ºæ™®é€šäºŒå‰æ ‘è¿˜æ˜¯äºŒå‰æœç´¢æ ‘ä¸€å®šå‰åºï¼Œéƒ½æ˜¯å…ˆæ„é€ ä¸­èŠ‚ç‚¹ã€‚</li><li>æ±‚æ™®é€šäºŒå‰æ ‘çš„å±æ€§ï¼Œä¸€èˆ¬æ˜¯ååºï¼Œä¸€èˆ¬è¦é€šè¿‡é€’å½’å‡½æ•°çš„è¿”å›å€¼åšè®¡ç®—ã€‚</li><li>æ±‚äºŒå‰æœç´¢æ ‘çš„å±æ€§ï¼Œä¸€å®šæ˜¯ä¸­åºäº†ï¼Œè¦ä¸ç™½çäº†æœ‰åºæ€§äº†ã€‚</li></ul><p>æ³¨æ„åœ¨æ™®é€šäºŒå‰æ ‘çš„å±æ€§ä¸­ï¼Œæˆ‘ç”¨çš„æ˜¯ä¸€èˆ¬ä¸ºååºï¼Œä¾‹å¦‚å•çº¯æ±‚æ·±åº¦å°±ç”¨å‰åºï¼Œ<a href="https://programmercarl.com/0257.%E4%BA%8C%E5%8F%89%E6%A0%91%E7%9A%84%E6%89%80%E6%9C%89%E8%B7%AF%E5%BE%84.html">äºŒå‰æ ‘ï¼šæ‰¾æ‰€æœ‰è·¯å¾„ (opens new window)</a>ä¹Ÿç”¨äº†å‰åºï¼Œè¿™æ˜¯ä¸ºäº†æ–¹ä¾¿è®©çˆ¶èŠ‚ç‚¹æŒ‡å‘å­èŠ‚ç‚¹ã€‚</p><p>æ‰€ä»¥æ±‚æ™®é€šäºŒå‰æ ‘çš„å±æ€§è¿˜æ˜¯è¦å…·ä½“é—®é¢˜å…·ä½“åˆ†æã€‚</p>]]></content>
    
    
    <categories>
      
      <category>ç®—æ³•</category>
      
    </categories>
    
    
    <tags>
      
      <tag>java</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>å•è°ƒæ ˆ</title>
    <link href="/2022/09/16/dan-diao-zhan/"/>
    <url>/2022/09/16/dan-diao-zhan/</url>
    
    <content type="html"><![CDATA[<h1 id="å•è°ƒæ ˆ"><a href="#å•è°ƒæ ˆ" class="headerlink" title="å•è°ƒæ ˆ"></a>å•è°ƒæ ˆ</h1><p>åœ¨ä½¿ç”¨å•è°ƒæ ˆçš„æ—¶å€™é¦–å…ˆè¦æ˜ç¡®å¦‚ä¸‹å‡ ç‚¹ï¼š</p><ol><li>å•è°ƒæ ˆé‡Œå­˜æ”¾çš„å…ƒç´ æ˜¯ä»€ä¹ˆï¼Ÿ</li></ol><p>å•è°ƒæ ˆé‡Œåªéœ€è¦å­˜æ”¾å…ƒç´ çš„ä¸‹æ ‡iå°±å¯ä»¥äº†ï¼Œå¦‚æœéœ€è¦ä½¿ç”¨å¯¹åº”çš„å…ƒç´ ï¼Œç›´æ¥T[i]å°±å¯ä»¥è·å–ã€‚</p><ol><li>å•è°ƒæ ˆé‡Œå…ƒç´ æ˜¯é€’å¢å‘¢ï¼Ÿ è¿˜æ˜¯é€’å‡å‘¢ï¼Ÿ</li></ol><p><strong>æ³¨æ„ä¸€ä¸‹é¡ºåºä¸º ä»æ ˆå¤´åˆ°æ ˆåº•çš„é¡ºåº</strong>ï¼Œå› ä¸ºå•çº¯çš„è¯´ä»å·¦åˆ°å³æˆ–è€…ä»å‰åˆ°åï¼Œä¸è¯´æ ˆå¤´æœå“ªä¸ªæ–¹å‘çš„è¯ï¼Œå¤§å®¶ä¸€å®šä¼šè¶Šçœ‹è¶Šæ‡µã€‚</p><h2 id="æ¯æ—¥æ¸©åº¦"><a href="#æ¯æ—¥æ¸©åº¦" class="headerlink" title="æ¯æ—¥æ¸©åº¦"></a>æ¯æ—¥æ¸©åº¦</h2><p>æ€è·¯ä¸€ï¼šæš´åŠ›ï¼Œä¸¤å±‚forå¾ªç¯å°±å¯ä»¥è§£å†³é—®é¢˜</p><p>æ€è·¯äºŒï¼šå•è°ƒæ ˆ</p><p><strong>é€šå¸¸æ˜¯ä¸€ç»´æ•°ç»„ï¼Œè¦å¯»æ‰¾ä»»ä¸€ä¸ªå…ƒç´ çš„å³è¾¹æˆ–è€…å·¦è¾¹ç¬¬ä¸€ä¸ªæ¯”è‡ªå·±å¤§æˆ–è€…å°çš„å…ƒç´ çš„ä½ç½®ï¼Œæ­¤æ—¶æˆ‘ä»¬å°±è¦æƒ³åˆ°å¯ä»¥ç”¨å•è°ƒæ ˆäº†</strong>ã€‚</p><p>å•è°ƒæ ˆæ—¶é—´å¤æ‚åº¦ä¸ºO(n)</p><p>æœ¬é¢˜ä½¿ç”¨æ ˆå¤´åˆ°æ ˆå°¾é€’å¢ï¼Œæ³¨æ„å•è°ƒæ ˆé‡Œé¢æ”¾çš„æ˜¯å…ƒç´ çš„ä¸‹æ ‡i</p><p>è‹¥æ˜¯æ ˆå°¾å…ƒç´ å¤§äºç­‰äºå½“å‰å…ƒç´ ï¼Œç›´æ¥è¿›æ ˆï¼›å¦åˆ™æ ˆå°¾å…ƒç´ å°äºå½“å‰å…ƒç´ çš„è¯ï¼Œå…ˆå¼¹å‡ºæ¯”å½“å‰å…ƒç´ å°çš„æ ˆå°¾ï¼ˆç”¨whileåˆ¤æ–­ï¼‰ï¼Œå†å…¥æ ˆ</p><h2 id="ä¸‹ä¸€ä¸ªæ›´å¤§å…ƒç´ I"><a href="#ä¸‹ä¸€ä¸ªæ›´å¤§å…ƒç´ I" class="headerlink" title="ä¸‹ä¸€ä¸ªæ›´å¤§å…ƒç´ I"></a>ä¸‹ä¸€ä¸ªæ›´å¤§å…ƒç´ I</h2><p>é¦–å…ˆæƒ³åˆ°æš´åŠ›è§£æ³•ï¼Œå¤–å±‚éå†nums1ï¼Œå†…å±‚éå†nums2ï¼Œå½“ç„¶å¯ä»¥ï¼Œæ—¶é—´å¤æ‚åº¦æ˜¯O(n*2)</p><p>ä¹Ÿå¯ä½¿ç”¨å•è°ƒæ ˆ</p><p>æˆ‘æ˜¯è¿™ä¹ˆæƒ³çš„ï¼Œå…ˆç”¨â€œæ¯æ—¥æ¸©åº¦â€çš„æ€è·¯ï¼ŒæŠŠnums2å¯»æ‰¾å³ä¾§ç¬¬ä¸€ä¸ªæ¯”è‡ªå·±å¤§çš„å…ƒç´ çš„ä½ç½®æ‰¾åˆ°ï¼Œç„¶åå†éå†num1ã€‚å¯ä»¥ä¸€è¯•ï¼›NOï¼Œåˆ°æœ€åç»™resèµ‹å€¼çš„æ—¶å€™ï¼Œæ‰¾ä¸åˆ°nums2çš„å…·ä½“ä½ç½®</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">if</span>(nums2[i] &lt;= nums2[stack.peek()])    <span class="hljs-comment">//  å°äºç­‰äºï¼Œç»§ç»­å¾€é‡Œæ”¾</span><br>     stack.push(i);<br><span class="hljs-keyword">else</span> &#123;<br>     <span class="hljs-keyword">while</span> (!stack.isEmpty() &amp;&amp; nums2[i] &gt; nums2[stack.peek()]) &#123;<br>           <span class="hljs-keyword">if</span> (hashMap.containsKey(nums2[stack.peek()])) &#123;<br>                  <span class="hljs-type">Integer</span> <span class="hljs-variable">index</span> <span class="hljs-operator">=</span> hashMap.get(nums2[stack.peek()]); <span class="hljs-comment">//å…ˆå–å‡ºnums2çš„ä¸‹æ ‡ï¼Œå†èµ‹å€¼ç»™nums1</span><br>                  res[index] = nums2[i];<br>           &#125;<br>           stack.pop();<br>     &#125;<br>     stack.push(i);<br>&#125;<br></code></pre></td></tr></table></figure><p>é‡ç‚¹æ˜¯ç¬¬6ã€7è¡Œçš„ä»£ç </p><p>ç›®çš„æ˜¯nums1è¦ä»nums2ä¸­å–å‡ºæ•°ï¼›æ¯”å¦‚ä¸‹é¢çš„nums[1],   nums[1] = 1,è®¡ç®—nums2ä¸­1çš„å³è¾¹ç¬¬ä¸€ä¸ªå¤§çš„å…ƒç´ ï¼Œè¿”å›çš„æ˜¯nums2[1]è€Œä¸æ˜¯ä¸‹æ ‡1</p><p><img src="/2022/09/16/dan-diao-zhan/Typoraæ–‡ä»¶\Typoraå›¾ç‰‡\image-20220915111659905.png" alt="image-20220915111659905"></p><h2 id="ä¸‹ä¸€ä¸ªæ›´å¤§å…ƒç´ II"><a href="#ä¸‹ä¸€ä¸ªæ›´å¤§å…ƒç´ II" class="headerlink" title="ä¸‹ä¸€ä¸ªæ›´å¤§å…ƒç´ II"></a>ä¸‹ä¸€ä¸ªæ›´å¤§å…ƒç´ II</h2><p>æœ¬é¢˜åŠ äº†ä¸ªå¾ªç¯ï¼Œä¸ªäººæƒ³æ³•æ˜¯ä¸¤éï¼Œæ•°ç»„éå†ä¸¤éï¼Œå½“æˆä¸€ä¸ªæ•°ç»„æ¥åš</p><p>ç¡®å®å¯ä»¥ï¼Œä½†æ˜¯åšäº†æ— ç”¨åŠŸï¼Œä¾‹å¦‚æ‰©å……æ•°ç»„ï¼Œæ‰©å……æ•°ç»„å°±ä¸è¯´äº†ï¼Œæœ€åè¿˜éœ€è¦å°†resæ•°ç»„åˆç¼©å°</p><p>å¡å“¥æ€è·¯ï¼šè·Ÿä¸Šé¢˜å¤§ä½“ä¸Šç±»ä¼¼ï¼Œåªä¸è¿‡æœ¬é¢˜æ˜¯éå†äº†2å€çš„æ•°ç»„ï¼Œç„¶åå¾ªç¯çš„æ—¶å€™è®¡ç®—ç”¨i%sizeæ¥è®¡ç®—</p><p>è¿™ç§å•è°ƒæ ˆï¼Œæˆ‘è§‰å¾—æœ€é‡è¦çš„æ˜¯èµ‹å€¼çš„å¤„ç†ï¼Œå¾ªç¯å†…çš„å…³é”®ä»£ç çš„ä¹¦å†™</p><h2 id="æ¥é›¨æ°´"><a href="#æ¥é›¨æ°´" class="headerlink" title="æ¥é›¨æ°´"></a>æ¥é›¨æ°´</h2><p>ä¸‰ç§æ€è·¯ï¼š</p><p>ä¸€ã€åŒæŒ‡é’ˆæ³•</p><p>è¦æ±‚é›¨æ°´ï¼ŒæŒ‰åˆ—æ¥æ±‚ï¼Œé›¨æ°´çš„é«˜åº¦ç­‰äºè¯¥åˆ—å·¦ä¾§æœ€é«˜é«˜åº¦å’Œå³ä¾§æœ€é«˜é«˜åº¦ä¸­ä½çš„é‚£ä¸ªï¼Œåªéœ€è¦å°†å·¦å³ä¾§ä½çš„é‚£ä¸ªæŸ±å­çš„é«˜åº¦å‡å»å½“å‰åˆ—æŸ±å­çš„é«˜åº¦ï¼Œå°±å¯æ±‚å‡ºè¯¥åˆ—çš„é›¨æ°´ï¼Œç„¶åä»0å¾ªç¯ï¼Œæ±‚æ€»å’Œ</p><p>äºŒã€åŠ¨æ€è§„åˆ’æ³•</p><p>ç‰›è›™ç‰›è›™</p><p>åŠ¨æ€è§„åˆ’æ€è·¯å’ŒåŒæŒ‡é’ˆæ³•å…¶å®å·®ä¸å¤šï¼Œåªä¸è¿‡ç”±äºåŒæŒ‡é’ˆæ³•å­˜åœ¨ç€å¤§é‡é‡å¤çš„æ“ä½œï¼ŒåŠ¨æ€è§„åˆ’ä¼˜åŒ–äº†ä¸€ä¸‹è€Œå·²</p><p>åŠ¨æ€è§„åˆ’è¦æ±‚å°†å·¦ä¾§æœ€é«˜é«˜åº¦å’Œå³ä¾§æœ€é«˜é«˜åº¦éƒ½ä¿å­˜åœ¨å¯¹åº”çš„ä¸€ä¸ªæ•°ç»„é‡Œï¼Œå¦‚maxleft[], maxright[]</p><p>é€’æ¨å…¬å¼ï¼šå·¦è¾¹çš„æœ€é«˜é«˜åº¦ä¸ºä¸Šä¸€ä¸ªçš„æœ€é«˜é«˜åº¦å’Œå½“å‰çš„é«˜åº¦å–æœ€å¤§å€¼ï¼Œå³ä¾§åŒç†</p><p>ä»å·¦å‘å³éå†ï¼šmaxLeft[i] = max(height[i], maxLeft[i - 1]);</p><p>ä»å³å‘å·¦éå†ï¼šmaxRight[i] = max(height[i], maxRight[i + 1]);</p><p>æœ€åæ±‚å’Œ</p><p>æœ¬é¢˜åŠ¨æ€è§„åˆ’æœ€ç®€å•</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-type">int</span>[] maxleft = <span class="hljs-keyword">new</span> <span class="hljs-title class_">int</span>[height.length];<br><span class="hljs-type">int</span>[] maxright = <span class="hljs-keyword">new</span> <span class="hljs-title class_">int</span>[height.length];<br><span class="hljs-type">int</span> <span class="hljs-variable">sum</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>;<br>maxleft[<span class="hljs-number">0</span>] = height[<span class="hljs-number">0</span>];<br>maxright[height.length - <span class="hljs-number">1</span>] = height[height.length - <span class="hljs-number">1</span>];<br><span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> <span class="hljs-variable">i</span> <span class="hljs-operator">=</span> <span class="hljs-number">1</span>; i &lt; height.length; i++) &#123;<br>     maxleft[i] = Math.max(maxleft[i - <span class="hljs-number">1</span>], height[i]);<br>&#125;<br><span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> <span class="hljs-variable">i</span> <span class="hljs-operator">=</span> height.length - <span class="hljs-number">2</span>; i &gt;= <span class="hljs-number">0</span>; i--) &#123;<br>     maxright[i] = Math.max(maxright[i + <span class="hljs-number">1</span>], height[i]);<br>&#125;<br><span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> <span class="hljs-variable">i</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>; i &lt; height.length; i++) &#123;<br>     <span class="hljs-type">int</span> <span class="hljs-variable">area</span> <span class="hljs-operator">=</span> Math.min(maxleft[i], maxright[i]) - height[i];<br>     <span class="hljs-keyword">if</span> (area &gt; <span class="hljs-number">0</span>)<br>          sum += area;<br>&#125;<br><span class="hljs-keyword">return</span> sum;<br></code></pre></td></tr></table></figure><p>ä¸‰ã€å•è°ƒæ ˆæ³•</p><p>å•è°ƒæ ˆæ³•æ¯”è¾ƒéš¾ç†è§£ï¼Œå•è°ƒæ ˆæ³•æ˜¯ç»´æŒæ ˆå†…ä»æ ˆå¤´åˆ°æ ˆå°¾ä»å°åˆ°å¤§çš„é¡ºåºæ’åˆ—ï¼Œä¸€æ—¦å‘ç°æ–°å…¥æ ˆçš„å…ƒç´ å€¼å¤§äºæ ˆé¡¶å…ƒç´ ï¼Œå°±å¼¹å‡ºæ ˆé¡¶å…ƒç´ ï¼Œæ­¤æ—¶æ ˆé¡¶å…ƒç´ å°±æ˜¯åº•éƒ¨ï¼Œå†å¼¹å‡ºæ ˆé¡¶å…ƒç´ ï¼Œæ ˆé¡¶å…ƒç´ å°±æ˜¯å·¦ä¾§æŸ±å­ï¼Œæ–°å…¥æ ˆçš„å…ƒç´ å°±æ˜¯å³ä¾§æŸ±å­ï¼›</p><p>æ€è·¯æœ‰äº†ï¼Œå…¶ä¸­è¿˜æœ‰ä¸€äº›å°ç»†èŠ‚ã€‚</p><p>æ±‚é›¨æ°´çš„é«˜åº¦å°±æ˜¯é•¿ä¹˜å®½ï¼Œé•¿æ˜¯é«˜åº¦ï¼Œå®½æ˜¯å³ä¾§ä¸å·¦ä¾§æŸ±å­ä¹‹é—´çš„è·ç¦»ï¼Œç›¸åŠ ã€‚</p><blockquote><p>å…³é”®ä»£ç ï¼š</p></blockquote><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">while</span> (!stack.isEmpty() &amp;&amp; height[i] &gt; height[stacktop]) &#123;<br>     <span class="hljs-type">int</span> <span class="hljs-variable">bottom</span> <span class="hljs-operator">=</span> stack.pop();    <span class="hljs-comment">//å…ˆæŠŠåº•æŸ±çš„ç¼–å·å–å‡º</span><br>     <span class="hljs-keyword">if</span> (!stack.isEmpty()) &#123;   <span class="hljs-comment">//è‹¥æ˜¯æ ˆä¸ä¸ºç©ºçš„è¯ï¼Œè¿›è¡Œæ“ä½œ</span><br>          <span class="hljs-type">int</span> <span class="hljs-variable">min</span> <span class="hljs-operator">=</span> Math.min(height[i], height[stack.peek()]);    <span class="hljs-comment">//å–å‡ºå·¦è¾¹å’Œå³è¾¹çš„æœ€å°å€¼ï¼Œæ³¨æ„å·¦æŸ±ä¸ºå¼¹å‡º</span><br>          <span class="hljs-type">int</span> <span class="hljs-variable">area</span> <span class="hljs-operator">=</span> (min - height[bottom]) * (i - stack.peek() - <span class="hljs-number">1</span>);  <span class="hljs-comment">// æ±‚é¢ç§¯</span><br>          <span class="hljs-keyword">if</span> (area &gt; <span class="hljs-number">0</span>)<br>                sum += area;<br>          stacktop = stack.peek();   <span class="hljs-comment">//æ³¨æ„ï¼šå·¦æŸ±å¹¶æ²¡æœ‰å¼¹å‡ºï¼Œè€Œæ˜¯æ›´æ–°æ ˆé¡¶å…ƒç´ ï¼Œæ¥ç€åˆ¤æ–­ï¼Œå› ä¸ºæ˜¯while</span><br>     &#125;<br>&#125;<br>stack.push(i);   <span class="hljs-comment">//æœ€åå†å°†å½“å‰å…ƒç´ è¿›æ ˆï¼Œè¿›è¡Œä¸‹ä¸€æ¬¡å¾ªç¯</span><br></code></pre></td></tr></table></figure><h2 id="æŸ±çŠ¶å›¾ä¸­æœ€å¤§çš„çŸ©å½¢"><a href="#æŸ±çŠ¶å›¾ä¸­æœ€å¤§çš„çŸ©å½¢" class="headerlink" title="æŸ±çŠ¶å›¾ä¸­æœ€å¤§çš„çŸ©å½¢"></a>æŸ±çŠ¶å›¾ä¸­æœ€å¤§çš„çŸ©å½¢</h2><p>æ„Ÿè§‰è¿™ç±»é¢˜åŠ¨æ€è§„åˆ’å¯èƒ½å¥½ä¸€ç‚¹ï¼Ÿ</p><p>æœ¬é¢˜è·Ÿæ¥é›¨æ°´é‚£é“é¢˜ç±»ä¼¼ï¼Œåªä¸è¿‡æœ¬é¢˜æ¢æˆäº†æ±‚å½“å‰æŸ±å­å·¦å³ä¸¤è¾¹ç¬¬ä¸€ä¸ªå°äºè¯¥æŸ±å­çš„æŸ±å­</p><p>è¿˜æœ‰ä¸€ä¸ªåŒºåˆ«ï¼Œæ˜¯æœ¬é¢˜è¦è®°å½•ä¸‹æ ‡ï¼Œè€Œä¸æ˜¯é«˜åº¦</p><blockquote><p>æ€è·¯ä¸€ï¼šåŠ¨æ€è§„åˆ’</p></blockquote><p>åŠ¨æ€è§„åˆ’ä¸»è¦ä½“ç°åœ¨æ±‚ä¸¤ä¾§ç¬¬ä¸€ä¸ªå°äºè¯¥æŸ±å­çš„æŸ±å­ä¸Š</p><ul><li>æ±‚å·¦ä¾§ï¼š<br>ä»0å¼€å§‹éå†ï¼Œä½¿ç”¨ä¸€ä¸ªå˜é‡tæ¥è®°å½•ï¼Œç¢°åˆ°å¤§çš„ï¼Œå†å¾€å·¦èµ°ï¼›ç¢°åˆ°å°çš„ç›´æ¥èµ‹å€¼</li><li>æ±‚å³ä¾§ï¼š<br>ä»length-2å¼€å§‹éå†ï¼Œè·Ÿæ±‚å·¦ä¾§ä¸€æ ·</li></ul><p>æœ€åæ±‚å’Œï¼Œæ±‚æœ€å¤§</p><blockquote><p>æ€è·¯äºŒï¼šå•è°ƒæ ˆ</p></blockquote><p>ä¹Ÿèƒ½æˆåŠŸACï¼Œä½†æ˜¯å¾ˆæ˜æ˜¾ï¼Œå•è°ƒæ ˆçš„ç”¨æ—¶æ›´é•¿</p><p>ç»´æŒä¸€ä¸ªæ ˆå¤´åˆ°æ ˆå°¾ç”±å¤§åˆ°å°çš„æ ˆï¼Œè‹¥æ˜¯é‡åˆ°å½“å‰å…ƒç´ å¤§äºæ ˆå¤´å…ƒç´ çš„ï¼Œç›´æ¥è¿›æ ˆï¼›ç­‰äºä¹Ÿæ˜¯ç›´æ¥è¿›æ ˆï¼›å½“å‰å…ƒç´ å°äºæ ˆå¤´å…ƒç´ çš„ï¼Œé‚£ä¹ˆå½“å‰æ ˆé¡¶å…ƒç´ å°±æ˜¯åº•æŸ±ï¼Œæ ˆé¡¶å¼¹å‡ºåï¼Œå½“å‰å…ƒç´ çš„æ ˆé¡¶æ˜¯å·¦æŸ±ï¼Œiæ˜¯å³æŸ±ï¼›å³å¯æ±‚å‡ºé¢ç§¯ï¼Œå¹¶åŒæ±‚æœ€å¤§å€¼ã€‚</p><p>ä½†æ˜¯éœ€è¦æ•°ç»„æ‰©å®¹ï¼Œä¸¤è¾¹åŒæ—¶æ‰©ä¸€ä¸‹ï¼›å¯èƒ½æ˜¯ä¸ºäº†é˜²æ­¢i = 1çš„æ—¶å€™å‰é¢æ²¡æœ‰å…ƒç´ å¯å¼¹å‡ºç°æ ˆæº¢å‡ºçš„é”™è¯¯å§ã€‚</p>]]></content>
    
    
    <categories>
      
      <category>ç®—æ³•</category>
      
    </categories>
    
    
    <tags>
      
      <tag>java</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>åŠ¨æ€è§„åˆ’</title>
    <link href="/2022/09/16/dong-tai-gui-hua/"/>
    <url>/2022/09/16/dong-tai-gui-hua/</url>
    
    <content type="html"><![CDATA[<h1 id="åŠ¨æ€è§„åˆ’"><a href="#åŠ¨æ€è§„åˆ’" class="headerlink" title="åŠ¨æ€è§„åˆ’"></a>åŠ¨æ€è§„åˆ’</h1><p>åŠ¨æ€è§„åˆ’é€šä¿—æ¥è®²å°±æ˜¯ç”±ä¸Šä¸€ä¸ªçŠ¶æ€æ¨å¯¼å‡ºæ¥çš„</p><p>çŠ¶æ€è½¬ç§»å…¬å¼</p><p>ä¸€èˆ¬è§£é¢˜æ­¥éª¤æœ‰ä»¥ä¸‹äº”æ­¥ï¼š</p><ol><li>ç¡®å®šdpæ•°ç»„ï¼ˆdp tableï¼‰ä»¥åŠä¸‹æ ‡çš„å«ä¹‰</li><li>ç¡®å®šé€’æ¨å…¬å¼</li><li>dpæ•°ç»„å¦‚ä½•åˆå§‹åŒ–</li><li>ç¡®å®šéå†é¡ºåº</li><li>ä¸¾ä¾‹æ¨å¯¼dpæ•°ç»„</li></ol><p>åŠ¨æ€è§„åˆ’Debug</p><p>å…ˆç¡®å®šçŠ¶æ€è½¬ç§»å…¬å¼ï¼Œåšåˆ°å¿ƒä¸­æœ‰æ•°ï¼›è‹¥æ²¡é€šè¿‡ï¼Œæ‰“å°å‡ºæ¥ï¼Œçœ‹çœ‹ä¸è‡ªå·±å¿ƒä¸­æ‰€æƒ³æ˜¯å¦ä¸€æ ·ï¼›è‹¥æ˜¯ä¸€æ ·çš„ï¼Œé‚£å°±æ˜¯é€’æ¨å…¬å¼ã€åˆå§‹åŒ–æˆ–è€…éå†é¡ºåºæœ‰é—®é¢˜äº†ã€‚</p><p>==é—®é¢˜è¦é—®çš„ä¸“ä¸š==</p><h2 id="æ–æ³¢é‚£å¥‘æ•°"><a href="#æ–æ³¢é‚£å¥‘æ•°" class="headerlink" title="æ–æ³¢é‚£å¥‘æ•°"></a>æ–æ³¢é‚£å¥‘æ•°</h2><p>DPäº”éƒ¨æ›²ï¼š</p><ol><li><p>ç¡®å®šdpæ•°ç»„ä»¥åŠä¸‹æ ‡å«ä¹‰ï¼šdp[i]çš„å®šä¹‰ï¼šç¬¬iä¸ªæ•°çš„æ–æ³¢é‚£å¥‘æ•°å€¼æ˜¯dp[i]</p></li><li><p>ç¡®å®šé€’æ¨å…¬å¼ï¼šé¢˜ç›®å·²ç»ç»™äº†ï¼Œ<strong>çŠ¶æ€è½¬ç§»æ–¹ç¨‹ dp[i] = dp[i - 1] + dp[i - 2];</strong></p></li><li><p>å¦‚ä½•åˆå§‹åŒ–ï¼š</p><figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs text">dp[0] = 0;<br>dp[1] = 1;<br></code></pre></td></tr></table></figure></li><li><p>ç¡®å®šéå†é¡ºåºï¼šä»å‰å¾€åéå†</p></li><li><p>ä¸¾ä¾‹æ¨å¯¼dpæ•°ç»„ï¼šæŒ‰ç…§è¿™ä¸ªé€’æ¨å…¬å¼dp[i] = dp[i - 1] + dp[i - 2]ï¼Œæˆ‘ä»¬æ¥æ¨å¯¼ä¸€ä¸‹ï¼Œå½“Nä¸º10çš„æ—¶å€™ï¼Œdpæ•°ç»„åº”è¯¥æ˜¯å¦‚ä¸‹çš„æ•°åˆ—ï¼š</p><p>0 1 1 2 3 5 8 13 21 34 55</p></li></ol><h2 id="çˆ¬æ¥¼æ¢¯"><a href="#çˆ¬æ¥¼æ¢¯" class="headerlink" title="çˆ¬æ¥¼æ¢¯"></a>çˆ¬æ¥¼æ¢¯</h2><p>dp[i]çš„å®šä¹‰ï¼š  ç¬¬iä¸ªé˜¶æ¢¯æœ‰å¤šå°‘ç§çˆ¬æ¥¼æ¢¯çš„æ–¹å¼</p><p>é€’æ¨å…¬å¼ï¼š  </p><p>Outï¼</p><p>å¡å“¥æ€è·¯ï¼š</p><ol><li>dp[i]çš„å®šä¹‰ï¼š  ç¬¬iä¸ªé˜¶æ¢¯æœ‰å¤šå°‘ç§çˆ¬æ¥¼æ¢¯çš„æ–¹å¼</li><li>é€’æ¨å…¬å¼ï¼š<br>å…ˆæƒ³dp[i - 1]ï¼Œdp[i - 1] å†çˆ¬ä¸Šä¸€é˜¶å°±æ˜¯dp[i];å†æƒ³dp[i - 2]ï¼Œdp[i - 2]å†çˆ¬ä¸Šä¸¤é˜¶å°±æ˜¯dp[i]ï¼›<br>æ‰€ä»¥dp[i] = dp[i - 1] + dp[i - 2];</li><li>åˆå§‹åŒ–å°±æœ‰äº‰è®®äº†ï¼šä½†æ˜¯æ³¨æ„çœ‹é¢˜ç›®çš„èŒƒå›´ï¼Œé¢˜ç›®è¯´çš„æ˜¯nä¸ºæ•´æ•°ï¼Œé‚£ä¹ˆè‡ªç„¶ä»1å¼€å§‹å–½ï¼Œåˆå§‹åŒ–1ã€2ï¼Œç„¶åä»3å¼€å§‹éå†</li><li>ç¡®å®šéå†é¡ºåºï¼šä»å‰å¾€åéå†</li><li>ä¸¾ä¾‹æ¨å¯¼dpæ•°ç»„ï¼š<br><img src="/2022/09/16/dong-tai-gui-hua/Typoraæ–‡ä»¶\Typoraå›¾ç‰‡\image-20220624112625495.png" alt="image-20220624112625495"></li></ol><p>é€’æ¨å…¬å¼è¿™æ ·æƒ³ï¼š iå±‚ = i - 1 å±‚ + i- 2 å±‚çš„</p><p>æœ‰å¤šå°‘ç§æ–¹æ³•è¾¾åˆ°i-1å±‚ï¼Œå…ˆè®°ä¸ºn1,ï¼›æœ‰å¤šå°‘ç§æ–¹æ³•è¾¾åˆ°i-2å±‚ï¼Œå†è®°ä¸ºn2ï¼›è®©è¿™ä¿©ç›¸åŠ å³å¯</p><h2 id="ä½¿ç”¨æœ€å°èŠ±è´¹çˆ¬æ¥¼æ¢¯"><a href="#ä½¿ç”¨æœ€å°èŠ±è´¹çˆ¬æ¥¼æ¢¯" class="headerlink" title="ä½¿ç”¨æœ€å°èŠ±è´¹çˆ¬æ¥¼æ¢¯"></a>ä½¿ç”¨æœ€å°èŠ±è´¹çˆ¬æ¥¼æ¢¯</h2><p>ä½†æ˜¯è¿™é“é¢˜å¥½åƒä¹Ÿå¯ä»¥ç”¨è´ªå¿ƒï¼Ÿ</p><ol><li>dp[i]è¡¨ç¤ºå‰ié˜¶æ¥¼æ¢¯æ‰€ç”¨çš„èŠ±è´¹</li><li>é€’æ¨å…¬å¼ï¼š<br>ä¸ä¼šäº†</li></ol><p>ä¸èƒ½ç”¨è´ªå¿ƒ</p><p>æ¥ç€æ¥</p><ol><li>dp[i]è¡¨ç¤ºå‰ié˜¶æ¥¼æ¢¯æ‰€ç”¨çš„èŠ±è´¹</li><li>é€’æ¨å…¬å¼ï¼š<br>ä»i-1å’Œi-2å¤„ä¸‹æ‰‹ï¼Œdp[i] = min(dp[i-1], dp[i - 2]) + cost[i];<br>ä¸ä¼šé€’æ¨å…¬å¼äº†å°±ä»i-1å’Œi-2ä¸‹æ‰‹</li><li>åˆå§‹åŒ–ï¼šåªéœ€åˆå§‹åŒ–dp[0]å’Œdp[1]å³å¯</li><li>ç¡®å®šéå†é¡ºåºï¼Œæœ¬ä½“æ˜¾ç„¶æ˜¯ä»å‰åˆ°å</li><li>ä¸¾ä¾‹æ¨å¯¼</li></ol><p>ä¸ªäººè§‰å¾—dpå®Œäº†ä¹‹åè¿˜è¦éªŒç®—ä¸€ä¸‹ç»“å°¾æƒ…å†µ</p><h2 id="ä¸åŒè·¯å¾„"><a href="#ä¸åŒè·¯å¾„" class="headerlink" title="ä¸åŒè·¯å¾„"></a>ä¸åŒè·¯å¾„</h2><p>åŠ¨æ€è§„åˆ’äº”éƒ¨æ›²ï¼š</p><ol><li>ç¡®å®šdpæ•°ç»„çš„å«ä¹‰ï¼Œdp[i] [j]è¡¨ç¤ºåˆ°è¾¾è¿™ä¸€æ­¥æœ‰å¤šå°‘ç§èµ°æ³•ï¼Œæœ€åè¿”å›dp[m] [n]å³å¯</li><li>é€’æ¨å…¬å¼ï¼š<br>dp[i] [j] = dp[i - 1] [j] + dp[i] [j - 1];</li><li>åˆå§‹åŒ–ï¼š<br>dp[0] [0] = 1ï¼›dp[0] [1] = 1ï¼›dp[1] [0] = 1ï¼›</li><li>äºŒç»´æ•°ç»„è¿›è¡Œéå†ï¼ŒåŒé‡å¾ªç¯</li><li>ä¸¾ä¾‹æ¨å¯¼</li></ol><p>ä¸Šè¿°äº”éƒ¨æ›²ä¸­ï¼Œæœ‰é—®é¢˜çš„æ˜¯ç¬¬ä¸‰ç‚¹å’Œç¬¬å››ç‚¹ã€‚é¦–å…ˆç¬¬ä¸‰ç‚¹åˆå§‹åŒ–ï¼Œåˆå§‹åŒ–åªåˆå§‹åŒ–äº†  0 1   å’Œ 1 0ï¼Œä½†æ˜¯è¦æ˜¯ç¢°åˆ°0 2 å’Œ2 0 å‘¢ï¼Ÿä¼šæŠ¥é”™ï¼Œæ‰€ä»¥è¾¹ç•Œéƒ½è¦è€ƒè™‘åˆ°ä½ï¼Œè‡³äºè¯´æ˜¯å…·ä½“æ˜¯å‡ ç§èµ°æ³•ï¼Œå½“ç„¶æ˜¯ä¸€ç§å•¦ï¼Œå› ä¸ºè¾¹ç•Œï¼Œåªæœ‰ä»è¾¹ç•Œè¿™ä¸€ä¾§èµ°è¿‡æ¥ï¼›ç¬¬å››ç‚¹éå†é¡ºåºï¼Œä¸å¤Ÿç»†è‡´ï¼Œæ˜¯ä»å·¦åˆ°å³ä¸ºä¸»å‘¢è¿˜æ˜¯ä»ä¸Šåˆ°ä¸‹ä¸ºä¸»ï¼Œå…¶å®æˆ‘è§‰å¾—éƒ½å¯ä»¥ï¼Œä½†æ˜¯è¦å†™å‡ºæ¥ï¼Œä»å·¦åˆ°å³é¡ºç†æˆç« ã€‚</p><p>æˆåŠŸAC</p><p>è¿˜æœ‰ä¸€ç§æ€è·¯ï¼š</p><p>æ•°è®ºæ–¹æ³•ï¼š</p><p>ç»„åˆæ•°å­¦ä¸­å­¦åˆ°çš„èš‚èšä¸Šæ ‘é—®é¢˜ï¼Œå‰å®³å‰å®³ï¼</p><p>ç»„åˆé—®é¢˜ï¼Œä»ï¼ˆ0ï¼Œ0ï¼‰åˆ°ï¼ˆm, nï¼‰ï¼Œå…±éœ€è¦ m + n - 2æ­¥ï¼Œéœ€è¦m - 1æ­¥çš„å‘å³ï¼Œæ‰€ä»¥å°±æ˜¯</p><p><img src="/2022/09/16/dong-tai-gui-hua/Typoraæ–‡ä»¶\Typoraå›¾ç‰‡\image-20220627101912530.png" alt="image-20220627101912530"></p><p>Yse, AC !</p><p>long è½¬int:</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-comment">//è¿”å›intå‹</span><br><span class="hljs-type">long</span> <span class="hljs-variable">a</span> <span class="hljs-operator">=</span> <span class="hljs-number">300</span>;<br><span class="hljs-keyword">return</span> (<span class="hljs-type">int</span>)a;<br></code></pre></td></tr></table></figure><h2 id="ä¸åŒè·¯å¾„II"><a href="#ä¸åŒè·¯å¾„II" class="headerlink" title="ä¸åŒè·¯å¾„II"></a>ä¸åŒè·¯å¾„II</h2><p>ä¸­é—´æœ‰éšœç¢ç‰©äº†ï¼›</p><p>ä¸ªäººæ€è·¯ï¼šä¸ä¸Šä¸€é¢˜dpä¸€æ ·ï¼Œåªä¸è¿‡å¤šäº†ä¸€ä¸ªéšœç¢ç‰©åˆ¤æ–­</p><ol><li>ç¡®å®šdpæ•°ç»„çš„å«ä¹‰ï¼Œdp[i] [j]è¡¨ç¤ºåˆ°è¾¾è¿™ä¸€æ­¥æœ‰å¤šå°‘ç§èµ°æ³•ï¼Œæœ€åè¿”å›dp[m] [n]å³å¯</li><li>é€’æ¨å…¬å¼ï¼š<br>dp[i] [j] = dp[i - 1] [j] + dp[i] [j - 1];ä¸­é—´åŠ ä¸€ä¸ªåˆ¤æ–­æ˜¯å¦ä¸ºéšœç¢ç‰©</li><li>åˆå§‹åŒ–ï¼š<br>æ‰€æœ‰è¾¹ç•Œéƒ½åˆå§‹åŒ–ä¸º1</li><li>ä¸€å±‚ä¸€å±‚çš„æ¥ï¼Œä»å·¦åˆ°å³ï¼Œä»ä¸Šåˆ°ä¸‹</li><li>ä¸¾ä¾‹æ¨å¯¼</li></ol><p>Yes   æˆåŠŸACï¼Œæ”¹äº†åŠå¤©bugï¼Œé—®é¢˜åœ¨äºåˆå§‹åŒ–ï¼Œè‹¥æ˜¯ç¢°åˆ°åœ¨è¾¹ç•Œçš„éšœç¢ç‰©ï¼Œè¯¥æ€ä¹ˆåˆå§‹åŒ–ï¼Ÿåº”è¯¥å°†å…¶ä»¥åŠå…¶åé¢çš„è¾¹ç•Œå…¨ç½®ä½0</p><p>çœ‹äº†å¡å“¥çš„ä»£ç ï¼Œæ„Ÿè§‰è‡ªå·±å¥½è ¢å•Šï¼Œå…¶å®å¯ä»¥ä¸ç”¨åˆ†çš„è¿™ä¹ˆç»†ï¼Œåªè€ƒè™‘éœ€è¦çš„æƒ…å†µå³å¯ï¼Œä¾‹å¦‚è¿›è¡Œåˆå§‹åŒ–æ—¶æˆ‘æ˜¯è¿™æ ·çš„ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-type">int</span> <span class="hljs-variable">flag</span> <span class="hljs-operator">=</span> <span class="hljs-number">1</span>;<br>      <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> <span class="hljs-variable">i</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>; i &lt; obstacleGrid.length; i++) &#123;<br>          <span class="hljs-keyword">if</span> (obstacleGrid[i][<span class="hljs-number">0</span>] == <span class="hljs-number">1</span>)<br>              flag = <span class="hljs-number">0</span>;<br>          <span class="hljs-keyword">if</span> (flag == <span class="hljs-number">1</span>)<br>              dp[i][<span class="hljs-number">0</span>] = <span class="hljs-number">1</span>;<br>          <span class="hljs-keyword">else</span><br>              dp[i][<span class="hljs-number">0</span>] = <span class="hljs-number">0</span>;<br>      &#125;<br>      flag = <span class="hljs-number">1</span>;<br>      <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> <span class="hljs-variable">j</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>; j &lt; obstacleGrid[<span class="hljs-number">0</span>].length; j++) &#123;<br>          <span class="hljs-keyword">if</span> (obstacleGrid[<span class="hljs-number">0</span>][j] == <span class="hljs-number">1</span>)<br>              flag = <span class="hljs-number">0</span>;<br>          <span class="hljs-keyword">if</span> (flag == <span class="hljs-number">1</span>)<br>              dp[<span class="hljs-number">0</span>][j] = <span class="hljs-number">1</span>;<br>          <span class="hljs-keyword">else</span><br>              dp[<span class="hljs-number">0</span>][j] = <span class="hljs-number">0</span>;<br>      &#125;<br></code></pre></td></tr></table></figure><p>å¡å“¥æ˜¯è¿™æ ·çš„:</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> <span class="hljs-variable">i</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>; i &lt; m; i++) &#123;<br>   <span class="hljs-keyword">if</span> (obstacleGrid[<span class="hljs-number">0</span>][i] == <span class="hljs-number">1</span>) <span class="hljs-keyword">break</span>; <span class="hljs-comment">//ä¸€æ—¦é‡åˆ°éšœç¢ï¼Œåç»­éƒ½åˆ°ä¸äº†</span><br>   dp[<span class="hljs-number">0</span>][i] = <span class="hljs-number">1</span>;<br>      &#125;<br>      <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> <span class="hljs-variable">i</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>; i &lt; n; i++) &#123;<br>   <span class="hljs-keyword">if</span> (obstacleGrid[i][<span class="hljs-number">0</span>] == <span class="hljs-number">1</span>) <span class="hljs-keyword">break</span>; <span class="hljs-comment">////ä¸€æ—¦é‡åˆ°éšœç¢ï¼Œåç»­éƒ½åˆ°ä¸äº†</span><br>   dp[i][<span class="hljs-number">0</span>] = <span class="hljs-number">1</span>;<br>      &#125;<br></code></pre></td></tr></table></figure><p>éå†ä¼˜åŒ–,æˆ‘çš„ä»£ç å¦‚ä¸‹:</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (obstacleGrid[i - <span class="hljs-number">1</span>][j] == <span class="hljs-number">1</span> &amp;&amp; obstacleGrid[i][j - <span class="hljs-number">1</span>] != <span class="hljs-number">1</span>)<br>dp[i][j] = dp[i][j - <span class="hljs-number">1</span>];<br><span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (obstacleGrid[i][j - <span class="hljs-number">1</span>] == <span class="hljs-number">1</span> &amp;&amp; obstacleGrid[i - <span class="hljs-number">1</span>][j] != <span class="hljs-number">1</span>)<br>dp[i][j] = dp[i - <span class="hljs-number">1</span>][j];<br><span class="hljs-keyword">else</span><br>dp[i][j] = dp[i - <span class="hljs-number">1</span>][j] + dp[i][j - <span class="hljs-number">1</span>];<br></code></pre></td></tr></table></figure><p>ä½†å…¶å®ï¼Œè¿™ä¸‰ç§å¯ä»¥åˆä¸ºä¸€ç§ï¼Œå› ä¸ºç¢°åˆ°ä¸€ç§æƒ…å†µæ—¶ï¼Œå¦ä¸€ä¸ªdpå°±ä¸º0ï¼Œæ‰€ä»¥åŠ ä¸Šä¹Ÿæ— æ‰€è°“</p><p>å¯ä»¥ç›´æ¥åˆä¸ºï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs java">dp[i][j] = dp[i - <span class="hljs-number">1</span>][j] + dp[i][j - <span class="hljs-number">1</span>]<br></code></pre></td></tr></table></figure><h2 id="æ•´æ•°æ‹†åˆ†"><a href="#æ•´æ•°æ‹†åˆ†" class="headerlink" title="æ•´æ•°æ‹†åˆ†"></a>æ•´æ•°æ‹†åˆ†</h2><p>åŠ¨æ€è§„åˆ’äº”éƒ¨æ›²ï¼š</p><ol><li>ç¡®å®šdp[i]çš„æ„æ€ï¼šdp[i]è¡¨ç¤º iå¯ä»¥æ‹†åˆ†æˆçš„æœ€å¤§ä¹˜ç§¯ã€‚ä¸‹é¢æƒ³ä¸é€šäº†å¯ä»¥å›æ¥æƒ³æƒ³dp[i]çš„å«ä¹‰ï¼›</li><li>ç¡®å®šé€’æ¨å…¬å¼ï¼šé€’å½’å…¬å¼è‹¥æ˜¯ä¸å¥½æƒ³çš„è¯ï¼Œå¯ä»¥å¾€å›æƒ³æƒ³ï¼Œæƒ³æƒ³i - 1æˆ–è€…æ˜¯dp[i]æ˜¯æ€ä¹ˆå¾—æ¥çš„ã€‚å¯ä»¥åˆ†ä¸ºä¸¤éƒ¨åˆ†ï¼š  j *(i - j)æˆ–è€… j *dp[i - j]ï¼ŒäºŒè€…å–æœ€å¤§å€¼ã€‚è¿™ä¸ºä»€ä¹ˆå¯ä»¥å‘¢ï¼Œç¬¬ä¸€ä¸ªæ˜¯æŠŠ iç›´æ¥åˆ†ä¸ºä¸¤ä¸ªæ•°çš„ä¹˜ç§¯ï¼Œç¬¬äºŒä¸ªæ˜¯æŠŠiåˆ†ä¸ºä¸¤ä¸ªä»¥ä¸Šçš„ä¹˜ç§¯ï¼Œjä»1å¼€å§‹éå†ï¼Œä¸€ç›´å»æœ€å¤§å€¼å³å¯ï¼›</li><li>åˆå§‹åŒ–ï¼šdp[1] = 1;dp[2] = 1; dp[3] = 2;</li><li>éå†é¡ºåºä»å‰åˆ°åï¼Œä¸¤å±‚éå†ï¼›å¤–å±‚æ˜¯i: 3åˆ°iï¼Œå†…å±‚æ˜¯j: 1åˆ°i</li><li>ä¸¾ä¾‹æ¨å¯¼</li></ol><p>è¿™é“é¢˜éå†çš„æ—¶å€™ï¼Œå¡å“¥å†…å±‚æ˜¯ä»1éå†åˆ°i - jï¼Œå¡å“¥è¯´æ˜¯åé¢é‡å¤äº†ï¼Œä½†æ˜¯ç”±äºæˆ‘è¿˜æ²¡æœ‰ç›¸åŒï¼Œæ‰€ä»¥ç›´æ¥ç”¨çš„ 1åˆ°i</p><h2 id="ä¸åŒçš„äºŒå‰æœç´¢æ ‘"><a href="#ä¸åŒçš„äºŒå‰æœç´¢æ ‘" class="headerlink" title="ä¸åŒçš„äºŒå‰æœç´¢æ ‘"></a>ä¸åŒçš„äºŒå‰æœç´¢æ ‘</h2><p>åŠ¨æ€è§„åˆ’äº”éƒ¨æ›²ï¼š</p><ol><li>ç¡®å®šdp[i]çš„æ„æ€ï¼šdp[i]çš„æ„æ€æ˜¯iä¸ªèŠ‚ç‚¹çš„äºŒå‰æœç´¢æ ‘å…±æœ‰dp[i]ç§</li><li>ç¡®å®šé€’æ¨å…¬å¼ï¼šå¾€å›æƒ³ï¼Œå¦‚æœæ±‚dp[3]çš„æ—¶å€™ï¼Œå…ˆæƒ³dp[2],ç„¶åå†æ€ä¹ˆæ¼”åŒ–ä¸ºdp[3]ï¼Œä½†æ˜¯æ¼”åŒ–ï¼Œæˆ‘æƒ³åˆ°çš„æ˜¯ï¼šåˆ†ä¸ºå¤§äºéƒ¨åˆ†å’Œå°äºéƒ¨åˆ†ï¼Œä½†æ˜¯ä¸­é—´éƒ¨åˆ†å‘¢ï¼Ÿ<br>dp[i] = 2 * dp[i - 1] + 1ï¼Ÿ</li><li>åˆå§‹åŒ–ï¼š</li></ol><p>å’ï¼</p><p>ç¬¬äºŒæ­¥å°±é”™äº†ã€‚</p><p>å¡å“¥æ€è·¯ï¼šç”»å›¾ï¼Œå…ˆç”»å‡ºä¸€ä¸ªèŠ‚ç‚¹çš„æ•°é‡ï¼Œå†ç”»å‡ºä¸¤ä¸ªèŠ‚ç‚¹çš„æ•°é‡ï¼›ç„¶åç”»ç¬¬ä¸‰ä¸ªèŠ‚ç‚¹çš„æ—¶å€™ï¼Œåˆ†ä¸ºå‡ ç§æƒ…å†µï¼Œ1ä¸ºèŠ‚ç‚¹å¤´ï¼Œ2ä¸ºèŠ‚ç‚¹å¤´ï¼Œ3ä¸ºèŠ‚ç‚¹å¤´ã€‚</p><p>1ä¸ºèŠ‚ç‚¹å¤´æ—¶ï¼Œæ•°é‡å°±æ˜¯dp[2]ï¼›2ä¸ºèŠ‚ç‚¹å¤´æ—¶ï¼Œæ•°é‡å°±æ˜¯d[1]*d[1];3ä¸ºèŠ‚ç‚¹å¤´æ—¶ï¼Œæ•°é‡å°±æ˜¯dp[2]ã€‚</p><p>æ‰€ä»¥æ¥ç€ä¸Šè¿°ï¼š</p><ol><li></li><li>é€’æ¨å…¬å¼ï¼šdp[i]  += dp[j - 1] * dp[i - j];  jä»1å¼€å§‹</li><li>åˆå§‹åŒ–ï¼šåªéœ€åˆå§‹åŒ–dp[0] = 1å³å¯</li><li>éå†é¡ºåºå½“ç„¶æ˜¯ä»å‰å¾€åéå†</li><li>ä¸¾ä¾‹æ¨å¯¼ </li></ol><p>æˆåŠŸACï¼ä½†æ˜¯é€’æ¨å…¬å¼åˆ°åº•æ€ä¹ˆæƒ³å‡ºæ¥çš„ã€‚</p><p>å½“i = 3æ—¶ï¼Œ   0 2ï¼›  1 1ï¼› 2 0  </p><p>jä»0å¼€å§‹ï¼Œåˆ°i - 1ã€‚</p><p>é€’æ¨å…¬å¼ä¾ç„¶æ˜¯ä»å‰é¢å‡ ä¸ªå…¥æ‰‹ï¼Œä»è€Œæ¨å‡ºiæ˜¯æ€ä¹ˆæ¥åˆ° ã€‚</p><h2 id="èƒŒåŒ…é—®é¢˜"><a href="#èƒŒåŒ…é—®é¢˜" class="headerlink" title="èƒŒåŒ…é—®é¢˜"></a>èƒŒåŒ…é—®é¢˜</h2><p><img src="/2022/09/16/dong-tai-gui-hua/Typoraæ–‡ä»¶\Typoraå›¾ç‰‡\image-20220628110720342.png" alt="image-20220628110720342"></p><h3 id="01èƒŒåŒ…é—®é¢˜ï¼ˆäºŒç»´æ•°ç»„ï¼‰"><a href="#01èƒŒåŒ…é—®é¢˜ï¼ˆäºŒç»´æ•°ç»„ï¼‰" class="headerlink" title="01èƒŒåŒ…é—®é¢˜ï¼ˆäºŒç»´æ•°ç»„ï¼‰"></a>01èƒŒåŒ…é—®é¢˜ï¼ˆäºŒç»´æ•°ç»„ï¼‰</h3><p>æœ‰nä»¶ç‰©å“å’Œä¸€ä¸ªæœ€å¤šèƒ½èƒŒé‡é‡ä¸ºw çš„èƒŒåŒ…ã€‚ç¬¬iä»¶ç‰©å“çš„é‡é‡æ˜¯weight[i]ï¼Œå¾—åˆ°çš„ä»·å€¼æ˜¯value[i] ã€‚<strong>æ¯ä»¶ç‰©å“åªèƒ½ç”¨ä¸€æ¬¡</strong>ï¼Œæ±‚è§£å°†å“ªäº›ç‰©å“è£…å…¥èƒŒåŒ…é‡Œç‰©å“ä»·å€¼æ€»å’Œæœ€å¤§ã€‚</p><p>åŠ¨æ€è§„åˆ’äº”éƒ¨æ›²ï¼š</p><ol><li><p>ç¡®å®šdpæ•°ç»„ä»¥åŠå«ä¹‰ï¼šå¯¹äºèƒŒåŒ…é—®é¢˜ï¼Œæœ‰ä¸€ç§å†™æ³•ï¼Œ æ˜¯ä½¿ç”¨äºŒç»´æ•°ç»„ï¼Œå³<strong>dp[i] [j] è¡¨ç¤ºä»ä¸‹æ ‡ä¸º[0-i]çš„ç‰©å“é‡Œä»»æ„å–ï¼Œæ”¾è¿›å®¹é‡ä¸ºjçš„èƒŒåŒ…ï¼Œä»·å€¼æ€»å’Œæœ€å¤§æ˜¯å¤šå°‘</strong>ã€‚</p></li><li><p>é‚£ä¹ˆå¯ä»¥æœ‰ä¸¤ä¸ªæ–¹å‘æ¨å‡ºæ¥dp[i] [j]ï¼Œ</p><ul><li><strong>ä¸æ”¾ç‰©å“i</strong>ï¼šç”±dp[i - 1] [j]æ¨å‡ºï¼Œå³èƒŒåŒ…å®¹é‡ä¸ºjï¼Œé‡Œé¢ä¸æ”¾ç‰©å“içš„æœ€å¤§ä»·å€¼ï¼Œæ­¤æ—¶dp[i][j]å°±æ˜¯dp[i - 1] [j]ã€‚(å…¶å®å°±æ˜¯å½“ç‰©å“içš„é‡é‡å¤§äºèƒŒåŒ…jçš„é‡é‡æ—¶ï¼Œç‰©å“iæ— æ³•æ”¾è¿›èƒŒåŒ…ä¸­ï¼Œæ‰€ä»¥è¢«èƒŒåŒ…å†…çš„ä»·å€¼ä¾ç„¶å’Œå‰é¢ç›¸åŒã€‚)</li><li><strong>æ”¾ç‰©å“i</strong>ï¼šç”±dp[i - 1] [j - weight[i]]æ¨å‡ºï¼Œdp[i - 1] [j - weight[i]] ä¸ºèƒŒåŒ…å®¹é‡ä¸ºj - weight[i]çš„æ—¶å€™ä¸æ”¾ç‰©å“içš„æœ€å¤§ä»·å€¼ï¼Œé‚£ä¹ˆdp[i - 1] [j - weight[i]] + value[i] ï¼ˆç‰©å“içš„ä»·å€¼ï¼‰ï¼Œå°±æ˜¯èƒŒåŒ…æ”¾ç‰©å“iå¾—åˆ°çš„æœ€å¤§ä»·å€¼</li></ul><p>é€’å½’å…¬å¼ï¼š dp[i] [j] = max(dp[i - 1] [j], dp[i - 1] [j - weight[i]] + value[i]);</p></li><li><p>åˆå§‹åŒ–ï¼šé¦–å…ˆä»dp[i] [j]çš„å®šä¹‰å‡ºå‘ï¼Œå¦‚æœèƒŒåŒ…å®¹é‡jä¸º0çš„è¯ï¼Œå³dp[i] [0]ï¼Œæ— è®ºæ˜¯é€‰å–å“ªäº›ç‰©å“ï¼ŒèƒŒåŒ…ä»·å€¼æ€»å’Œä¸€å®šä¸º0ã€‚</p><p>çŠ¶æ€è½¬ç§»æ–¹ç¨‹ dp[i] [j] = max(dp[i - 1] [j], dp[i - 1] [j - weight[i]] + value[i]); å¯ä»¥çœ‹å‡ºi æ˜¯ç”± i-1 æ¨å¯¼å‡ºæ¥ï¼Œé‚£ä¹ˆiä¸º0çš„æ—¶å€™å°±ä¸€å®šè¦åˆå§‹åŒ–ã€‚</p><p>dp[0] [j]ï¼Œå³ï¼šiä¸º0ï¼Œå­˜æ”¾ç¼–å·0çš„ç‰©å“çš„æ—¶å€™ï¼Œå„ä¸ªå®¹é‡çš„èƒŒåŒ…æ‰€èƒ½å­˜æ”¾çš„æœ€å¤§ä»·å€¼ã€‚</p><p>é‚£ä¹ˆå¾ˆæ˜æ˜¾å½“ j &lt; weight[0]çš„æ—¶å€™ï¼Œdp[0] [j] åº”è¯¥æ˜¯ 0ï¼Œå› ä¸ºèƒŒåŒ…å®¹é‡æ¯”ç¼–å·0çš„ç‰©å“é‡é‡è¿˜å°ã€‚</p><p>å½“j &gt;= weight[0]æ—¶ï¼Œdp[0] [j] åº”è¯¥æ˜¯value[0]ï¼Œå› ä¸ºèƒŒåŒ…å®¹é‡æ”¾è¶³å¤Ÿæ”¾ç¼–å·0ç‰©å“ã€‚</p><p>ä»£ç åˆå§‹åŒ–å¦‚ä¸‹ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> <span class="hljs-variable">j</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span> ; j &lt; weight[<span class="hljs-number">0</span>]; j++) &#123;  <span class="hljs-comment">// å½“ç„¶è¿™ä¸€æ­¥ï¼Œå¦‚æœæŠŠdpæ•°ç»„é¢„å…ˆåˆå§‹åŒ–ä¸º0äº†ï¼Œè¿™ä¸€æ­¥å°±å¯ä»¥çœç•¥ï¼Œä½†å¾ˆå¤šåŒå­¦åº”è¯¥æ²¡æœ‰æƒ³æ¸…æ¥šè¿™ä¸€ç‚¹ã€‚</span><br>    dp[<span class="hljs-number">0</span>][j] = <span class="hljs-number">0</span>;<br>&#125;<br><span class="hljs-comment">// æ­£åºéå†</span><br><span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> <span class="hljs-variable">j</span> <span class="hljs-operator">=</span> weight[<span class="hljs-number">0</span>]; j &lt;= bagweight; j++) &#123;<br>    dp[<span class="hljs-number">0</span>][j] = value[<span class="hljs-number">0</span>];<br>&#125;<br></code></pre></td></tr></table></figure><p>å…¶ä»–çš„ä¸‹æ ‡å¯ä»¥åˆå§‹åŒ–ä¸º0</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-comment">// åˆå§‹åŒ– dp</span><br>vector&lt;vector&lt;<span class="hljs-type">int</span>&gt;&gt; <span class="hljs-title function_">dp</span><span class="hljs-params">(weight.size()</span>, vector&lt;<span class="hljs-type">int</span>&gt;(bagweight + <span class="hljs-number">1</span>, <span class="hljs-number">0</span>));<br><span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> <span class="hljs-variable">j</span> <span class="hljs-operator">=</span> weight[<span class="hljs-number">0</span>]; j &lt;= bagweight; j++) &#123;<br>    dp[<span class="hljs-number">0</span>][j] = value[<span class="hljs-number">0</span>];<br>&#125;<br></code></pre></td></tr></table></figure><p><img src="/2022/09/16/dong-tai-gui-hua/Typoraæ–‡ä»¶\Typoraå›¾ç‰‡\image-20220628112932740.png" alt="image-20220628112932740"></p></li><li><p>ç¡®å®šéå†é¡ºåºï¼Œå…ˆéå†ç‰©å“åéå†èƒŒåŒ…é‡é‡å’Œå…ˆéå†èƒŒåŒ…é‡é‡åéå†ç‰©å“éƒ½å¯ä»¥ï¼Œåªæ˜¯å…ˆéå†ç‰©å“æ›´å®¹æ˜“ç†è§£ã€‚<br>å…ˆéå†ç‰©å“ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-comment">// weightæ•°ç»„çš„å¤§å° å°±æ˜¯ç‰©å“ä¸ªæ•°</span><br><span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> <span class="hljs-variable">i</span> <span class="hljs-operator">=</span> <span class="hljs-number">1</span>; i &lt; weight.size(); i++) &#123; <span class="hljs-comment">// éå†ç‰©å“</span><br>    <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> <span class="hljs-variable">j</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>; j &lt;= bagweight; j++) &#123; <span class="hljs-comment">// éå†èƒŒåŒ…å®¹é‡</span><br>        <span class="hljs-keyword">if</span> (j &lt; weight[i]) dp[i][j] = dp[i - <span class="hljs-number">1</span>][j]; <br>        <span class="hljs-keyword">else</span> dp[i][j] = max(dp[i - <span class="hljs-number">1</span>][j], dp[i - <span class="hljs-number">1</span>][j - weight[i]] + value[i]);<br><br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>å…ˆéå†èƒŒåŒ…é‡é‡ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-comment">// weightæ•°ç»„çš„å¤§å° å°±æ˜¯ç‰©å“ä¸ªæ•°</span><br><span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> <span class="hljs-variable">j</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>; j &lt;= bagweight; j++) &#123; <span class="hljs-comment">// éå†èƒŒåŒ…å®¹é‡</span><br>    <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> <span class="hljs-variable">i</span> <span class="hljs-operator">=</span> <span class="hljs-number">1</span>; i &lt; weight.size(); i++) &#123; <span class="hljs-comment">// éå†ç‰©å“</span><br>        <span class="hljs-keyword">if</span> (j &lt; weight[i]) dp[i][j] = dp[i - <span class="hljs-number">1</span>][j];<br>        <span class="hljs-keyword">else</span> dp[i][j] = max(dp[i - <span class="hljs-number">1</span>][j], dp[i - <span class="hljs-number">1</span>][j - weight[i]] + value[i]);<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure></li><li><p>ä¸¾ä¾‹æ¨å¯¼</p></li></ol><p>Javaå®Œæ•´01èƒŒåŒ…ä»£ç </p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span> &#123;<br>        <span class="hljs-type">int</span>[] weight = &#123;<span class="hljs-number">1</span>, <span class="hljs-number">3</span>, <span class="hljs-number">4</span>&#125;;<br>        <span class="hljs-type">int</span>[] value = &#123;<span class="hljs-number">15</span>, <span class="hljs-number">20</span>, <span class="hljs-number">30</span>&#125;;<br>        <span class="hljs-type">int</span> <span class="hljs-variable">bagsize</span> <span class="hljs-operator">=</span> <span class="hljs-number">4</span>;<br>        testweightbagproblem(weight, value, bagsize);<br>    &#125;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">testweightbagproblem</span><span class="hljs-params">(<span class="hljs-type">int</span>[] weight, <span class="hljs-type">int</span>[] value, <span class="hljs-type">int</span> bagsize)</span>&#123;<br>        <span class="hljs-type">int</span> <span class="hljs-variable">wlen</span> <span class="hljs-operator">=</span> weight.length, value0 = <span class="hljs-number">0</span>;<br>        <span class="hljs-comment">//å®šä¹‰dpæ•°ç»„ï¼šdp[i][j]è¡¨ç¤ºèƒŒåŒ…å®¹é‡ä¸ºjæ—¶ï¼Œå‰iä¸ªç‰©å“èƒ½è·å¾—çš„æœ€å¤§ä»·å€¼</span><br>        <span class="hljs-type">int</span>[][] dp = <span class="hljs-keyword">new</span> <span class="hljs-title class_">int</span>[wlen + <span class="hljs-number">1</span>][bagsize + <span class="hljs-number">1</span>];<br>        <span class="hljs-comment">//åˆå§‹åŒ–ï¼šèƒŒåŒ…å®¹é‡ä¸º0æ—¶ï¼Œèƒ½è·å¾—çš„ä»·å€¼éƒ½ä¸º0</span><br>        <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> <span class="hljs-variable">i</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>; i &lt;= wlen; i++)&#123;<br>            dp[i][<span class="hljs-number">0</span>] = value0;<br>        &#125;<br>        <span class="hljs-comment">//éå†é¡ºåºï¼šå…ˆéå†ç‰©å“ï¼Œå†éå†èƒŒåŒ…å®¹é‡</span><br>        <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> <span class="hljs-variable">i</span> <span class="hljs-operator">=</span> <span class="hljs-number">1</span>; i &lt;= wlen; i++)&#123;<br>            <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> <span class="hljs-variable">j</span> <span class="hljs-operator">=</span> <span class="hljs-number">1</span>; j &lt;= bagsize; j++)&#123;<br>                <span class="hljs-keyword">if</span> (j &lt; weight[i - <span class="hljs-number">1</span>])&#123;<br>                    dp[i][j] = dp[i - <span class="hljs-number">1</span>][j];<br>                &#125;<span class="hljs-keyword">else</span>&#123;<br>                    dp[i][j] = Math.max(dp[i - <span class="hljs-number">1</span>][j], dp[i - <span class="hljs-number">1</span>][j - weight[i - <span class="hljs-number">1</span>]] + value[i - <span class="hljs-number">1</span>]);<br>                &#125;<br>            &#125;<br>        &#125;<br>        <span class="hljs-comment">//æ‰“å°dpæ•°ç»„</span><br>        <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> <span class="hljs-variable">i</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>; i &lt;= wlen; i++)&#123;<br>            <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> <span class="hljs-variable">j</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>; j &lt;= bagsize; j++)&#123;<br>                System.out.print(dp[i][j] + <span class="hljs-string">&quot; &quot;</span>);<br>            &#125;<br>            System.out.print(<span class="hljs-string">&quot;\n&quot;</span>);<br>        &#125;<br>    &#125;<br></code></pre></td></tr></table></figure><h3 id="01èƒŒåŒ…é—®é¢˜ï¼ˆæ»šåŠ¨æ•°ç»„ï¼‰"><a href="#01èƒŒåŒ…é—®é¢˜ï¼ˆæ»šåŠ¨æ•°ç»„ï¼‰" class="headerlink" title="01èƒŒåŒ…é—®é¢˜ï¼ˆæ»šåŠ¨æ•°ç»„ï¼‰"></a>01èƒŒåŒ…é—®é¢˜ï¼ˆæ»šåŠ¨æ•°ç»„ï¼‰</h3><p>æ»šåŠ¨æ•°ç»„å…¶å®å°±æ˜¯ä¸€ç»´æ•°ç»„</p><p>åŠ¨æ€è§„åˆ’äº”éƒ¨æ›²ï¼š</p><ol><li><p>ç¡®å®šdpæ•°ç»„çš„å®šä¹‰<br>åœ¨ä¸€ç»´dpæ•°ç»„ä¸­ï¼Œdp[j]è¡¨ç¤ºï¼šå®¹é‡ä¸ºjçš„èƒŒåŒ…ï¼Œæ‰€èƒŒçš„ç‰©å“ä»·å€¼å¯ä»¥æœ€å¤§ä¸ºdp[j]ã€‚</p></li><li><p>ä¸€ç»´dpæ•°ç»„çš„é€’æ¨å…¬å¼</p><p>dp[j]å¯ä»¥é€šè¿‡dp[j - weight[i]]æ¨å¯¼å‡ºæ¥ï¼Œdp[j - weight[i]]è¡¨ç¤ºå®¹é‡ä¸ºj - weight[i]çš„èƒŒåŒ…æ‰€èƒŒçš„æœ€å¤§ä»·å€¼ã€‚</p><p>dp[j - weight[i]] + value[i] è¡¨ç¤º å®¹é‡ä¸º j - ç‰©å“ié‡é‡ çš„èƒŒåŒ… åŠ ä¸Š ç‰©å“içš„ä»·å€¼ã€‚ï¼ˆä¹Ÿå°±æ˜¯å®¹é‡ä¸ºjçš„èƒŒåŒ…ï¼Œæ”¾å…¥ç‰©å“iäº†ä¹‹åçš„ä»·å€¼å³ï¼šdp[j]ï¼‰</p><p>æ­¤æ—¶dp[j]æœ‰ä¸¤ä¸ªé€‰æ‹©ï¼Œä¸€ä¸ªæ˜¯å–è‡ªå·±dp[j] ç›¸å½“äº äºŒç»´dpæ•°ç»„ä¸­çš„dp[i-1] [j]ï¼Œå³ä¸æ”¾ç‰©å“iï¼Œä¸€ä¸ªæ˜¯å–dp[j - weight[i]] + value[i]ï¼Œå³æ”¾ç‰©å“iï¼ŒæŒ‡å®šæ˜¯å–æœ€å¤§çš„ï¼Œæ¯•ç«Ÿæ˜¯æ±‚æœ€å¤§ä»·å€¼ï¼Œæ‰€ä»¥é€’å½’å…¬å¼ä¸ºï¼š   dp[j] = max(dp[j], dp[j - weight[i]] + value[i]);</p></li><li><p>åˆå§‹åŒ–æ•°ç»„ï¼Œåˆå§‹åŒ–ä¸€å®šè¦å’Œå®šä¹‰è”ç³»åœ¨ä¸€èµ·<br>dp[j]è¡¨ç¤ºï¼šå®¹é‡ä¸ºjçš„èƒŒåŒ…ï¼Œæ‰€èƒŒçš„ç‰©å“ä»·å€¼å¯ä»¥æœ€å¤§ä¸ºdp[j]ï¼Œé‚£ä¹ˆdp[0]å°±åº”è¯¥æ˜¯0ï¼Œå› ä¸ºèƒŒåŒ…å®¹é‡ä¸º0æ‰€èƒŒçš„ç‰©å“çš„æœ€å¤§ä»·å€¼å°±æ˜¯0ã€‚<br>dpæ•°ç»„åœ¨æ¨å¯¼çš„æ—¶å€™ä¸€å®šæ˜¯å–ä»·å€¼æœ€å¤§çš„æ•°ï¼Œå¦‚æœé¢˜ç›®ç»™çš„ä»·å€¼éƒ½æ˜¯æ­£æ•´æ•°é‚£ä¹ˆé0ä¸‹æ ‡éƒ½åˆå§‹åŒ–ä¸º0å°±å¯ä»¥äº†ã€‚</p></li><li><p>éå†é¡ºåºï¼šéå†é¡ºåºä¸€å®šæ˜¯å…ˆéå†ç‰©å“ï¼Œå†éå†èƒŒåŒ…å®¹é‡ã€‚å¹¶ä¸”éå†èƒŒåŒ…å®¹é‡çš„æ—¶å€™ï¼Œæ»šåŠ¨æ•°ç»„ä¸€å®šæ˜¯ä»å¤§åˆ°å°çš„éå†ã€‚ä¸ºä»€ä¹ˆå‘¢ï¼Ÿå› ä¸ºæ»šåŠ¨æ•°ç»„éå†çš„æ—¶å€™éœ€è¦å‰é¢çš„å€¼ï¼Œä½†æ˜¯å‰é¢çš„å€¼ä¸€ç›´å˜åŒ–ï¼Œè€Œä»åå¾€å‰çš„ è¯ï¼Œå‰é¢çš„å€¼å°±ä¸€ç›´ä¸º0ã€‚</p></li><li><p>ä¸¾ä¾‹æ¨å¯¼</p><p><img src="/2022/09/16/dong-tai-gui-hua/Typoraæ–‡ä»¶\Typoraå›¾ç‰‡\image-20220629111108557.png" alt="image-20220629111108557"></p></li></ol><p>æ»šåŠ¨æ•°ç»„éå†å…¨ä»£ç ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span> &#123;<br>       <span class="hljs-type">int</span>[] weight = &#123;<span class="hljs-number">1</span>, <span class="hljs-number">3</span>, <span class="hljs-number">4</span>&#125;;<br>       <span class="hljs-type">int</span>[] value = &#123;<span class="hljs-number">15</span>, <span class="hljs-number">20</span>, <span class="hljs-number">30</span>&#125;;<br>       <span class="hljs-type">int</span> <span class="hljs-variable">bagWight</span> <span class="hljs-operator">=</span> <span class="hljs-number">4</span>;<br>       testWeightBagProblem(weight, value, bagWight);<br>   &#125;<br><br>   <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">testWeightBagProblem</span><span class="hljs-params">(<span class="hljs-type">int</span>[] weight, <span class="hljs-type">int</span>[] value, <span class="hljs-type">int</span> bagWeight)</span>&#123;<br>       <span class="hljs-type">int</span> <span class="hljs-variable">wLen</span> <span class="hljs-operator">=</span> weight.length;<br>       <span class="hljs-comment">//å®šä¹‰dpæ•°ç»„ï¼šdp[j]è¡¨ç¤ºèƒŒåŒ…å®¹é‡ä¸ºjæ—¶ï¼Œèƒ½è·å¾—çš„æœ€å¤§ä»·å€¼</span><br>       <span class="hljs-type">int</span>[] dp = <span class="hljs-keyword">new</span> <span class="hljs-title class_">int</span>[bagWeight + <span class="hljs-number">1</span>];<br>       <span class="hljs-comment">//éå†é¡ºåºï¼šå…ˆéå†ç‰©å“ï¼Œå†éå†èƒŒåŒ…å®¹é‡</span><br>       <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> <span class="hljs-variable">i</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>; i &lt; wLen; i++)&#123;<br>           <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> <span class="hljs-variable">j</span> <span class="hljs-operator">=</span> bagWeight; j &gt;= weight[i]; j--)&#123;<br>               dp[j] = Math.max(dp[j], dp[j - weight[i]] + value[i]);<br>           &#125;<br>       &#125;<br>       <span class="hljs-comment">//æ‰“å°dpæ•°ç»„</span><br>       <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> <span class="hljs-variable">j</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>; j &lt;= bagWeight; j++)&#123;<br>           System.out.print(dp[j] + <span class="hljs-string">&quot; &quot;</span>);<br>       &#125;<br>   &#125;<br></code></pre></td></tr></table></figure><p>å…¶å®æˆ‘è¿˜æ²¡å®Œå…¨ç†è§£æ˜ç™½ï¼</p><h2 id="åˆ†å‰²ç­‰å’Œå­é›†"><a href="#åˆ†å‰²ç­‰å’Œå­é›†" class="headerlink" title="åˆ†å‰²ç­‰å’Œå­é›†"></a>åˆ†å‰²ç­‰å’Œå­é›†</h2><p>è¿™å®Œå…¨çœ‹ä¸å‡ºæ¥æ˜¯è¦ç”¨åŠ¨æ€è§„åˆ’å•Šã€‚ä¸ªäººæ€è·¯ï¼šå…ˆè¿›è¡Œæ’åºï¼Œç„¶åä»ä¸­é—´åˆ†æˆä¸¤ä¸ªæ•°ç»„ï¼Œæ¯æ¬¡åˆ¤æ–­æ˜¯å¦ç›¸ç­‰ï¼Œè‹¥æ˜¯ä¸ç›¸ç­‰ï¼Œåˆ™ä»å¤§çš„é‚£è¾¹åŒ€ä¸€ä¸ªç»™å°çš„ï¼Œä»¥æ­¤ç±»æ¨ï¼›æœ€åè¦æ˜¯å‘ç°å¤§çš„é‚£è¾¹æœ€ç»ˆå°äºå°çš„é‚£è¾¹äº†ï¼Œåˆ™è¯æ˜æ²¡æœ‰ï¼Œè¿”å›falseã€‚</p><blockquote><p>å›æº¯æ³•ï¼š</p><ul><li>698.åˆ’åˆ†ä¸ºkä¸ªç›¸ç­‰çš„å­é›†</li><li>473.ç«æŸ´æ‹¼æ­£æ–¹å½¢</li></ul></blockquote><p>ä»¥ä¸Šæˆ‘çš„æ€è·¯æ˜¯ä¹Ÿç§°ä¸ºå›æº¯æš´åŠ›æ³•ï¼Œä½†æ˜¯è¶…æ—¶ã€‚ç›´æ¥ä¸Š01èƒŒåŒ…</p><p>é‡ç‚¹æ˜¯è¦ç†è§£ä¸ºä½•èƒ½åµŒå¥—01èƒŒåŒ…ï¼Œä»¥åŠé‡é‡ä»¥åŠå®¹é‡éƒ½å¯¹åº”ç€ä»€ä¹ˆã€‚</p><p><strong>åªæœ‰ç¡®å®šäº†å¦‚ä¸‹å››ç‚¹ï¼Œæ‰èƒ½æŠŠ01èƒŒåŒ…é—®é¢˜å¥—åˆ°æœ¬é¢˜ä¸Šæ¥ã€‚</strong></p><ul><li>èƒŒåŒ…çš„ä½“ç§¯ä¸ºsum / 2</li><li>èƒŒåŒ…è¦æ”¾å…¥çš„å•†å“ï¼ˆé›†åˆé‡Œçš„å…ƒç´ ï¼‰é‡é‡ä¸º å…ƒç´ çš„æ•°å€¼ï¼Œä»·å€¼ä¹Ÿä¸ºå…ƒç´ çš„æ•°å€¼</li><li>èƒŒåŒ…å¦‚æœæ­£å¥½è£…æ»¡ï¼Œè¯´æ˜æ‰¾åˆ°äº†æ€»å’Œä¸º sum / 2 çš„å­é›†ã€‚</li><li>èƒŒåŒ…ä¸­æ¯ä¸€ä¸ªå…ƒç´ æ˜¯ä¸å¯é‡å¤æ”¾å…¥ã€‚</li></ul><p>åŠ¨æ€è§„åˆ’äº”éƒ¨æ›²ï¼š</p><ol><li><p>ç¡®å®šdpæ•°ç»„å«ä¹‰ï¼š<br>**dp[j]è¡¨ç¤º èƒŒåŒ…æ€»å®¹é‡æ˜¯jï¼Œæœ€å¤§å¯ä»¥å‡‘æˆjçš„å­é›†æ€»å’Œä¸ºdp[j]**ã€‚</p></li><li><p>ç¡®å®šé€’æ¨å…¬å¼ï¼š<br>æœ¬é¢˜ç›¸å½“äºèƒŒåŒ…é‡Œæ”¾æ•°å€¼ï¼Œé‚£ä¹ˆé‡é‡ä¹Ÿå°±æ˜¯nums[i]ï¼Œå…¶ä»·å€¼ä¹Ÿæ˜¯nums[i]<br>dp[j] = max(dp[j], dp[j - nums[i]] + nums[i]);</p></li><li><p>å¦‚ä½•åˆå§‹åŒ–ï¼Œè·Ÿæ»šåŠ¨æ•°ç»„åˆå§‹åŒ–ä¸€æ ·ï¼Œ0åˆå§‹åŒ–ä¸º0ï¼Œå…¶ä½™æ•´æ•°åˆå§‹åŒ–ä¸º0ï¼Œè´Ÿæ•°åˆå§‹åŒ–ä¸ºè´Ÿæ— ç©·</p></li><li><p>éå†é¡ºåºï¼ŒåŒæ»šåŠ¨æ•°ç»„ï¼Œå…ˆéå†ç‰©å“ï¼Œæ”¾åˆ°è¿™é“é¢˜ä¹Ÿå°±æ˜¯nums[i]ï¼›åµŒå¥—éå†ä»·å€¼</p></li><li><p>ä¸¾ä¾‹æ¨å¯¼</p><p>dp[j]çš„æ•°å€¼ä¸€å®šæ˜¯å°äºç­‰äºjçš„ã€‚</p><p><strong>å¦‚æœdp[j] == j è¯´æ˜ï¼Œé›†åˆä¸­çš„å­é›†æ€»å’Œæ­£å¥½å¯ä»¥å‡‘æˆæ€»å’Œjï¼Œç†è§£è¿™ä¸€ç‚¹å¾ˆé‡è¦ã€‚</strong></p></li></ol><p>å¥½å¥½æƒ³æƒ³ï¼ï¼ï¼</p><p>ä¸€å±‚éå†æœ€åçš„ç»“æœï¼Œä¹Ÿæ˜¯ä¸€å±‚ä¸€å±‚ï¼Œè¿˜æ˜¯ç›¸å½“äºä¸¤å±‚éå†çš„ç»“æœï¼Œåªä¸è¿‡æœ€åä¿å­˜çš„æ˜¯i = nums.length çš„å€¼</p><h2 id="æœ€åä¸€å—çŸ³å¤´çš„é‡é‡II"><a href="#æœ€åä¸€å—çŸ³å¤´çš„é‡é‡II" class="headerlink" title="æœ€åä¸€å—çŸ³å¤´çš„é‡é‡II"></a>æœ€åä¸€å—çŸ³å¤´çš„é‡é‡II</h2><p>ä¸æ˜¨å¤©çš„åˆ†å‰²ç­‰å­é›†å’Œç±»ä¼¼ï¼Œéƒ½æ˜¯åˆ†å‰²æˆä¸¤å—é‡é‡ç›¸å·®æœ€å°çš„å—ï¼Œç„¶åç›¸å‡å³å¯ã€‚<em>ä¸è¿‡è¿™é“é¢˜ä¸ä¸Šé¢˜ä¸åŒçš„æ˜¯ï¼Œå…¶ä¸­ä¸€å—çš„å…·ä½“é‡é‡æ— æ³•ç¡®å®š</em></p><p>æœ¬é¢˜ç‰©å“é‡é‡store[], ä»·å€¼ä¹Ÿä¸ºstore[]ï¼›å¯¹åº”01èƒŒåŒ…é—®é¢˜çš„ç‰©å“é‡é‡å’Œä»·å€¼</p><ol><li>ç¡®å®šdpæ•°ç»„çš„å«ä¹‰ï¼šdp[j]è¡¨ç¤ºjå—çŸ³å¤´ç›¸åŠ å¾—å‡ºæ¥çš„æ€»é‡é‡</li><li>ç¡®å®šé€’å½’å‡½æ•°ï¼šå¯ä»¥åˆ†ä¸ºä¸¤æ­¥è€ƒè™‘ï¼Œä¸€ä¸ªæ˜¯ä¸æ”¾ç¬¬jå—ï¼Œå¦ä¸€ä¸ªæ˜¯æ”¾ç¬¬jå—ï¼›ä¸æ”¾å°±æ˜¯dp[j ], æ”¾å°±æ˜¯dp[j - store[j] ] + store[j]<br>æ‰€ä»¥ï¼šdp[j] = max(dp[j], dp[j - store[j] ] + store[j]  )</li><li>åˆå§‹åŒ–ï¼šå…ˆå…¨éƒ¨åˆå§‹åŒ–ä¸º0ï¼Œä¹‹åè‚¯å®šä¼šä¸€å±‚ä¸€å±‚çš„éå†ï¼›è‡³äºdpæ•°ç»„å¼€åˆ°å¤šå¤§ï¼Œä¸€ç§åšæ³•æ˜¯æ‰€æœ‰æ•°ç›¸åŠ å†é™¤ä»¥äºŒï¼›è¿˜æœ‰ä¸€ç§æ˜¯çœ‹é¢˜ç›®ç»™çš„èŒƒå›´ï¼Œç›´æ¥èŒƒå›´é™¤ä»¥äºŒ</li><li>éå†é¡ºåºï¼šå¤–å±‚ä»å‰å¾€åï¼Œå†…å±‚ä»åå¾€å‰</li><li>ä¸¾ä¾‹æ¨å¯¼</li></ol><p>æœ€ååˆ¤æ–­çš„æ—¶å€™ï¼Œdp[j]è¡¨ç¤ºå¯ä»¥è£…å¤šå¤§çš„é‡é‡ï¼Œé‚£ä¹ˆå¦ä¸€è¾¹å°±æ˜¯sum - dp[j],é‚£ä¹ˆç›¸å·®æœ€å°å°±æ˜¯ sum - dp[j] - dp[j]</p><p>ä¸Šé¢æ–œä½“å­—å†™å¾— é‚£ä¸€æ®µï¼ŒçœŸæ˜¯æ„šè ¢ï¼</p><p>dpä¸ç®¡å¦‚ä½•åˆ†ï¼Œåªç®¡targetçš„å¤§å°ï¼Œä¹Ÿå°±æ˜¯æ€»å’Œ / 2ï¼›</p><p>å…¶å®åŠ¨æ€è§„åˆ’äºŒç»´æ•°ç»„å’Œä¸€ç»´æ•°ç»„ï¼Œæœ¬è´¨ä¸Šè¿˜æ˜¯äºŒç»´æ•°ç»„ï¼Œåªä¸è¿‡æ¯æ¬¡äºŒç»´æ•°ç»„ä¸€æ¬¡éå†ï¼Œè€Œä¸€ç»´æ•°ç»„è¿›è¡Œå¤šæ¬¡éå†ï¼Œæœ€ååªä¿ç•™æœ€åä¸€æ¬¡éå†çš„é‚£æ¬¡ç»“æœã€‚</p><h2 id="ç›®æ ‡å’Œ"><a href="#ç›®æ ‡å’Œ" class="headerlink" title="ç›®æ ‡å’Œ"></a>ç›®æ ‡å’Œ</h2><p>çŸäº†ä¸€çœ¼å¡å“¥çš„æ€è·¯ï¼Œæˆ‘åªèƒ½è¯´ç‰›</p><p>é¦–å…ˆç»™å‡ºäº†ä¸€ä¸ªtargetï¼Œé‚£ä¹ˆä¸€å®šä¼šæœ‰left å’Œrightï¼›   åŒæ—¶left + right = sum; ä½†æ˜¯ target = left - (sum - left); æ‰€ä»¥left = (target + sum) / 2,æœ¬é¢˜ä¹Ÿå°±è½¬æ¢ä¸ºæ±‚æ•°ç»„ä¸­æœ‰å¤šå°‘ä¸ªå’Œæ˜¯leftçš„ç»„åˆ</p><p>åŒæ ·ï¼ŒåŠ¨æ€è§„åˆ’äº”éƒ¨æ›²ï¼š</p><ol><li><p>ç¡®å®šdp[]æ•°ç»„çš„å«ä¹‰ï¼šdp[j]æ•°ç»„è¡¨ç¤ºå’Œä¸ºjçš„æœ‰å¤šå°‘ç§æ–¹æ³•</p></li><li><p>ç¡®å®šé€’å½’å‡½æ•°</p><p>ç¡®å®šé€’å½’å‡½æ•°çš„æ—¶å€™ï¼Œè€ƒè™‘ä¸€ä¸‹æ¥æºï¼›æ¥æºæœ‰å“ªäº›å‘¢ï¼Ÿä¸è€ƒè™‘nums[i]çš„æƒ…å†µä¸‹ï¼Œå¡«æ»¡å®¹é‡ä¸ºj - nums[i]çš„èƒŒåŒ…ï¼Œæœ‰dp[j - nums[i]]ç§æ–¹æ³•ã€‚<br>è€ƒè™‘nums[i]çš„æƒ…å†µä¸‹ï¼Œå‡‘æˆdp[j]å°±æœ‰dp[j - nums[i]]ç§æ–¹æ³•ã€‚</p><p>ä¾‹å¦‚ï¼šdp[j]ï¼Œj ä¸º5ï¼Œ</p><ul><li>å·²ç»æœ‰ä¸€ä¸ª1ï¼ˆnums[i]ï¼‰ çš„è¯ï¼Œæœ‰ dp[4]ç§æ–¹æ³• å‡‘æˆ dp[5]ã€‚</li><li>å·²ç»æœ‰ä¸€ä¸ª2ï¼ˆnums[i]ï¼‰ çš„è¯ï¼Œæœ‰ dp[3]ç§æ–¹æ³• å‡‘æˆ dp[5]ã€‚</li><li>å·²ç»æœ‰ä¸€ä¸ª3ï¼ˆnums[i]ï¼‰ çš„è¯ï¼Œæœ‰ dp[2]ä¸­æ–¹æ³• å‡‘æˆ dp[5]</li><li>å·²ç»æœ‰ä¸€ä¸ª4ï¼ˆnums[i]ï¼‰ çš„è¯ï¼Œæœ‰ dp[1]ä¸­æ–¹æ³• å‡‘æˆ dp[5]</li><li>å·²ç»æœ‰ä¸€ä¸ª5 ï¼ˆnums[i]ï¼‰çš„è¯ï¼Œæœ‰ dp[0]ä¸­æ–¹æ³• å‡‘æˆ dp[5]</li></ul><p>é‚£ä¹ˆå‡‘æ•´dp[5]æœ‰å¤šå°‘æ–¹æ³•å‘¢ï¼Œä¹Ÿå°±æ˜¯æŠŠ æ‰€æœ‰çš„ dp[j - nums[i]] ç´¯åŠ èµ·æ¥</p><p>ç»„åˆé—®é¢˜çš„å…¬å¼ï¼šdp[j] += dp[j - nums[i]]</p></li><li><p>åˆå§‹åŒ–ï¼šå…¨åˆå§‹åŒ–ä¸º0</p></li><li><p>éå†é¡ºåºï¼šå¤–å±‚ä»å‰å¾€åï¼Œå†…å±‚ä»åå¾€å‰</p></li><li><p>ä¸¾ä¾‹æ¨å¯¼</p></li></ol><p>å¯ä»¥è®°ä½ï¼šåœ¨æ±‚è£…æ»¡èƒŒåŒ…æœ‰å‡ ç§æ–¹æ³•çš„æ—¶å€™ï¼Œé€’æ¨å…¬å¼ä¸€èˆ¬ä¸ºï¼šdp[j] += dp[j - nums[i]];</p><p>åˆ°æœ€ååŠ¨æ€è§„åˆ’æ€»ç»“çš„ æ—¶å€™ï¼Œ==ä¸€å®šè¦å¤šæ€»ç»“å„ç§dpå…¬å¼==ï¼ï¼</p><h2 id="ä¸€å’Œé›¶"><a href="#ä¸€å’Œé›¶" class="headerlink" title="ä¸€å’Œé›¶"></a>ä¸€å’Œé›¶</h2><p>åŠ¨æ€è§„åˆ’ï¼Ÿ</p><p>åŠ¨æ€è§„åˆ’äº”éƒ¨æ›²ï¼š</p><ol><li>ç¡®å®šdpæ•°ç»„çš„å«ä¹‰ï¼šdp[i]æ•°ç»„è¡¨ç¤º</li></ol><p>ç ´åŠŸ</p><p>åŠ¨è§„äº”éƒ¨æ›²ï¼š</p><ol><li><p>ç¡®å®šdpæ•°ç»„çš„å«ä¹‰ï¼š**dp[i] [j]ï¼šæœ€å¤šæœ‰iä¸ª0å’Œjä¸ª1çš„strsçš„æœ€å¤§å­é›†çš„å¤§å°ä¸ºdp[i] [j]**ã€‚</p></li><li><p>ç¡®å®šé€’æ¨å…¬å¼</p><p>dp[i] [j] å¯ä»¥ç”±å‰ä¸€ä¸ªstrsé‡Œçš„å­—ç¬¦ä¸²æ¨å¯¼å‡ºæ¥ï¼Œstrsé‡Œçš„å­—ç¬¦ä¸²æœ‰zeroNumä¸ª0ï¼ŒoneNumä¸ª1ã€‚</p><p>dp[i] [j] å°±å¯ä»¥æ˜¯ dp[i - zeroNum] [j - oneNum] + 1ã€‚</p><p>ç„¶åæˆ‘ä»¬åœ¨éå†çš„è¿‡ç¨‹ä¸­ï¼Œå–dp[i] [j]çš„æœ€å¤§å€¼ã€‚</p><p>æ‰€ä»¥é€’æ¨å…¬å¼ï¼šdp[i] [j] = max(dp[i][j], dp[i - zeroNum] [j - oneNum] + 1);</p></li><li><p>dpæ•°ç»„å¦‚ä½•åˆå§‹åŒ–ï¼Œåˆå§‹åŒ–ä¸º0å³å¯ï¼Œå› ä¸ºç‰©å“é‡é‡ä¸å¯èƒ½ä¸º0ï¼Œæ‰€ä»¥åªéœ€åˆå§‹åŒ–ä¸º0ï¼›</p></li><li><p>ç¡®å®šéå†é¡ºåº<br>å¤–å±‚forå¾ªç¯éå†ç‰©å“ï¼Œå†…å±‚forå¾ªç¯éå†èƒŒåŒ…å®¹é‡ä¸”ä»åå‘å‰éå†ï¼</p></li><li><p>ä¸¾ä¾‹æ¨å¯¼</p></li></ol><h2 id="é›¶é’±å…‘æ¢II"><a href="#é›¶é’±å…‘æ¢II" class="headerlink" title="é›¶é’±å…‘æ¢II"></a>é›¶é’±å…‘æ¢II</h2><p>ä¸€çœ‹åˆ°é¢˜ç›®ä¸­çš„æ˜¯é’±å¸ä¸é™ï¼Œå°±çŸ¥é“è¦ç”¨å®Œå…¨èƒŒåŒ…</p><ol><li>ç¡®å®šdpæ•°ç»„å«ä¹‰ï¼šdp[j]è¡¨ç¤ºæ€»é‡‘é¢ä¸ºjçš„è´§å¸ç»„åˆæ•°ä¸ºdp[j]</li><li>ç¡®å®šé€’æ¨å…¬å¼ï¼šdp[j]å°±æ˜¯dp[j - coins[i]]ï¼ˆä¸è€ƒè™‘coins[i]ï¼‰ç›¸åŠ ã€‚<br>æ‰€ä»¥ï¼šdp[j] += dp[j - coins[i]]</li><li>å¦‚ä½•åˆå§‹åŒ–ï¼šdp[0] = 1,è¿™æ˜¯å¼€å§‹ï¼Œå…¶ä½™åˆå§‹åŒ–ä¸º0ï¼›</li><li>ç¡®å®šéå†é¡ºåº<br>åˆ°åº•æ˜¯å…ˆéå†èƒŒåŒ…å†éå†é‡é‡è¿˜æ˜¯å…ˆéå†é‡é‡å†éå†èƒŒåŒ…ï¼›å…ˆè¯•æƒ³ä¸€ä¸‹ï¼Œè‹¥æ˜¯å…ˆéå†èƒŒåŒ…å†éå†é‡é‡ï¼Œé‚£ä¹ˆé‡é‡å°±ä¼šéå†å¥½å‡ æ¬¡ï¼Œå¯èƒ½å°±æ˜¯æ’åˆ—ï¼›è€Œå…ˆéå†é‡é‡å†éå†èƒŒåŒ…çš„è¯ï¼Œå°±æ˜¯ç»„åˆã€‚è‹¥æ˜¯æ˜¯åœ¨æ— æ³•ç¡®å®šï¼Œè‡ªå·±æ‰‹åŠ¨æ¼”ç¤ºä¸€é</li><li>ä¸¾ä¾‹æ¨å¯¼</li></ol><p>è¦æƒ³æ¸…æ¥šï¼ŒèƒŒåŒ…å’Œç‰©å“å¥—åœ¨æœ¬é¢˜æ˜¯å¯¹åº”å“ªä¸€éƒ¨åˆ†</p><blockquote><p>å†æ¥ç†è§£ä¸€ä¸‹é€’æ¨å…¬å¼ï¼š     dp[j] += dp[j - coins[i]]   ï¼›ä»£è¡¨éå†æ¯ä¸ª coinsï¼Œé‚£ä¹ˆdp[j]å°±ç­‰äº å‰ä¸€ä¸ªçš„ç›¸åŠ ï¼Œè€Œå‰ä¸€ä¸ªå°±ç”¨coins[i]æ¥è¡¨ç¤ºï¼›æ‰€ä»¥ä¼šæœ‰   += çš„å‡ºç°ã€‚</p></blockquote><p><strong>æ³¨æ„ï¼šæ±‚è£…æ»¡èƒŒåŒ…æœ‰å‡ ç§æ–¹æ³•ç±»ä¼¼çš„é¢˜ç›®ï¼Œé€’æ¨å…¬å¼åŸºæœ¬éƒ½æ˜¯è¿™æ ·çš„</strong>ã€‚</p><h2 id="ç»„åˆæ€»å’ŒIV"><a href="#ç»„åˆæ€»å’ŒIV" class="headerlink" title="ç»„åˆæ€»å’ŒIV"></a>ç»„åˆæ€»å’ŒIV</h2><p>ä¸å¯¹ï¼Œè‡ªå·±å“ªé‡Œå‡ºäº†é—®é¢˜</p><ol><li>ç¡®å®šdpæ•°ç»„å«ä¹‰ï¼šdp[j]è¡¨ç¤ºæ€»å’Œä¸ºjçš„ç»„åˆæ•°ä¸ºdp[j]</li><li>ç¡®å®šé€’æ¨å…¬å¼ï¼šdp[j]å°±æ˜¯dp[j - nums[i]]ï¼ˆä¸è€ƒè™‘nums[i]ï¼‰ç›¸åŠ ã€‚<br>æ‰€ä»¥ï¼šdp[j] += dp[j - nums[i]]</li><li>å¦‚ä½•åˆå§‹åŒ–ï¼šdp[0] = 1,è¿™æ˜¯å¼€å§‹ï¼Œå…¶ä½™åˆå§‹åŒ–ä¸º0ï¼›</li><li>ç¡®å®šéå†é¡ºåº<br>åˆ°åº•æ˜¯å…ˆéå†èƒŒåŒ…å†éå†é‡é‡è¿˜æ˜¯å…ˆéå†é‡é‡å†éå†èƒŒåŒ…ï¼›å…ˆè¯•æƒ³ä¸€ä¸‹ï¼Œè‹¥æ˜¯å…ˆéå†èƒŒåŒ…å†éå†é‡é‡ï¼Œé‚£ä¹ˆé‡é‡å°±ä¼šéå†å¥½å‡ æ¬¡ï¼Œå¯èƒ½å°±æ˜¯æ’åˆ—ï¼›è€Œå…ˆéå†é‡é‡å†éå†èƒŒåŒ…çš„è¯ï¼Œå°±æ˜¯ç»„åˆã€‚è‹¥æ˜¯æ˜¯åœ¨æ— æ³•ç¡®å®šï¼Œè‡ªå·±æ‰‹åŠ¨æ¼”ç¤ºä¸€é<br>é‚£ä¹ˆæœ¬é¢˜ï¼Œè¦æ±‚çš„æ˜¯æ’åˆ—æ•°ï¼Œé‚£å°±å…ˆéå†èƒŒåŒ…å†éå†é‡é‡;</li><li>ä¸¾ä¾‹æ¨å¯¼</li></ol><p><strong>å¦‚æœæ±‚ç»„åˆæ•°å°±æ˜¯å¤–å±‚forå¾ªç¯éå†ç‰©å“ï¼Œå†…å±‚foréå†èƒŒåŒ…</strong>ã€‚</p><p><strong>å¦‚æœæ±‚æ’åˆ—æ•°å°±æ˜¯å¤–å±‚foréå†èƒŒåŒ…ï¼Œå†…å±‚forå¾ªç¯éå†ç‰©å“</strong>ã€‚</p><h2 id="çˆ¬æ¥¼æ¢¯-è¿›é˜¶ç‰ˆ"><a href="#çˆ¬æ¥¼æ¢¯-è¿›é˜¶ç‰ˆ" class="headerlink" title="çˆ¬æ¥¼æ¢¯(è¿›é˜¶ç‰ˆ)"></a>çˆ¬æ¥¼æ¢¯(è¿›é˜¶ç‰ˆ)</h2><ol><li>ç¡®å®šdpæ•°ç»„ä»¥åŠä¸‹æ ‡çš„å«ä¹‰<br><strong>dp[i]ï¼šçˆ¬åˆ°æœ‰iä¸ªå°é˜¶çš„æ¥¼é¡¶ï¼Œæœ‰dp[i]ç§æ–¹æ³•</strong>ã€‚</li><li>ç¡®å®šé€’æ¨å…¬å¼ï¼š<br>dp[i]æœ‰å‡ ç§æ¥æºï¼Œdp[i-1],dp[i-2],dp[i-3]ç­‰ç­‰ã€‚dp[i] += dp[i - j]</li><li>dpå¦‚ä½•åˆå§‹åŒ–<br>dp[0] = 1,å…¶ä½™éƒ½åˆå§‹åŒ–ä¸º0</li><li>ç¡®å®šéå†é¡ºåº<br>é¦–å…ˆæ˜ç¡®è¦æ±‚æ’åˆ—è¿˜æ˜¯æ±‚ç»„åˆï¼Œè¿™æ˜¯æ±‚æ’åˆ—é—®é¢˜ï¼›é‚£ä¹ˆå…ˆéå†èƒŒåŒ…ï¼Œå†éå†é‡é‡</li><li>ä¸¾ä¾‹æ¨å¯¼</li></ol><h2 id="é›¶é’±å…‘æ¢"><a href="#é›¶é’±å…‘æ¢" class="headerlink" title="é›¶é’±å…‘æ¢"></a>é›¶é’±å…‘æ¢</h2><p>æ€»é‡‘é¢ä¸ºèƒŒåŒ…ï¼Œcoinsä¸ºç‰©å“é‡é‡ï¼›è¦æ±‚ä»¶æ•°æœ€å°‘</p><p>åŠ¨æ€è§„åˆ’äº”éƒ¨æ›²ï¼š</p><ol><li>ç¡®å®šdpæ•°ç»„å«ä¹‰ï¼š<br>dp[i]è¡¨ç¤ºæ€»é‡‘é¢ä¸ºiçš„æœ€å°‘çš„ç¡¬å¸ä¸ªæ•°</li><li>ç¡®å®šé€’æ¨å…¬å¼ï¼š<br>å…ˆè€ƒè™‘dp[i]æ€ä¹ˆæ¥çš„ï¼Œdp[i]ç”± dp[i - coins[j]]ï¼Œç„¶åä¸€ç›´éå†ï¼›é‚£ä¹ˆå°±æ˜¯dp[i] += dp[i - coins[j]]</li><li>åˆå§‹åŒ–<br>dp[0] = 1,å…¶ä½™éƒ½ä¸º0</li><li>éå†é¡ºåº<br>ç»„åˆè¿˜æ˜¯æ’åˆ—ï¼Ÿç»„åˆï¼Œé‚£å°±å…ˆç‰©å“é‡é‡ï¼Œå†èƒŒåŒ…</li><li>ä¸¾ä¾‹æ¨å¯¼</li></ol><p>é”™ï¼</p><ol><li><p>ç¡®å®šdpæ•°ç»„å«ä¹‰ï¼š<br>dp[i]è¡¨ç¤ºæ€»é‡‘é¢ä¸ºiçš„æœ€å°‘çš„ç¡¬å¸ä¸ªæ•°</p></li><li><p>ç¡®å®šé€’æ¨å…¬å¼ï¼š<br>å…ˆè€ƒè™‘dp[j]æ€ä¹ˆæ¥çš„ï¼Œdp[j]ç”± dp[j - coins[i]]ï¼Œ</p><p>å‡‘è¶³æ€»é¢ä¸ºj - coins[i]çš„æœ€å°‘ä¸ªæ•°ä¸ºdp[j - coins[i]]ï¼Œé‚£ä¹ˆåªéœ€è¦åŠ ä¸Šä¸€ä¸ªé’±å¸coins[i]å³dp[j - coins[i]] + 1å°±æ˜¯dp[j]ï¼ˆè€ƒè™‘coins[i]ï¼‰</p><p>æ‰€ä»¥dp[j] è¦å–æ‰€æœ‰ dp[j - coins[i]] + 1 ä¸­æœ€å°çš„ã€‚</p><p>é€’æ¨å…¬å¼ï¼šdp[j] = min(dp[j - coins[i]] + 1, dp[j]);</p></li><li><p>åˆå§‹åŒ–<br>dp[0] = 0,å…¶ä»–çš„åˆå§‹åŒ–çš„æ—¶å€™ï¼Œè¦è€ƒè™‘è¦æ±‚æœ€å¤§å€¼è¿˜æ˜¯æ±‚æœ€å°å€¼ï¼Œé¢˜ç›®æ˜¯è¦æ±‚æœ€å°å€¼ï¼Œé‚£ä¹ˆå°±èµ‹å€¼æœ€å¤§å€¼ï¼Œå¦åˆ™å°±ä¼šè¢«dp[0]ä¸€ç›´è¦†ç›–</p></li><li><p>éå†é¡ºåº<br>æœ¬é¢˜ç»„åˆå’Œæ’åˆ—å‡å¯ï¼Œé‚£å°±å…ˆèƒŒåŒ…è¿˜æ˜¯å…ˆç‰©å“éƒ½å¯ä»¥</p></li><li><p>ä¸¾ä¾‹æ¨å¯¼</p></li></ol><p>åŠ¨æ€è§„åˆ’å°±ç®—çŸ¥é“äº†äº”éƒ¨æ›²ï¼Œåˆ°ç°åœ¨è¿˜æœ‰ä¸¤ä¸ªéš¾ç‚¹ï¼š</p><ul><li>éå†æ—¶i å’Œ jçš„åˆå§‹å€¼èµ‹å€¼é—®é¢˜ï¼Œå°¤å…¶æ˜¯å†…å±‚å¾ªç¯ï¼Œæ˜¯ä» 0å¼€å§‹è¿˜æ˜¯ä»coins[i]å¼€å§‹</li><li>å†™é€’æ¨å…¬å¼çš„åˆ¤å®šé—®é¢˜ï¼Œæ˜¯ç›´æ¥å†™è¿˜æ˜¯è¦æ»¡è¶³ä»€ä¹ˆæ¡ä»¶å†å†™</li></ul><h2 id="å®Œå…¨å¹³æ–¹æ•°"><a href="#å®Œå…¨å¹³æ–¹æ•°" class="headerlink" title="å®Œå…¨å¹³æ–¹æ•°"></a>å®Œå…¨å¹³æ–¹æ•°</h2><p>å‘Šè¯‰ä½ ç”¨åŠ¨æ€è§„åˆ’ï¼Œè¦æ€ä¹ˆå¥—</p><p>èƒŒåŒ…æ˜¯æ•´æ•°nï¼Œé‡é‡æ˜¯æ¯ä¸ªå®Œå…¨å¹³æ–¹æ•°ï¼Œå®Œå…¨å¹³æ–¹æ•°å¯ä»¥é‡å¤ä½¿ç”¨ï¼Œç›¸å½“äºå®Œå…¨èƒŒåŒ…é—®é¢˜ï¼›<strong>ä½†æ˜¯é‡é‡éœ€è¦åˆ¤æ–­</strong></p><ol><li>ç¡®å®šdpæ•°ç»„çš„å«ä¹‰ï¼šdp[j]è¡¨ç¤ºå’Œä¸ºjçš„å®Œå…¨å¹³æ–¹æ•°çš„æœ€å°‘æ•°é‡</li><li>ç¡®å®šé€’æ¨å…¬å¼ï¼š<br>dp[j]å¯ä»¥ç”±dp[j - i *i] å¾—æ¥ï¼Œæ‰€ä»¥dp[j] = min(dp[j], dp[j - i * i] + 1);</li><li>åˆå§‹åŒ–ï¼šå› ä¸ºè¦æ±‚æœ€å°å€¼ï¼Œæ‰€ä»¥åˆå§‹åŒ–ä¸ºæœ€å¤§å€¼ï¼›dp[0] = 0;</li><li>ç¡®å®šéå†é¡ºåºï¼šéå†é¡ºåºéƒ½å¯ï¼Œå°±å…ˆéå†èƒŒåŒ…ï¼Œå†éå†é‡é‡å§</li><li>ä¸¾ä¾‹æ¨å¯¼</li></ol><blockquote><p>çªç„¶å‘ç°ä¸€ä¸ªç‰¹ç‚¹ï¼Œé‚£å°±æ˜¯éå†çš„æ—¶å€™ï¼Œdp[j]è¿˜æ˜¯dp[i]ï¼Œæ˜¯è°ä¸çŸ¥é“ï¼Œä½†æ˜¯ä¸€å®šè¦æ»¡è¶³çš„æ˜¯ï¼Œè¦ä»å¤´å¼€å§‹éå†ï¼Œä¸èƒ½æ–­æ–­ç»­ç»­ï¼Œè¿™ä¹Ÿèƒ½ç¡®å®šä¸€éƒ¨åˆ†æ˜¯iè¿˜æ˜¯j</p></blockquote><p>==ä¸¾ä¾‹æ¨å¯¼ä¹Ÿå¾ˆé‡è¦==</p><p>ä½†æ˜¯æœ¬é¢˜é‡è¦ä¸éœ€è¦åˆ¤æ–­ï¼Œé‚£ä¹ˆé¢˜ç›®ä¸­è¦æ±‚çš„å®Œå…¨å¹³æ–¹æ•°ä½“ç°åœ¨å“ªé‡Œå‘¢ï¼Ÿä½“ç°åœ¨é€’æ¨å…¬å¼ä¸Šï¼Œé€’æ¨å…¬å¼æ˜¯dp[j - i * i]ï¼Œåé¢i * iå°±å·²ç»æŠŠé‚£äº›ä¸æ˜¯å®Œå…¨å¹³æ–¹æ•°çš„æ’é™¤äº†ï¼Œä¸æ‰‹åŠ¨è¿›è¡Œç­›é€‰ï¼Œåªåœ¨forå¾ªç¯é‡Œé¢è¿›è¡Œç­›é€‰ï¼›ä¹Ÿæ˜¯ä¸€ç§æ€è·¯</p><p>å¥¥ï¼æˆ‘çªç„¶çŸ¥é“äº†ï¼Œæœ€å†…å±‚å¾ªç¯çš„å…³é”®ä»£ç ï¼Œdp[i]è¿˜æ˜¯dp[j]è¦å–å†³äºä»£è¡¨çš„æ„ä¹‰ï¼Œ==è‹¥iä»£è¡¨çš„æ˜¯èƒŒåŒ…ï¼Œåˆ™æ˜¯dp[i]ï¼›åä¹‹==</p><h2 id="å•è¯æ‹†åˆ†"><a href="#å•è¯æ‹†åˆ†" class="headerlink" title="å•è¯æ‹†åˆ†"></a>å•è¯æ‹†åˆ†</h2><p>å¥—åŠ¨æ€è§„åˆ’ã€</p><p>å­—ç¬¦ä¸²sç›¸å½“äºèƒŒåŒ…æ€»é‡é‡ï¼ŒwordDictæ•°ç»„ç›¸å½“äºç‰©å“é‡é‡ï¼›è¦æ±‚çš„æ˜¯æ’åˆ—ï¼Œç»„åˆè‚¯å®šä¸è¡Œï¼›</p><ol><li>ç¡®å®šdpæ•°ç»„çš„å«ä¹‰ï¼šdp[i]è¡¨ç¤ºç¬¬iä¸ªä½ç½®å¯ä»¥åŒ¹é…åˆ°</li><li></li></ol><p>OUT</p><p>æ€è·¯ä¸å¯¹ã€‚æˆ‘çš„æ€è·¯æ˜¯æ±‚æ’åˆ—ï¼Œä½†æ˜¯è‹¥æ˜¯é‡åˆ°é‡å¤çš„ ï¼Ÿæ‰€ä»¥åªéœ€è¦ç»„åˆ</p><ol><li>ç¡®å®šdpæ•°ç»„çš„å«ä¹‰ï¼šdp[i]è¡¨ç¤ºç¬¬iä¸ªä½ç½®å¯ä»¥åŒ¹é…åˆ°</li><li>ç¡®å®šé€’æ¨å…¬å¼ï¼š<br>é¦–å…ˆè‹¥æ˜¯dp[j]ä¸ºtrueçš„æ—¶å€™ï¼Œè¯´æ˜  0-j éƒ½å¯ä»¥éå†æˆåŠŸï¼›é‚£ä¹ˆè‹¥æ˜¯å­˜åœ¨   i - j çš„å­—ç¬¦ä¸²ï¼Œåˆ™dp[i ]è®¾ç½®ä¸ºtrueï¼›if([j, i] è¿™ä¸ªåŒºé—´çš„å­ä¸²å‡ºç°åœ¨å­—å…¸é‡Œ &amp;&amp; dp[j]æ˜¯true) é‚£ä¹ˆ dp[i] = trueã€‚</li><li>åˆå§‹åŒ–ï¼šdp[0] = trueï¼›0æ˜¯ä¸€å®šè¦åˆå§‹åŒ–çš„ï¼Œå› ä¸ºæ‰€æœ‰çš„åˆ¤æ–­éƒ½æ˜¯ä»¥å‰é¢çš„ä¸ºåŸºç¡€</li><li>éå†é¡ºåºï¼šå…ˆéå†èƒŒåŒ…å’Œå…ˆéå†ç‰©å“éƒ½å¯ä»¥ï¼›ä½†æ˜¯æ¨èå…ˆéå†èƒŒåŒ…ï¼Œè‹¥æ˜¯å…ˆéå†ç‰©å“çš„è¯ï¼Œé‚£å°±éœ€è¦æå‰å…ˆæŠŠæ‰€æœ‰ç‰©å“æ”¾è¿›å®¹å™¨é‡Œ</li><li>ä¸¾ä¾‹æ¨å¯¼</li></ol><p>å¥½éš¾ï¼ </p><h2 id="èƒŒåŒ…é—®é¢˜æ€»ç»“"><a href="#èƒŒåŒ…é—®é¢˜æ€»ç»“" class="headerlink" title="==èƒŒåŒ…é—®é¢˜æ€»ç»“=="></a>==èƒŒåŒ…é—®é¢˜æ€»ç»“==</h2><p>èƒŒåŒ…é€’æ¨å…¬å¼ï¼š</p><ul><li>é—®èƒ½å¦è£…æ»¡èƒŒåŒ…ï¼šdp[j] = max(dp[j], dp[j - nums[i]] + nums[i]);</li><li>é—®è£…æ»¡èƒŒåŒ…æœ‰å‡ ç§æ–¹æ³•ï¼šdp[j] += dp[j - nums[i]] ï¼›</li><li>é—®èƒŒåŒ…è£…æ»¡æœ€å¤§ä»·å€¼ï¼šdp[j] = max(dp[j], dp[j - weight[i]] + value[i]); </li><li>é—®è£…æ»¡èƒŒåŒ…æ‰€æœ‰ç‰©å“çš„æœ€å°ä¸ªæ•°ï¼šdp[j] = min(dp[j - coins[i]] + 1, dp[j]); </li></ul><p>éå†é¡ºåºï¼š</p><ol><li><p>01èƒŒåŒ…<br>äºŒç»´dpæ•°ç»„01èƒŒåŒ…å…ˆéå†ç‰©å“è¿˜æ˜¯å…ˆéå†èƒŒåŒ…éƒ½æ˜¯å¯ä»¥çš„ï¼Œä¸”ç¬¬äºŒå±‚forå¾ªç¯æ˜¯ä»å°åˆ°å¤§éå†ã€‚ä¸€ç»´dpæ•°ç»„01èƒŒåŒ…åªèƒ½å…ˆéå†ç‰©å“å†éå†èƒŒåŒ…å®¹é‡ï¼Œä¸”ç¬¬äºŒå±‚forå¾ªç¯æ˜¯ä»å¤§åˆ°å°éå†ã€‚</p></li><li><p>å®Œå…¨èƒŒåŒ…</p><p><strong>å¦‚æœæ±‚ç»„åˆæ•°å°±æ˜¯å¤–å±‚forå¾ªç¯éå†ç‰©å“ï¼Œå†…å±‚foréå†èƒŒåŒ…</strong>ã€‚</p><p><strong>å¦‚æœæ±‚æ’åˆ—æ•°å°±æ˜¯å¤–å±‚foréå†èƒŒåŒ…ï¼Œå†…å±‚forå¾ªç¯éå†ç‰©å“</strong>ã€‚<br>å¦‚æœæ±‚æœ€å°æ•°ï¼Œé‚£ä¹ˆä¸¤å±‚forå¾ªç¯çš„å…ˆåé¡ºåºå°±æ— æ‰€è°“äº†ã€‚</p></li></ol><h2 id="æ‰“å®¶åŠ«èˆ"><a href="#æ‰“å®¶åŠ«èˆ" class="headerlink" title="æ‰“å®¶åŠ«èˆ"></a>æ‰“å®¶åŠ«èˆ</h2><p>åŠ¨æ€è§„åˆ’äº”éƒ¨æ›²ï¼š</p><ol><li>ç¡®å®šdpæ•°ç»„çš„å«ä¹‰ï¼šdp[i]è¡¨ç¤ºå‰iä¸ªå…ƒç´ å¯ä»¥å·å–çš„æœ€å¤§é‡‘é¢</li><li>ç¡®å®šé€’æ¨å…¬å¼ï¼š<br>æˆ‘æ„Ÿè§‰è¦å»ºç«‹ä¸€ä¸ªæ•°ç»„ï¼Œç¡®å®šæ˜¯å¦å·²ç»é€‰å–ï¼›å…ˆå‡å®šé€‰å–ç¬¬ä¸€ä¸ªï¼Œç„¶åä¸é€‰ç¬¬äºŒä¸ªï¼Œå†é€‰ç¬¬ä¸‰ä¸ªçš„æ—¶å€™åˆ¤æ–­ç¬¬ä¸€ä¸ªå¤§è¿˜æ˜¯ç¬¬äºŒä¸ªå¤§ï¼›<br>dp[j]  += max(dp[j - 1], dp[j] )</li></ol><p>ä½†æ˜¯åˆ¤å®šæ•°ç»„å¦‚ä½•ä½¿ç”¨ï¼Ÿ</p><p>åŠ¨æ€è§„åˆ’äº”éƒ¨æ›²ï¼š</p><ol><li>ç¡®å®šdpæ•°ç»„çš„å«ä¹‰ï¼šdp[i]è¡¨ç¤ºå‰iä¸ªå…ƒç´ å¯ä»¥å·å–çš„æœ€å¤§é‡‘é¢</li><li>ç¡®å®šé€’æ¨å…¬å¼ï¼š<br>å†³å®šdp[i]çš„å› ç´ å°±æ˜¯ç¬¬iæˆ¿é—´å·è¿˜æ˜¯ä¸å·ã€‚å¦‚æœå·ï¼Œé‚£ä¹ˆå°±dp[i] = dp[i - 2] + nums[i]ï¼›è‹¥æ˜¯ä¸å·ï¼Œåˆ™dp[i] = dp[i - 1]ã€‚ä½†æ˜¯è¿™é‡Œè¦åˆ¤æ–­ä¸€ä¸‹ï¼Œè¿™ä¿©ä¸ªé‚£ä¸¤ä¸ªå¤§ï¼Œé‚£ä¹ˆå°±æ˜¯ï¼šdp[i] = max(dp[i - 2] + nums[i], dp[i - 1])</li><li>åˆå§‹åŒ–ï¼šç›´æ¥åˆå§‹åŒ–dp[0] = nums[0]ï¼Œdp[1] = max(nums[0], nums[1])</li><li>ç¡®å®šéå†é¡ºåºï¼šä¸€å±‚å¾ªç¯ï¼Ÿä»å‰å¾€åéå†</li><li>ä¸¾ä¾‹æ¨å¯¼</li></ol><p>åŠ¨æ€è§„åˆ’å¹¶ä¸æ˜¯éè¦å¥—ä»€ä¹ˆ01èƒŒåŒ…é—®é¢˜ï¼Œåƒæœ¬é¢˜å°±ä¸ç”¨ï¼Œä¸”å•å±‚å¾ªç¯</p><p>è¿˜è¦æ³¨æ„è¦åˆ¤ç©ºå¤„ç†ï¼Œæ¯”å¦‚æ•°ç»„åªæœ‰ä¸€ä¸ªæ•°æˆ–è€…æ˜¯æ•°ç»„ä¸ºç©ºçš„æƒ…å†µ</p><h2 id="æ‰“å®¶åŠ«èˆII"><a href="#æ‰“å®¶åŠ«èˆII" class="headerlink" title="æ‰“å®¶åŠ«èˆII"></a>æ‰“å®¶åŠ«èˆII</h2><p>æœ¬é¢˜ç›¸æ¯”ä¸Šé¢˜ï¼Œå¤šäº†ä¸€ä¸ªå¾ªç¯ï¼Œä¹Ÿå°±æ˜¯æ”¶å°¾æ˜¯ç›¸è¿çš„ï¼›æ¢å¥è¯è¯´ï¼Œå°±æ˜¯é€‰é¦–ä¸èƒ½é€‰å°¾ï¼Œé€‰å°¾ä¸èƒ½é€‰é¦–ã€‚å¯ä»¥æŠŠç¬¬ä¸€ä¸ªæ•°åŠ åˆ°æœ€åä¸€ä¸ªæ•°åé¢è¿™æ ·å¤„ç†å—ï¼Ÿ</p><p>åŠ¨æ€è§„åˆ’äº”éƒ¨æ›²ï¼š</p><ol><li>ç¡®å®šdpæ•°ç»„çš„å«ä¹‰ï¼šdp[i]è¡¨ç¤ºå‰iä¸ªå…ƒç´ å¯ä»¥å·å–çš„æœ€å¤§é‡‘é¢</li><li>ç¡®å®šé€’æ¨å…¬å¼ï¼š<br>å†³å®šdp[i]çš„å› ç´ å°±æ˜¯ç¬¬iæˆ¿é—´å·è¿˜æ˜¯ä¸å·ã€‚å¦‚æœå·ï¼Œé‚£ä¹ˆå°±dp[i] = dp[i - 2] + nums[i]ï¼›è‹¥æ˜¯ä¸å·ï¼Œåˆ™dp[i] = dp[i - 1]ã€‚ä½†æ˜¯è¿™é‡Œè¦åˆ¤æ–­ä¸€ä¸‹ï¼Œè¿™ä¿©ä¸ªé‚£ä¸¤ä¸ªå¤§ï¼Œé‚£ä¹ˆå°±æ˜¯ï¼šdp[i] = max(dp[i - 2] + nums[i], dp[i - 1])</li><li>åˆå§‹åŒ–ï¼šç›´æ¥åˆå§‹åŒ–dp[0] = nums[0]ï¼Œdp[1] = max(nums[0], nums[1])</li><li>ç¡®å®šéå†é¡ºåºï¼šä¸€å±‚å¾ªç¯ï¼Ÿä»å‰å¾€åéå†</li><li>ä¸¾ä¾‹æ¨å¯¼</li></ol><p>å¡å“¥å‰å®³ï¼</p><p>åˆ†æå¦‚ä¸‹ï¼š</p><p><img src="/2022/09/16/dong-tai-gui-hua/Typoraæ–‡ä»¶\Typoraå›¾ç‰‡\image-20220708113513360.png" alt="image-20220708113513360"></p><p><img src="/2022/09/16/dong-tai-gui-hua/Typoraæ–‡ä»¶\Typoraå›¾ç‰‡\image-20220708113521374.png" alt="image-20220708113521374"></p><p><img src="/2022/09/16/dong-tai-gui-hua/Typoraæ–‡ä»¶\Typoraå›¾ç‰‡\image-20220708113529354.png" alt="image-20220708113529354"></p><p>æ—¢ç„¶é¦–å°¾ä¸èƒ½åŒæ—¶å­˜åœ¨ï¼Œé‚£ä¹ˆæˆ‘æ‰‹åŠ¨åˆ‡å»é¦–æˆ–è€…å°¾ä¸å°±è¡Œäº†ã€‚</p><p>æƒ…å†µäºŒä¸‰å¯ä»¥åŒ…å«æƒ…å†µä¸€ï¼Œæ‰€ä»¥ä»£ç æ€»ä½“é€»è¾‘è¿˜æ˜¯è·Ÿä¸Šé¢˜ç±»ä¼¼ï¼Œåªä¸è¿‡æœ¬é¢˜éœ€è¦æ¯”è¾ƒæƒ…å†µäºŒå’Œæƒ…å†µä¸‰è°å¤§è°å°</p><blockquote><p>ä¸¤ä¸ªé—®é¢˜ï¼ˆå·²ç†é¡ºï¼‰</p></blockquote><ol><li>ä¸»å‡½æ•°è¾¹ç•Œé—®é¢˜<br>ä¸»å‡½æ•°è¾¹ç•Œé—®é¢˜è¦æ·±å…¥åˆ°åŠ¨æ€è§„åˆ’å‡½æ•°é‡Œé¢ï¼Œå‘ç°é‡Œé¢çš„å‰é—­åå¼€çš„ï¼Œè§£å†³ã€‚</li><li>ä¸ç”¨æ•°ç»„è¿›è¡ŒåŠ¨æ€è§„åˆ’éå†é—®é¢˜<br>é¦–å…ˆè¦æ¸…æ¥šï¼Œéå†è¦ç”¨åˆ°i-1å’Œi-2çš„ï¼Œé‚£ä¹ˆå°±è¦å®šä¹‰ä¸‰ä¸ªå˜é‡ï¼Œä¸€ä¸ªæ˜¯i-2ï¼Œä¸€ä¸ªæ˜¯i-1ï¼Œä¸€ä¸ªæ˜¯iï¼›åˆ†åˆ«ç”¨x,y,zæ¥è¡¨ç¤ºã€‚ç”±äºåˆå§‹åŒ–å…¨ä¸º0ï¼Œæ‰€ä»¥å…ˆèµ‹å€¼i - 1ï¼›å†èµ‹å€¼å½“å‰çš„iï¼Œä¹Ÿå°±æ˜¯åŠ¨æ€è§„åˆ’é€’æ¨å…¬å¼ï¼Œæœ€åæ›´æ–°i -2,ä¹Ÿå°±æ˜¯x</li></ol><h2 id="æ‰“å®¶åŠ«èˆIII"><a href="#æ‰“å®¶åŠ«èˆIII" class="headerlink" title="æ‰“å®¶åŠ«èˆIII"></a>æ‰“å®¶åŠ«èˆIII</h2><p>åŠ¨æ€è§„åˆ’äº”éƒ¨æ›²ï¼š</p><ol><li>ç¡®å®šdpæ•°ç»„çš„å«ä¹‰ï¼šdp[j]è¡¨ç¤ºåˆ°ç¬¬jå±‚å¯ä»¥å·åˆ°çš„æœ€å¤§é‡‘é¢</li><li>ç¡®å®šé€’æ¨å…¬å¼ï¼š  è€ƒè™‘dp[j]ï¼Œdp[j]è¦ä¹ˆæ˜¯j-2ä¸ªåŠ ä¸Šjçš„ï¼Œè¦ä¹ˆæ˜¯j-1çš„ï¼›å…·ä½“æ˜¯å“ªä¸ªå–å†³äºå“ªä¸ªæ¯”è¾ƒå¤§ã€‚<br>æ‰€ä»¥é€’æ¨å…¬å¼ï¼šdp[j] = max(dp[j - 1], dp[j - 2] + nums[j])</li><li>åˆå§‹åŒ–ï¼šç¬¬ä¸€å±‚åˆå§‹åŒ–ä¸ºrootï¼Œç¬¬äºŒå±‚åˆå§‹åŒ–ä¸ºç¬¬ä¸€å±‚å’Œç¬¬äºŒå±‚çš„æœ€å¤§å€¼ï¼›</li><li>éå†é¡ºåºï¼šä½¿ç”¨å±‚åºéå†ï¼Œä¸€å±‚ä¸€å±‚</li><li>ä¸¾ä¾‹æ¨å¯¼</li></ol><p>å¡å“¥æ€è·¯ï¼š</p><p>æ ‘å½¢åŠ¨æ€è§„åˆ’åˆæ˜¯å¦å¤–ä¸€ç§æƒ…å†µï¼š</p><ol><li><p>ç¡®å®šé€’å½’å‡½æ•°çš„å‚æ•°å’Œè¿”å›å€¼<br>è¿”å›çš„å°±æ˜¯dpæ•°ç»„</p></li><li><p>ç¡®å®šç»ˆæ­¢æ¡ä»¶<br>åœ¨éå†çš„è¿‡ç¨‹ä¸­ï¼Œè‹¥é‡åˆ°ç©ºèŠ‚ç‚¹ï¼Œæ— è®ºæ˜¯å·æˆ–è€…ä¸å·ï¼Œéƒ½åˆå§‹åŒ–ä¸º0ï¼›æ³¨æ„ï¼Œæ˜¯æ•°ç»„</p></li><li><p>ç¡®å®šéå†é¡ºåºï¼š<br>ä½¿ç”¨ååºéå†ï¼›é€šè¿‡é€’å½’å·¦èŠ‚ç‚¹ï¼Œå¾—åˆ°å·¦èŠ‚ç‚¹å·ä¸ä¸å·çš„é‡‘é’±ï¼›é€šè¿‡é€’å½’å³èŠ‚ç‚¹ï¼Œå¾—åˆ°å·¦èŠ‚ç‚¹å·ä¸ä¸å·çš„é‡‘é’±</p></li><li><p>ç¡®å®šå•å±‚é€’å½’çš„é€»è¾‘</p><p>é¦–å…ˆæ˜ç¡®ä¸€ç‚¹ï¼Œres[0, 1];res[0]ä»£è¡¨ä¸å·å½“å‰èŠ‚ç‚¹ï¼Œres[1]ä»£è¡¨å·å½“å‰èŠ‚ç‚¹<br>åˆ†ä¸¤ç§æƒ…å†µï¼Œè‹¥æ˜¯å·å½“å‰èŠ‚ç‚¹ï¼Œåˆ™å·¦å³èŠ‚ç‚¹ä¸èƒ½å·ï¼Œval1 = cur-&gt;val + left[0] + right[0];è‹¥æ˜¯ä¸å·å½“å‰èŠ‚ç‚¹ï¼Œé‚£ä¹ˆå°±è¦å·å·¦å³èŠ‚ç‚¹ï¼Œæ—¢ç„¶æ˜¯å·å·¦å³èŠ‚ç‚¹ï¼Œé‚£å½“ç„¶æ˜¯è¦æ‰¾å·¦å³èŠ‚ç‚¹çš„æœ€å¤§å€¼ï¼Œval2 = max(left[0], left[1]) + max(right[0], right[1])</p></li><li><p>ä¸¾ä¾‹æ¨å¯¼</p></li></ol><h2 id="ä¹°å–è‚¡ç¥¨çš„æœ€ä½³æ—¶æœº"><a href="#ä¹°å–è‚¡ç¥¨çš„æœ€ä½³æ—¶æœº" class="headerlink" title="ä¹°å–è‚¡ç¥¨çš„æœ€ä½³æ—¶æœº"></a>ä¹°å–è‚¡ç¥¨çš„æœ€ä½³æ—¶æœº</h2><p>è´ªå¿ƒï¼š</p><p>ç‰›ï¼è®¡ç®—æœ€å·¦æœ€å°å€¼ï¼Œæœ€ä¼˜æœ€å¤§å€¼ï¼Œè®¡ç®—å·®å€¼å³å¯</p><p>åŠ¨æ€è§„åˆ’äº”éƒ¨æ›²ï¼š</p><ol><li>ç¡®å®šdpæ•°ç»„å«ä¹‰ï¼šdp[i] [0]è¡¨ç¤ºä»Šå¤©æŒæœ‰è‚¡ç¥¨æ‰€å¾—çš„ä»·å€¼ï¼›dp[i] [1]è¡¨ç¤ºä»Šå¤©ä¸æŒæœ‰è‚¡ç¥¨æ‰€å¾—çš„ä»·å€¼</li><li>ç¡®å®šåŠ¨æ€è§„åˆ’é€’æ¨å…¬å¼ï¼šé¦–å…ˆè¦æ˜ç¡®ï¼ŒæŒæœ‰å¹¶ä¸ä»£è¡¨ä»Šå¤©ä¹°å…¥ï¼ŒåŒæ ·ï¼Œä¸æŒæœ‰å¹¶ä¸ä»£è¡¨æ˜¯ä»Šå¤©å–å‡ºçš„ï¼›<br>é‚£ä¹ˆé—®é¢˜æ˜æœ—äº†ï¼ŒæŒæœ‰åˆ†ä¸¤ç§æƒ…å†µï¼Œä¸€ç§æ˜¯ä»Šå¤©ä¹°å…¥ï¼Œä¸€ç§æ˜¯ä»Šå¤©ä¸ä¹°å…¥ï¼›æ‰€ä»¥dp[i] [0] = max(- prices[i], dp[i - 1] [0]);<br>ä¸æŒæœ‰åˆ†ä¸¤ç§æƒ…å†µï¼Œä¸€ç§æ˜¯ä»Šå¤©å–å‡ºï¼Œä¸€ç§æ˜¯ä»Šå¤©ä¸å–å‡ºï¼›æ‰€ä»¥dp[i] [1] = max(dp[i - 1] [1], prices[i] + dp[i - 1] [0]);</li><li>åˆå§‹åŒ–ï¼šä»é€’æ¨å…¬å¼ä¸Šå¯ä»¥çœ‹å‡ºï¼Œéƒ½æ˜¯åŸºäºå‰ä¸€ä¸ªæ¥è¿›è¡Œé€’æ¨ï¼Œæ‰€ä»¥åˆå§‹åŒ–dp[0] [0] = -prices[0], dp[0] [1] = 0;</li><li>éå†é¡ºåºï¼šä»å‰å¾€åéå†</li><li>ä¸¾ä¾‹æ¨å¯¼</li></ol><blockquote><p>æ³¨æ„ï¼Œç¡®å®šåŠ¨æ€è§„åˆ’é€’æ¨å…¬å¼çš„æ—¶å€™ï¼Œæ³¨æ„æ­£è´Ÿå·ï¼›</p></blockquote><p>åŠ¨æ€è§„åˆ’ç¡®å®šdpæ•°ç»„çš„æ—¶å€™ï¼Œæ€è·¯è¦æ‰“å¼€ï¼Œæœ‰å¯èƒ½äºŒç»´æ•°ç»„æ˜¯å› ä¸ºæœ‰ä¸¤ä¸ªä¸åŒçš„ç»´åº¦ï¼Œæ¯”å¦‚ç‰©å“é‡é‡å’Œç‰©å“ä»·å€¼ï¼›ä½†ä¹Ÿæœ‰å¯èƒ½æ˜¯åšä¸€ä¸ªæ ‡è®°ï¼Œ0 å’Œ 1ï¼›</p><h2 id="ä¹°å–è‚¡ç¥¨çš„æœ€ä½³æ—¶æœºII"><a href="#ä¹°å–è‚¡ç¥¨çš„æœ€ä½³æ—¶æœºII" class="headerlink" title="ä¹°å–è‚¡ç¥¨çš„æœ€ä½³æ—¶æœºII"></a>ä¹°å–è‚¡ç¥¨çš„æœ€ä½³æ—¶æœºII</h2><p>åŠ¨æ€è§„åˆ’äº”éƒ¨æ›²ï¼š</p><ol><li>ç¡®å®šdpæ•°ç»„å«ä¹‰ï¼šdp[i] [0]è¡¨ç¤ºä»Šå¤©æŒæœ‰è‚¡ç¥¨æ‰€å¾—çš„ä»·å€¼ï¼›dp[i] [1]è¡¨ç¤ºä»Šå¤©ä¸æŒæœ‰è‚¡ç¥¨æ‰€å¾—çš„ä»·å€¼</li><li>ç¡®å®šåŠ¨æ€è§„åˆ’é€’æ¨å…¬å¼ï¼šé¦–å…ˆè¦æ˜ç¡®ï¼ŒæŒæœ‰å¹¶ä¸ä»£è¡¨ä»Šå¤©ä¹°å…¥ï¼ŒåŒæ ·ï¼Œä¸æŒæœ‰å¹¶ä¸ä»£è¡¨æ˜¯ä»Šå¤©å–å‡ºçš„ï¼›<br>é‚£ä¹ˆé—®é¢˜æ˜æœ—äº†ï¼ŒæŒæœ‰åˆ†ä¸¤ç§æƒ…å†µï¼Œä¸€ç§æ˜¯ä»Šå¤©ä¹°å…¥ï¼Œä¸€ç§æ˜¯ä»Šå¤©ä¸ä¹°å…¥ï¼›ä»Šå¤©ä¹°å…¥çš„æƒ…å†µï¼Œè¦ç”¨æ˜¨å¤©æœªä¹°å…¥çš„ä»·å€¼å‡å»prices[i]ï¼Œ<strong>è¿™ä¸€ç‚¹ä¹Ÿæ˜¯ä¸å‰ä¸€é“é¢˜æœ‰æ‰€ä¸åŒ</strong>ï¼Œ æ‰€ä»¥dp[i] [0] = max(dp[i - 1] [1] - prices[i], dp[i - 1] [0]);<br>ä¸æŒæœ‰åˆ†ä¸¤ç§æƒ…å†µï¼Œä¸€ç§æ˜¯ä»Šå¤©å–å‡ºï¼Œä¸€ç§æ˜¯ä»Šå¤©ä¸å–å‡ºï¼›æ‰€ä»¥dp[i] [1] = max(dp[i - 1] [1], prices[i] + dp[i - 1] [0]);</li><li>åˆå§‹åŒ–ï¼šä»é€’æ¨å…¬å¼ä¸Šå¯ä»¥çœ‹å‡ºï¼Œéƒ½æ˜¯åŸºäºå‰ä¸€ä¸ªæ¥è¿›è¡Œé€’æ¨ï¼Œæ‰€ä»¥åˆå§‹åŒ–dp[0] [0] = -proces[0], dp[0] [1] = 0;</li><li>éå†é¡ºåºï¼šä»å‰å¾€åéå†</li><li>ä¸¾ä¾‹æ¨å¯¼</li></ol><h2 id="ä¹°å–è‚¡ç¥¨çš„æœ€ä½³æ—¶æœºIII"><a href="#ä¹°å–è‚¡ç¥¨çš„æœ€ä½³æ—¶æœºIII" class="headerlink" title="ä¹°å–è‚¡ç¥¨çš„æœ€ä½³æ—¶æœºIII"></a>ä¹°å–è‚¡ç¥¨çš„æœ€ä½³æ—¶æœºIII</h2><p>åŠ¨æ€è§„åˆ’äº”éƒ¨æ›²ï¼š</p><ol><li><p>ç¡®å®šdpæ•°ç»„çš„å«ä¹‰ï¼šdp[i] [j], j ä» 0 åˆ°4 ï¼Œåˆ†åˆ«ä»£è¡¨ç€ä¸æ“ä½œï¼Œç¬¬ä¸€æ¬¡ä¹°å–è‚¡ç¥¨ï¼Œç¬¬äºŒæ¬¡ä¹°å–è‚¡ç¥¨</p></li><li><p>ç¡®å®šåŠ¨æ€è§„åˆ’é€’æ¨å…¬å¼ï¼š<br>ä¸æ“ä½œå°±ä¸ç”¨è¯´äº†ï¼Œè¾¾åˆ°dp[i] [1]æœ‰ä¸¤ç§é€”å¾„ï¼š</p><ul><li>ä»Šå¤©è´­ä¹°ï¼Œdp[i] [1] = dp[i - 1] [0] - prices[i]</li><li>ä»Šå¤©æ²¿ç”¨æ˜¨å¤©çš„çŠ¶æ€ï¼Œdp[i] [1] = dp[i - 1] [1]</li></ul><p>å–æœ€å¤§å€¼ï¼š  dp[i] [1] = max(dp[i - 1] [0] - prices[i], dp[i - 1] [1])<br>åŒæ · dp[i] [2] = max(dp[i - 1] [1] + prices[i], dp[i - 1] [2])</p><p>åŒç† dp[i] [3] = max(dp[i - 1] [2] - prices[i], dp[i - 1] [3])</p><p>â€‹         dp[i] [4] = max(dp[i - 1] [3] + prices[i], dp[i - 1] [4])</p></li><li><p>å¦‚ä½•åˆå§‹åŒ–ï¼š<br>dp[0] [0] = 0;  dp[0] [1] = -prices[0];  dp[0] [2] = 0; dp[0] [3] = -prices[0];  dp[0] [4] = 0; </p></li><li><p>ç¡®å®šéå†é¡ºåºï¼šä»å‰å¾€åéå†</p></li><li><p>ä¸¾ä¾‹æ¨å¯¼</p></li></ol><h2 id="ä¹°å–è‚¡ç¥¨çš„æœ€ä½³æ—¶æœºIV-å†è€ƒè™‘è€ƒè™‘"><a href="#ä¹°å–è‚¡ç¥¨çš„æœ€ä½³æ—¶æœºIV-å†è€ƒè™‘è€ƒè™‘" class="headerlink" title="ä¹°å–è‚¡ç¥¨çš„æœ€ä½³æ—¶æœºIV(å†è€ƒè™‘è€ƒè™‘)"></a>ä¹°å–è‚¡ç¥¨çš„æœ€ä½³æ—¶æœºIV(å†è€ƒè™‘è€ƒè™‘)</h2><p>åŠ¨æ€è§„åˆ’äº”éƒ¨æ›²ï¼š</p><ol><li>ç¡®å®šdpæ•°ç»„çš„å«ä¹‰ï¼šdp[i] [j],ä»£è¡¨ç¬¬iå¤©çš„çŠ¶æ€ä¸ºjæ‰€å‰©ä¸‹çš„æœ€å¤§ç°é‡‘<ul><li>jçš„çŠ¶æ€è¡¨ç¤ºä¸ºï¼š<br>0ä»£è¡¨ä»€ä¹ˆéƒ½ä¸å¹²ï¼Œï¼›<br>1ä»£è¡¨ç¬¬ä¸€æ¬¡ä¹°å…¥<br>2ä»£è¡¨ç¬¬ä¸€æ¬¡å–å‡º<br>3ä»£è¡¨ç¬¬äºŒæ¬¡ä¹°å…¥<br>4ä»£è¡¨ç¬¬äºŒæ¬¡å–å‡º    é‚£ä¹ˆjçš„èŒƒå›´å°±å¯ä»¥å®šä¹‰ä¸º2*k + 1</li></ul></li><li>ç¡®å®šåŠ¨æ€è§„åˆ’é€’æ¨å…¬å¼ï¼š<br>è¦æƒ³è¾¾åˆ°dp[i] [1]æœ‰ä¸¤ç§ï¼šä»Šå¤©ä¹°ï¼Œæˆ–è€…ä»Šå¤©æ²¿ç”¨æ˜¨å¤©çš„çŠ¶æ€ï¼›  dp[i] [1] = dp[i - 1] [0] - prices[i]  ï¼› dp[i] [1] = dp[i - 1] [1]   ï¼Œé€‰æœ€å¤§çš„<br>åŒæ ·ï¼Œè¾¾åˆ°dp[i] [2]ä¹Ÿæœ‰ä¸¤ç§ï¼šä»Šå¤©å–ï¼Œä»Šå¤©æ²¿ç”¨æ˜¨å¤©çš„çŠ¶æ€ï¼›  dp[i] [2] = max(dp[i - 1] [1] + prices[i], dp[i - 1] [2])<br>éå†jï¼Œä»0åˆ°2*k + 1å³å¯</li><li>åˆå§‹åŒ–ï¼š<br>dp[0] [0] = 0;   ç¬¬ä¸€æ¬¡ä¹°å…¥çš„è¯ï¼Œdp[0] [1] = -prices[i]  ;ç¬¬ä¸€æ¬¡å–å‡ºçš„è¯ï¼Œdp[0] [2] = 0;åŒç†ï¼Œä¹‹ååªè¦æ˜¯ä¹°å…¥ï¼Œä¸ç®¡ç¬¬å‡ æ¬¡ï¼Œéƒ½æ˜¯-prices[i]</li><li>ç¡®å®šéå†é¡ºåºï¼šä»å‰å¾€å</li><li>ä¸¾ä¾‹æ¨å¯¼</li></ol><h2 id="æœ€ä½³ä¹°å–è‚¡ç¥¨æ—¶æœºå«å†·å†»æœŸ-å†è€ƒè™‘è€ƒè™‘"><a href="#æœ€ä½³ä¹°å–è‚¡ç¥¨æ—¶æœºå«å†·å†»æœŸ-å†è€ƒè™‘è€ƒè™‘" class="headerlink" title="æœ€ä½³ä¹°å–è‚¡ç¥¨æ—¶æœºå«å†·å†»æœŸ(å†è€ƒè™‘è€ƒè™‘)"></a>æœ€ä½³ä¹°å–è‚¡ç¥¨æ—¶æœºå«å†·å†»æœŸ(å†è€ƒè™‘è€ƒè™‘)</h2><p>åŠ¨æ€è§„åˆ’äº”éƒ¨æ›²ï¼š</p><ol><li><p>ç¡®å®šdpæ•°ç»„çš„å«ä¹‰ï¼šdp[i] [j],ä»£è¡¨ç¬¬iå¤©çš„çŠ¶æ€ä¸ºjæ‰€å‰©ä¸‹çš„æœ€å¤§ç°é‡‘</p><ul><li>jçš„ç¬¬ä¸€ä¸ªçŠ¶æ€ï¼š0ï¼Œè¡¨ç¤ºä»Šå¤©ä¹°å…¥</li><li>jçš„ç¬¬ä¸€ä¸ªçŠ¶æ€ï¼š1ï¼Œè¡¨ç¤ºä»Šå¤©ä¿æŒå–å‡ºçŠ¶æ€ï¼Œä¸”åº¦è¿‡å†·å†»æœŸ</li><li>jçš„ç¬¬ä¸€ä¸ªçŠ¶æ€ï¼š2ï¼Œè¡¨ç¤ºä»Šå¤©å–å‡º</li><li>jçš„ç¬¬ä¸€ä¸ªçŠ¶æ€ï¼š3ï¼Œè¡¨ç¤ºä»Šå¤©ä¸ºå†·å†»æœŸ</li></ul></li><li><p>ç¡®å®šé€’æ¨å…¬å¼ï¼š<br>==!==æƒ³æƒ³dp[i] [0] å¦‚ä½•æ¥çš„ï¼Œä¹Ÿå°±æ˜¯ä»Šå¤©ä¹°å…¥ï¼Œä¸€ç§æ˜¯ä»Šå¤©ä¹°å…¥ï¼Œå¦ä¸€ç§æ˜¯ä»Šå¤©ä¿æŒä¹°å…¥çŠ¶æ€ã€‚äºŒè€…å–æœ€å¤§ï¼šmax(dp[i - 1] [0] + prices[i] , dp[i - 1] [0]);;<br>ä»¥ä¸Šé”™è¯¯ï¼Œæ²¡æœ‰è€ƒè™‘åˆ°å†·å†»æœŸçš„å­˜åœ¨</p><p>è¾¾åˆ°ä¹°å…¥è‚¡ç¥¨çŠ¶æ€ï¼ˆçŠ¶æ€ä¸€ï¼‰å³ï¼šdp[i] [0]ï¼Œæœ‰ä¸¤ä¸ªå…·ä½“æ“ä½œï¼š</p><ul><li>æ“ä½œä¸€ï¼šå‰ä¸€å¤©å°±æ˜¯æŒæœ‰è‚¡ç¥¨çŠ¶æ€ï¼ˆçŠ¶æ€ä¸€ï¼‰ï¼Œdp[i] [0] = dp[i - 1] [0]</li><li>æ“ä½œäºŒï¼šä»Šå¤©ä¹°å…¥äº†ï¼Œæœ‰ä¸¤ç§æƒ…å†µ<ul><li>å‰ä¸€å¤©æ˜¯å†·å†»æœŸï¼ˆçŠ¶æ€å››ï¼‰ï¼Œdp[i - 1] [3] - prices[i]</li><li>å‰ä¸€å¤©æ˜¯ä¿æŒå–å‡ºè‚¡ç¥¨çŠ¶æ€ï¼ˆçŠ¶æ€äºŒï¼‰ï¼Œdp[i - 1] [1] - prices[i]</li></ul></li></ul><p>æ‰€ä»¥æ“ä½œäºŒå–æœ€å¤§å€¼ï¼Œå³ï¼šmax(dp[i - 1] [3], dp[i - 1] [1]) - prices[i]</p><p>é‚£ä¹ˆdp[i] [0] = max(dp[i - 1] [0], max(dp[i - 1] [3], dp[i - 1] [1]) - prices[i]);</p><p>è¾¾åˆ°ä¿æŒå–å‡ºè‚¡ç¥¨çŠ¶æ€ï¼ˆçŠ¶æ€äºŒï¼‰å³ï¼šdp[i] [1]ï¼Œæœ‰ä¸¤ä¸ªå…·ä½“æ“ä½œï¼š</p><ul><li>æ“ä½œä¸€ï¼šå‰ä¸€å¤©å°±æ˜¯çŠ¶æ€äºŒ</li><li>æ“ä½œäºŒï¼šå‰ä¸€å¤©æ˜¯å†·å†»æœŸï¼ˆçŠ¶æ€å››ï¼‰</li></ul><p>dp[i] [1] = max(dp[i - 1] [1], dp[i - 1] [3]);</p><p>è¾¾åˆ°ä»Šå¤©å°±å–å‡ºè‚¡ç¥¨çŠ¶æ€ï¼ˆçŠ¶æ€ä¸‰ï¼‰ï¼Œå³ï¼šdp[i] [2] ï¼Œåªæœ‰ä¸€ä¸ªæ“ä½œï¼š</p><ul><li>æ“ä½œä¸€ï¼šæ˜¨å¤©ä¸€å®šæ˜¯ä¹°å…¥è‚¡ç¥¨çŠ¶æ€ï¼ˆçŠ¶æ€ä¸€ï¼‰ï¼Œä»Šå¤©å–å‡º</li></ul><p>å³ï¼šdp[i] [2] = dp[i - 1] [0] + prices[i];</p><p>è¾¾åˆ°å†·å†»æœŸçŠ¶æ€ï¼ˆçŠ¶æ€å››ï¼‰ï¼Œå³ï¼šdp[i] [3]ï¼Œåªæœ‰ä¸€ä¸ªæ“ä½œï¼š</p><ul><li>æ“ä½œä¸€ï¼šæ˜¨å¤©å–å‡ºäº†è‚¡ç¥¨ï¼ˆçŠ¶æ€ä¸‰ï¼‰</li></ul><p>dp[i] [3] = dp[i - 1] [2];<br>==æ³¨æ„ï¼šè®¨è®ºçš„æ˜¯ä¹°å–è‚¡ç¥¨çš„çŠ¶æ€ï¼Œå¹¶ä¸æ˜¯ä»Šå¤©ä¸€å®šè¦ä¹°å–==</p></li><li><p>åˆå§‹åŒ–<br>ä¸»è¦è€ƒè™‘ç¬¬0å¤©å¦‚ä½•åˆå§‹åŒ–å³å¯ã€‚<br>dp[0] [0] = -prices[0]<br>dp[0] [1] = 0 ,ç¬¬0å¤©æ²¡æœ‰å–å‡ºï¼Œåˆå§‹åŒ–ä¸º0å³å¯<br>dp[0] [2] = 0, dp[0] [3] = 0</p></li><li><p>éå†é¡ºåºï¼Œä»å‰å¾€å</p></li><li><p>ä¸¾ä¾‹æ¨å¯¼</p></li></ol><p>æœ¬é¢˜å®˜æ–¹ç»™çš„ç­”æ¡ˆä¹Ÿå¾ˆæ¸…æ™°</p><h2 id="ä¹°å–è‚¡ç¥¨çš„æœ€ä½³æ—¶æœºå«æ‰‹ç»­è´¹"><a href="#ä¹°å–è‚¡ç¥¨çš„æœ€ä½³æ—¶æœºå«æ‰‹ç»­è´¹" class="headerlink" title="ä¹°å–è‚¡ç¥¨çš„æœ€ä½³æ—¶æœºå«æ‰‹ç»­è´¹"></a>ä¹°å–è‚¡ç¥¨çš„æœ€ä½³æ—¶æœºå«æ‰‹ç»­è´¹</h2><ol><li><p>ç¡®å®šdpæ•°ç»„çš„å«ä¹‰ï¼šdp[i] [0],  dp[i] [1]ï¼Œåˆ†åˆ«ä»£è¡¨ç€æŒæœ‰è‚¡ç¥¨æ‰€å¾—çš„æœ€å¤§æ”¶å…¥å’Œä¸æŒæœ‰è‚¡ç¥¨æ‰€å¾—çš„æœ€å¤§æ”¶å…¥</p></li><li><p>ç¡®å®šåŠ¨æ€è§„åˆ’é€’æ¨å…¬å¼ï¼š<br>è¾¾åˆ°dp[i] [0]æœ‰ä¸¤ç§é€”å¾„ï¼š</p><ul><li>æ˜¨å¤©å·²è´­ä¹°ï¼Œdp[i] [0] = dp[i - 1] [0]</li><li>ä»Šå¤©è´­ä¹°ï¼Œdp[i] [0] = dp[i - 1] [1] -  prices[i]</li></ul><p>è¾¾åˆ°dp[i] [1] æœ‰ä¸¤ç§é€”å¾„</p><ul><li>æ˜¨å¤©å·²å–å‡ºï¼Œdp[i] [1] = dp[i - 1] [1]</li><li>ä»Šå¤©å–å‡ºï¼Œè¦åŠ ä¸Šæ‰‹ç»­è´¹ï¼Œdp[i] [1] = dp[i - 1] [0] + prices[i] -fee</li></ul></li><li><p>å¦‚ä½•åˆå§‹åŒ–ï¼š<br>dp[0] [1] = 0;  dp[0] [0] = -prices[0]; </p></li><li><p>ç¡®å®šéå†é¡ºåºï¼šä»å‰å¾€åéå†</p></li><li><p>ä¸¾ä¾‹æ¨å¯¼</p></li></ol><h2 id="æœ€é•¿é€’å¢å­åºåˆ—"><a href="#æœ€é•¿é€’å¢å­åºåˆ—" class="headerlink" title="æœ€é•¿é€’å¢å­åºåˆ—"></a>æœ€é•¿é€’å¢å­åºåˆ—</h2><p>åŠ¨æ€è§„åˆ’äº”éƒ¨æ›²ï¼š</p><ol><li>ç¡®å®šdpæ•°ç»„çš„å«ä¹‰ï¼šdp[i]è¡¨ç¤ºiä¹‹å‰åŒ…æ‹¬içš„æœ€é•¿é€’å¢å­åºåˆ—çš„ä¸ªæ•°</li><li>ç¡®å®šé€’æ¨å…¬å¼ï¼š<br>ä¸ªäººæƒ³æ³•æ˜¯ä»å½“å‰ä½ç½®å‘å‰æ‰¾ç¬¬ä¸€ä¸ªå°äºiçš„é‚£ä¸ªï¼Œç„¶å+1<br>å…¶å®é“ç†éƒ½ä¸€æ ·ï¼Œå¡å“¥æ˜¯ç”¨dp[i]å’Œdp[j]+1ä¸­å–æœ€å¤§å€¼ï¼Œjçš„èŒƒå›´æ˜¯0 åˆ° i - 1</li><li>åˆå§‹åŒ–ï¼šå…ˆå…¨éƒ¨åˆå§‹åŒ–ä¸º1ï¼›   éå†ä¸ºäºŒæ¬¡å¾ªç¯ï¼Œè€Œä¸æ˜¯ä¸€æ¬¡å¾ªç¯</li><li>éå†é¡ºåºï¼šä»å‰å¾€å    iå¤–å±‚ï¼Œjå†…å±‚</li><li>ä¸¾ä¾‹æ¨å¯¼ </li></ol><h2 id="æœ€é•¿è¿ç»­é€’å¢å­åºåˆ—"><a href="#æœ€é•¿è¿ç»­é€’å¢å­åºåˆ—" class="headerlink" title="æœ€é•¿è¿ç»­é€’å¢å­åºåˆ—"></a>æœ€é•¿è¿ç»­é€’å¢å­åºåˆ—</h2><p>åŠ¨æ€è§„åˆ’äº”éƒ¨æ›²ï¼š</p><ol><li>ç¡®å®šdpæ•°ç»„çš„å«ä¹‰ï¼šdp[i]è¡¨ç¤ºiä¹‹å‰åŒ…æ‹¬içš„æœ€é•¿è¿ç»­é€’å¢å­åºåˆ—çš„ä¸ªæ•°</li><li>ç¡®å®šé€’æ¨å…¬å¼ï¼š<br>åªéœ€è¦åˆ¤æ–­nums[i] å’Œnums[i-1]è°å¤§è°å°ï¼Œè‹¥iå¤§ï¼Œåˆ™dp[i] = dp[i - 1] + 1ï¼Œå¦åˆ™ä»¤dp[i] = 1</li><li>åˆå§‹åŒ–ï¼šå…ˆå…¨éƒ¨åˆå§‹åŒ–ä¸º1ï¼› </li><li>éå†é¡ºåºï¼šä»å‰å¾€å   </li><li>ä¸¾ä¾‹æ¨å¯¼</li></ol><p>So Easyï¼</p><h2 id="æœ€é•¿é‡å¤å­æ•°ç»„"><a href="#æœ€é•¿é‡å¤å­æ•°ç»„" class="headerlink" title="æœ€é•¿é‡å¤å­æ•°ç»„"></a>æœ€é•¿é‡å¤å­æ•°ç»„</h2><p>åŠ¨æ€è§„åˆ’äº”éƒ¨æ›²ï¼š</p><ol><li>ç¡®å®šdpæ•°ç»„çš„å«ä¹‰ï¼šdp[i] [j] è¡¨ç¤ºä»¥ä¸‹æ ‡i-1ç»“å°¾çš„aå’Œä»¥ä¸‹æ ‡j-1ç»“å°¾çš„bçš„æœ€é•¿é‡å¤å­æ•°ç»„</li><li>ç¡®å®šé€’æ¨å…¬å¼ï¼š<br>é€šè¿‡ä»¥å‰çš„çŠ¶æ€æ¥åˆ¤æ–­ï¼Œè‹¥æ˜¯Aå’ŒBæ•°ç»„ç›¸ç­‰ï¼Œé‚£ä¹ˆå°±ä»¤dp[i] [j] = dp[i - 1] [j - 1] + 1;</li><li>åˆå§‹åŒ–ï¼šé¦–å…ˆdp[0] [0]æ˜¯æ— æ„ä¹‰çš„ï¼Œä½†ä¸ºäº†æ–¹ä¾¿åç»­ï¼Œå°†dp[0] [0]  dp[0] [j] dp[i] [0]å…¨éƒ¨åˆå§‹åŒ–ä¸º0ï¼›å…¶å®åˆä¸åˆå§‹åŒ–çš„æ— æ‰€è°“</li><li>éå†é¡ºåºï¼Œä¸¤å±‚éå†</li><li>ä¸¾ä¾‹æ¨å¯¼</li></ol><h2 id="æœ€é•¿å…¬å…±å­åºåˆ—"><a href="#æœ€é•¿å…¬å…±å­åºåˆ—" class="headerlink" title="æœ€é•¿å…¬å…±å­åºåˆ—"></a>æœ€é•¿å…¬å…±å­åºåˆ—</h2><p>åŠ¨æ€è§„åˆ’äº”éƒ¨æ›²ï¼š</p><ol><li>ç¡®å®šdpæ•°ç»„çš„å«ä¹‰ï¼šdp[i] [j]è¡¨ç¤ºä»0åˆ°i-1çš„å­—ç¬¦ä¸²1å’Œä»0åˆ°j-1çš„å­—ç¬¦ä¸²2çš„æœ€é•¿å…¬å…±å­åºåˆ—</li><li>ç¡®å®šé€’æ¨å…¬å¼ï¼š<br>ä¸¤ç§ç»“æœï¼šç›¸ç­‰ã€ä¸ç­‰ï¼›ç›¸ç­‰çš„æƒ…å†µï¼šdp[i] [j] = dp[i - 1] [j - 1] + 1;ä¸ç­‰çš„æƒ…å†µï¼šå–dp[i - 1] [j - 2]å’Œdp[i - 2] [j - 1]çš„æœ€å¤§å€¼</li><li>åˆå§‹åŒ–ï¼šå°†å¸¦0çš„åˆå§‹åŒ–ä¸º0ï¼Œå¸¦0çš„æ¯«æ— æ„ä¹‰</li><li>éå†é¡ºåºï¼šä»é€’æ¨å…¬å¼å¯ä»¥çœ‹å‡ºï¼Œä¸€å®šæ˜¯ä»å‰åˆ°åï¼Œä»ä¸Šåˆ°ä¸‹</li><li>ä¸¾ä¾‹æ¨å¯¼</li></ol><h2 id="ä¸ç›¸äº¤çš„çº¿"><a href="#ä¸ç›¸äº¤çš„çº¿" class="headerlink" title="ä¸ç›¸äº¤çš„çº¿"></a>ä¸ç›¸äº¤çš„çº¿</h2><p>ä¸ä¸Šè¿°æœ€é•¿å…¬å…±å­åºåˆ—ä»£ç 95%ä¸€è‡´</p><h2 id="æœ€å¤§å­åºå’Œ"><a href="#æœ€å¤§å­åºå’Œ" class="headerlink" title="æœ€å¤§å­åºå’Œ"></a>æœ€å¤§å­åºå’Œ</h2><p>åŠ¨æ€è§„åˆ’äº”éƒ¨æ›²ï¼š</p><ol><li>ç¡®å®šdpæ•°ç»„çš„å«ä¹‰ï¼šdp[i]è¡¨ç¤ºå‰iä¸ªæ•°çš„æœ€å¤§å­åºå’Œ</li><li>ç¡®å®šé€’æ¨å…¬å¼ï¼š<br>è¿™ä¹ˆæƒ³ï¼Œç¬¬iä¸ªæ•°æœ‰ä¸¤ç§æƒ…å†µï¼Œä¸€ç§æ˜¯ç›´æ¥åŠ å…¥dp[i]ï¼Œå¦ä¸€ç§æ˜¯ä»å¤´ç®—èµ·ï¼ŒäºŒè€…å–æœ€å¤§</li><li>åˆå§‹åŒ–ï¼šdp[0] = nums[0]</li><li>éå†é¡ºåºï¼šä»å‰åˆ°å</li><li>ä¸¾ä¾‹æ¨å¯¼</li></ol><h2 id="åˆ¤æ–­å­åºåˆ—"><a href="#åˆ¤æ–­å­åºåˆ—" class="headerlink" title="åˆ¤æ–­å­åºåˆ—"></a>åˆ¤æ–­å­åºåˆ—</h2><p>åŠ¨æ€è§„åˆ’äº”éƒ¨æ›²ï¼š</p><ol><li>ç¡®å®šdpæ•°ç»„çš„å«ä¹‰ï¼šdp[i] [j]è¡¨ç¤ºå‰i-1å’Œå‰j - 1çš„å­—ç¬¦ä¸²ä¸ºå­åºåˆ—çš„ä¸ªæ•°</li><li>ç¡®å®šé€’æ¨å…¬å¼ï¼š<br>è€ƒè™‘ä¸¤ç§æƒ…å†µï¼š1ã€  i - 1 == j - 1ï¼Œåˆ™dp[i] [j] = dp[i - 1] [ j - 1] + 1;2ã€i - 1 ï¼= j - 1ï¼Œè‹¥ä¸ç›¸ç­‰ï¼Œé‚£ä¹ˆTå°±è¦â€œåˆ é™¤â€æ‰j - 1äº†ï¼Œé‚£ä¹ˆä»æ•°å€¼ä¸Šæ¥çœ‹å°±ç›¸å½“äºdp[i] [ j] = dp[i] [j - 1]</li><li>åˆå§‹åŒ–ï¼šå°†å¸¦0çš„å…¨éƒ¨åˆå§‹åŒ–ä¸º0</li><li>éå†é¡ºåºï¼Œä¸¤å±‚å¾ªç¯ï¼Œå¤–å±‚æ˜¯iï¼Œéå†sï¼›</li><li>ä¸¾ä¾‹æ¨å¯¼</li></ol><p>==æ³¨æ„è¾¹ç•Œï¼Œæ¯æ¬¡éƒ½æ˜¯è¾¹ç•Œå‡ºé”™ï¼›æœ€ååˆ¤æ–­çš„æ˜¯dp[s.length()] [t.length()]è€Œä¸æ˜¯dp[s.length()+1] [t.length()+1]==</p><blockquote><p>å› ä¸ºs.length()æœ¬èº«å°±ä¸åŒ…æ‹¬æœ€åä¸€ä¸ªå…ƒç´ ï¼Œå±äºæ˜¯å‰é—­åå¼€</p></blockquote><h2 id="ä¸åŒçš„å­åºåˆ—"><a href="#ä¸åŒçš„å­åºåˆ—" class="headerlink" title="ä¸åŒçš„å­åºåˆ—"></a>ä¸åŒçš„å­åºåˆ—</h2><p>åŠ¨æ€è§„åˆ’äº”éƒ¨æ›²ï¼š</p><ol><li>ç¡®å®šdpæ•°ç»„çš„å«ä¹‰ï¼šdp[i] [j]è¡¨ç¤ºå‰i-1å’Œå‰j - 1çš„å­—ç¬¦ä¸²ä¸ºä¸åŒå­åºåˆ—çš„ä¸ªæ•°</li><li>ç¡®å®šé€’æ¨å…¬å¼ï¼š<br>ä¸¤å¤§å—ï¼š1ã€ç›¸ç­‰  2ã€ä¸ç­‰<br>1ã€ç›¸ç­‰ï¼š å¯ä»¥ç”¨dp[i - 1] [j - 1]ï¼Œä¹Ÿå¯ä»¥ä¸ç”¨ï¼Œä¸ºä»€ä¹ˆä¸ç”¨å‘¢ï¼Œæ˜¯å› ä¸ºä¸åŒçš„å­åºåˆ—ï¼Œå¯èƒ½å¾—åˆ°çš„ç»“æœä¸åŒï¼Œæ‰€ä»¥å°±æ˜¯dp[i - 2] [j - 1];äºŒè€…ç›¸åŠ ï¼Œä¹Ÿå³dp[i] [j] = dp[i - 1] [j - 1] + dp[i - 1] [j];<br>2ã€ä¸ç­‰ï¼š ä¸ç­‰ç›´æ¥å°±æ˜¯dp[i - 1] [j]ï¼Œå³dp[i] [j] = dp[i - 1] [j];</li><li>åˆå§‹åŒ–ï¼šé¦–å…ˆå¸¦0çš„è‚¯å®šæ˜¯è¦åˆå§‹åŒ–çš„ï¼Œè‡³äºæ€ä¹ˆåˆå§‹åŒ–ï¼Œçœ‹dp[i] [0]ï¼Œä»£è¡¨çš„å«ä¹‰ä»¥i-1ä¸ºç»“å°¾çš„så¯ä»¥éšä¾¿åˆ é™¤å…ƒç´ ï¼Œå‡ºç°ç©ºå­—ç¬¦ä¸²çš„ä¸ªæ•°ï¼›é‚£ä¹ˆsåˆ é™¤æ‰€ä»¥å…ƒç´ æ‰èƒ½ å‡ºç°ç©ºå­—ç¬¦ä¸²ï¼Œä¹Ÿå°±æ˜¯åªæœ‰ä¸€ç§æƒ…å†µï¼Œæ‰€ä»¥å°±æ˜¯dp[i] [0] = 1; dp[0] [j] ä»£è¡¨çš„å«ä¹‰æ˜¯ä»¥j-1ä¸ºç»“å°¾çš„tå¯ä»¥éšä¾¿åˆ é™¤å…ƒç´ ï¼Œå‡ºç°ç©ºå­—ç¬¦ä¸²çš„ä¸ªæ•°ï¼Œé‚£ä¹ˆè‚¯å®šå°±æ˜¯0ï¼Œå› ä¸ºsä¸ºç©ºï¼Œæ˜¯æ— è®ºå¦‚ä½•éƒ½ä¸å¯èƒ½å˜ä¸ºjçš„ï¼›æœ€åçœ‹dp[0] [0]ï¼Œåˆå§‹åŒ–ä¸º1</li><li>éå†é¡ºåºï¼šä»å·¦åˆ°å³ï¼Œä»ä¸Šåˆ°ä¸‹</li><li>ä¸¾ä¾‹æ¨å¯¼</li></ol><blockquote><p>åˆæ˜¯é‚£ä¸ªé—®é¢˜ï¼Œè¾¹ç•Œæ²¡æœ‰æ³¨æ„åˆ°</p></blockquote><h2 id="ä¸¤ä¸ªå­—ç¬¦ä¸²çš„åˆ é™¤æ“ä½œ"><a href="#ä¸¤ä¸ªå­—ç¬¦ä¸²çš„åˆ é™¤æ“ä½œ" class="headerlink" title="ä¸¤ä¸ªå­—ç¬¦ä¸²çš„åˆ é™¤æ“ä½œ"></a>ä¸¤ä¸ªå­—ç¬¦ä¸²çš„åˆ é™¤æ“ä½œ</h2><p>ä¸¤ç§åŠ¨æ€è§„åˆ’çš„æ€è·¯ï¼š</p><p>æ€è·¯ä¸€ï¼šä¸ä¸Šè¿°çš„æœ€é•¿å…¬å…±å­åºåˆ—ç›¸åŒï¼Œåªä¸è¿‡å¤šäº†ä¸€æ­¥ç”¨ä¸¤ä¸ªå­—ç¬¦ä¸²çš„æ€»é•¿åº¦å‡å»æœ€é•¿å…¬å…±å­åºåˆ—çš„é•¿åº¦</p><p>æ€è·¯äºŒï¼š</p><p>åŠ¨æ€è§„åˆ’äº”éƒ¨æ›²ï¼š</p><ol><li>ç¡®å®šdpæ•°ç»„çš„å«ä¹‰ï¼šdp[i] [j]ï¼šä»¥i-1ä¸ºç»“å°¾çš„å­—ç¬¦ä¸²word1ï¼Œå’Œä»¥j-1ä½ç»“å°¾çš„å­—ç¬¦ä¸²word2ï¼Œæƒ³è¦è¾¾åˆ°ç›¸ç­‰ï¼Œæ‰€éœ€è¦åˆ é™¤å…ƒç´ çš„æœ€å°‘æ¬¡æ•°ã€‚</li><li>ç¡®å®šé€’æ¨å…¬å¼ï¼š<br>word[i] å’Œword[j]ç›¸ç­‰ï¼šç›¸ç­‰å¥½è¯´ï¼Œç›´æ¥dp[i] [j] = dp[i - 1] [j - 1]<br>word[i] å’Œword[j]ä¸ç­‰ï¼šä¸ç­‰åˆæœ‰ä¸‰ç§æƒ…å†µå¯ä»¥æ“ä½œï¼Œåˆ æ‰i+1ï¼Œåˆ æ‰j+1ï¼ŒåŒæ—¶åˆ æ‰iå’Œj+2ï¼›å–æœ€å°å€¼</li><li>åˆå§‹åŒ–ï¼šdp[i] [0] å’Œdp[j] [0] å’Œdp[0] [0]æ˜¯å¿…é¡»è¦åˆå§‹åŒ–çš„ï¼›dp[i] [0]åˆå§‹åŒ–ä¸ºiï¼Œdp[0] [j]åˆå§‹åŒ–ä¸ºjï¼Œdp[0] [0]åˆå§‹åŒ–ä¸º0</li><li>éå†é¡ºåºï¼šä¸¤å±‚å¾ªç¯ï¼Œå¤–å±‚i</li><li>ä¸¾ä¾‹æ¨å¯¼</li></ol><blockquote><p>1ã€Math.min() è¯¥æ–¹æ³•åªèƒ½æ¯”è¾ƒä¸¤ä¸ªæ•°çš„å¤§å°ï¼Œç¢°åˆ°ä¸‰ä¸ªçš„å°±ç”¨ä¸¤æ¬¡è¯¥æ–¹æ³•å§</p><p>2ã€è¦æ±‚æœ€å°å€¼ï¼Œé‚£ä¹ˆæ¯ä¸€æ¬¡æ“ä½œçš„+1å¿…ä¸å¯å°‘</p></blockquote><h2 id="ç¼–è¾‘è·ç¦»-ï¼ˆç»å…¸ï¼‰"><a href="#ç¼–è¾‘è·ç¦»-ï¼ˆç»å…¸ï¼‰" class="headerlink" title="==ç¼–è¾‘è·ç¦»==ï¼ˆç»å…¸ï¼‰"></a>==ç¼–è¾‘è·ç¦»==ï¼ˆç»å…¸ï¼‰</h2><p>åŠ¨æ€è§„åˆ’äº”éƒ¨æ›²ï¼š</p><ol><li>ç¡®å®šdpæ•°ç»„çš„å«ä¹‰ï¼šdp[i] [j]ï¼šä»¥i-1ä¸ºç»“å°¾çš„å­—ç¬¦ä¸²word1ï¼Œå’Œä»¥j-1ä½ç»“å°¾çš„å­—ç¬¦ä¸²word2ï¼Œæƒ³è¦è¾¾åˆ°ç›¸ç­‰ï¼Œæ‰€éœ€è¦æ“ä½œå…ƒç´ çš„æœ€å°‘æ¬¡æ•°ã€‚</li><li>ç¡®å®šé€’æ¨å…¬å¼ï¼š<br>åˆ†ä¸¤ç§æƒ…å†µï¼šè¦ä¹ˆç›¸ç­‰ã€è¦ä¹ˆä¸ç­‰<br>ç›¸ç­‰çš„æƒ…å†µï¼šç›´æ¥dp[i] [j] = dp[i - 1] [j - 1]<br>ä¸ç­‰çš„æƒ…å†µï¼šåˆåˆ†ä¸‰ç§æƒ…å†µï¼Œéœ€è¦word1å¢ã€åˆ ã€æ”¹<pre><code class="hljs">                   å¢ï¼šword1å¢ä¹Ÿå³word2åˆ ï¼Œå³dp[i] [j] = dp[i] [j - 1] + 1                   åˆ ï¼šdp[i] [j] = dp[i - 1] [j] + 1                   æ”¹ï¼šæ”¹æ„æ€æ˜¯word1 å’Œ word2 ç›¸ç­‰ï¼Œå³dp[i] [j] = dp[i - 1] [j - 1] + 1</code></pre>å–æœ€å°å€¼</li><li>åˆå§‹åŒ–ï¼šä»é€’æ¨å…¬å¼å¯ä»¥çœ‹å‡ºï¼Œå¸¦0çš„å¿…é¡»åˆå§‹åŒ–ï¼Œdp[i] [0]åˆå§‹åŒ–ä¸ºiï¼Œdp[0] [j] åˆå§‹åŒ–ä¸ºj</li><li>éå†é¡ºåºï¼šä¸¤å±‚å¾ªç¯ï¼Œå¤–å±‚i</li><li>ä¸¾ä¾‹æ¨å¯¼</li></ol><p>æˆ‘æ„¿ç§°ä¹‹ä¸ºç»å…¸</p><h2 id="å›æ–‡å­ä¸²"><a href="#å›æ–‡å­ä¸²" class="headerlink" title="å›æ–‡å­ä¸²"></a>å›æ–‡å­ä¸²</h2><p>åŠ¨æ€è§„åˆ’äº”éƒ¨æ›²ï¼š</p><ol><li>ç¡®å®šdpæ•°ç»„çš„å«ä¹‰ï¼šdp[i] [j] è¡¨ç¤ºiåˆ°jçš„å›æ–‡æ•°</li><li>ç¡®å®šé€’æ¨å…¬å¼ï¼š<br>åŒæ ·ï¼Œs[i] å’Œs[j] åˆ†ç›¸ç­‰å’Œä¸ç­‰<br>ä¸ç­‰ï¼šdp[i] [j] = false<br>ç›¸ç­‰ï¼šiå’Œjç›¸ç­‰æˆ–ç›¸å·®1ï¼Œå¦‚a,   aa;   i å’Œjç›¸å·®å¤§äº1ï¼Œå¤§äº1ï¼Œè¯´æ˜ä¸¤ä¸ªè¾¹å·²ç»æ˜¯å›æ–‡äº†ï¼Œé‚£ä¹ˆå°±åˆ¤æ–­é‡Œé¢æ˜¯å¦ä¹Ÿæ˜¯å›æ–‡ï¼Œä¹Ÿå³åˆ¤æ–­i+1 å’Œ j - 1ï¼›</li><li>åˆå§‹åŒ–ï¼šdp[i] [j]åˆå§‹åŒ–ä¸ºfalse</li><li>éå†é¡ºåºï¼šdp[i] [j] ç”¨åˆ°äº† dp[i+1] [j-1]ã€‚æ„æ€æ˜¯è¦ç”¨åˆ°å·¦ä¸‹è§’çš„æ•°æ®ï¼Œæ‰€ä»¥æ˜¯ä»ä¸‹åˆ°ä¸Šï¼Œä»å·¦åˆ°å³</li><li>ä¸¾ä¾‹æ¨å¯¼</li></ol><blockquote><p>if (dp[i] [j])  å’Œ if (dp[i] [j] == true)æ˜¯åˆ¤æ–­æ˜¯å¦ä¸ºtrue<br>if (dp[i] [j] = true) æ˜¯èµ‹å€¼</p></blockquote><p>è¿˜æœ‰ä¸€ç§æ€è·¯ï¼š</p><p>ä¸­å¿ƒæ‰©æ•£æ³•ã€‚  éå†æ¯ä¸ªå›æ–‡ä¸­å¿ƒï¼Œè‹¥ç›¸ç­‰åŒæ—¶å‘ä¸¤è¾¹æ‰©æ•£ï¼ŒåŒæ—¶æ€»æ•°+1</p><h2 id="æœ€é•¿å›æ–‡å­åºåˆ—"><a href="#æœ€é•¿å›æ–‡å­åºåˆ—" class="headerlink" title="æœ€é•¿å›æ–‡å­åºåˆ—"></a>æœ€é•¿å›æ–‡å­åºåˆ—</h2><p>åŠ¨æ€è§„åˆ’äº”éƒ¨æ›²ï¼š</p><ol><li>ç¡®å®šdpæ•°ç»„çš„å«ä¹‰ï¼šdp[i] [j] è¡¨ç¤ºiåˆ°jçš„å›æ–‡æ•°</li><li>ç¡®å®šé€’æ¨å…¬å¼ï¼š<br>ä¸¤ç§æƒ…å†µï¼Œs[i] å’Œ s[j] ç›¸ç­‰ï¼Œä¸ç­‰<br>ç›¸ç­‰ï¼š  é‚£ä¹ˆå‘é‡Œè¾¹æ‰©æ•£ï¼Œå³dp[i] [j] = dp[i + 1] [ j -1] + 2<br>ä¸ç­‰ï¼š åˆ¤æ–­å‘å·¦å¤§è¿˜æ˜¯å‘å³ï¼Œå³dp[i] [j] = max(dp[i + 1] [j], dp[i] [ j - 1], dp[i] [j])</li><li>åˆå§‹åŒ–ï¼šdp[i] [i] åˆå§‹åŒ–ä¸º1ï¼Œå…¶ä½™åˆå§‹åŒ–ä¸º0</li><li>éå†é¡ºåºï¼šéå†é¡ºåºä»é€’æ¨å…¬å¼å¼€å§‹ï¼Œå¯ä»¥çœ‹å‡ºï¼Œè¿™ä¸€è¡Œç”¨åˆ°çš„æ•°æ®éœ€è¦ç”¨åˆ°ä¸‹ä¸€è¡Œçš„æ•°æ®ï¼Œé‚£ä¹Ÿå°±æ˜¯ä»ä¸‹åˆ°ä¸Šï¼Œä»å·¦åˆ°å³</li><li>ä¸¾ä¾‹æ¨å¯¼</li></ol><hr><h4 id="1235-è§„åˆ’å…¼èŒå·¥ä½œ"><a href="#1235-è§„åˆ’å…¼èŒå·¥ä½œ" class="headerlink" title="1235. è§„åˆ’å…¼èŒå·¥ä½œ"></a><a href="https://leetcode.cn/problems/maximum-profit-in-job-scheduling/">1235. è§„åˆ’å…¼èŒå·¥ä½œ</a></h4>]]></content>
    
    
    <categories>
      
      <category>ç®—æ³•</category>
      
    </categories>
    
    
    <tags>
      
      <tag>java</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>æˆ‘çš„ç¬¬ä¸€ç¯‡åšå®¢æ–‡ç« </title>
    <link href="/2022/09/15/wo-de-di-yi-pian-bo-ke-wen-zhang/"/>
    <url>/2022/09/15/wo-de-di-yi-pian-bo-ke-wen-zhang/</url>
    
    <content type="html"><![CDATA[<p>ç¬¬ä¸€ç« </p><p>ç¬¬äºŒç« </p><p>å†…å®¹</p><p>å‚è€ƒæ–‡çŒ®</p><p>åŸŸå</p>]]></content>
    
    
    <categories>
      
      <category>éšç¬”</category>
      
    </categories>
    
    
    <tags>
      
      <tag>å°è®°</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Hello World</title>
    <link href="/2022/09/15/hello-world/"/>
    <url>/2022/09/15/hello-world/</url>
    
    <content type="html"><![CDATA[<p>Welcome to <a href="https://hexo.io/">Hexo</a>! This is your very first post. Check <a href="https://hexo.io/docs/">documentation</a> for more info. If you get any problems when using Hexo, you can find the answer in <a href="https://hexo.io/docs/troubleshooting.html">troubleshooting</a> or you can ask me on <a href="https://github.com/hexojs/hexo/issues">GitHub</a>.</p><h2 id="Quick-Start"><a href="#Quick-Start" class="headerlink" title="Quick Start"></a>Quick Start</h2><h3 id="Create-a-new-post"><a href="#Create-a-new-post" class="headerlink" title="Create a new post"></a>Create a new post</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">$ hexo new <span class="hljs-string">&quot;My New Post&quot;</span><br></code></pre></td></tr></table></figure><p>More info: <a href="https://hexo.io/docs/writing.html">Writing</a></p><h3 id="Run-server"><a href="#Run-server" class="headerlink" title="Run server"></a>Run server</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">$ hexo server<br></code></pre></td></tr></table></figure><p>More info: <a href="https://hexo.io/docs/server.html">Server</a></p><h3 id="Generate-static-files"><a href="#Generate-static-files" class="headerlink" title="Generate static files"></a>Generate static files</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">$ hexo generate<br></code></pre></td></tr></table></figure><p>More info: <a href="https://hexo.io/docs/generating.html">Generating</a></p><h3 id="Deploy-to-remote-sites"><a href="#Deploy-to-remote-sites" class="headerlink" title="Deploy to remote sites"></a>Deploy to remote sites</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">$ hexo deploy<br></code></pre></td></tr></table></figure><p>More info: <a href="https://hexo.io/docs/one-command-deployment.html">Deployment</a></p>]]></content>
    
    
    <categories>
      
      <category>éšç¬”</category>
      
    </categories>
    
    
    <tags>
      
      <tag>å°è®°</tag>
      
    </tags>
    
  </entry>
  
  
  
  
</search>
